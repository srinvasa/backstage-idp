(self.webpackChunkapp=self.webpackChunkapp||[]).push([["6290"],{45575:function(e,t,r){"use strict";r.d(t,{f:()=>c});var n=r(31085),i=r(77125),s=r(99703),o=r(58837),l=r(72501);let a=(0,o.A)(e=>(0,s.A)({root:{color:e.palette.text.primary,padding:e.spacing(2,2,3),backgroundImage:e.getPageTheme({themeId:"card"}).backgroundImage,backgroundPosition:0,backgroundSize:"inherit"}}),{name:"BackstageItemCardHeader"});function c(e){let{title:t,subtitle:r,children:s}=e,o=a(e);return(0,n.jsxs)(i.A,{className:o.root,children:[r&&(0,n.jsx)(l.A,{variant:"subtitle2",component:"h3",children:r}),t&&(0,n.jsx)(l.A,{variant:"h6",component:"h4",children:t}),s]})}},13977:function(e,t,r){"use strict";r.d(t,{m:()=>m});var n=r(31085),i=r(79089),s=r(18139),o=r(34477),l=r(77125),a=r(14041),c=r(49724),h=r(18453);r(46343),r(40074),r(46123),r(96403);var u=r(73466),d=r(30043),f=r(80084),p=r(10265);let m=e=>{let t,r,{allowedKinds:m,hidden:g,initialFilter:y="component"}=e,{t:v}=(0,p.i)(f.j),x=(0,s.gf)(o.k),{error:b,allKinds:w,selectedKind:k,setSelectedKind:A}=function(e){let{filters:t,queryParameters:{kind:r},updateFilters:n}=(0,h.nK)(),i=(0,a.useMemo)(()=>[r].flat()[0],[r]),[o,l]=(0,a.useState)(i??t.kind?.value??e.initialFilter);(0,a.useEffect)(()=>{i&&l(i)},[i]),(0,a.useEffect)(()=>{t.kind?.value&&l(t.kind?.value)},[t.kind]);let{allKinds:f,loading:p,error:m}=function(){let e=(0,s.gf)(d.v),{error:t,loading:r,value:n}=(0,u.A)(async()=>{let{facets:t}=await e.getEntityFacets({facets:["kind"]});return new Map((t.kind??[]).map(e=>e.value).map(e=>[e.toLocaleLowerCase("en-US"),e]))},[e]);return{loading:r,error:t,allKinds:n??new Map}}(),g=f.get(o)||o;return(0,a.useEffect)(()=>{n({kind:o?new c.gM(o,g):void 0})},[o,g,n]),{loading:p,error:m,allKinds:f,selectedKind:o,setSelectedKind:l}}({initialFilter:y});if((0,a.useEffect)(()=>{b&&x.post({message:v("entityKindPicker.errorMessage"),severity:"error"})},[b,x,v]),b)return null;let S=[...(t=Array.from(w.keys()),m&&(t=m.map(e=>e.toLocaleLowerCase("en-US")).filter(e=>w.has(e))),r=new Map(t.map(e=>[e,w.get(e)||e])),k&&!r.has(k)&&r.set(k.toLocaleLowerCase("en-US"),k),r).entries()].map(([e,t])=>({label:t,value:e}));return g?null:(0,n.jsx)(l.A,{pb:1,pt:1,children:(0,n.jsx)(i.w,{label:v("entityKindPicker.title"),items:S,selected:k.toLocaleLowerCase("en-US"),onChange:e=>A(String(e))})})}},79533:function(e,t,r){"use strict";r.d(t,{l:()=>x});var n=r(31085),i=r(95061),s=r(29365),o=r(63301),l=r(34839),a=r(75173),c=r(58837),h=r(64704),u=r(45917),d=r(14041),f=r(16983),p=r(18453),m=r(49724),g=r(80084),y=r(10265);let v=(0,c.A)(e=>({searchToolbar:{paddingLeft:0,paddingRight:0},input:{}}),{name:"CatalogReactEntitySearchBar"}),x=()=>{let e=v(),{t}=(0,y.i)(g.j),{updateFilters:r,queryParameters:{text:c}}=(0,p.nK)(),x=(0,d.useMemo)(()=>[c].flat()[0],[c]),[b,w]=(0,d.useState)(x??"");return(0,f.default)(()=>{r({text:b.length?new m.V3(b):void 0})},250,[b,r]),(0,d.useEffect)(()=>{x&&w(x)},[x]),(0,n.jsx)(a.A,{className:e.searchToolbar,children:(0,n.jsx)(i.A,{children:(0,n.jsx)(o.A,{"aria-label":"search",id:"input-with-icon-adornment",className:e.input,placeholder:t("entitySearchBar.placeholder"),autoComplete:"off",onChange:e=>w(e.target.value),value:b,startAdornment:(0,n.jsx)(l.A,{position:"start",children:(0,n.jsx)(u.default,{})}),endAdornment:(0,n.jsx)(l.A,{position:"end",children:(0,n.jsx)(s.A,{"aria-label":"clear search",onClick:()=>w(""),edge:"end",disabled:0===b.length,children:(0,n.jsx)(h.default,{})})})})})})}},57278:function(e,t,r){"use strict";r.d(t,{j:()=>f});var n=r(14041),i=r(73466),s=r(46343),o=r.n(s),l=r(40074),a=r.n(l),c=r(18139),h=r(30043),u=r(18453),d=r(49724);function f(){let e=(0,c.gf)(h.v),{filters:{kind:t,type:r},queryParameters:{type:s},updateFilters:l}=(0,u.nK)(),f=(0,n.useMemo)(()=>[s].flat().filter(Boolean),[s]),[p,m]=(0,n.useState)(f.length?f:r?.getTypes()??[]);(0,n.useEffect)(()=>{f.length&&m(f)},[f]);let[g,y]=(0,n.useState)([]),v=(0,n.useMemo)(()=>t?.value,[t]),{error:x,loading:b,value:w}=(0,i.A)(async()=>v?await e.getEntityFacets({filter:{kind:v},facets:["spec.type"]}).then(e=>e.facets["spec.type"]||[]):[],[v,e]),k=(0,n.useRef)(w);return(0,n.useEffect)(()=>{let e=k.current;if(k.current=w,b||!v||e===w||!w)return;let t=[...new Set(a()(w,e=>-e.count).map(e=>e.value.toLocaleLowerCase("en-US")))];y(t);let r=p.filter(e=>t.includes(e));o()(p,r)||m(r)},[b,v,p,m,w]),(0,n.useEffect)(()=>{l({type:p.length?new d.qA(p):void 0})},[p,l]),{loading:b,error:x,availableTypes:g,selectedTypes:p,setSelectedTypes:m}}},39641:function(e,t,r){"use strict";let n,i,s,o,l,a;r.d(t,{Router:()=>jX});var c,h,u,d,f,p,m,g,y={};r.r(y),r.d(y,{DescriptionField:()=>h7});var v=r(31085),x=r(18690),b=r(91042),w=r(76842),k=r(18139),A=r(77026),S=r(19579);let C={AdditionalItemsError:"Array at `{{pointer}}` may not have an additional item `{{key}}`",AdditionalPropertiesError:"Additional property `{{property}}` on `{{pointer}}` does not match schema `{{schema}}`",AllOfError:"Value `{{value}}` at `{{pointer}}` does not match schema of `{{allOf}}`",AnyOfError:"Value `{{value}}` at `{{pointer}}` does not match any schema of `{{anyOf}}`",ConstError:"Expected value at `{{pointer}}` to be `{{expected}}`, but value given is `{{value}}`",containsAnyError:"The array at `{{pointer}}` must contain at least one item",ContainsArrayError:"The property at `{{pointer}}` must not be an array",ContainsError:"The array at `{{pointer}}` must contain an element that matches `{{schema}}`",EnumError:"Expected given value `{{value}}` in `{{pointer}}` to be one of `{{values}}`",ForbiddenPropertyError:"Property name `{{property}}` at `{{pointer}}` is not allowed",FormatDateError:"Value `{{value}}` at `{{pointer}}` is not a valid date",FormatDateTimeError:"Value `{{value}}` at `{{pointer}}` is not a valid date-time",FormatEmailError:"Value `{{value}}` at `{{pointer}}` is not a valid email",FormatHostnameError:"Value `{{value}}` at `{{pointer}}` is not a valid hostname",FormatIPV4Error:"Value `{{value}}` at `{{pointer}}` is not a valid IPv4 address",FormatIPV4LeadingZeroError:"IPv4 addresses starting with zero are invalid, since they are interpreted as octals",FormatIPV6Error:"Value `{{value}}` at `{{pointer}}` is not a valid IPv6 address",FormatIPV6LeadingZeroError:"IPv6 addresses starting with zero are invalid, since they are interpreted as octals",FormatJsonPointerError:"Value `{{value}}` at `{{pointer}}` is not a valid json-pointer",FormatRegExError:"Value `{{value}}` at `{{pointer}}` is not a valid regular expression",FormatTimeError:"Value `{{value}}` at `{{pointer}}` is not a valid time",FormatURIError:"Value `{{value}}` at `{{pointer}}` is not a valid uri",FormatURIReferenceError:"Value `{{value}}` at `{{pointer}}` is not a valid uri-reference",FormatURITemplateError:"Value `{{value}}` at `{{pointer}}` is not a valid uri-template",FormatURLError:"Value `{{value}}` at `{{pointer}}` is not a valid url",InvalidDataError:"No value may be specified in `{{pointer}}`",InvalidPropertyNameError:"Invalid property name `{{property}}` at `{{pointer}}`",MaximumError:"Value in `{{pointer}}` is `{{length}}`, but should be `{{maximum}}` at maximum",MaxItemsError:"Too many items in `{{pointer}}`, should be `{{maximum}}` at most, but got `{{length}}`",MaxLengthError:"Value `{{pointer}}` should have a maximum length of `{{maxLength}}`, but got `{{length}}`.",MaxPropertiesError:"Too many properties in `{{pointer}}`, should be `{{maximum}}` at most, but got `{{length}}`",MinimumError:"Value in `{{pointer}}` is `{{length}}`, but should be `{{minimum}}` at minimum",MinItemsError:"Too few items in `{{pointer}}`, should be at least `{{minItems}}`, but got `{{length}}`",MinItemsOneError:"At least one item is required in `{{pointer}}`",MinLengthError:"Value `{{pointer}}` should have a minimum length of `{{minLength}}`, but got `{{length}}`.",MinLengthOneError:"A value is required in `{{pointer}}`",MinPropertiesError:"Too few properties in `{{pointer}}`, should be at least `{{minimum}}`, but got `{{length}}`",MissingDependencyError:"The required propery '{{missingProperty}}' in `{{pointer}}` is missing",MissingOneOfPropertyError:"Value at `{{pointer}}` property: `{{property}}`",MultipleOfError:"Expected `{{value}}` in `{{pointer}}` to be multiple of `{{multipleOf}}`",MultipleOneOfError:"Value `{{value}}` should not match multiple schemas in oneOf `{{matches}}`",NoAdditionalPropertiesError:"Additional property `{{property}}` in `{{pointer}}` is not allowed",NotError:"Value `{{value}}` at pointer should not match schema `{{not}}`",OneOfError:"Value `{{value}}` in `{{pointer}}` does not match any given oneof schema",OneOfPropertyError:"Failed finding a matching oneOfProperty schema in `{{pointer}}` where `{{property}}` matches `{{value}}`",PatternError:"Value in `{{pointer}}` should match `{{description}}`, but received `{{received}}`",PatternPropertiesError:"Property `{{key}}` does not match any patterns in `{{pointer}}`. Valid patterns are: {{patterns}}",RequiredPropertyError:"The required property `{{key}}` is missing at `{{pointer}}`",SchemaWarning:"Failed retrieving a schema from '{{pointer}}' to key '{{key}}'",TypeError:"Expected `{{value}}` ({{received}}) in `{{pointer}}` to be of type `{{expected}}`",UndefinedValueError:"Value must not be undefined in `{{pointer}}`",UniqueItemsError:"Items in array must be unique. Value `{{value}}` in `{{pointer}}` is a duplicate of {{duplicatePointer}}.",UnknownPropertyError:"Could not find a valid schema for property `{{pointer}}` within object",ValueNotEmptyError:"A value for `{{property}}` is required at `{{pointer}}`"},E=Object.prototype.toString;function j(e){let t=E.call(e).match(/\s([^\]]+)\]/).pop().toLowerCase();return"file"===t?"object":t}function O(e,t){return{type:"error",name:e,code:e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),message:function(e,t,r=e){var n;return function(e,t={}){return e.replace(/\{\{\w+\}\}/g,e=>{let r=t[e.replace(/[{}]/g,"")],n=j(r);return"object"===n||"array"===n?JSON.stringify(r):r})}(null!=(n=C[e])?n:r,t)}(e,t),data:t}}function P(e){return O.bind(null,e)}function M(e,t=[]){for(let r=0;r<e.length;r+=1){let n=e[r];Array.isArray(n)?M(n,t):t.push(n)}return t}let T={DECLARATOR_ONEOF:"oneOfProperty",GET_TEMPLATE_RECURSION_LIMIT:1,propertyBlacklist:["_id"],templateDefaultOptions:{addOptionalProps:!1,removeInvalidData:!1,extendDefaults:!0}};function I(e,t,r){let n={...t};return Object.defineProperty(n,"getOneOfOrigin",{enumerable:!1,value:()=>({index:r,schema:e})}),n}function $(e){return(null==e?void 0:e.type)==="error"}function D(e){return $(e)||e instanceof Promise}let{DECLARATOR_ONEOF:R}=T;function N(e,t,r=e.rootSchema,n="#"){if(null!=t&&r[R]){let i=[],s=r[R],o=t[r[R]];if(void 0===o)return e.errors.missingOneOfPropertyError({property:s,pointer:n,schema:r,value:t});for(let l=0;l<r.oneOf.length;l+=1){let a=e.resolveRef(r.oneOf[l]),c=e.step(s,a,t,n);if($(c))return c;let h=M(e.validate(o,c,n));if(!((h=h.filter(D)).length>0))return I(r,a,l);i.push(...h)}return e.errors.oneOfPropertyError({property:s,value:o,pointer:n,schema:r,errors:i})}let i=[];for(let s=0;s<r.oneOf.length;s+=1){let o=e.resolveRef(r.oneOf[s]);e.isValid(t,o,n)&&i.push({schema:o,index:s})}if(1===i.length)return I(r,i[0].schema,i[0].index);if("object"===j(t)){let i,s=-1,o=0;for(let n=0;n<r.oneOf.length;n+=1){let l=e.resolveRef(r.oneOf[n]),a=function(e,t,r,n){if(null==r||null==t.properties)return -1;let i=0,s=Object.keys(t.properties);for(let n=0;n<s.length;n+=1){let o=s[n];null!=r[o]&&e.isValid(r[o],t.properties[o],void 0)&&(i+=1)}return i}(e,l,t);o<a&&(o=a,i=r.oneOf[n],s=n)}return void 0===i?e.errors.oneOfError({value:JSON.stringify(t),pointer:n,schema:r,oneOf:r.oneOf}):I(r,i,s)}return i.length>1?e.errors.multipleOneOfError({matches:i,pointer:n,schema:r,value:t}):e.errors.oneOfError({value:JSON.stringify(t),pointer:n,schema:r,oneOf:r.oneOf})}var L=r(52743),F=r.n(L);let _=(e,t)=>t,B=(e,t)=>F()(e,t,{arrayMerge:_}),z=(e,t)=>{let r=e.concat(t);return r.filter((e,t)=>r.indexOf(e)===t)};function W(e,t){if(j(e)!==j(t))return e;let r=F()(e,t,{arrayMerge:z});return e.getOneOfOrigin?Object.defineProperty(r,"getOneOfOrigin",{enumerable:!1,value:e.getOneOfOrigin}):t.getOneOfOrigin&&Object.defineProperty(r,"getOneOfOrigin",{enumerable:!1,value:t.getOneOfOrigin}),r}function V(e,...t){let r={};return Object.keys(e).forEach(n=>{t.includes(n)||(r[n]=e[n])}),e.getOneOfOrigin&&Object.defineProperty(r,"getOneOfOrigin",{enumerable:!1,value:e.getOneOfOrigin}),r}var H=Function.prototype.toString,U=Object.create,q=Object.prototype.toString,K=function(){function e(){this._keys=[],this._values=[]}return e.prototype.has=function(e){return!!~this._keys.indexOf(e)},e.prototype.get=function(e){return this._values[this._keys.indexOf(e)]},e.prototype.set=function(e,t){this._keys.push(e),this._values.push(t)},e}(),G="undefined"!=typeof WeakMap?function(){return new WeakMap}:function(){return new K};function J(e){if(!e)return U(null);var t=e.constructor;if(t===Object)return e===Object.prototype?{}:U(e);if(t&&~H.call(t).indexOf("[native code]"))try{return new t}catch(e){}return U(e)}var Y="g"===/test/g.flags?function(e){return e.flags}:function(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t};function X(e){var t=q.call(e);return t.substring(8,t.length-1)}var Z="undefined"!=typeof Symbol?function(e){return e[Symbol.toStringTag]||X(e)}:X,Q=Object.defineProperty,ee=Object.getOwnPropertyDescriptor,et=Object.getOwnPropertyNames,er=Object.getOwnPropertySymbols,en=Object.prototype,ei=en.hasOwnProperty,es=en.propertyIsEnumerable,eo="function"==typeof er,el=eo?function(e){return et(e).concat(er(e))}:et;function ea(e,t,r){for(var n=el(e),i=0,s=n.length,o=void 0,l=void 0;i<s;++i)if("callee"!==(o=n[i])&&"caller"!==o){if(!(l=ee(e,o))){t[o]=r.copier(e[o],r);continue}l.get||l.set||(l.value=r.copier(l.value,r));try{Q(t,o,l)}catch(e){t[o]=l.value}}return t}function ec(e,t){return e.slice(0)}function eh(e,t){var r=new t.Constructor;return t.cache.set(e,r),e.forEach(function(e,n){r.set(n,t.copier(e,t))}),r}function eu(e,t){return new t.Constructor(e.valueOf())}function ed(e,t){return e}function ef(e,t){var r=new t.Constructor;return t.cache.set(e,r),e.forEach(function(e){r.add(t.copier(e,t))}),r}var ep=Array.isArray,em=Object.assign,eg=Object.getPrototypeOf||function(e){return e.__proto__},ey={array:function(e,t){var r=new t.Constructor;t.cache.set(e,r);for(var n=0,i=e.length;n<i;++n)r[n]=t.copier(e[n],t);return r},arrayBuffer:ec,blob:function(e,t){return e.slice(0,e.size,e.type)},dataView:function(e,t){return new t.Constructor(ec(e.buffer))},date:function(e,t){return new t.Constructor(e.getTime())},error:ed,map:eh,object:eo?function(e,t){var r=J(t.prototype);for(var n in t.cache.set(e,r),e)ei.call(e,n)&&(r[n]=t.copier(e[n],t));for(var i=er(e),s=0,o=i.length,l=void 0;s<o;++s)l=i[s],es.call(e,l)&&(r[l]=t.copier(e[l],t));return r}:function(e,t){var r=J(t.prototype);for(var n in t.cache.set(e,r),e)ei.call(e,n)&&(r[n]=t.copier(e[n],t));return r},regExp:function(e,t){var r=new t.Constructor(e.source,Y(e));return r.lastIndex=e.lastIndex,r},set:ef},ev=em({},ey,{array:function(e,t){var r=new t.Constructor;return t.cache.set(e,r),ea(e,r,t)},map:function(e,t){return ea(e,eh(e,t),t)},object:function(e,t){var r=J(t.prototype);return t.cache.set(e,r),ea(e,r,t)},set:function(e,t){return ea(e,ef(e,t),t)}});function ex(e){var t,r={Arguments:(t=em({},ey,e)).object,Array:t.array,ArrayBuffer:t.arrayBuffer,Blob:t.blob,Boolean:eu,DataView:t.dataView,Date:t.date,Error:t.error,Float32Array:t.arrayBuffer,Float64Array:t.arrayBuffer,Int8Array:t.arrayBuffer,Int16Array:t.arrayBuffer,Int32Array:t.arrayBuffer,Map:t.map,Number:eu,Object:t.object,Promise:ed,RegExp:t.regExp,Set:t.set,String:eu,WeakMap:ed,WeakSet:ed,Uint8Array:t.arrayBuffer,Uint8ClampedArray:t.arrayBuffer,Uint16Array:t.arrayBuffer,Uint32Array:t.arrayBuffer,Uint64Array:t.arrayBuffer},n=r.Array,i=r.Object;function s(e,t){if(t.prototype=t.Constructor=void 0,!e||"object"!=typeof e)return e;if(t.cache.has(e))return t.cache.get(e);if(t.prototype=eg(e),t.Constructor=t.prototype&&t.prototype.constructor,!t.Constructor||t.Constructor===Object)return i(e,t);if(ep(e))return n(e,t);var s=r[Z(e)];return s?s(e,t):"function"==typeof e.then?e:i(e,t)}return function(e){return s(e,{Constructor:void 0,cache:G(),copier:s,prototype:void 0})}}ex(em({},ev,{}));var eb=ex({});function ew(e,t,r){if(null!=t.if){if(!1===t.if)return t.else;if(t.if&&(t.then||t.else)){let n=e.validate(r,e.resolveRef(t.if));if(0===n.length&&t.then)return e.resolveRef(t.then);if(0!==n.length&&t.else)return e.resolveRef(t.else)}}}function ek(e,t,r){var n;let i={...null!=(n=e.resolveRef(t))?n:{}},s=ew(e,i,r);return s||V(i,"if","then","else")}function eA(e,t){let{allOf:r}=t;if(!Array.isArray(r)||0===r.length)return;let n={};return r.forEach(t=>{n=W(n,e.resolveRef(t))}),n}function eS(e){return"object"===j(e)}function eC(e,t,r){let{dependencies:n}=t;if(!eS(n)||!eS(r))return;let i=!1,s={required:[]};if(Object.keys(n).forEach(o=>{var l,a;if(null==r[o]&&!((null==(l=t.required)?void 0:l.includes(o))||(null==(a=s.required)?void 0:a.includes(o))))return;let c=n[o];if(Array.isArray(c)){i=!0,s.required.push(...c);return}if(eS(c)){i=!0,s=W(s,e.resolveRef(c));return}}),i){var o;return s.required=(o=s.required).filter((e,t)=>o.indexOf(e)===t),s}}function eE(e,t,r){let n;if(Array.isArray(t.anyOf)&&0!==t.anyOf.length)return t.anyOf.forEach(t=>{t=e.resolveRef(t),e.isValid(r,t)&&(n=n?W(n,t):t)}),n}let ej=["allOf","anyOf","oneOf","dependencies","if","then","else"],eO=["allOf","anyOf","oneOf","dependencies","if"],eP=["allOf","anyOf","oneOf","dependencies","if","then","else"];function eM(e,t,r,n){let i=function e(t,r,n,i){let s,o;if((r=t.resolveRef(r)).oneOf){let e=N(t,n,r,i);$(e)?o=e:e&&(s=W(null!=s?s:{},e))}if(Array.isArray(r.allOf)){let o=r.allOf.map(r=>{let s;if(s=Object.keys(r),-1!==eO.findIndex(e=>s.includes(e))){let s=e(t,r,n,i);return s?V(s=W(r,s),...ej):void 0}return r});o.length>0&&(s=W(null!=s?s:{},eA(t,{allOf:o})))}let l=eE(t,r,n);l&&(s=W(null!=s?s:{},l));let a=eC(t,r,n);a&&(s=W(null!=s?s:{},a));let c=ew(t,r,n);if(c&&(s=W(null!=s?s:{},c)),null==s)return o;let h=e(t,s,n,i);return h&&(s=W(s,h)),V(s,...ej)}(e,t,r,n);return i?V(i=W(t,i),...eP):t}class eT{constructor(e,t){this.remotes={},this.errors={},this.typeKeywords={},this.validateKeyword={},this.validateType={},this.validateFormat={},this.config=e,this.typeKeywords=eb(e.typeKeywords),this.validateKeyword=Object.assign({},e.validateKeyword),this.validateType=Object.assign({},e.validateType),this.validateFormat=Object.assign({},e.validateFormat),this.errors=Object.assign({},e.errors),this.setSchema(t)}get rootSchema(){return this.__rootSchema}set rootSchema(e){null!=e&&(this.__rootSchema=this.config.compileSchema(this,e))}addRemoteSchema(e,t){this.config.addRemoteSchema(this,e,t)}compileSchema(e){var t;return this.config.compileSchema(this,e,null!=(t=this.rootSchema)?t:e)}createSchemaOf(e){return this.config.createSchemaOf(e)}each(e,t,r,n){return this.config.each(this,e,t,r,n)}eachSchema(e,t=this.rootSchema){return this.config.eachSchema(t,e)}getChildSchemaSelection(e,t){return this.config.getChildSchemaSelection(this,e,t)}getSchema(e){return this.config.getSchema(this,e)}getTemplate(e,t,r=this.config.templateDefaultOptions){return this.config.getTemplate(this,e,t,r)}isValid(e,t,r){return this.config.isValid(this,e,t,r)}resolveAnyOf(e,t,r){return this.config.resolveAnyOf(this,e,t,r)}resolveAllOf(e,t){return this.config.resolveAllOf(this,e,t)}resolveRef(e){return this.config.resolveRef(e,this.rootSchema)}resolveOneOf(e,t,r){return this.config.resolveOneOf(this,e,t,r)}setSchema(e){this.rootSchema=e}step(e,t,r,n){return this.config.step(this,e,t,r,n)}validate(e,t,r){return this.config.validate(this,e,t,r)}}var eI=r(95716),e$=r.n(eI),eD=r(22193);let eR="[^?/{}*,()#]+",eN=`
root ::= ("#" recursion | recursion | (query | pattern) recursion* | "#" SEP? | SEP)
recursion ::= (SEP query | pattern)*

query ::= (ESC escaped ESC | property | all | any | regex) typecheck? lookahead?
property ::= ${eR}
regex ::= "{" [^}]+ "}"
SEP ::= "/"
all ::= "**"
any ::= "*"

typecheck ::= "?:" ("value" | "boolean" | "string" | "number" | "object" | "array")
lookahead ::= "?" expression ((andExpr | orExpr) expression)*
andExpr ::= S? "&&" S?
orExpr ::= S? "||" S?

expression ::= (exprProperty | ESC escaped ESC) ((isnot | is) (exprProperty | regex | ESC escaped ESC))*
exprProperty ::= [a-zA-Z0-9-_ $]+
escaped ::= [^"]+
is ::= ":"
isnot ::= ":!"
ESC ::= '"'

pattern ::= S? "(" (SEP query | pattern (orPattern? pattern)*)* ")" quantifier? S? lookahead?
quantifier ::= "+" | "*" | [0-9]+
orPattern ::= S? "," S?

S ::= [ ]*
`,eL=new eD.default.Parser(eN),eF=(e,t)=>`${e}/${t}`,e_=Object.prototype.toString,eB=/Object|Array/,ez=e=>eB.test(e_.call(e));function eW(e){return new RegExp(e.text.replace(/(^{|}$)/g,""))}function eV(e){return Array.isArray(e)?e.map(function(e,t){return`${t}`}):"[object Object]"===Object.prototype.toString.call(e)?Object.keys(e):[]}let eH={mem:[],get(e,t){let r=e[0][t];if(!eH.mem.includes(r))return ez(r)&&eH.mem.push(r),[r,t,e[0],eF(e[3],t)]},reset(){eH.mem.length=0}},eU={any(e,t){let r=t[0];return eV(r).map(e=>[r[e],e,r,eF(t[3],e)])},all(e,t){var r,n;let i=[t];return r=t[0],n=(r,n)=>{let s=eH.get(t,n);s&&i.push(...eU.all(e,s))},Array.isArray(r)?r.forEach(n):"[object Object]"===Object.prototype.toString.call(r)&&Object.keys(r).forEach(function(e){n(r[e],e,r)}),i},regex(e,t){let r=eW(e),n=t[0];return eV(n).filter(e=>r.test(e)).map(e=>[n[e],e,n,eF(t[3],e)])}},eq={escaped:(e,t)=>eq.property(e,t),property:(e,t)=>{let r=e.text;if(t[0]&&void 0!==t[0][r])return[t[0][r],r,t[0],eF(t[3],r)]},typecheck:(e,t)=>{let r,n=e.text.replace(/^\?:/,"");return"value"===n?ez(t[0])?void 0:t:(r=t[0],e_.call(r).match(/\s([^\]]+)\]/).pop().toLowerCase()===n)?t:void 0},lookahead:(e,t)=>{let r=!0,n=!1;return e.children.forEach(e=>{if("expression"===e.type){let i=void 0!==eq.expression(e,t);r=!0===n?r||i:r&&i}else n="orExpr"===e.type}),r?t:void 0},expression:(e,t)=>{let r=e.children[0].text,n=e.children[1],i=e.children[2],s=t[0];if(!1!==ez(s))return!function(e,t,r){let n;if(void 0===t)return void 0!==e;let i=`${e}`;return n="regex"===r.type?eW(r).test(i):i===r.text,"isnot"===t.type&&(n=!1===n&&void 0!==e),n}(s[r],n,i)?void 0:t}},eK={value:e=>e.map(e=>e[0]),pointer:e=>e.map(e=>e[3]),all:e=>e,map:e=>{let t={};return e.forEach(e=>t[e[3]]=e[0]),t}};function eG(e,t,r=uq.VALUE){let n;if(null==t)return[];""===(t=t.replace(/(\/$)/g,""))&&(t="#");let i=(n=t,eL.getAST(n));if(null==i)throw Error(`empty ast for '${t}'`);if(""!==i.rest)throw Error(`Failed parsing queryString from: '${i.rest}'`);let s=(eH.reset(),eH.mem.push(e),function e(t,r,n){let i;if("query"===r.type){let e;e=t,r.children.forEach(t=>{if(eU[t.type])e=function(e,t,r,n){let i=[];for(let s=0,o=t.length;s<o;s+=1)i.push(...e(r,t[s],r,n));return i}(eU[t.type],e,t,n);else if(eq[t.type])e=function(e,t,r,n){let i=[];for(let s=0,o=t.length;s<o;s+=1){let o=e(r,t[s],n);o&&i.push(o)}return i}(eq[t.type],e,t,n);else throw Error(`Unknown filter ${t.type}`)}),i=e}else if("pattern"===r.type)i=function(t,r,n){let i=[],s=r.children.find(e=>"quantifier"===e.type),o=function(e){if(null==e)return 1;if("*"===e||"+"===e)return 1/0;let t=parseInt(e);return isNaN(t)?1:t}(s&&s.text),l=t;s&&"*"===s.text&&i.push(...l);let a=0;for(;l.length>0&&a<o;)i.push(...l=function(t,r,n){let i=[],s=t;return r.children.forEach(r=>{if("orPattern"===r.type){i.push(...s),s=t;return}s=e(s,r,n)}),i.push(...s),i}(l,r,n)),a+=1;return i}(t,r,n);else{let s;s=t,r.children.forEach(t=>s=e(s,t,n)),i=s}return eH.reset(),eH.mem.push(t),i}([[e,null,null,"#"]],i));return"function"==typeof r?s.map(e=>r(...e)):eK[r]?eK[r](s):s}(uW=uq||(uq={})).POINTER="pointer",uW.VALUE="value",uW.ALL="all",uW.MAP="map",eG.POINTER=uq.POINTER,eG.VALUE=uq.VALUE,eG.ALL=uq.ALL,eG.MAP=uq.MAP;let eJ=["root","recursion"],eY=e=>JSON.parse(JSON.stringify(e)),eX=Object.prototype.toString,eZ=e=>eX.call(e).match(/\s([^\]]+)\]/).pop().toLowerCase(),eQ=RegExp(`^("[^"]+"|${eR})$`),e0=["string","number","boolean","null"],e1=/^\[\d*\]$/,e2=/^\[(\d+)\]$/,e4=/^".+"$/,e3=/(^\[\d*\]$|^\d+$)/;function e5(e){return parseInt(e.replace(/^(\[|\]$)/,""))}function e6(e){return e4.test(e)?e.replace(/(^"|"$)/g,""):e}function e9(e,t,r,n){let i=e[0];if(/^\[\]$/.test(t)){i.push(r);let t=i.length-1;return[i[t],t,i,`${e[3]}/${t}}`]}if(null==n&&"object"===eZ(i[t])&&"object"===eZ(r))return Object.assign(i[t],r),[i[t],t,i,`${e[3]}/${t}}`];if(n===e8.INSERT_ITEMS||null==n&&e2.test(t)){let n=e5(t);return i.length<=n?i[n]=r:i.splice(n,0,r),[i[n],n,i,`${e[3]}/${n}}`]}if(n===e8.REPLACE_ITEMS||null==n){let n=e5(t);return i[n]=r,[i[n],n,i,`${e[3]}/${n}}`]}throw Error(`Unknown array index '${t}' with force-option '${n}'`)}function e8(e,t,r,n){if(null==t)return eY(e);if(""===(t=t.replace(/(\/$)/g,"")))return eY(r);let i=eY(e),s=[[i,null,null,"#"]],o=function(e){return null==e||""===e?[]:function e(t,r=[]){return eJ.includes(t.type)?t.children.forEach(t=>e(t,r)):r.push(t.text),r}(eL.getAST(e))}(t),l=o.pop(),a=e1.test(l)&&!1===e2.test(l);if(!1===eQ.test(l)||a)throw Error(`Unsupported query '${t}' ending with non-property`);return o.forEach((e,t)=>{var r,i;if("__proto__"===e||"prototyped"===e||"constructor"===e)return;if(!1===eQ.test(e)){let t;t=[],s.forEach(r=>t.push(...eG(r[0],e,uq.ALL))),s=t;return}let a=t>=o.length-1?l:o[t+1],c=e3.test(a);r=s,i=e6(i=e),s=r.filter(e=>!!(Array.isArray(e[0])&&e3.test(i))||!1===e0.includes(eZ(e[0][i]))).map(e=>{let t=c?[]:{},r=e[0],s=eZ(t),o=eZ(r[i]);return Array.isArray(r)&&o!==s?e9(e,i,t,n):(r[i]=r[i]||t,[r[i],i,r,`${e[3]}/${i}`])})}),s.forEach(e=>{let t=r;"function"===eZ(r)&&(t=r(e[3],l,e[0],`${e[3]}/${l}`));let i=e[0];if(Array.isArray(i))e9(e,l,t,n);else{let e=e6(l);if("__proto__"===e||"prototyped"===e||"constructor"===e)return;i[e]=t}}),i}(uV=uK||(uK={})).REPLACE_ITEMS="replace",uV.INSERT_ITEMS="insert",e8.REPLACE_ITEMS=uK.REPLACE_ITEMS,e8.INSERT_ITEMS=uK.INSERT_ITEMS;let e7={$ref:{type:!1},allOf:{type:!1,definitions:["allOf/*"]},anyOf:{type:!1,definitions:["anyOf/*"]},array:{type:!0,definitions:["allOf/*","anyOf/*","oneOf/*","not","items","items/*","additionalItems"],validationKeywords:["minItems","maxItems","uniqueItems"],keywords:["items","additionalItems","minItems","maxItems","uniqueItems"]},boolean:{type:!0},enum:{type:!1},integer:{type:!0,definitions:["allOf/*","anyOf/*","oneOf/*","not"],validationKeywords:["minimum","maximum","multipleOf"]},not:{type:!1,definitions:["not"]},number:{type:!0,definitions:["allOf/*","anyOf/*","oneOf/*","not"],validationKeywords:["minimum","maximum","multipleOf"]},null:{type:!0},object:{type:!0,definitions:["allOf/*","anyOf/*","oneOf/*","not","properties/*","additionalProperties","patternProperties/*","dependencies/*"],validationKeywords:["minProperties","maxProperties","required"],keywords:["properties","additionalProperties","patternProperties","dependencies","minProperties","maxProperties","required"]},oneOf:{type:!1,definitions:["oneOf/*"]},string:{type:!0,definitions:["allOf/*","anyOf/*","oneOf/*","not"],validationKeywords:["minLength","maxLength","pattern"]}},te=Object.keys(e7).filter(e=>!1===e7[e].type),tt=Object.prototype.hasOwnProperty;function tr(e){if(!1===eS(e))return;if(e.enum)return"enum";let t=e.type;if(Array.isArray(t)||e7[t])return t;let r=te.filter(t=>e[t]);if(1===r.length)return r[0];if(0===r.length){for(let t=0,r=e7.object.keywords.length;t<r;t+=1){let r=e7.object.keywords[t];if(tt.call(e,r))return"object"}for(let t=0,r=e7.array.keywords.length;t<r;t+=1){let r=e7.array.keywords[t];if(tt.call(e,r))return"array"}return}throw Error(`Mutiple typeIds [${r.join(", ")}] matched in ${JSON.stringify(e)}`)}function tn(e,t){!0===this.callback(e,t)||(function(e){let t,r=[],n=tr(e);if(null==n)return r;if(Array.isArray(n)){t={};for(let e=0,r=n.length;e<r;e+=1)Object.assign(t,e7[n[e]])}else t=e7[n];return null==t.definitions||t.definitions.forEach(t=>{eG(e,t,(e,t,n,i)=>{eS(e)&&tr(e)&&r.push({pointer:e$().join(e$().split(i),!1),def:e})})}),r})(e).forEach(e=>this.nextTypeDefs(e.def,e$().join(t,e.pointer,!1)))}function ti(e,t,r,n="definitions"){let i=t[n];Object.keys(i).forEach(t=>{if(!1===i[t]||eS(i[t]))return void e.nextTypeDefs(i[t],e$().join(r,n,t,!1))})}function ts(e,t,r="#"){let n={callback:t,nextTypeDefs:tn};n.nextTypeDefs(e,r),null!=e.definitions&&(n.callback=(e,r)=>{t(e,r),null!=e.definitions&&ti(n,e,r)},ti(n,e,r)),null!=e.$defs&&(n.callback=(e,r)=>{t(e,r),null!=e.definitions&&ti(n,e,r)},ti(n,e,r,"$defs"))}let to=/(#|\/)+$/,tl=/#$/,ta=/^[^:]+:\/\/[^/]+\//,tc=/\/[^/]*$/,th=/#.*$/;function tu(e,t){return null==e&&null==t?"#":null==t?e.replace(tl,""):null==e?t.replace(tl,""):"#"===t[0]?`${e.replace(th,"")}${t.replace(to,"")}`:ta.test(t)?t.replace(tl,""):`${e.replace(tc,"")}/${t.replace(tl,"")}`}let td=/(#|\/)+$/g,tf=["",null,"#"],tp=/(#|\/)+$/g,tm={additionalItemsError:P("AdditionalItemsError"),additionalPropertiesError:P("AdditionalPropertiesError"),anyOfError:P("AnyOfError"),allOfError:P("AllOfError"),constError:P("ConstError"),containsError:P("ContainsError"),containsArrayError:P("ContainsArrayError"),containsAnyError:P("ContainsAnyError"),enumError:P("EnumError"),forbiddenPropertyError:P("ForbiddenPropertyError"),formatURLError:P("FormatURLError"),formatURIError:P("FormatURIError"),formatURIReferenceError:P("FormatURIReferenceError"),formatURITemplateError:P("FormatURITemplateError"),formatDateError:P("FormatDateError"),formatDateTimeError:P("FormatDateTimeError"),formatEmailError:P("FormatEmailError"),formatHostnameError:P("FormatHostnameError"),formatIPV4Error:P("FormatIPV4Error"),formatIPV4LeadingZeroError:P("FormatIPV4LeadingZeroError"),formatIPV6Error:P("FormatIPV6Error"),formatIPV6LeadingZeroError:P("FormatIPV6LeadingZeroError"),formatJsonPointerError:P("FormatJsonPointerError"),formatRegExError:P("FormatRegExError"),formatTimeError:P("FormatTimeError"),invalidSchemaError:P("InvalidSchemaError"),invalidDataError:P("InvalidDataError"),invalidTypeError:P("InvalidTypeError"),invalidPropertyNameError:P("InvalidPropertyNameError"),maximumError:P("MaximumError"),maxItemsError:P("MaxItemsError"),maxLengthError:P("MaxLengthError"),maxPropertiesError:P("MaxPropertiesError"),minimumError:P("MinimumError"),minItemsError:P("MinItemsError"),minItemsOneError:P("MinItemsOneError"),minLengthError:P("MinLengthError"),minLengthOneError:P("MinLengthOneError"),minPropertiesError:P("MinPropertiesError"),missingDependencyError:P("MissingDependencyError"),missingOneOfPropertyError:P("MissingOneOfPropertyError"),multipleOfError:P("MultipleOfError"),multipleOneOfError:P("MultipleOneOfError"),noAdditionalPropertiesError:P("NoAdditionalPropertiesError"),notError:P("NotError"),oneOfError:P("OneOfError"),oneOfPropertyError:P("OneOfPropertyError"),patternError:P("PatternError"),patternPropertiesError:P("PatternPropertiesError"),requiredPropertyError:P("RequiredPropertyError"),schemaWarning:P("SchemaWarning"),typeError:P("TypeError"),undefinedValueError:P("UndefinedValueError"),uniqueItemsError:P("UniqueItemsError"),unknownPropertyError:P("UnknownPropertyError"),valueNotEmptyError:P("ValueNotEmptyError")};var tg=r(47112),ty=r.n(tg),tv=r(96542);let tx=RegExp("^([0-9]+)-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])[Tt]([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?(([Zz])|([\\+|\\-]([01][0-9]|2[0-3]):[0-5][0-9]))$"),tb=/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,tw=/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,tk=/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,tA=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,tS=/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,tC=[0,31,28,31,30,31,30,31,31,30,31,30,31],tE=/^(?:\/(?:[^~/]|~0|~1)*)*$/,tj=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,tO=/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,tP=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,tM={},tT=T.templateDefaultOptions;function tI(e,t){let{$ref:r}=e;return null==r||(null==n[t]||null==n[t][r]?0:n[t][r])<T.GET_TEMPLATE_RECURSION_LIMIT}function t$(e,t,r){let{$ref:i}=t;return null==i?t:(n[r]=n[r]||{},n[r][i]=n[r][i]||0,n[r][i]+=1,e.resolveRef(t))}function tD(e,t,r,n,i){if("object"!==j(t))return Object.assign({pointer:n},t);if(!1===tI(t,n)&&null==r)return!1;let s=eb(t$(e,t,n));if(Array.isArray(t.anyOf)&&t.anyOf.length>0&&(tI(t.anyOf[0],`${n}/anyOf/0`)&&((s=B(s,t$(e,t.anyOf[0],`${n}/anyOf/0`))).pointer=t.anyOf[0].$ref||s.pointer),delete s.anyOf),Array.isArray(t.allOf)&&t.allOf.map((e,t)=>tI(e,`${n}/allOf/${t}`)).reduceRight((e,t)=>e&&t,!0)){let o=[],l=eb(r);for(let r=0;r<t.allOf.length;r+=1)o.push(ek(e,t.allOf[r],l)),l=tR(e,l,{type:t.type,...o[r]},`${n}/allOf/${r}`,i);let a=eA(e,{allOf:o});a&&(s=W(s,a))}return s.pointer=s.pointer||t.$ref||n,s}function tR(e,t,r,n,i){var s;let o,l;if(null==r)throw Error(`getTemplate: missing schema for data: ${JSON.stringify(t)}`);if(null==n)throw Error("Missing pointer");let a=tD(e,r,t,n,i);if(!((o=a)&&"object"==typeof o))return;if(n=a.pointer,null==a?void 0:a.const)return a.const;if(Array.isArray(a.oneOf))if(function(e){switch(j(e)){case"string":case"array":return(null==e?void 0:e.length)===0;case"null":case"undefined":return!0;case"object":return 0===Object.keys(e).length;default:return!1}}(t)){let e=a.oneOf[0].type||a.type||a.const&&typeof a.const||j(t);a={...a.oneOf[0],type:e}}else{let r=N(e,t,a);if($(r)){if(null!=t&&!0!==i.removeInvalidData)return t;a=a.oneOf[0],t=void 0}else r.type=null!=(s=r.type)?s:a.type,a=r}if(!((l=a)&&"object"==typeof l)||null==a.type)return;if(t instanceof File)return t;let c=Array.isArray(a.type)?function(e,t,r){if(void 0==t){if(null!=r){let t=j(r);if(e.includes(t))return t}return e[0]}let n=j(t);return e.includes(n)?n:e[0]}(a.type,t,a.default):a.type,h=j(t);if(null!=t&&h!==c&&("number"!==h||"integer"!==c)&&(t=function(e,t){if("string"===e)return JSON.stringify(t);if("string"!=typeof t)return null;try{if(typeof(t=JSON.parse(t))===e)return t}catch(e){}return null}(c,t)),null==tN[c]){if(i.removeInvalidData)return;return t}return tN[c](e,a,t,n,i)}let tN={null:(e,t,r)=>tL(t,r,null),string:(e,t,r)=>tL(t,r,""),number:(e,t,r)=>tL(t,r,0),integer:(e,t,r)=>tL(t,r,0),boolean:(e,t,r)=>tL(t,r,!1),object:(e,t,r,n,i)=>{var s;let o=void 0===t.default?{}:t.default,l={},a=!1===i.extendDefaults&&void 0!==t.default?[]:null!=(s=t.required)?s:[];t.properties&&Object.keys(t.properties).forEach(s=>{let c=null==r||null==r[s]?o[s]:r[s],h=a.includes(s);(null!=c||h||i.addOptionalProps)&&(l[s]=tR(e,c,t.properties[s],`${n}/properties/${s}`,i))});let c=eC(e,t,l);c&&(c=W(t,c),delete c.dependencies,Object.assign(l,tR(e,r,c,`${n}/dependencies`,i))),r&&(!0===i.removeInvalidData&&(!1===t.additionalProperties||"object"===j(t.additionalProperties))?"object"===j(t.additionalProperties)&&Object.keys(r).forEach(n=>{null==l[n]&&e.isValid(r[n],t.additionalProperties)&&(l[n]=r[n])}):Object.keys(r).forEach(e=>null==l[e]&&(l[e]=r[e])));let h=ew(e,t,l);if(h){let t=tR(e,l,{type:"object",...h},n,i);Object.assign(l,t)}return l},array:(e,t,r,n,i)=>{var s,o;if(null==t.items)return r||[];let l=void 0===t.default?[]:t.default,a=r||l,c=!1===i.extendDefaults&&void 0!==t.default?0:t.minItems||0;if(Array.isArray(t.items)){for(let r=0,h=Math.max(null!=c?c:0,null!=(o=null==(s=t.items)?void 0:s.length)?o:0);r<h;r+=1)a[r]=tR(e,null==a[r]?l[r]:a[r],t.items[r],`${n}/items/${r}`,i);return a}if("object"!==j(t.items))return a;let h=tD(e,t.items,r,n,i);if(!1===h)return a;if(n=h.pointer||n,h.oneOf&&0===a.length){let t=h.oneOf[0];for(let r=0;r<c;r+=1)a[r]=tR(e,null==a[r]?l[r]:a[r],t,`${n}/oneOf/0`,i);return a}if(h.oneOf&&a.length>0){let t=Math.max(c,a.length);for(let r=0;r<t;r+=1){let t=null==a[r]?l[r]:a[r],s=N(e,t,h);null==s||$(s)?null!=t&&!0!==i.removeInvalidData?a[r]=t:(t=void 0,s=h.oneOf[0],a[r]=tR(e,t,s,`${n}/oneOf/${r}`,i)):a[r]=tR(e,t,s,`${n}/oneOf/${r}`,i)}return a}if(h.type)for(let t=0,r=Math.max(c,a.length);t<r;t+=1)a[t]=tR(e,null==a[t]?l[t]:a[t],h,`${n}/items`,i);return a}};function tL(e,t,r){return null!=t?t:e.const?e.const:void 0===e.default&&Array.isArray(e.enum)?e.enum[0]:void 0===e.default?r:e.default}function tF(e){let t=[],r=0,n=e.length;for(;r<n;){let i=e.charCodeAt(r++);if(i>=55296&&i<=56319&&r<n){let n=e.charCodeAt(r++);(64512&n)==56320?t.push(((1023&i)<<10)+(1023&n)+65536):(t.push(i),r--)}else t.push(i)}return t}function t_(e){let t=`${e}`,r=t.indexOf(".");return -1===r?0:t.length-(r+1)}var tB=r(38792),tz=r.n(tB);let tW=Object.prototype.hasOwnProperty,tV=(e,t)=>!(void 0===e[t]||!tW.call(e,t));function tH(e){if(void 0===e)return;let t={type:j(e)};return"object"===t.type&&eS(e)&&(t.properties={},Object.keys(e).forEach(r=>t.properties[r]=tH(e[r]))),"array"===t.type&&Array.isArray(e)&&(1===e.length?t.items=tH(e[0]):t.items=e.map(tH)),t}let tU={array:(e,t,r,n,i)=>{let s=null==n?void 0:n[t],o=j(r.items);if("object"===o)return eM(e,r.items,s,`${i}/${t}`)||e.resolveRef(r.items);if("array"===o){if(!0===r.items[t])return tH(s);if(!1===r.items[t])return e.errors.invalidDataError({key:t,value:s,pointer:i,schema:r});if(r.items[t])return e.resolveRef(r.items[t]);if(!1===r.additionalItems)return e.errors.additionalItemsError({key:t,value:s,pointer:i,schema:r});if(!0===r.additionalItems||void 0===r.additionalItems)return tH(s);if("object"===j(r.additionalItems))return r.additionalItems;throw Error(`Invalid schema ${JSON.stringify(r,null,2)} for ${JSON.stringify(n,null,2)}`)}return!1!==r.additionalItems&&s?tH(s):Error(`Invalid array schema for ${t} at ${i}`)},object:(e,t,r,n,i)=>{var s;let o=null==(s=null==(r=eM(e,r,n,i))?void 0:r.properties)?void 0:s[t];if(void 0!==o){if(!1===o)return e.errors.forbiddenPropertyError({property:t,value:n,pointer:i,schema:r});if(!0===o)return tH(null==n?void 0:n[t]);let s=e.resolveRef(o);if($(s))return s;if(s&&Array.isArray(s.oneOf)){let r=e.resolveOneOf(n[t],s,`${i}/${t}`);for(let e in s)"oneOf"!==e&&void 0===r[e]&&(r[e]=s[e]);return r}if(s)return s}let{patternProperties:l}=r;if("object"===j(l)){let e=Object.keys(l);for(let r=0,n=e.length;r<n;r+=1)if(new RegExp(e[r]).test(t))return l[e[r]]}let{additionalProperties:a}=r;return"object"===j(a)?r.additionalProperties:n&&(void 0===a||!0===a)?tH(n[t]):e.errors.unknownPropertyError({property:t,value:n,pointer:`${i}`,schema:r})}};T.templateDefaultOptions;let tq="__compiled",tK="__ref",tG=/(#|\/)+$/g;T.templateDefaultOptions;let tJ={typeKeywords:{array:["allOf","anyOf","contains","enum","if","items","maxItems","minItems","not","oneOf","uniqueItems"],boolean:["allOf","anyOf","enum","not","oneOf"],object:["additionalProperties","allOf","anyOf","dependencies","enum","format","if","maxProperties","minProperties","not","oneOf","patternProperties","properties","propertyNames","required"],string:["allOf","anyOf","enum","format","if","maxLength","minLength","not","oneOf","pattern"],number:["allOf","anyOf","enum","exclusiveMaximum","exclusiveMinimum","format","if","maximum","minimum","multipleOf","not","oneOf"],null:["allOf","anyOf","enum","format","not","oneOf"]},validateKeyword:{additionalProperties:(e,t,r,n)=>{if(!0===t.additionalProperties||null==t.additionalProperties||"object"===j(t.patternProperties)&&!1===t.additionalProperties)return;let i=[],s=Object.keys(r).filter(e=>!1===T.propertyBlacklist.includes(e)),o=Object.keys(t.properties||{});if("object"===j(t.patternProperties)){let e=Object.keys(t.patternProperties).map(e=>new RegExp(e));s=s.filter(t=>{for(let r=0;r<e.length;r+=1)if(e[r].test(t))return!1;return!0})}for(let l=0,a=s.length;l<a;l+=1){let a=s[l];if(-1===o.indexOf(a)){let c=eS(t.additionalProperties);if(c&&Array.isArray(t.additionalProperties.oneOf)){let c=e.resolveOneOf(r[a],t.additionalProperties,`${n}/${a}`);$(c)?i.push(e.errors.additionalPropertiesError({pointer:n,schema:t.additionalProperties,value:r,property:s[l],properties:o,errors:c.data.errors})):i.push(...e.validate(r[a],c,n))}else c?i.push(...e.validate(r[a],t.additionalProperties,`${n}/${a}`)):i.push(e.errors.noAdditionalPropertiesError({pointer:n,schema:t,value:r,property:s[l],properties:o}))}}return i},allOf:(e,t,r,n)=>{let{allOf:i}=t;if(!Array.isArray(i)||0===i.length)return;let s=[];return t.allOf.forEach(t=>{s.push(...e.validate(r,t,n))}),s},anyOf:(e,t,r,n)=>{if(Array.isArray(t.anyOf)&&0!==t.anyOf.length){for(let n=0;n<t.anyOf.length;n+=1)if(e.isValid(r,t.anyOf[n]))return;return e.errors.anyOfError({pointer:n,schema:t,value:r,anyOf:t.anyOf})}},dependencies:(e,t,r,n)=>{if("object"!==j(t.dependencies))return;let i=[];return Object.keys(r).forEach(s=>{let o;if(void 0===t.dependencies[s]||!0===t.dependencies[s])return;if(!1===t.dependencies[s])return void i.push(e.errors.missingDependencyError({pointer:n,schema:t,value:r}));let l=j(t.dependencies[s]);if("array"===l)o=t.dependencies[s].filter(e=>void 0===r[e]).map(i=>e.errors.missingDependencyError({missingProperty:i,pointer:n,schema:t,value:r}));else if("object"===l)o=e.validate(r,t.dependencies[s],n);else throw Error(`Invalid dependency definition for ${n}/${s}. Must be string[] or schema`);i.push(...o)}),i.length>0?i:void 0},enum:(e,t,r,n)=>{let i=j(r);if("object"===i||"array"===i){let e=JSON.stringify(r);for(let r=0;r<t.enum.length;r+=1)if(JSON.stringify(t.enum[r])===e)return}else if(t.enum.includes(r))return;return e.errors.enumError({pointer:n,schema:t,value:r,values:t.enum})},format:(e,t,r,n)=>{if(e.validateFormat[t.format])return e.validateFormat[t.format](e,t,r,n)},items:(e,t,r,n)=>{if(!1===t.items){if(Array.isArray(r)&&0===r.length)return;return e.errors.invalidDataError({pointer:n,value:r,schema:t})}let i=[];for(let s=0;s<r.length;s+=1){let o=r[s],l=e.step(s,t,r,n);if($(l))return[l];let a=e.validate(o,l,`${n}/${s}`);i.push(...a)}return i},maximum:(e,t,r,n)=>{if(!isNaN(t.maximum)){if(t.maximum&&t.maximum<r)return e.errors.maximumError({maximum:t.maximum,length:r,value:r,pointer:n,schema:t});if(t.maximum&&!0===t.exclusiveMaximum&&t.maximum===r)return e.errors.maximumError({maximum:t.maximum,length:r,pointer:n,schema:t,value:r})}},maxItems:(e,t,r,n)=>{if(!isNaN(t.maxItems)&&t.maxItems<r.length)return e.errors.maxItemsError({maximum:t.maxItems,length:r.length,schema:t,value:r,pointer:n})},maxLength:(e,t,r,n)=>{if(isNaN(t.maxLength))return;let i=tF(r).length;if(t.maxLength<i)return e.errors.maxLengthError({maxLength:t.maxLength,length:i,pointer:n,schema:t,value:r})},maxProperties:(e,t,r,n)=>{let i=Object.keys(r).length;if(!1===isNaN(t.maxProperties)&&t.maxProperties<i)return e.errors.maxPropertiesError({maxProperties:t.maxProperties,length:i,pointer:n,schema:t,value:r})},minLength:(e,t,r,n)=>{if(isNaN(t.minLength))return;let i=tF(r).length;if(t.minLength>i)return 1===t.minLength?e.errors.minLengthOneError({minLength:t.minLength,length:i,pointer:n,schema:t,value:r}):e.errors.minLengthError({minLength:t.minLength,length:i,pointer:n,schema:t,value:r})},minimum:(e,t,r,n)=>{if(!isNaN(t.minimum)&&(t.minimum>r||!0===t.exclusiveMinimum&&t.minimum===r))return e.errors.minimumError({minimum:t.minimum,length:r,pointer:n,schema:t,value:r})},minItems:(e,t,r,n)=>{if(!isNaN(t.minItems)&&t.minItems>r.length)return 1===t.minItems?e.errors.minItemsOneError({minItems:t.minItems,length:r.length,pointer:n,schema:t,value:r}):e.errors.minItemsError({minItems:t.minItems,length:r.length,pointer:n,schema:t,value:r})},minProperties:(e,t,r,n)=>{if(isNaN(t.minProperties))return;let i=Object.keys(r).length;if(t.minProperties>i)return e.errors.minPropertiesError({minProperties:t.minProperties,length:i,pointer:n,schema:t,value:r})},multipleOf:(e,t,r,n)=>{if(isNaN(t.multipleOf)||"number"!=typeof r)return;let i=t_(r),s=t_(t.multipleOf);if(i>s)return e.errors.multipleOfError({multipleOf:t.multipleOf,value:r,pointer:n,schema:t});let o=Math.pow(10,s);if(Math.round(r*o)%Math.round(t.multipleOf*o)/o!=0)return e.errors.multipleOfError({multipleOf:t.multipleOf,value:r,pointer:n,schema:t})},not:(e,t,r,n)=>{let i=[];return 0===e.validate(r,t.not,n).length&&i.push(e.errors.notError({value:r,not:t.not,pointer:n,schema:t})),i},oneOf:(e,t,r,n)=>{if(Array.isArray(t.oneOf)){let i=e.resolveOneOf(r,t,n);if($(i))return i}},pattern:(e,t,r,n)=>{if(!1===RegExp(t.pattern,"u").test(r))return e.errors.patternError({pattern:t.pattern,description:t.patternExample||t.pattern,received:r,schema:t,value:r,pointer:n})},patternProperties:(e,t,r,n)=>{let i=t.properties||{},s=t.patternProperties;if("object"!==j(s))return;let o=[],l=Object.keys(r),a=Object.keys(s).map(e=>({regex:new RegExp(e),patternSchema:s[e]}));return l.forEach(l=>{let c=!1;for(let t=0,i=a.length;t<i;t+=1)if(a[t].regex.test(l)){c=!0;let i=e.validate(r[l],a[t].patternSchema,`${n}/${l}`);i&&i.length>0&&o.push(...i)}i[l]||!1===c&&!1===t.additionalProperties&&o.push(e.errors.patternPropertiesError({key:l,pointer:n,schema:t,value:r,patterns:Object.keys(s).join(",")}))}),o},properties:(e,t,r,n)=>{let i=[],s=Object.keys(t.properties||{});for(let o=0;o<s.length;o+=1){let l=s[o];if(tV(r,l)){let s=e.step(l,t,r,n),o=e.validate(r[l],s,`${n}/${l}`);i.push(...o)}}return i},propertiesRequired:(e,t,r,n)=>{let i=[],s=Object.keys(t.properties||{});for(let o=0;o<s.length;o+=1){let l=s[o];if(void 0===r[l])i.push(e.errors.requiredPropertyError({key:l,pointer:n,schema:t,value:r}));else{let s=e.step(l,t,r,n),o=e.validate(r[l],s,`${n}/${l}`);i.push(...o)}}return i},required:(e,t,r,n)=>{if(!1!==Array.isArray(t.required))return t.required.map(i=>{if(!tV(r,i))return e.errors.requiredPropertyError({key:i,pointer:n,schema:t,value:r})})},requiredNotEmpty:(e,t,r,n)=>{if(!1!==Array.isArray(t.required))return t.required.map(i=>{if(null==r[i]||""===r[i])return e.errors.valueNotEmptyError({property:i,pointer:`${n}/${i}`,schema:t,value:r})})},uniqueItems:(e,t,r,n)=>{if(!1===(Array.isArray(r)&&t.uniqueItems))return;let i=[],s=[];return r.forEach((o,l)=>{for(let a=l+1;a<r.length;a+=1)tz()(o,r[a])&&!i.includes(a)&&(s.push(e.errors.uniqueItemsError({pointer:`${n}/${a}`,duplicatePointer:`${n}/${l}`,arrayPointer:n,value:JSON.stringify(o),schema:t})),i.push(a))}),s},contains:(e,t,r,n)=>{if(!1===t.contains)return e.errors.containsArrayError({pointer:n,value:r,schema:t});if(!0===t.contains)return Array.isArray(r)&&0===r.length?e.errors.containsAnyError({pointer:n,value:r,schema:t}):void 0;if("object"===j(t.contains)){for(let n=0;n<r.length;n+=1)if(e.isValid(r[n],t.contains))return;return e.errors.containsError({pointer:n,schema:t,value:r})}},exclusiveMaximum:(e,t,r,n)=>{if(!isNaN(t.exclusiveMaximum)&&t.exclusiveMaximum<=r)return e.errors.maximumError({maximum:t.exclusiveMaximum,length:r,pointer:n,schema:t,value:r})},exclusiveMinimum:(e,t,r,n)=>{if(!isNaN(t.exclusiveMinimum)&&t.exclusiveMinimum>=r)return e.errors.minimumError({minimum:t.exclusiveMinimum,length:r,pointer:n,schema:t,value:r})},if:(e,t,r,n)=>{let i=ew(e,t,r);if(i)return e.validate(r,i,n)},maximum:(e,t,r,n)=>{if(!isNaN(t.maximum)&&t.maximum&&t.maximum<r)return e.errors.maximumError({maximum:t.maximum,length:r,pointer:n,schema:t,value:r})},minimum:(e,t,r,n)=>{if(!isNaN(t.minimum)&&t.minimum>r)return e.errors.minimumError({minimum:t.minimum,length:r,pointer:n,schema:t,value:r})},patternProperties:(e,t,r,n)=>{let i=t.properties||{},s=t.patternProperties;if("object"!==j(s))return;let o=[],l=Object.keys(r),a=Object.keys(s).map(e=>({regex:new RegExp(e),patternSchema:s[e]}));return l.forEach(l=>{let c=!1;for(let i=0,h=a.length;i<h;i+=1)if(a[i].regex.test(l)){if(c=!0,!1===a[i].patternSchema)return void o.push(e.errors.patternPropertiesError({key:l,pointer:n,patterns:Object.keys(s).join(","),schema:t,value:r}));let h=e.validate(r[l],a[i].patternSchema,`${n}/${l}`);h&&h.length>0&&o.push(...h)}i[l]||!1===c&&!1===t.additionalProperties&&o.push(e.errors.patternPropertiesError({key:l,pointer:n,patterns:Object.keys(s).join(","),schema:t,value:r}))}),o},propertyNames:(e,t,r,n)=>{if(!1===t.propertyNames){if(0===Object.keys(r).length)return;return e.errors.invalidPropertyNameError({property:Object.keys(r),pointer:n,value:r,schema:t})}if(!0===t.propertyNames||"object"!==j(t.propertyNames))return;let i=[],s=Object.keys(r),o={...t.propertyNames,type:"string"};return s.forEach(s=>{let l=e.validate(s,o,`${n}/${s}`);l.length>0&&i.push(e.errors.invalidPropertyNameError({property:s,pointer:n,validationError:l[0],value:r[s],schema:t}))}),i}},validateType:{array:(e,t,r,n)=>e.typeKeywords.array.filter(e=>t&&null!=t[e]).map(i=>e.validateKeyword[i](e,t,r,n)),object:(e,t,r,n)=>e.typeKeywords.object.filter(e=>t&&null!=t[e]).map(i=>e.validateKeyword[i](e,t,r,n)),string:(e,t,r,n)=>e.typeKeywords.string.filter(e=>t&&null!=t[e]).map(i=>e.validateKeyword[i](e,t,r,n)),integer:(e,t,r,n)=>e.typeKeywords.number.filter(e=>t&&null!=t[e]).map(i=>e.validateKeyword[i](e,t,r,n)),number:(e,t,r,n)=>e.typeKeywords.number.filter(e=>t&&null!=t[e]).map(i=>e.validateKeyword[i](e,t,r,n)),boolean:(e,t,r,n)=>e.typeKeywords.boolean.filter(e=>t&&null!=t[e]).map(i=>e.validateKeyword[i](e,t,r,n)),null:(e,t,r,n)=>e.typeKeywords.null.filter(e=>t&&null!=t[e]).map(i=>e.validateKeyword[i](e,t,r,n))},validateFormat:{date:(e,t,r,n)=>{if("string"!=typeof r||""===r)return;let i=r.match(tA);if(!i)return e.errors.formatDateTimeError({value:r,pointer:n,schema:t});let s=+i[1],o=+i[2],l=+i[3];if(!(o>=1)||!(o<=12)||!(l>=1)||!(l<=(2==o&&s%4==0&&(s%100!=0||s%400==0)?29:tC[o])))return e.errors.formatDateError({value:r,pointer:n,schema:t})},"date-time":(e,t,r,n)=>{if("string"==typeof r&&""!==r)return""===r||tx.test(r)?"Invalid Date"===new Date(r).toString()?e.errors.formatDateTimeError({value:r,pointer:n,schema:t}):void 0:e.errors.formatDateTimeError({value:r,pointer:n,schema:t})},email:(e,t,r,n)=>{if("string"!=typeof r||""===r)return;if('"'===r[0])return e.errors.formatEmailError({value:r,pointer:n,schema:t});let[i,s,...o]=r.split("@");if(!i||!s||0!==o.length||i.length>64||s.length>253||"."===i[0]||i.endsWith(".")||i.includes("..")||!/^[a-z0-9.-]+$/i.test(s)||!/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+$/i.test(i)||!s.split(".").every(e=>/^[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?$/i.test(e)))return e.errors.formatEmailError({value:r,pointer:n,schema:t})},"idn-email":(e,t,r,n)=>{if("string"==typeof r&&""!==r)try{(0,tv.parse)(r);return}catch(i){return e.errors.formatEmailError({value:r,pointer:n,schema:t})}},hostname:(e,t,r,n)=>{if("string"==typeof r&&!(""===r||tk.test(r)))return e.errors.formatHostnameError({value:r,pointer:n,schema:t})},ipv4:(e,t,r,n)=>"string"!=typeof r||""===r?void 0:r&&"0"===r[0]?e.errors.formatIPV4LeadingZeroError({value:r,pointer:n,schema:t}):r.length<=15&&tb.test(r)?void 0:e.errors.formatIPV4Error({value:r,pointer:n,schema:t}),ipv6:(e,t,r,n)=>"string"!=typeof r||""===r?void 0:r&&"0"===r[0]?e.errors.formatIPV6LeadingZeroError({value:r,pointer:n,schema:t}):r.length<=45&&tw.test(r)?void 0:e.errors.formatIPV6Error({value:r,pointer:n,schema:t}),"json-pointer":(e,t,r,n)=>{if("string"==typeof r&&""!==r&&!tE.test(r))return e.errors.formatJsonPointerError({value:r,pointer:n,schema:t})},"relative-json-pointer":(e,t,r,n)=>{if("string"==typeof r&&""!==r&&!tj.test(r))return e.errors.formatJsonPointerError({value:r,pointer:n,schema:t})},regex:(e,t,r,n)=>{if("string"==typeof r&&!1===/\\Z$/.test(r)){try{new RegExp(r);return}catch(e){}return e.errors.formatRegExError({value:r,pointer:n,schema:t})}if(!("object"==typeof r||"number"==typeof r||Array.isArray(r)))return e.errors.formatRegExError({value:r,pointer:n,schema:t})},time:(e,t,r,n)=>{if("string"==typeof r&&""!==r)return r.match(tS)?void 0:e.errors.formatDateTimeError({value:r,pointer:n,schema:t})},uri:(e,t,r,n)=>{if("string"==typeof r&&""!==r&&!ty().isUri(r))return e.errors.formatURIError({value:r,pointer:n,schema:t})},"uri-reference":(e,t,r,n)=>{if("string"==typeof r&&""!==r&&!tO.test(r))return e.errors.formatURIReferenceError({value:r,pointer:n,schema:t})},"uri-template":(e,t,r,n)=>{if("string"==typeof r&&""!==r&&!tP.test(r))return e.errors.formatURITemplateError({value:r,pointer:n,schema:t})},url:(e,t,r,n)=>{if(!(""===r||ty().isWebUri(r)))return e.errors.formatURLError({value:r,pointer:n,schema:t})}},errors:tm,addRemoteSchema:function(e,t,r){r.id=r.id||t,e.remotes[t]=e.compileSchema(r)},compileSchema:function(e,t,r=t,n=!1){if(!0===t||!1===t||void 0===t||void 0!==t[tq])return t;let i={ids:{},remotes:e.remotes},s=JSON.stringify(t),o=JSON.parse(s);if(Object.defineProperty(o,tq,{enumerable:!1,value:!0}),Object.defineProperty(o,"getRef",{enumerable:!1,value:(function e(t,r,n){let i;if("object"===j(n)&&(n=n.__ref||n.$ref),null==n)return r;let s=n.replace(tp,"");if(t.remotes[s])return(i=t.remotes[s])&&i.$ref?e(t,r,i.$ref):i;if(t.ids[n])return(i=(0,eI.get)(r,t.ids[n]))&&i.$ref?e(t,r,i.$ref):i;let o=function(e){if(tf.includes(e))return[];if(-1===(e=e.replace(td,"")).indexOf("#")||0===e.indexOf("#"))return[e.replace(td,"")];let t=e.split("#");return t[0]=t[0].replace(td,""),t[1]=`#${t[1].replace(td,"")}`,t}(n);if(0===o.length)return r;if(1===o.length){if(n=o[0],t.remotes[n])return i=t.remotes[n],e(t,r,i.$ref);if(t.ids[n])return(i=(0,eI.get)(r,t.ids[n]))&&i.$ref?e(t,r,i.$ref):i}if(2===o.length){let i=o[0];if(n=o[1],t.remotes[i])return t.remotes[i].getRef?t.remotes[i].getRef(n):e(t,t.remotes[i],n);if(t.ids[i])return e(t,(0,eI.get)(r,t.ids[i]),n)}return(i=(0,eI.get)(r,t.ids[n]||n))&&i.$ref?e(t,r,i.$ref):i}).bind(null,i,o)}),!1===n&&!1===s.includes("$ref"))return o;o!==r&&Object.defineProperty(o,"$defs",{enumerable:!0,value:Object.assign({},r.definitions,r.$defs,o.definitions,o.$defs)});let l={},a=()=>o;return ts(o,(e,t)=>{var r;if(e.$id){if(e.$id.startsWith("http")&&/(allOf|anyOf|oneOf)\/\d+$/.test(t)){let n=t.replace(/\/(allOf|anyOf|oneOf)\/\d+$/,"");e.$id=null!=(r=(0,eI.get)(o,n).$id)?r:e.$id}i.ids[e.$id.replace(tG,"")]=t}let n=(t=`#${t}`.replace(/##+/,"#")).replace(/\/[^/]+$/,""),s=t.replace(/\/[^/]+\/[^/]+$/,""),c=tu(l[n]||l[s],e.$id);l[t]=c,null==i.ids[c]&&(i.ids[c]=t),e.$ref&&!e[tK]&&(Object.defineProperty(e,tK,{enumerable:!1,value:tu(c,e.$ref)}),Object.defineProperty(e,"getRoot",{enumerable:!1,value:a}))}),o},createSchemaOf:tH,each:function(e,t,r,n=e.rootSchema,i="#"){r(n=e.resolveRef(n),t,i);let s=j(t);"object"===s?Object.keys(t).forEach(s=>{let o=e.step(s,n,t,i),l=t[s];e.each(l,r,o,`${i}/${s}`)}):"array"===s&&t.forEach((s,o)=>{let l=e.step(o,n,t,i);e.each(s,r,l,`${i}/${o}`)})},eachSchema:ts,getChildSchemaSelection:function(e,t,r=e.rootSchema){var n;if(r.oneOf)return r.oneOf.map(t=>e.resolveRef(t));if(null==(n=r.items)?void 0:n.oneOf)return r.items.oneOf.map(t=>e.resolveRef(t));let i=e.step(t,r,{},"#");return $(i)?i:[i]},getSchema:function(e,t=tM){let{pointer:r="#",data:n,schema:i=e.rootSchema,withSchemaWarning:s=!1}=t,o=e$().split(r),l=function e(t,r,n,i,s=tM){if(0===n.length)return t.resolveRef(r);let o=n.shift();return $(r=t.step(o,r,s,i))?r:(s=s[o],e(t,r,n,`${i}/${o}`,s))}(e,e.resolveRef(i),o,"#",n);if(s||(null==l?void 0:l.code)!=="schema-warning")return l},getTemplate:(e,t,r=e.rootSchema,i)=>(n={},i)?tR(e,t,r,"#",{...tT,...i}):tR(e,t,r,"#",tT),isValid:function(e,t,r=e.rootSchema,n="#"){return 0===e.validate(t,r,n).length},resolveAllOf:function(e,t,r=e.rootSchema){let n=eb(r);for(let i=0;i<r.allOf.length;i+=1)n=W(n,ek(e,r.allOf[i],t));return delete n.allOf,n},resolveAnyOf:function(e,t,r=e.rootSchema,n="#"){let{anyOf:i}=r;if(!Array.isArray(i)||0===i.length)return r;let s=eE(e,r,t);return null==s?e.errors.anyOfError({pointer:n,schema:r,value:t,anyOf:JSON.stringify(i)}):V(W(r,s),"anyOf")},resolveOneOf:function(e,t,r=e.rootSchema,n="#"){if(null!=t&&r[R]){let i=[],s=r[R],o=t[r[R]];if(void 0===o)return e.errors.missingOneOfPropertyError({property:s,pointer:n,schema:r,value:t});for(let l=0;l<r.oneOf.length;l+=1){let a=e.resolveRef(r.oneOf[l]),c=e.step(s,a,t,n);if($(c))return c;let h=M(e.validate(o,c,n));if(!((h=h.filter(D)).length>0))return I(r,a,l);i.push(...h)}return e.errors.oneOfPropertyError({property:s,value:o,pointer:n,schema:r,errors:i})}let i=[],s=[];for(let o=0;o<r.oneOf.length;o+=1){let l=e.resolveRef(r.oneOf[o]),a=M(e.validate(t,l,n));(a=a.filter(D)).length>0?s.push(...a):i.push({index:o,schema:l})}return 1===i.length?I(r,i[0].schema,i[0].index):i.length>1?e.errors.multipleOneOfError({value:t,pointer:n,schema:r,matches:i}):e.errors.oneOfError({value:JSON.stringify(t),pointer:n,schema:r,oneOf:r.oneOf,errors:s})},resolveRef:function(e,t){return null==e||null==e.$ref?e:e.getRoot?e.getRoot().getRef(e):t.getRef(e)},step:function(e,t,r,n,i="#"){var s;let o=j(n),l=null!=(s=r.type)?s:o;if(Array.isArray(l)){if(!l.includes(o))return e.errors.typeError({value:n,pointer:i,expected:r.type,received:o,schema:r});l=o}let a=tU[l];if(a){let s=a(e,`${t}`,r,n,i);return void 0===s?e.errors.schemaWarning({pointer:i,value:n,schema:r,key:t}):s}return Error(`Unsupported schema type ${r.type} for key ${t}`)},validate:function(e,t,r=e.rootSchema,n="#"){var i;let s;if("boolean"===j(r=e.resolveRef(r)))return r?[]:[e.errors.invalidDataError({pointer:n,schema:r,value:t})];if($(r))return[r];if(void 0!==r.const)return tz()(r.const,t)?[]:[e.errors.constError({pointer:n,schema:r,value:t,expected:r.const})];let o=(i=r.type,"number"===(s=j(t))&&("integer"===i||Array.isArray(i)&&i.includes("integer"))?Number.isInteger(t)||isNaN(t)?"integer":"number":s),l=r.type||o;return o===l||Array.isArray(l)&&l.includes(o)?null==e.validateType[o]?[e.errors.invalidTypeError({pointer:n,schema:r,value:t,receivedType:o})]:M(e.validateType[o](e,r,t,n)).filter(D):[e.errors.typeError({pointer:n,schema:r,value:t,received:o,expected:l})]},templateDefaultOptions:T.templateDefaultOptions};class tY extends eT{constructor(e,t={}){super(B(tJ,t),e)}}({...tJ,resolveOneOf:N,resolveRef:function(e,t){if(null==e||null==e.$ref)return e;let r=Object.assign({},t.getRef(e),e);return delete r.$ref,Object.defineProperty(r,"__ref",{enumerable:!1,value:e.__ref}),Object.defineProperty(r,"getRoot",{enumerable:!1,value:e.getRoot}),r}});var tX=r(45250),tZ=r(14041),tQ=r.t(tZ,2),t0=r(4794),t1=r.n(t0),t2=r(12784),t4=r.n(t2),t3=r(46108),t5=r.n(t3),t6=r(75706),t9=r(97909),t8=r(17875),t7=r(79541),re=r(62416),rt=r(26611),rr=r(6451),rn=r(5507),ri=r(77795),rs=r(9739),ro=r(34861),rl=r(71135),ra=r(16249);let rc=e=>{let{setSecrets:t,secrets:r}=(0,t9.Z)(),{name:n,onChange:i,schema:{title:s,minLength:o,maxLength:l},required:a,disabled:c}=e,[h,u]=(0,tZ.useState)(r[n]??""),d=(0,tZ.useMemo)(()=>t4()(e=>{t({[n]:e})},300),[t,n]);return(0,v.jsx)(ra.A,{id:s,label:s,"aria-describedby":s,onChange:e=>{let t=e.target.value;u(t),i(Array(t.length).fill("*").join("")),d(t)},value:h,type:"password",autoComplete:"off",required:a,disabled:c,inputProps:{minLength:o,maxLength:l}})};var rh=r(22139),ru=r(82235),rd=r(58464),rf=r(95201),rp=r(71004),rm=r(8886),rg=r(21775),ry=r(63653),rv=r(19742),rx=r(63374),rb=r(23654);let rw=[{component:t8.q,name:"EntityPicker",schema:rf.f2},{component:t7.R,name:"EntityNamePicker",validation:re._,schema:rp.a},{component:rt.t,name:"EntityTagsPicker",schema:rm.u},{component:rn.e,name:"RepoUrlPicker",validation:ri._,schema:rg.d},{component:rr.u,name:"OwnerPicker",schema:ry.h},{component:rs.F,name:"OwnedEntityPicker",schema:rv.M},{component:ro.T,name:"MyGroupsPicker",schema:rx.M},{component:e=>{let{schema:{description:t},rawErrors:r,disabled:n,errors:i,required:s,uiSchema:o}=e;return(0,v.jsx)(rl.g,{rawErrors:r,rawDescription:o["ui:description"]??t,disabled:n,errors:i,required:s,children:(0,v.jsx)(rc,{...e})})},name:"Secret"},{component:rh.R,name:"MultiEntityPicker",schema:rb.mG,validation:rh.e},{component:ru.z,name:"RepoBranchPicker",schema:rd._}];var rk=r(66446),rA=r(73466),rS=r(63163),rC=r(8973),rE=r(91567),rj=r(29655),rO=r(77125),rP=r(72501),rM=r(58837),rT=r(6924),rI=r(86613),r$=r(98312),rD=r(34839),rR=r(45917),rN=r(72814),rL=r(96872),rF=r(12554),r_=r(56711),rB=r(75202),rz=r(28364),rW=r(82326),rV=r(79182),rH=r(16454),rU=r(10265),rq=r(29365),rK=r(68804),rG=r(5951),rJ=r(26343),rY=r(28233),rX=r(55197),rZ=r(25534),rQ=r(4832),r0=r(75625),r1=r(20353),r2=r(43135),r4=r(71407),r3=r(90712),r5=r(31627);let r6=(0,r(48870).h)({id:"scaffolder-react",messages:{passwordWidget:{content:"This widget is insecure. Please use [`ui:field: Secret`](https://backstage.io/docs/features/software-templates/writing-templates/#using-secrets) instead of `ui:widget: password`"},scaffolderPageContextMenu:{moreLabel:"more",createLabel:"Create",editorLabel:"Manage Templates",actionsLabel:"Installed Actions",tasksLabel:"Task List",templatingExtensionsLabel:"Templating Extensions"},stepper:{backButtonText:"Back",createButtonText:"Create",reviewButtonText:"Review",stepIndexLabel:"Step {{index, number}}",nextButtonText:"Next"},templateCategoryPicker:{title:"Categories"},templateCard:{noDescription:"No description",chooseButtonText:"Choose"},cardHeader:{detailBtnTitle:"Show template entity details"},templateOutputs:{title:"Text Output"},workflow:{noDescription:"No description"}}}),r9=(0,rM.A)(e=>({button:{color:e.page.fontColor}}));function r8(e){let{t}=(0,rU.i)(r6),{onEditorClicked:r,onActionsClicked:n,onTasksClicked:i,onCreateClicked:s,onTemplatingExtensionsClicked:o}=e,l=r9(),[a,c]=(0,tZ.useState)(),{allowed:h}=(0,r3.J)({permission:r5.$});return r||n||i||s||o?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(rq.A,{id:"long-menu","aria-label":t("scaffolderPageContextMenu.moreLabel"),"aria-controls":"long-menu","aria-expanded":!!a,"aria-haspopup":"true",role:"button",onClick:e=>{c(e.currentTarget)},"data-testid":"menu-button",color:"inherit",className:l.button,children:(0,v.jsx)(r4.default,{})}),(0,v.jsx)(rX.Ay,{"aria-labelledby":"long-menu",open:!!a,onClose:()=>{c(void 0)},anchorEl:a,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:(0,v.jsxs)(rY.A,{children:[s&&(0,v.jsxs)(rJ.A,{onClick:s,children:[(0,v.jsx)(rK.A,{children:(0,v.jsx)(rZ.default,{fontSize:"small"})}),(0,v.jsx)(rG.A,{primary:t("scaffolderPageContextMenu.createLabel")})]}),r&&h&&(0,v.jsxs)(rJ.A,{onClick:r,children:[(0,v.jsx)(rK.A,{children:(0,v.jsx)(r0.default,{fontSize:"small"})}),(0,v.jsx)(rG.A,{primary:t("scaffolderPageContextMenu.editorLabel")})]}),o&&(0,v.jsxs)(rJ.A,{onClick:o,children:[(0,v.jsx)(rK.A,{children:(0,v.jsx)(r2.default,{fontSize:"small"})}),(0,v.jsx)(rG.A,{primary:t("scaffolderPageContextMenu.templatingExtensionsLabel")})]}),n&&(0,v.jsxs)(rJ.A,{onClick:n,children:[(0,v.jsx)(rK.A,{children:(0,v.jsx)(rQ.default,{fontSize:"small"})}),(0,v.jsx)(rG.A,{primary:t("scaffolderPageContextMenu.actionsLabel")})]}),i&&(0,v.jsxs)(rJ.A,{onClick:i,children:[(0,v.jsx)(rK.A,{children:(0,v.jsx)(r1.default,{fontSize:"small"})}),(0,v.jsx)(rG.A,{primary:t("scaffolderPageContextMenu.tasksLabel")})]})]})})]}):null}var r7=r(30268),ne=r(94390),nt=r(69621),nr=r(58007),nn=r(8109),ni=r(4321),ns=r(61009),no=r(13677),nl=r(54801),na=r(10985),nc=r(47625),nh=r(9719),nu=r(71677),nd=r(23164),nf=r(85006),np=r(53373),nm=r.n(np);let ng=["allOf","anyOf","not","oneOf"],ny=e=>{if(!e.type){if(Object.getOwnPropertyNames(e).some(e=>ng.includes(e)))return;return["unknown"]}return"array"!==e.type?[e.type].flat():[`${e.type}(${e.items?.type??"unknown"})`]},nv=(0,rM.A)({description:{width:"40%",whiteSpace:"normal",wordWrap:"break-word","&.MuiTableCell-root":{whiteSpace:"normal"}},standard:{whiteSpace:"normal"}}),nx=(e,t)=>e.key?`${t.parentId}.${e.key}`:t.parentId,nb={key:"name",title:e=>e("renderSchema.tableCell.name"),render:(e,t)=>(0,v.jsx)("div",{className:nm()(t.classes.code,{[t.classes.codeRequired]:e.required}),children:e.key})},nw={key:"title",title:e=>e("renderSchema.tableCell.title"),render:e=>(0,v.jsx)(rz.h,{content:e.schema.title??""})},nk={key:"description",title:e=>e("renderSchema.tableCell.description"),render:e=>(0,v.jsx)(rz.h,{content:e.schema.description??""}),className:"description"},nA=e=>{if("array"===e.type){if(e.items&&"boolean"!=typeof e.items)if(!Array.isArray(e.items))return e.items?.enum;else{let t=e.items.filter(e=>"object"==typeof e&&"enum"in e).map(e=>e);if(t.length)return t[0].enum}return}return e.enum},nS=e=>"boolean"==typeof e?{canSubschema:!1,hasEnum:!1}:{canSubschema:Object.getOwnPropertyNames(e).some(e=>ng.includes(e))||ny(e).some(e=>e.includes("object")),hasEnum:!!nA(e)},nC={key:"type",title:e=>e("renderSchema.tableCell.type"),render:(e,t)=>{if("boolean"==typeof e.schema)return(0,v.jsx)(rP.A,{children:e.schema?"any":"none"});let r=ny(e.schema),[n,i]=t.expanded,s=nx(e,t),o=nS(e.schema);return(0,v.jsx)(v.Fragment,{children:r?.map((e,t)=>o.canSubschema||o.hasEnum&&0===t?(0,v.jsx)(ne.A,{"data-testid":`expand_${s}`,label:e,icon:n[s]?(0,v.jsx)(nd.default,{}):(0,v.jsx)(rT.default,{}),variant:"outlined",onClick:()=>i(e=>({...e,[s]:!e[s]}))},e):(0,v.jsx)(ne.A,{label:e,variant:"outlined"},e))})}},nE=({e,classes:t,...r})=>(0,v.jsx)(nr.A,{...r,children:e.map((e,r)=>{let n=(0,v.jsx)(rP.A,{"data-testid":`enum_el${r}`,className:nm()(t.code),children:JSON.stringify(e)});return null!==e&&["object","array"].includes(typeof e)&&(n=(0,v.jsxs)(v.Fragment,{children:[n,(0,v.jsx)(nu.Ay,{title:(0,v.jsx)(rP.A,{"data-testid":`pretty_${r}`,className:nm()(t.code),style:{whiteSpace:"pre-wrap"},children:JSON.stringify(e,void 0,2)}),children:(0,v.jsx)(rq.A,{"data-testid":`wrap-text_${r}`,children:(0,v.jsx)(nf.default,{})})})]})),(0,v.jsx)(nn.A,{children:n},r)})}),nj=(0,rM.A)({schema:{width:"100%",overflowX:"hidden","& table":{width:"100%",tableLayout:"fixed"}}}),nO=({strategy:e,context:t,schema:r})=>{let{t:n}=(0,rU.i)(r7.W),i=nj(),s=nv();return(()=>{if("object"==typeof r){let o,l,a=(e=>{if("boolean"==typeof e)return{};let t={},r={};for(let[n,i]of Object.entries(e))if(ng.includes(n)){let e;if(Array.isArray(i)){if(!i.length)continue;e=i}else{if(!i)continue;e=[i]}r[n]=e}else t[n]=i;return t?.type==="object"||"properties"in t?Object.fromEntries(Object.entries(r).map(([r,n])=>[r,n.map(r=>{if("boolean"!=typeof r&&r.required){let n={};if(e.properties)for(let t of r.required)t in e.properties&&(n[t]=e.properties[t]);return Object.assign(n,r.properties),{...t,...r,properties:n}}return r})])):r})(r);if("root"===e)("type"in r||!Object.keys(a).length)&&(l=[{schema:r}],o=[nC],r.description&&o.unshift(nk),r.title&&o.unshift(nw));else if(r.properties)o=[nb,nw,nk,nC],l=Object.entries(r.properties).map(([e,t])=>({schema:t,key:e,required:r.required?.includes(e)}));else if(!Object.keys(a).length)return;let[c]=t.expanded;return(0,v.jsxs)(v.Fragment,{children:[o&&l&&(0,v.jsx)(na.A,{component:ni.A,className:i.schema,children:(0,v.jsxs)(ns.A,{"data-testid":`${e}_${t.parentId}`,size:"small",children:[(0,v.jsx)(nc.A,{children:(0,v.jsx)(nh.A,{children:o.map((e,t)=>(0,v.jsx)(nl.A,{className:s[e.className??"standard"],children:e.title(n)},t))})}),(0,v.jsx)(no.A,{children:l.map(r=>{let n=nx(r,t),i=nS(r.schema),l=[(0,v.jsx)(nh.A,{"data-testid":`${e}-row_${n}`,children:o.map(e=>(0,v.jsx)(nl.A,{className:s[e.className??"standard"],children:e.render(r,t)},e.key))})];if("boolean"!=typeof r.schema&&(i.canSubschema||i.hasEnum)){let e=(0,v.jsxs)(rO.A,{"data-testid":`expansion_${n}`,sx:{margin:1},children:[i.canSubschema&&(0,v.jsx)(nO,{strategy:"properties",context:{...t,parentId:n,parent:t},schema:"array"===r.schema.type?r.schema.items:r.schema}),i.hasEnum&&(0,v.jsxs)(v.Fragment,{children:[(0,tZ.cloneElement)(t.headings[0],{},"Valid values:"),(0,v.jsx)(nE,{"data-testid":`enum_${n}`,e:nA(r.schema),classes:t.classes})]})]});ny(r.schema)&&(e=(0,v.jsx)(nt.A,{in:c[n],timeout:"auto",unmountOnExit:!0,children:e})),l.push((0,v.jsx)(nh.A,{children:(0,v.jsx)(nl.A,{style:{paddingBottom:0,paddingTop:0},colSpan:o.length,children:e})}))}return(0,v.jsx)(tZ.Fragment,{children:l},n)})})]})}),Object.keys(a).map(r=>(0,v.jsxs)(tZ.Fragment,{children:[(0,tZ.cloneElement)(t.headings[0],{},r),a[r].map((n,i)=>(0,v.jsx)(nO,{strategy:"boolean"!=typeof n&&"properties"in n?e:"root",...{context:{...t,parentId:`${t.parentId}_${r}${i}`},schema:n}},i))]},r))]})}})()??(0,v.jsx)(rP.A,{children:"No schema defined"})};var nP=r(62112),nM=r(42899);let nT=e=>(0,v.jsx)(nM.A,{"data-testid":"examples",container:!0,children:e.examples.map((e,t)=>(0,v.jsxs)(tZ.Fragment,{children:[(0,v.jsx)(nM.A,{"data-testid":`example_desc${t}`,item:!0,lg:3,children:(0,v.jsxs)(rO.A,{padding:1,style:{overflowX:"auto"},children:[e.description&&(0,v.jsx)(rz.h,{content:e.description}),e.notes?.length&&(0,v.jsx)(rz.h,{content:e.notes})]})}),(0,v.jsx)(nM.A,{"data-testid":`example_code${t}`,item:!0,lg:9,children:(0,v.jsx)(rO.A,{padding:1,children:(0,v.jsx)(nP.z,{text:e.example?.trim(),showLineNumbers:!0,showCopyCodeButton:!0,language:"yaml"})})})]},`example-${t}`))}),nI=(0,rM.A)(e=>({code:{fontFamily:"Menlo, monospace",padding:e.spacing(1),backgroundColor:"dark"===e.palette.type?e.palette.grey[700]:e.palette.grey[300],display:"inline-block",borderRadius:5,border:`1px solid ${e.palette.grey[500]}`,position:"relative"},codeRequired:{"&::after":{position:"absolute",content:'"*"',top:0,right:e.spacing(.5),fontWeight:"bolder",color:e.palette.error.light}},link:{paddingLeft:e.spacing(1)}})),n$=()=>{let e=(0,k.gf)(rS.z),{t}=(0,rU.i)(r7.W),r=nI(),{loading:n,value:i=[],error:s}=(0,rA.A)(async()=>e.listActions(),[e]),[o,l]=(0,tZ.useState)(null),a=(0,tZ.useState)({});return((0,tZ.useEffect)(()=>{i.length&&window.location.hash&&document.querySelector(window.location.hash)?.scrollIntoView()},[i]),n)?(0,v.jsx)(rL.k,{}):s?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(rF.b,{error:s}),(0,v.jsx)(r_.p,{missing:"info",title:t("actionsPage.content.emptyState.title"),description:t("actionsPage.content.emptyState.description")})]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(rO.A,{pb:3,children:(0,v.jsx)(r$.Ay,{id:"actions-autocomplete",options:i,loading:n,getOptionLabel:e=>e.id,renderInput:e=>(0,v.jsx)(ra.A,{...e,"aria-label":t("actionsPage.content.searchFieldPlaceholder"),placeholder:t("actionsPage.content.searchFieldPlaceholder"),variant:"outlined",InputProps:{...e.InputProps,startAdornment:(0,v.jsx)(rD.A,{position:"start",children:(0,v.jsx)(rR.default,{})})}}),onChange:(e,t)=>{l(t)},fullWidth:!0})}),(o?[o]:i).map(e=>{if(e.id.startsWith("legacy:"))return;let n={classes:r,expanded:a,headings:[(0,v.jsx)(rP.A,{variant:"h6",component:"h4"})]};return(0,v.jsxs)(rO.A,{pb:3,children:[(0,v.jsxs)(rO.A,{display:"flex",alignItems:"center",children:[(0,v.jsx)(rP.A,{id:e.id.replaceAll(":","-"),variant:"h5",component:"h2",className:r.code,children:e.id}),(0,v.jsx)(rB.N_,{className:r.link,to:`#${e.id.replaceAll(":","-")}`,children:(0,v.jsx)(rI.default,{})})]}),e.description&&(0,v.jsx)(rz.h,{content:e.description}),e.schema?.input&&(0,v.jsxs)(rO.A,{pb:2,children:[(0,v.jsx)(rP.A,{variant:"h6",component:"h3",children:t("actionsPage.action.input")}),(0,v.jsx)(nO,{strategy:"properties",context:{parentId:`${e.id}.input`,...n},schema:e?.schema?.input})]}),e.schema?.output&&(0,v.jsxs)(rO.A,{pb:2,children:[(0,v.jsx)(rP.A,{variant:"h5",component:"h3",children:t("actionsPage.action.output")}),(0,v.jsx)(nO,{strategy:"properties",context:{parentId:`${e.id}.output`,...n},schema:e?.schema?.output})]}),e.examples&&(0,v.jsxs)(rC.A,{children:[(0,v.jsx)(rj.A,{expandIcon:(0,v.jsx)(rT.default,{}),children:(0,v.jsx)(rP.A,{variant:"h6",component:"h3",children:t("actionsPage.action.examples")})}),(0,v.jsx)(rE.A,{children:(0,v.jsx)(rO.A,{pb:2,children:(0,v.jsx)(nT,{examples:e.examples})})})]})]},e.id)})]})},nD=e=>{let t=(0,x.Zp)(),r=(0,rN.S)(rk.Dg),n=(0,rN.S)(rk.JX),i=(0,rN.S)(rk.rQ),s=(0,rN.S)(rk.SE),{t:o}=(0,rU.i)(r7.W),l={onEditorClicked:e?.contextMenu?.editor!==!1?()=>t(r()):void 0,onActionsClicked:void 0,onTasksClicked:e?.contextMenu?.tasks!==!1?()=>t(n()):void 0,onCreateClicked:e?.contextMenu?.create!==!1?()=>t(i()):void 0,onTemplatingExtensionsClicked:e?.contextMenu?.templatingExtensions!==!1?()=>t(s()):void 0};return(0,v.jsxs)(rW.Y,{themeId:"home",children:[(0,v.jsx)(rV.Y,{pageTitleOverride:o("actionsPage.pageTitle"),title:o("actionsPage.title"),subtitle:o("actionsPage.subtitle"),children:(0,v.jsx)(r8,{...l})}),(0,v.jsx)(rH.U,{children:(0,v.jsx)(n$,{})})]})};var nR=r(3571),nN=r(77509),nL=r(40703),nF=r(9684),n_=r(53364);let nB=(0,rM.A)(e=>({root:{backgroundColor:"rgba(0, 0, 0, .11)",boxShadow:"none",margin:e.spacing(1,0,1,0)},title:{margin:e.spacing(1,0,0,1),textTransform:"uppercase",fontSize:12,fontWeight:"bold"},listIcon:{minWidth:30,color:e.palette.text.primary},menuItem:{minHeight:e.spacing(6)},groupWrapper:{margin:e.spacing(1,1,2,1)}}),{name:"ScaffolderReactOwnerListPicker"}),nz=e=>{let{filter:t,onSelectOwner:r}=e,n=nB(),{t:i}=(0,rU.i)(r7.W),s=[{name:i("ownerListPicker.title"),items:[{id:"owned",label:i("ownerListPicker.options.owned"),icon:nF.default},{id:"all",label:i("ownerListPicker.options.all"),icon:n_.default}]}];return(0,v.jsx)(nL.A,{className:n.root,children:s.map(e=>(0,v.jsxs)(tZ.Fragment,{children:[(0,v.jsx)(rP.A,{variant:"subtitle2",component:"span",className:n.title,children:e.name}),(0,v.jsx)(nL.A,{className:n.groupWrapper,children:(0,v.jsx)(nr.A,{disablePadding:!0,dense:!0,role:"menu",children:e.items.map((i,s)=>(0,v.jsxs)(rJ.A,{divider:s!==e.items.length-1,ContainerProps:{role:"menuitem"},onClick:()=>r(i.id),selected:i.id===t,className:n.menuItem,"data-testid":`owner-picker-${i.id}`,children:[i.icon&&(0,v.jsx)(rK.A,{className:n.listIcon,children:(0,v.jsx)(i.icon,{fontSize:"small"})}),(0,v.jsx)(rG.A,{children:(0,v.jsx)(rP.A,{variant:"body1",children:i.label})})]},i.id))})})]},e.name))})};var nW=r(69374);let nV=({createdAt:e,locale:t})=>{let r=nW.c9.fromISO(e),n=t||window.navigator.language||"en-US",i=r.setLocale(n).toLocaleString({...nW.c9.DATETIME_SHORT_WITH_SECONDS});return(0,v.jsx)(rP.A,{paragraph:!0,children:i})};var nH=r(30043),nU=r(37281),nq=r(78560);let nK=({entityRef:e})=>{let t=(0,k.gf)(nH.v),{value:r,loading:n,error:i}=(0,rA.A)(()=>t.getEntityByRef(e||""),[t,e]);return e?n||i?null:(0,v.jsx)(nU.z,{entityRef:(0,nq.KU)(e),title:r?.spec?.profile?.displayName??r?.metadata.name}):(0,v.jsx)(rP.A,{paragraph:!0,children:"Unknown"})};var nG=r(12714);let nJ=({status:e})=>{switch(e){case"processing":return(0,v.jsx)(nG.Ek,{children:e});case"completed":return(0,v.jsx)(nG.z3,{children:e});default:return(0,v.jsx)(nG.Xs,{children:e})}},nY=({entityRef:e})=>{let t=(0,k.gf)(rS.z),{value:r,loading:n,error:i}=(0,rA.A)(()=>t.getTemplateParameterSchema(e||""),[t,e]);return n||i||!e?null:(0,v.jsx)(nU.z,{entityRef:(0,nq.KU)(e),title:r?.title})},nX=e=>{let{initiallySelectedFilter:t="owned"}=e,{t:r}=(0,rU.i)(r7.W),[n,i]=(0,tZ.useState)(5),[s,o]=(0,tZ.useState)(0),l=(0,k.gf)(rS.z),a=(0,rN.S)(rk.rQ),[c,h]=(0,tZ.useState)(t),{value:u,loading:d,error:f}=(0,rA.A)(()=>l.listTasks?l.listTasks?.({filterByOwnership:c,limit:n,offset:s*n}):(console.warn("listTasks is not implemented in the scaffolderApi, please make sure to implement this method."),Promise.resolve({tasks:[],totalTasks:0})),[l,c,n,s]);return d?(0,v.jsx)(rL.k,{}):f?(0,v.jsxs)(nN.GI,{children:[(0,v.jsx)(nN.GI.Filters,{children:(0,v.jsx)(nz,{filter:c,onSelectOwner:e=>h(e)})}),(0,v.jsxs)(nN.GI.Content,{children:[(0,v.jsx)(rF.b,{error:f}),(0,v.jsx)(r_.p,{missing:"info",title:r("listTaskPage.content.emptyState.title"),description:r("listTaskPage.content.emptyState.description")})]})]}):(0,v.jsxs)(nN.GI,{children:[(0,v.jsx)(nN.GI.Filters,{children:(0,v.jsx)(nz,{filter:c,onSelectOwner:e=>h(e)})}),(0,v.jsx)(nN.GI.Content,{children:(0,v.jsx)(nR.X,{onRowsPerPageChange:e=>{o(0),i(e)},onPageChange:e=>o(e),options:{pageSize:n,emptyRowsWhenPaging:!1},data:u?.tasks??[],page:s,totalCount:u?.totalTasks??0,title:r("listTaskPage.content.tableTitle"),columns:[{title:r("listTaskPage.content.tableCell.taskID"),field:"id",render:e=>(0,v.jsx)(rB.N_,{to:`${a()}/tasks/${e.id}`,children:e.id})},{title:r("listTaskPage.content.tableCell.template"),field:"spec.templateInfo.entity.metadata.title",render:e=>(0,v.jsx)(nY,{entityRef:e.spec.templateInfo?.entityRef})},{title:r("listTaskPage.content.tableCell.created"),field:"createdAt",render:e=>(0,v.jsx)(nV,{createdAt:e.createdAt})},{title:r("listTaskPage.content.tableCell.owner"),field:"createdBy",render:e=>(0,v.jsx)(nK,{entityRef:e.spec?.user?.ref})},{title:r("listTaskPage.content.tableCell.status"),field:"status",render:e=>(0,v.jsx)(nJ,{status:e.status})}]})})]})},nZ=e=>{let t=(0,x.Zp)(),r=(0,rN.S)(rk.Dg),n=(0,rN.S)(rk.GF),i=(0,rN.S)(rk.rQ),{t:s}=(0,rU.i)(r7.W),o=(0,rN.S)(rk.SE),l={onEditorClicked:e?.contextMenu?.editor!==!1?()=>t(r()):void 0,onActionsClicked:e?.contextMenu?.actions!==!1?()=>t(n()):void 0,onTasksClicked:void 0,onCreateClicked:e?.contextMenu?.create!==!1?()=>t(i()):void 0,onTemplatingExtensionsClicked:e?.contextMenu?.templatingExtensions!==!1?()=>t(o()):void 0};return(0,v.jsxs)(rW.Y,{themeId:"home",children:[(0,v.jsx)(rV.Y,{pageTitleOverride:s("listTaskPage.pageTitle"),title:s("listTaskPage.title"),subtitle:s("listTaskPage.subtitle"),children:(0,v.jsx)(r8,{...l})}),(0,v.jsx)(rH.U,{children:(0,v.jsx)(nX,{...e})})]})};var nQ=r(95208),n0=r(92483),n1=r(17138),n2=r(56420),n4=r(18453),n3=r(79533),n5=r(13977),n6=r(75303),n9=r(56829),n8=r(46923),n7=r(34477),ie=r(57278),it=r(98552),ir=r(86901),ii=r(44148),is=r(41260),io=r(56005),il=r.n(io);let ia=(0,v.jsx)(is.default,{fontSize:"small"}),ic=(0,v.jsx)(ii.default,{fontSize:"small"}),ih=(0,rM.A)({root:{},label:{}},{name:"ScaffolderReactTemplateCategoryPicker"}),iu=()=>{let{t:e}=(0,rU.i)(r6),t=ih(),r=(0,k.gf)(n7.k),{error:n,loading:i,availableTypes:s,selectedTypes:o,setSelectedTypes:l}=(0,ie.j)();return i?(0,v.jsx)(rL.k,{}):n?(r.post({message:`Failed to load entity types with error: ${n}`,severity:"error"}),null):s?(0,v.jsxs)(rO.A,{className:t.root,pb:1,pt:1,children:[(0,v.jsx)(rP.A,{className:t.label,variant:"button",component:"label",htmlFor:"categories-picker",children:e("templateCategoryPicker.title")}),(0,v.jsx)(r$.Ay,{PopperComponent:e=>(0,v.jsx)("div",{...e,children:e.children}),multiple:!0,id:"categories-picker",options:s,value:o,onChange:(e,t)=>l(t),renderOption:(e,{selected:t})=>(0,v.jsx)(ir.A,{control:(0,v.jsx)(it.A,{icon:ia,checkedIcon:ic,checked:t}),label:il()(e)}),size:"small",popupIcon:(0,v.jsx)(rT.default,{}),renderInput:e=>(0,v.jsx)(ra.A,{...e,variant:"outlined"})})]}):null};var id=r(24453),ip=r(15901),im=r(17174),ig=r(97214),iy=r(52262),iv=r(699),ix=r(59469),ib=r(48653),iw=r(37197),ik=r(54917),iA=r(45575),iS=r(86184),iC=r(20987);let iE=({template:e,className:t})=>{let r=(0,rN.S)(iC.s),{t:n}=(0,rU.i)(r6),i=(0,nq.U2)(e),s=(0,nQ.n)().getSystemIcon("kind:template")||rQ.default;return(0,v.jsx)(nu.Ay,{id:`tooltip-${i}`,title:n("cardHeader.detailBtnTitle"),children:(0,v.jsx)(rq.A,{"aria-label":n("cardHeader.detailBtnTitle"),id:`viewDetail-${i}`,style:{padding:0},children:(0,v.jsx)(rP.A,{component:"span",children:(0,v.jsx)(rB.N_,{to:r((0,iC.$)(e)),style:{display:"flex",alignItems:"center"},children:(0,v.jsx)(s,{className:t})})})})})},ij=(0,rM.A)(()=>({header:{backgroundImage:({cardBackgroundImage:e})=>e,color:({cardFontColor:e})=>e},subtitleWrapper:{display:"flex",justifyContent:"space-between"},detailIcon:{color:({cardFontColor:e})=>e}})),iO=e=>{let{template:{metadata:{title:t,name:r},spec:{type:n}}}=e,{getPageTheme:i}=(0,ik.A)(),s=i({themeId:n}),o=ij({cardFontColor:s.fontColor,cardBackgroundImage:s.backgroundImage}),l=(0,v.jsxs)("div",{className:o.subtitleWrapper,children:[(0,v.jsx)("div",{children:n}),(0,v.jsxs)("div",{children:[(0,v.jsx)(iE,{className:o.detailIcon,template:e.template}),(0,v.jsx)(iS.u,{entity:e.template,style:{padding:0,marginLeft:6}})]})]});return(0,v.jsx)(iA.f,{title:t??r,subtitle:l,classes:{root:o.header}})},iP=(0,rM.A)(()=>({box:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box","-webkit-line-clamp":10,"-webkit-box-orient":"vertical"},markdown:{"& :first-child":{margin:0}}})),iM=({template:e})=>{let{t}=(0,rU.i)(r6),r=iP();return(0,v.jsx)(nM.A,{item:!0,xs:12,"data-testid":"template-card-content-grid",children:(0,v.jsx)(rO.A,{className:r.box,"data-testid":"template-card-content-container",children:(0,v.jsx)(rz.h,{className:r.markdown,content:e.metadata.description??t("templateCard.noDescription")})})})},iT=({template:e})=>(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(nM.A,{item:!0,xs:12,children:(0,v.jsx)(iw.A,{"data-testid":"template-card-separator--tags"})}),(0,v.jsx)(nM.A,{item:!0,xs:12,children:(0,v.jsx)(nM.A,{container:!0,spacing:2,"data-testid":"template-card-tags",children:e.metadata.tags?.map(e=>(0,v.jsx)(nM.A,{item:!0,"data-testid":`template-card-tag-item-${e}`,children:(0,v.jsx)(ne.A,{style:{margin:0},size:"small","data-testid":`template-card-tag-chip-${e}`,label:e},e)},`grid-${e}`))})})]});var iI=r(23127);let i$=(0,rM.A)(()=>({linkText:{display:"inline-flex",alignItems:"center"}})),iD=({icon:e,text:t,url:r})=>{let n=i$();return(0,v.jsxs)("div",{className:n.linkText,children:[(0,v.jsx)(e,{fontSize:"small"}),(0,v.jsx)(rB.N_,{style:{marginLeft:"8px"},to:r,children:t||r})]})},iR=(0,rM.A)({}),iN=({template:e,additionalLinks:t})=>{let r=iR(),n=(0,nQ.n)();return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(nM.A,{item:!0,xs:12,children:(0,v.jsx)(iw.A,{"data-testid":"template-card-separator--links"})}),(0,v.jsx)(nM.A,{item:!0,xs:12,children:(0,v.jsxs)(nM.A,{container:!0,spacing:2,"data-testid":"template-card-links",children:[t?.map(({icon:e,text:t,url:n},i)=>(0,v.jsx)(nM.A,{className:r.linkText,item:!0,xs:6,"data-testid":"template-card-links--item",children:(0,v.jsx)(iD,{icon:e,text:t,url:n})},i)),e.metadata.links?.map(({url:e,icon:t,title:i},s)=>(0,v.jsx)(nM.A,{className:r.linkText,item:!0,xs:6,"data-testid":"template-card-links--metalink",children:(0,v.jsx)(iD,{icon:t?n.getSystemIcon(t)??iI.default:iI.default,text:i||e,url:e})},s))]})})]})};var iL=r(14158),iF=r(64947);let i_=(0,rM.A)(e=>({footer:{display:"flex",justifyContent:"space-between",flex:1,alignItems:"center"},ownedBy:{display:"flex",alignItems:"center",flex:1,color:e.palette.link},actionContainer:{padding:"16px",flex:1,alignItems:"flex-end"}})),iB=({canCreateTask:e,handleChoose:t,ownedByRelations:r})=>{let{t:n}=(0,rU.i)(r6),i=i_();return(0,v.jsxs)("div",{className:i.footer,"data-testid":"template-card-actions--footer",children:[(0,v.jsx)("div",{className:i.ownedBy,"data-testid":"template-card-actions--ownedby",children:r.length>0&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(n0.ny,{fontSize:"small"}),(0,v.jsx)(iL.i,{style:{marginLeft:"8px"},entityRefs:r,defaultKind:"Group",hideIcons:!0})]})}),e?(0,v.jsx)(iF.A,{size:"small",variant:"outlined",color:"primary","data-testid":"template-card-actions--create",onClick:t,children:n("templateCard.chooseButtonText")}):null]})},iz=(0,rM.A)(()=>({actionContainer:{padding:"16px",flex:1,alignItems:"flex-end"}})),iW=e=>{let{additionalLinks:t,onSelected:r,template:n}=e,i=iz(),s=(0,iy.s)(),o=(0,iv.t)(n,ig.vv),l=!!n.metadata.tags?.length,a=!!t?.length||!!n.metadata.links?.length,{allowed:c}=(0,r3.J)({permission:r5.X6}),h=(0,tZ.useCallback)(()=>{s.captureEvent("click","Template has been opened"),r?.(n)},[s,r,n]);return(0,v.jsxs)(nL.A,{children:[(0,v.jsx)(iO,{template:n,"data-testid":"template-card-header"}),(0,v.jsx)(ib.A,{children:(0,v.jsxs)(nM.A,{container:!0,spacing:2,"data-testid":"template-card-content",children:[(0,v.jsx)(iM,{template:n}),!l&&!a&&(0,v.jsx)(nM.A,{item:!0,xs:12,children:(0,v.jsx)(iw.A,{"data-testid":"template-card-separator"})}),l&&(0,v.jsx)(iT,{template:n}),a&&(0,v.jsx)(iN,{template:n,additionalLinks:t})]})}),(0,v.jsx)(ix.A,{className:i.actionContainer,"data-testid":"template-card-actions",children:(0,v.jsx)(iB,{canCreateTask:c,handleChoose:h,ownedByRelations:o})})]})};var iV=r(19224);let iH=e=>{let{templates:t,title:r,components:{CardComponent:n}={},onSelected:i}=e,s="string"==typeof r?(0,v.jsx)(n1.d,{title:r}):r;if(0===t.length)return null;let o=n||iW;return(0,v.jsxs)(rH.U,{children:[s,(0,v.jsx)(im.s,{children:t.map(({template:e,additionalLinks:t})=>(0,v.jsx)(iV.I,{attributes:{entityRef:(0,nq.U2)(e)},children:(0,v.jsx)(o,{additionalLinks:t,template:e,onSelected:i})},(0,nq.U2)(e)))})]})},iU=e=>{let{loading:t,error:r,entities:n}=(0,n4.nK)(),{groups:i,templateFilter:s,TemplateCardComponent:o,onTemplateSelected:l}=e,a=(0,k.gf)(id.m),c=(0,tZ.useCallback)(e=>{l?.(e)},[l]);return((0,tZ.useEffect)(()=>{r&&a.post(r)},[r,a]),t)?(0,v.jsx)(rL.k,{}):r?null:n&&n.length?(0,v.jsx)(v.Fragment,{children:i.map(({title:t,filter:r},i)=>{let l=n.filter(ip.c).filter(e=>!s||s(e)).filter(r).map(t=>{let r=e.additionalLinksForEntity?.(t)??[];return{template:t,additionalLinks:r}});return(0,v.jsx)(iH,{templates:l,title:t,components:{CardComponent:o},onSelected:c},i)})}):(0,v.jsxs)(rP.A,{variant:"body2",children:["No templates found that match your filter. Learn more about"," ",(0,v.jsx)(rB.N_,{to:"https://backstage.io/docs/features/software-templates/adding-templates",children:"adding templates"}),"."]})};var iq=r(5893),iK=r(73657),iG=r(71913);let iJ=e=>{let{title:t,to:r}=e,{allowed:n}=(0,r3.J)({permission:iG.C4}),i=(0,iq.A)(e=>e.breakpoints.down("xs"));return r&&n?i?(0,v.jsx)(rq.A,{component:iK.N_,color:"primary",title:t,size:"small",to:r,children:(0,v.jsx)(rZ.default,{})}):(0,v.jsx)(iF.A,{component:iK.N_,variant:"outlined",color:"primary",to:r,children:t}):null};var iY=r(11642),iX=r(19108);let iZ=e=>{let t=(0,rN.S)(rk.J0),{TemplateCardComponent:r,groups:n=[],templateFilter:i,headerOptions:s}=e,o=(0,x.Zp)(),l=(0,rN.S)(rk.Dg),a=(0,rN.S)(rk.GF),c=(0,rN.S)(rk.JX),h=(0,rN.S)(rk.UJ),u=(0,rN.S)(rk.sP),d=(0,rN.S)(rk.SE),f=(0,nQ.n)(),{t:p}=(0,rU.i)(r7.W),m=n.length?[...n,{title:p("templateListPage.templateGroups.otherTitle"),filter:e=>![...n].some(({filter:t})=>t(e))}]:[{title:p("templateListPage.templateGroups.defaultTitle"),filter:()=>!0}],g={onEditorClicked:e?.contextMenu?.editor!==!1?()=>o(l()):void 0,onActionsClicked:e?.contextMenu?.actions!==!1?()=>o(a()):void 0,onTasksClicked:e?.contextMenu?.tasks!==!1?()=>o(c()):void 0,onTemplatingExtensionsClicked:e?.contextMenu?.templatingExtensions!==!1?()=>o(d()):void 0},y=(0,tZ.useCallback)(e=>{if(!(e.metadata.annotations?.[iX.As]||e.metadata.annotations?.[iX.GO])||!h)return[];let t=(0,iY.b1)(e,h);return t?[{icon:f.getSystemIcon("docs")??n0.Vf,text:p("templateListPage.additionalLinksForEntity.viewTechDocsTitle"),url:t}]:[]},[f,h,p]),b=(0,tZ.useCallback)(e=>{let{namespace:t,name:r}=(0,nq.KU)((0,nq.U2)(e));o(u({namespace:t,templateName:r}))},[o,u]);return(0,v.jsx)(n4.B9,{children:(0,v.jsxs)(rW.Y,{themeId:"home",children:[(0,v.jsx)(rV.Y,{pageTitleOverride:p("templateListPage.pageTitle"),title:p("templateListPage.title"),subtitle:p("templateListPage.subtitle"),...s,children:(0,v.jsx)(r8,{...g})}),(0,v.jsxs)(rH.U,{children:[(0,v.jsxs)(n1.d,{children:[(0,v.jsx)(iJ,{title:p("templateListPage.contentHeader.registerExistingButtonTitle"),to:t&&t()}),(0,v.jsx)(n2.Y,{children:p("templateListPage.contentHeader.supportButtonTitle")})]}),(0,v.jsxs)(nN.GI,{children:[(0,v.jsxs)(nN.GI.Filters,{children:[(0,v.jsx)(n3.l,{}),(0,v.jsx)(n5.m,{initialFilter:"template",hidden:!0}),(0,v.jsx)(n6.y,{initialFilter:"all",availableFilters:["all","starred"]}),(0,v.jsx)(iu,{}),(0,v.jsx)(n9.m,{}),(0,v.jsx)(n8.t,{})]}),(0,v.jsx)(nN.GI.Content,{children:(0,v.jsx)(iU,{groups:m,templateFilter:i,TemplateCardComponent:r,onTemplateSelected:b,additionalLinksForEntity:y})})]})]})]})})};var iQ=r(55488),i0=r(76888);let i1=e=>{let t=(0,k.gf)(rS.z),{value:r,loading:n,error:i}=(0,rA.A)(()=>t.getTemplateParameterSchema(e),[t,e]);return{manifest:r,loading:n,error:i}};var i2=r(21332),i4=r(86702),i3=r(91638),i5=r(88951),i6=r(21619),i9=r(37877),i8=r(78733);function i7(e){return!("object"!=typeof e||null===e||"number"==typeof e.lastModified&&"undefined"!=typeof File&&e instanceof File)&&("function"!=typeof e.getMonth||"undefined"==typeof Date||!(e instanceof Date))&&!Array.isArray(e)}function se(e){if(""===e)return;if(null===e)return null;if(/\.$/.test(e)||/\.0$/.test(e)||/\.\d*0$/.test(e))return e;let t=Number(e);return"number"!=typeof t||Number.isNaN(t)?e:t}let st="__additional_property",sr="additionalProperties",sn="allOf",si="anyOf",ss="const",so="dependencies",sl="__errors",sa="items",sc="$name",sh="oneOf",su="properties",sd="submitButtonOptions",sf="$ref",sp="__rjsf_additionalProperties",sm="__rjsf_rootSchema",sg="ui:widget",sy="ui:options";function sv(e={},t={}){return Object.keys(e).filter(e=>0===e.indexOf("ui:")).reduce((t,r)=>{let n=e[r];return r===sg&&i7(n)?(console.error("Setting options via ui:widget object is no longer supported, use ui:options instead"),t):r===sy&&i7(n)?{...t,...n}:{...t,[r.substring(3)]:n}},{...t})}function sx(e,t={},r){if(!e.additionalProperties)return!1;let{expandable:n=!0}=sv(t);return!1===n?n:void 0===e.maxProperties||!r||Object.keys(r).length<e.maxProperties}var sb=r(48360),sw=r.n(sb),sk=r(40575),sA=r.n(sk);function sS(e,t){return sA()(e,t,(e,t)=>{if("function"==typeof e&&"function"==typeof t)return!0})}var sC=r(46123),sE=r.n(sC),sj=r(3514),sO=r.n(sj),sP=r(45838),sM=r(3326),sT=r.n(sM);function sI(e,t){let r=t[e];return[sT()(t,[e]),r]}function s$(e,t={}){return function e(t,r={},n=[]){let i,s=t||"";if(s.startsWith("#"))i=decodeURIComponent(s.substring(1));else throw Error(`Could not find a definition for ${t}.`);let o=sP.get(r,i);if(void 0===o)throw Error(`Could not find a definition for ${t}.`);let l=o[sf];if(l){if(n.includes(l)){if(1===n.length)throw Error(`Definition for ${t} is a circular reference`);let[e,...r]=n,i=[...r,s,e].join(" -> ");throw Error(`Definition for ${e} contains a circular reference through ${i}`)}let[i,a]=sI(sf,o),c=e(a,r,[...n,s]);return Object.keys(i).length>0?{...i,...c}:c}return o}(e,t,[])}var sD=r(52103),sR=r.n(sD),sN=r(60986),sL=r.n(sN),sF=r(41580),s_=r.n(sF),sB=r(8138),sz=r.n(sB),sW=r(90769),sV=r.n(sW),sH=r(55009),sU=r.n(sH);function sq(e,t,r){var n;if(e&&r){let i=sE()(e,r);if(void 0===i)return;for(let e=0;e<t.length;e++){let s=t[e],o=sE()(s,[su,r],{});if("object"!==o.type&&"array"!==o.type&&(o.const===i||(null==(n=o.enum)?void 0:n.includes(i))))return e}}}function sK(e,t,r,n,i){if(void 0===t)return 0;let s=sq(t,r,i);if(sL()(s))return s;for(let s=0;s<r.length;s++){let o=r[s];if(i&&sR()(o,[su,i])){let r=sE()(t,i),l=sE()(o,[su,i],{});if(e.isValid(l,r,n))return s}else if(o[su]){let r,i={anyOf:Object.keys(o[su]).map(e=>({required:[e]}))};if(o.anyOf){let{...e}=o;e.allOf?e.allOf=e.allOf.slice():e.allOf=[],e.allOf.push(i),r=e}else r=Object.assign({},o,i);if(delete r.required,e.isValid(r,t,n))return s}else if(e.isValid(o,t,n))return s}return 0}var sG=r(46343),sJ=r.n(sG),sY=r(41263),sX=r.n(sY),sZ=r(2011),sQ=r.n(sZ),s0=r(82451),s1=r.n(s0),s2=r(53435),s4=r.n(s2),s3=r(82438),s5=r.n(s3),s6=r(587),s9=r.n(s6);function s8(e){let t,r=sE()(e,"discriminator.propertyName",void 0);return sz()(r)?t=r:void 0!==r&&console.warn(`Expecting discriminator to be a string, got "${typeof r}" instead`),t}function s7(e){return Array.isArray(e)?"array":"string"==typeof e?"string":null==e?"null":"boolean"==typeof e?"boolean":isNaN(e)?"object"==typeof e?"object":"string":"number"}var oe=r(55620),ot=r.n(oe);function or(e){let{type:t}=e;return!t&&e.const?s7(e.const):!t&&e.enum?"string":!t&&(e.properties||e.additionalProperties)?"object":(Array.isArray(t)&&(t=2===t.length&&t.includes("null")?t.find(e=>"null"!==e):t[0]),t)}function on(e,t){let r=Object.assign({},e);return Object.keys(t).reduce((r,n)=>{let i=e?e[n]:{},s=t[n];return e&&n in e&&i7(s)?r[n]=on(i,s):e&&t&&("object"===or(e)||"object"===or(t))&&"required"===n&&Array.isArray(i)&&Array.isArray(s)?r[n]=ot()(i,s):r[n]=s,r},r)}function oi(e,t,r={},n,i){return oa(e,t,r,n,void 0,void 0,i)[0]}function os(e){return e.reduce((e,t)=>t.length>1?t.flatMap(t=>sU()(e.length,r=>[...e[r]].concat(t))):(e.forEach(e=>e.push(t[0])),e),[[]])}function oo(e,t,r,n,i,s,o){let l=ol(t,r,i);return l!==t?oa(e,l,r,s,n,i,o):[t]}function ol(e,t,r){if(!i7(e))return e;let n=e;if(sf in n){let{$ref:e,...i}=n;if(r.includes(e))return n;r.push(e),n={...s$(e,t),...i}}if(su in n){let e=[],i=sQ()(n[su],(n,i,s)=>{let o=[...r];n[s]=ol(i,t,o),e.push(o)},{});s1()(r,s5()(s4()(e))),n={...n,[su]:i}}return sa in n&&!Array.isArray(n.items)&&"boolean"!=typeof n.items&&(n={...n,items:ol(n.items,t,r)}),sJ()(e,n)?e:n}function oa(e,t,r,n,i=!1,s=[],o){let l;return i7(t)?((l=oo(e,t,r,i,s,n)).length>1||l[0]!==t?l:so in t?oc(e,t,r,i,s,n).flatMap(t=>oa(e,t,r,n,i,s,o)):sn in t&&Array.isArray(t.allOf)?os(t.allOf.map(t=>oa(e,t,r,n,i,s,o))).map(e=>({...t,allOf:e})):[t]).flatMap(t=>{var l,a;let c=t;if("if"in c)return function(e,t,r,n,i,s,o){let{if:l,then:a,else:c,...h}=t,u=e.isValid(l,s||{},r),d=[h],f=[];if(n)a&&"boolean"!=typeof a&&(f=f.concat(oa(e,a,r,s,n,i,o))),c&&"boolean"!=typeof c&&(f=f.concat(oa(e,c,r,s,n,i,o)));else{let t=u?a:c;t&&"boolean"!=typeof t&&(f=f.concat(oa(e,t,r,s,n,i,o)))}return f.length&&(d=f.map(e=>on(h,e))),d.flatMap(t=>oa(e,t,r,s,n,i,o))}(e,c,r,i,s,n,o);if(sn in c){if(i){let{allOf:e,...t}=c;return[...e,t]}try{let e=[],t=[];null==(l=c.allOf)||l.forEach(r=>{"object"==typeof r&&r.contains?e.push(r):t.push(r)}),e.length&&(c={...c,allOf:t}),c=o?o(c):s9()(c,{deep:!1}),e.length&&(c.allOf=e)}catch(r){console.warn("could not merge subschemas in allOf:\n",r);let{allOf:e,...t}=c;return t}}if(sr in c&&!1!==c.additionalProperties){let t,i;return t={...a=c,properties:{...a.properties}},Object.keys(i=n&&i7(n)?n:{}).forEach(n=>{if(n in t.properties)return;let s={};s="boolean"!=typeof t.additionalProperties?sf in t.additionalProperties?oi(e,{$ref:sE()(t.additionalProperties,[sf])},r,i,o):"type"in t.additionalProperties?{...t.additionalProperties}:si in t.additionalProperties||sh in t.additionalProperties?{type:"object",...t.additionalProperties}:{type:s7(sE()(i,[n]))}:{type:s7(sE()(i,[n]))},t.properties[n]=s,sX()(t.properties,[n,st],!0)}),t}return c}):[{}]}function oc(e,t,r,n,i,s,o){let{dependencies:l,...a}=t;return(function(e,t,r,n,i){let s,{oneOf:o,anyOf:l,...a}=t;if(Array.isArray(o)?s=o:Array.isArray(l)&&(s=l),s){let o=s8(t),l=sK(e,void 0===i&&n?{}:i,s=s.map(e=>ol(e,r,[])),r,o);if(n)return s.map(e=>on(a,e));t=on(a,s[l])}return[t]})(e,a,r,n,s).flatMap(t=>(function e(t,r,n,i,s,o,l,a){let c=[n];for(let h in r){if(!s&&void 0===sE()(l,[h])||n.properties&&!(h in n.properties))continue;let[u,d]=sI(h,r);return Array.isArray(d)?c[0]=function(e,t){if(!t)return e;let r=Array.isArray(e.required)?Array.from(new Set([...e.required,...t])):t;return{...e,required:r}}(n,d):i7(d)&&(c=function(e,t,r,n,i,s,o,l,a){return oa(e,i,r,l,s,o,a).flatMap(i=>{let{oneOf:c,...h}=i;return(t=on(t,h),void 0===c)?t:os(c.map(t=>"boolean"!=typeof t&&sf in t?oo(e,t,r,s,o,l):[t])).flatMap(i=>(function(e,t,r,n,i,s,o,l,a){let c=i.filter(t=>{if("boolean"==typeof t||!t||!t.properties)return!1;let{[n]:i}=t.properties;return!!i&&(e.isValid({type:"object",properties:{[n]:i}},l,r)||s)});return s||1===c.length?c.flatMap(i=>{let[c]=sI(n,i.properties);return oa(e,{...i,properties:c},r,l,s,o,a).map(e=>on(t,e))}):(console.warn("ignoring oneOf in dependencies because there isn't exactly one subschema that is valid"),[t])})(e,t,r,n,i,s,o,l,a))})}(t,n,i,h,d,s,o,l,a)),c.flatMap(r=>e(t,u,r,i,s,o,l,a))}return c})(e,l,t,r,n,i,s,o))}let oh={type:"object",$id:"_$junk_option_schema_id$_",properties:{__not_really_there__:{type:"number"}}};function ou(e,t,r,n,i=-1,s,o){let l=n.map(e=>ol(e,t,[])),a=sq(r,n,s);if(sL()(a))return a;let c=l.reduce((n,i,o)=>(1===sK(e,r,[oh,i],t,s)&&n.push(o),n),[]);if(1===c.length)return c[0];c.length||sU()(l.length,e=>c.push(e));let h=new Set,{bestIndex:u}=c.reduce((n,i)=>{let{bestScore:s}=n,a=function e(t,r,n,i,s){let o=0;return n&&(s_()(n.properties)?o+=sV()(n.properties,(n,o,l)=>{let a=sE()(i,l);if("boolean"==typeof o)return n;if(sR()(o,sf)){let i=oi(t,o,r,a,s);return n+e(t,r,i,a||{},s)}if((sR()(o,sh)||sR()(o,si))&&a){let e=sR()(o,sh)?sh:si,i=s8(o);return n+ou(t,r,a,sE()(o,e),-1,i,s)}if("object"===o.type)return s_()(a)&&(n+=1),n+e(t,r,o,a,s);if(o.type===s7(a)){let e=n+1;return o.default?e+=a===o.default?1:-1:o.const&&(e+=a===o.const?1:-1),e}return n},0):sz()(n.type)&&n.type===s7(i)&&(o+=1)),o}(e,t,l[i],r,o);return(h.add(a),a>s)?{bestIndex:i,bestScore:a}:n},{bestIndex:i,bestScore:0});return 1===h.size&&i>=0?i:u}function od(e){return Array.isArray(e.items)&&e.items.length>0&&e.items.every(e=>i7(e))}function of(e,t,r=!1,n=!1){if(Array.isArray(t)){let i=Array.isArray(e)?e:[],s=t.map((e,t)=>i[t]?of(i[t],e,r,n):e);return r&&s.length<i.length&&s.push(...i.slice(s.length)),s}if(i7(t)){let i=Object.assign({},e);return Object.keys(t).reduce((i,s)=>(i[s]=of(e?sE()(e,s):{},sE()(t,s),r,n),i),i)}return n&&void 0===t?e:t}function op(e,t,r=!1){return Object.keys(t).reduce((n,i)=>{let s=e?e[i]:{},o=t[i];if(e&&i in e&&i7(o))n[i]=op(s,o,r);else if(r&&Array.isArray(s)&&Array.isArray(o)){let e=o;"preventDuplicates"===r&&(e=o.reduce((e,t)=>(s.includes(t)||e.push(t),e),[])),n[i]=s.concat(e)}else n[i]=o;return n},Object.assign({},e))}function om(e,t,r={},n){let i=oi(e,t,r,void 0,n),s=i.oneOf||i.anyOf;return!!Array.isArray(i.enum)||!!Array.isArray(s)&&s.every(e=>"boolean"!=typeof e&&(Array.isArray(e.enum)&&1===e.enum.length||ss in e))}function og(e,t,r,n){return!!t.uniqueItems&&!!t.items&&"boolean"!=typeof t.items&&om(e,t.items,r,n)}let oy=["string","number","integer","boolean","null"];function ov(e,t=uG.Ignore,r=-1){if(r>=0){if(Array.isArray(e.items)&&r<e.items.length){let t=e.items[r];if("boolean"!=typeof t)return t}}else if(e.items&&!Array.isArray(e.items)&&"boolean"!=typeof e.items)return e.items;return t!==uG.Ignore&&i7(e.additionalItems)?e.additionalItems:{}}function ox(e,t,r,n,i,s=[],o={},l=!1){let{emptyObjectFields:a="populateAllDefaults"}=o;if(n||l)e[t]=r;else if("skipDefaults"!==a)if(i7(r)){let n=void 0===i?s.includes(t):i;"skipEmptyDefaults"===a?sO()(r)||(e[t]=r):(!sO()(r)||s.includes(t))&&(n||"populateRequiredDefaults"!==a)&&(e[t]=r)}else void 0!==r&&("populateAllDefaults"===a||"skipEmptyDefaults"===a||s.includes(t))&&(e[t]=r)}function ob(e,t,r={}){let{parentDefaults:n,rawFormData:i,rootSchema:s={},includeUndefinedValues:o=!1,_recurseList:l=[],experimental_defaultFormStateBehavior:a,experimental_customMergeAllOf:c,required:h}=r,u=i7(i)?i:{},d=i7(t)?t:{},f=n,p=null,m=a,g=l;if(d[ss]&&(null==a?void 0:a.constAsDefaults)!=="never")f=d.const;else if(i7(f)&&i7(d.default))f=op(f,d.default);else if("default"in d)f=d.default;else if(sf in d){let e=d[sf];l.includes(e)||(g=l.concat(e),p=s$(e,s))}else if(so in d){let t={...ow(e,d,r,f),...u};p=oc(e,d,s,!1,[],t,c)[0]}else if(od(d))f=d.items.map((t,r)=>ob(e,t,{rootSchema:s,includeUndefinedValues:o,_recurseList:l,experimental_defaultFormStateBehavior:a,experimental_customMergeAllOf:c,parentDefaults:Array.isArray(n)?n[r]:void 0,rawFormData:u,required:h}));else if(sh in d){let{oneOf:t,...r}=d;if(0===t.length)return;let n=s8(d),{type:i="null"}=r;!Array.isArray(i)&&oy.includes(i)&&(null==m?void 0:m.constAsDefaults)==="skipOneOf"&&(m={...m,constAsDefaults:"never"}),p=on(r,p=t[ou(e,s,sO()(u)?void 0:u,t,0,n,c)])}else if(si in d){let{anyOf:t,...r}=d;if(0===t.length)return;let n=s8(d);p=on(r,p=t[ou(e,s,sO()(u)?void 0:u,t,0,n,c)])}if(p)return ob(e,p,{rootSchema:s,includeUndefinedValues:o,_recurseList:g,experimental_defaultFormStateBehavior:m,experimental_customMergeAllOf:c,parentDefaults:f,rawFormData:u,required:h});void 0===f&&(f=d.default);let y=ow(e,d,r,f);return null!=y?y:f}function ow(e,t,r={},n){switch(or(t)){case"object":return function(e,t,{rawFormData:r,rootSchema:n={},includeUndefinedValues:i=!1,_recurseList:s=[],experimental_defaultFormStateBehavior:o,experimental_customMergeAllOf:l,required:a}={},c){{let h=i7(r)?r:{},u=(null==o?void 0:o.allOf)==="populateDefaults"&&sn in t?oi(e,t,n,h,l):t,d=u[ss],f=Object.keys(u.properties||{}).reduce((t,r)=>{var f;let p=sE()(u,[su,r]),m=i7(d)&&void 0!==d[r],g=(i7(p)&&ss in p||m)&&(null==o?void 0:o.constAsDefaults)!=="never",y=ob(e,p,{rootSchema:n,_recurseList:s,experimental_defaultFormStateBehavior:o,experimental_customMergeAllOf:l,includeUndefinedValues:!0===i,parentDefaults:sE()(c,[r]),rawFormData:sE()(h,[r]),required:null==(f=u.required)?void 0:f.includes(r)});return ox(t,r,y,i,a,u.required,o,g),t},{});if(u.additionalProperties){let t=i7(u.additionalProperties)?u.additionalProperties:{},r=new Set;i7(c)&&Object.keys(c).filter(e=>!u.properties||!u.properties[e]).forEach(e=>r.add(e));let d=[];Object.keys(h).filter(e=>!u.properties||!u.properties[e]).forEach(e=>{r.add(e),d.push(e)}),r.forEach(r=>{var p;let m=ob(e,t,{rootSchema:n,_recurseList:s,experimental_defaultFormStateBehavior:o,experimental_customMergeAllOf:l,includeUndefinedValues:!0===i,parentDefaults:sE()(c,[r]),rawFormData:sE()(h,[r]),required:null==(p=u.required)?void 0:p.includes(r)});ox(f,r,m,i,a,d)})}return f}}(e,t,r,n);case"array":return function(e,t,{rawFormData:r,rootSchema:n={},_recurseList:i=[],experimental_defaultFormStateBehavior:s,experimental_customMergeAllOf:o,required:l}={},a){var c,h;let u=null!=(c=null==s?void 0:s.arrayMinItems)?c:{},{populate:d,mergeExtraDefaults:f}=u,p="never"===d,m="requiredOnly"===d,g=null!=(h=null==u?void 0:u.computeSkipPopulate)?h:()=>!1,y=(null==s?void 0:s.emptyObjectFields)==="skipEmptyDefaults"?void 0:[];if(Array.isArray(a)&&(a=a.map((r,a)=>ob(e,ov(t,uG.Fallback,a),{rootSchema:n,_recurseList:i,experimental_defaultFormStateBehavior:s,experimental_customMergeAllOf:o,parentDefaults:r,required:l}))),Array.isArray(r)){let c=ov(t);if(p)a=r;else{let t=r.map((t,r)=>ob(e,c,{rootSchema:n,_recurseList:i,experimental_defaultFormStateBehavior:s,experimental_customMergeAllOf:o,rawFormData:t,parentDefaults:sE()(a,[r]),required:l}));a=of(a,t,(m&&l||"all"===d||!p&&!m)&&f)}}if(!1===(i7(t)&&ss in t&&(null==s?void 0:s.constAsDefaults)!=="never")){if(p)return null!=a?a:y;if(m&&!l)return a||void 0}let v=Array.isArray(a)?a.length:0;if(!t.minItems||og(e,t,n,o)||g(e,t,n)||t.minItems<=v)return a||y;let x=a||[],b=ov(t,uG.Invert),w=b.default,k=Array(t.minItems-v).fill(ob(e,b,{parentDefaults:w,rootSchema:n,_recurseList:i,experimental_defaultFormStateBehavior:s,experimental_customMergeAllOf:o,required:l}));return x.concat(k)}(e,t,r,n)}}function ok(e,t,r,n,i=!1,s,o){if(!i7(t))throw Error("Invalid schema: "+t);let l=oi(e,t,n,r,o),a=ob(e,l,{rootSchema:n,includeUndefinedValues:i,experimental_defaultFormStateBehavior:s,experimental_customMergeAllOf:o,rawFormData:r});if(null==r||"number"==typeof r&&isNaN(r))return a;let{mergeDefaultsIntoFormData:c,arrayMinItems:h={}}=s||{},{mergeExtraDefaults:u}=h;return i7(r)||Array.isArray(r)?of(a,r,u,"useDefaultIfFormDataUndefined"===c):r}function oA(e={}){return"widget"in sv(e)&&"hidden"!==sv(e).widget}function oS(e,t,r={},n,i){if("files"===r[sg])return!0;if(t.items){let r=oi(e,t.items,n,void 0,i);return"string"===r.type&&"data-url"===r.format}return!1}(uH=uG||(uG={}))[uH.Ignore=0]="Ignore",uH[uH.Invert=1]="Invert",uH[uH.Fallback=2]="Fallback";let oC=Symbol("no Value");class oE{constructor(e,t,r,n){this.rootSchema=t,this.validator=e,this.experimental_defaultFormStateBehavior=r,this.experimental_customMergeAllOf=n}getValidator(){return this.validator}doesSchemaUtilsDiffer(e,t,r={},n){return!!e&&!!t&&(this.validator!==e||!sS(this.rootSchema,t)||!sS(this.experimental_defaultFormStateBehavior,r)||this.experimental_customMergeAllOf!==n)}getDefaultFormState(e,t,r=!1){return ok(this.validator,e,t,this.rootSchema,r,this.experimental_defaultFormStateBehavior,this.experimental_customMergeAllOf)}getDisplayLabel(e,t,r){return function(e,t,r={},n,i,s){let{label:o=!0}=sv(r,i),l=!!o,a=or(t);return"array"===a&&(l=og(e,t,n,s)||oS(e,t,r,n,s)||oA(r)),"object"===a&&(l=!1),"boolean"!==a||r[sg]||(l=!1),r["ui:field"]&&(l=!1),l}(this.validator,e,t,this.rootSchema,r,this.experimental_customMergeAllOf)}getClosestMatchingOption(e,t,r,n){return ou(this.validator,this.rootSchema,e,t,r,n,this.experimental_customMergeAllOf)}getFirstMatchingOption(e,t,r){var n;return n=this.validator,sK(n,e,t,this.rootSchema,r)}getMatchingOption(e,t,r){return sK(this.validator,e,t,this.rootSchema,r)}isFilesArray(e,t){return oS(this.validator,e,t,this.rootSchema,this.experimental_customMergeAllOf)}isMultiSelect(e){return og(this.validator,e,this.rootSchema,this.experimental_customMergeAllOf)}isSelect(e){return om(this.validator,e,this.rootSchema,this.experimental_customMergeAllOf)}mergeValidationData(e,t){return function(e,t,r){if(!r)return t;let{errors:n,errorSchema:i}=t,s=e.toErrorList(r),o=r;return sO()(i)||(o=op(i,r,!0),s=[...n].concat(s)),{errorSchema:o,errors:s}}(this.validator,e,t)}retrieveSchema(e,t){return oi(this.validator,e,this.rootSchema,t,this.experimental_customMergeAllOf)}sanitizeDataForNewSchema(e,t,r){return function e(t,r,n,i,s={},o){let l;if(sR()(n,su)){let a={};sR()(i,su)&&Object.keys(sE()(i,su,{})).forEach(e=>{sR()(s,e)&&(a[e]=void 0)});let c=Object.keys(sE()(n,su,{})),h={};c.forEach(l=>{let c=sE()(s,l),u=sE()(i,[su,l],{}),d=sE()(n,[su,l],{});sR()(u,sf)&&(u=oi(t,u,r,c,o)),sR()(d,sf)&&(d=oi(t,d,r,c,o));let f=sE()(u,"type"),p=sE()(d,"type");if(!f||f===p)if(sR()(a,l)&&delete a[l],"object"===p||"array"===p&&Array.isArray(c)){let n=e(t,r,d,u,c,o);(void 0!==n||"array"===p)&&(h[l]=n)}else{let e=sE()(d,"default",oC),t=sE()(u,"default",oC);e!==oC&&e!==c&&(t===c?a[l]=e:!0===sE()(d,"readOnly")&&(a[l]=void 0));let r=sE()(d,"const",oC),n=sE()(u,"const",oC);r!==oC&&r!==c&&(a[l]=n===c?r:void 0)}}),l={..."string"==typeof s||Array.isArray(s)?void 0:s,...a,...h}}else if("array"===sE()(i,"type")&&"array"===sE()(n,"type")&&Array.isArray(s)){let a=sE()(i,"items"),c=sE()(n,"items");if("object"!=typeof a||"object"!=typeof c||Array.isArray(a)||Array.isArray(c))"boolean"==typeof a&&"boolean"==typeof c&&a===c&&(l=s);else{sR()(a,sf)&&(a=oi(t,a,r,s,o)),sR()(c,sf)&&(c=oi(t,c,r,s,o));let i=sE()(a,"type"),h=sE()(c,"type");if(!i||i===h){let i=sE()(n,"maxItems",-1);l="object"===h?s.reduce((n,s)=>{let l=e(t,r,c,a,s,o);return void 0!==l&&(i<0||n.length<i)&&n.push(l),n},[]):i>0&&s.length>i?s.slice(0,i):s}}}return l}(this.validator,this.rootSchema,e,t,r,this.experimental_customMergeAllOf)}toIdSchema(e,t,r,n="root",i="_"){return function(e,t,r,n,i,s="root",o="_",l){return function e(t,r,n,i,s,o,l,a=[],c){if(sf in r||so in r||sn in r){let h=oi(t,r,o,l,c);if(-1===a.findIndex(e=>sJ()(e,h)))return e(t,h,n,i,s,o,l,a.concat(h),c)}if(sa in r&&!sE()(r,[sa,sf]))return e(t,sE()(r,sa),n,i,s,o,l,a,c);let h={$id:s||n};if("object"===or(r)&&su in r)for(let s in r.properties){let u=sE()(r,[su,s]),d=h.$id+i+s;h[s]=e(t,i7(u)?u:{},n,i,d,o,sE()(l,[s]),a,c)}return h}(e,t,s,o,r,n,i,void 0,l)}(this.validator,e,t,this.rootSchema,r,n,i,this.experimental_customMergeAllOf)}toPathSchema(e,t,r){return function(e,t,r="",n,i,s){return function e(t,r,n,i,s,o=[],l){if(sf in r||so in r||sn in r){let a=oi(t,r,i,s,l);if(-1===o.findIndex(e=>sJ()(e,a)))return e(t,a,n,i,s,o.concat(a),l)}let a={[sc]:n.replace(/^\./,"")};if(sh in r||si in r){let c=sh in r?r.oneOf:r.anyOf,h=ou(t,i,s,c,0,s8(r),l),u=c[h];a={...a,...e(t,u,n,i,s,o,l)}}if(sr in r&&!1!==r[sr]&&sX()(a,sp,!0),sa in r&&Array.isArray(s)){let{items:c,additionalItems:h}=r;Array.isArray(c)?s.forEach((r,s)=>{c[s]?a[s]=e(t,c[s],`${n}.${s}`,i,r,o,l):h?a[s]=e(t,h,`${n}.${s}`,i,r,o,l):console.warn(`Unable to generate path schema for "${n}.${s}". No schema defined for it`)}):s.forEach((r,s)=>{a[s]=e(t,c,`${n}.${s}`,i,r,o,l)})}else if(su in r)for(let c in r.properties){let h=sE()(r,[su,c]);a[c]=e(t,h,`${n}.${c}`,i,sE()(s,[c]),o,l)}return a}(e,t,r,n,i,void 0,s)}(this.validator,e,t,this.rootSchema,r,this.experimental_customMergeAllOf)}}function oj(e,t){let r=String(e);for(;r.length<t;)r="0"+r;return r}function oO(e,t){let r=e;if(Array.isArray(t)){let e=r.split(/(%\d)/);t.forEach((t,r)=>{let n=e.findIndex(e=>e===`%${r+1}`);n>=0&&(e[n]=t)}),r=e.join("")}return r}function oP(e,t=[],r){if(Array.isArray(e))return e.map(e=>oP(e,t)).filter(e=>e!==r);let n=t[""===e||null===e?-1:Number(e)];return n?n.value:r}function oM(e,t,r=[]){let n=oP(e,r);return Array.isArray(t)?t.filter(e=>!sJ()(e,n)):sJ()(n,t)?void 0:t}function oT(e,t){return Array.isArray(t)?t.some(t=>sJ()(t,e)):sJ()(t,e)}function oI(e,t=[],r=!1){let n=t.map((t,r)=>oT(t.value,e)?String(r):void 0).filter(e=>void 0!==e);return r?n:n[0]}var o$=r(3668),oD=r.n(o$);function oR(e,t,r=[]){let n=oP(e,r);if(!oD()(n)){let e=r.findIndex(e=>n===e.value),i=r.map(({value:e})=>e);return t.slice(0,e).concat(n,t.slice(e)).sort((e,t)=>Number(i.indexOf(e)>i.indexOf(t)))}return t}var oN=r(92551),oL=r.n(oN);class oF{constructor(e){this.errorSchema={},this.resetAllErrors(e)}get ErrorSchema(){return this.errorSchema}getOrCreateErrorBlock(e){let t=Array.isArray(e)&&e.length>0||"string"==typeof e?sE()(this.errorSchema,e):this.errorSchema;return!t&&e&&(t={},oL()(this.errorSchema,e,t,Object)),t}resetAllErrors(e){return this.errorSchema=e?t5()(e):{},this}addErrors(e,t){let r=this.getOrCreateErrorBlock(t),n=sE()(r,sl);return Array.isArray(n)||(n=[],r[sl]=n),Array.isArray(e)?sX()(r,sl,[...new Set([...n,...e])]):sX()(r,sl,[...new Set([...n,e])]),this}setErrors(e,t){let r=this.getOrCreateErrorBlock(t),n=Array.isArray(e)?[...new Set([...e])]:[e];return sX()(r,sl,n),this}clearErrors(e){let t=this.getOrCreateErrorBlock(e);return sX()(t,sl,[]),this}}function o_(e){let t={};return e.multipleOf&&(t.step=e.multipleOf),(e.minimum||0===e.minimum)&&(t.min=e.minimum),(e.maximum||0===e.maximum)&&(t.max=e.maximum),t}function oB(e,t,r={},n=!0){let i={type:t||"text",...o_(e)};return r.inputType?i.type=r.inputType:!t&&("number"===e.type?(i.type="number",n&&void 0===i.step&&(i.step="any")):"integer"===e.type&&(i.type="number",void 0===i.step&&(i.step=1))),r.autocomplete&&(i.autoComplete=r.autocomplete),i}let oz={props:{disabled:!1},submitText:"Submit",norender:!1};function oW(e={}){let t=sv(e);if(t&&t[sd]){let e=t[sd];return{...oz,...e}}return oz}function oV(e,t,r={}){let{templates:n}=t;return"ButtonTemplates"===e?n[e]:r[e]||n[e]}var oH=r(35631);let oU={boolean:{checkbox:"CheckboxWidget",radio:"RadioWidget",select:"SelectWidget",hidden:"HiddenWidget"},string:{text:"TextWidget",password:"PasswordWidget",email:"EmailWidget",hostname:"TextWidget",ipv4:"TextWidget",ipv6:"TextWidget",uri:"URLWidget","data-url":"FileWidget",radio:"RadioWidget",select:"SelectWidget",textarea:"TextareaWidget",hidden:"HiddenWidget",date:"DateWidget",datetime:"DateTimeWidget","date-time":"DateTimeWidget","alt-date":"AltDateWidget","alt-datetime":"AltDateTimeWidget",time:"TimeWidget",color:"ColorWidget",file:"FileWidget"},number:{text:"TextWidget",select:"SelectWidget",updown:"UpDownWidget",range:"RangeWidget",radio:"RadioWidget",hidden:"HiddenWidget"},integer:{text:"TextWidget",select:"SelectWidget",updown:"UpDownWidget",range:"RangeWidget",radio:"RadioWidget",hidden:"HiddenWidget"},array:{select:"SelectWidget",checkboxes:"CheckboxesWidget",files:"FileWidget",hidden:"HiddenWidget"}};function oq(e,t,r={}){let n=or(e);if("function"==typeof t||t&&oH.isForwardRef((0,tZ.createElement)(t))||oH.isMemo(t)){let e=sE()(t,"MergedWidget");if(!e){let r=t.defaultProps&&t.defaultProps.options||{};e=({options:e,...n})=>(0,v.jsx)(t,{options:{...r,...e},...n}),sX()(t,"MergedWidget",e)}return e}if("string"!=typeof t)throw Error(`Unsupported widget definition: ${typeof t}`);if(t in r)return oq(e,r[t],r);if("string"==typeof n){if(!(n in oU))throw Error(`No widget for type '${n}'`);if(t in oU[n])return oq(e,r[oU[n][t]],r)}throw Error(`No widget '${t}' for type '${n}'`)}function oK(e,t){let r=sz()(e)?e:e.$id;return`${r}__${t}`}function oG(e){return oK(e,"description")}function oJ(e){return oK(e,"error")}function oY(e){return oK(e,"examples")}function oX(e){return oK(e,"help")}function oZ(e){return oK(e,"title")}function oQ(e,t=!1){let r=t?` ${oY(e)}`:"";return`${oJ(e)} ${oG(e)} ${oX(e)}${r}`}function o0(e,t){return`${e}-${t}`}function o1(e,t){let r,n;if(e.enum){let r;if(t){let{enumNames:e}=sv(t);r=e}return!r&&e.enumNames&&(r=e.enumNames),e.enum.map((e,t)=>({label:(null==r?void 0:r[t])||String(e),value:e}))}return e.anyOf?(r=e.anyOf,n=null==t?void 0:t.anyOf):e.oneOf&&(r=e.oneOf,n=null==t?void 0:t.oneOf),r&&r.map((e,t)=>{let{title:r}=sv(null==n?void 0:n[t]),i=function(e){if("enum"in e&&Array.isArray(e.enum)&&1===e.enum.length)return e.enum[0];if(ss in e)return e.const;throw Error("schema cannot be inferred as a constant")}(e),s=r||e.title||String(i);return{schema:e,label:s,value:i}})}function o2(e,t=!0){if(!e)return{year:-1,month:-1,day:-1,hour:t?-1:0,minute:t?-1:0,second:t?-1:0};let r=new Date(e);if(Number.isNaN(r.getTime()))throw Error("Unable to parse date "+e);return{year:r.getUTCFullYear(),month:r.getUTCMonth()+1,day:r.getUTCDate(),hour:t?r.getUTCHours():0,minute:t?r.getUTCMinutes():0,second:t?r.getUTCSeconds():0}}function o4(e){return!!e.const||!!e.enum&&1===e.enum.length&&!0===e.enum[0]||(e.anyOf&&1===e.anyOf.length?o4(e.anyOf[0]):e.oneOf&&1===e.oneOf.length?o4(e.oneOf[0]):!!e.allOf&&e.allOf.some(e=>o4(e)))}function o3(e,t=!0){let{year:r,month:n,day:i,hour:s=0,minute:o=0,second:l=0}=e,a=new Date(Date.UTC(r,n-1,i,s,o,l)).toJSON();return t?a:a.slice(0,10)}function o5(e,t=[]){if(!e)return[];let r=[];return sl in e&&(r=r.concat(e[sl].map(e=>{let r=`.${t.join(".")}`;return{property:r,message:e,stack:`${r} ${e}`}}))),Object.keys(e).reduce((r,n)=>{if(n!==sl){let i=e[n];sw()(i)&&(r=r.concat(o5(i,[...t,n])))}return r},r)}var o6=r(42613),o9=r.n(o6);function o8(e,t){if(!t)return e;let{errors:r,errorSchema:n}=e,i=o5(t),s=t;return sO()(n)||(s=op(n,t,!0),i=[...r].concat(i)),{errorSchema:s,errors:i}}(uU=uJ||(uJ={})).ArrayItemTitle="Item",uU.MissingItems="Missing items definition",uU.YesLabel="Yes",uU.NoLabel="No",uU.CloseLabel="Close",uU.ErrorsLabel="Errors",uU.NewStringDefault="New Value",uU.AddButton="Add",uU.AddItemButton="Add Item",uU.CopyButton="Copy",uU.MoveDownButton="Move down",uU.MoveUpButton="Move up",uU.RemoveButton="Remove",uU.NowLabel="Now",uU.ClearLabel="Clear",uU.AriaDateLabel="Select a date",uU.PreviewLabel="Preview",uU.DecrementAriaLabel="Decrease value by 1",uU.IncrementAriaLabel="Increase value by 1",uU.UnknownFieldType="Unknown field type %1",uU.OptionPrefix="Option %1",uU.TitleOptionPrefix="%1 option %2",uU.KeyLabel="%1 Key",uU.InvalidObjectField='Invalid "%1" object field configuration: _%2_.',uU.UnsupportedField="Unsupported field schema.",uU.UnsupportedFieldWithId="Unsupported field schema for field `%1`.",uU.UnsupportedFieldWithReason="Unsupported field schema: _%1_.",uU.UnsupportedFieldWithIdAndReason="Unsupported field schema for field `%1`: _%2_.",uU.FilesInfo="**%1** (%2, %3 bytes)";var o7=r(83657),le=r.n(o7),lt=r(11601),lr=r.n(lt),ln=r(74421),li=r.n(ln);let ls={allErrors:!0,multipleOfPrecision:8,strict:!1,verbose:!0,discriminator:!1},lo=/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/,ll=/^data:([a-z]+\/[a-z0-9-+.]+)?;(?:name=(.*);)?base64,(.*)$/;class la{constructor(e,t){const{additionalMetaSchemas:r,customFormats:n,ajvOptionsOverrides:i,ajvFormatOptions:s,AjvClass:o}=e;this.ajv=function(e,t,r={},n,i=lr()){let s=new i({...ls,...r});return n?li()(s,n):!1!==n&&li()(s),s.addFormat("data-url",ll),s.addFormat("color",lo),s.addKeyword(st),s.addKeyword(sp),Array.isArray(e)&&s.addMetaSchema(e),s_()(t)&&Object.keys(t).forEach(e=>{s.addFormat(e,t[e])}),s}(r,n,i,s,o),this.localizer=t}reset(){this.ajv.removeSchema()}toErrorList(e,t=[]){return o5(e,t)}rawValidation(e,t){var r,n;let i,s,o;e.$id&&(i=this.ajv.getSchema(e.$id));try{void 0===i&&(i=this.ajv.compile(e)),i(t)}catch(e){o=e}return i&&("function"==typeof this.localizer&&((null!=(r=i.errors)?r:[]).forEach(e=>{var t;(null==(t=e.params)?void 0:t.missingProperty)&&(e.params.missingProperty=`'${e.params.missingProperty}'`)}),this.localizer(i.errors),(null!=(n=i.errors)?n:[]).forEach(e=>{var t;(null==(t=e.params)?void 0:t.missingProperty)&&(e.params.missingProperty=e.params.missingProperty.slice(1,-1))})),s=i.errors||void 0,i.errors=null),{errors:s,validationError:o}}validateFormData(e,t,r,n,i){return function(e,t,r,n,i,s,o){var l;let a,{validationError:c}=t,h=function(e=[],t){return e.map(e=>{let{instancePath:r,keyword:n,params:i,schemaPath:s,parentSchema:o,...l}=e,{message:a=""}=l,c=r.replace(/\//g,"."),h=`${c} ${a}`.trim();if("missingProperty"in i){c=c?`${c}.${i.missingProperty}`:i.missingProperty;let e=i.missingProperty,r=sv(sE()(t,`${c.replace(/^\./,"")}`)).title;if(void 0===r){let n=s.replace(/\/properties\//g,"/").split("/").slice(1,-1).concat([e]);r=sv(sE()(t,n)).title}if(r)a=a.replace(`'${e}'`,`'${r}'`);else{let t=sE()(o,[su,e,"title"]);t&&(a=a.replace(`'${e}'`,`'${t}'`))}h=a}else{let e=sv(sE()(t,`${c.replace(/^\./,"")}`)).title;if(e)h=`'${e}' ${a}`.trim();else{let e=null==o?void 0:o.title;e&&(h=`'${e}' ${a}`.trim())}}return{name:n,property:c,message:a,params:i,stack:h,schemaPath:s}})}(t.errors,o);c&&(h=[...h,{stack:c.message}]),"function"==typeof s&&(h=s(h,o));let u=(l=h,a=new oF,l.length&&l.forEach(e=>{let{property:t,message:r}=e,n="."===t?[]:o9()(t);n.length>0&&""===n[0]&&n.splice(0,1),r&&a.addErrors(r,n)}),a.ErrorSchema);if(c&&(u={...u,$schema:{__errors:[c.message]}}),"function"!=typeof i)return{errors:h,errorSchema:u};let d=ok(e,n,r,n,!0);return o8({errors:h,errorSchema:u},function e(t){return Object.keys(t).reduce((r,n)=>{if("addError"===n)return r;{let i=t[n];return sw()(i)?{...r,[n]:e(i)}:{...r,[n]:i}}},{})}(i(d,function e(t){let r={[sl]:[],addError(e){this[sl].push(e)}};return Array.isArray(t)?t.reduce((t,r,n)=>({...t,[n]:e(r)}),r):sw()(t)?Object.keys(t).reduce((r,n)=>({...r,[n]:e(t[n])}),r):r}(d),o)))}(this,this.rawValidation(t,e),e,t,r,n,i)}handleSchemaUpdate(e){var t,r;let n=null!=(t=e.$id)?t:sm;void 0===this.ajv.getSchema(n)?this.ajv.addSchema(e,n):sS(e,null==(r=this.ajv.getSchema(n))?void 0:r.schema)||(this.ajv.removeSchema(n),this.ajv.addSchema(e,n))}isValid(e,t,r){var n;try{let i;this.handleSchemaUpdate(r);let s=function e(t){if(Array.isArray(t)){var r=[...t];for(let t=0;t<r.length;t++)r[t]=e(r[t]);return r}if(s_()(t)){var n={...t};for(let t in n){let r=n[t];t===sf&&"string"==typeof r&&r.startsWith("#")?n[t]=sm+r:n[t]=e(r)}return n}return t}(e),o=null!=(n=s.$id)?n:function(e){let t=new Set;JSON.stringify(e,(e,r)=>(t.add(e),r));var r=JSON.stringify(e,Array.from(t).sort());let n=0;for(let e=0;e<r.length;e+=1)n=(n<<5)-n+r.charCodeAt(e),n&=n;return n.toString(16)}(s);return i=this.ajv.getSchema(o),void 0===i&&(i=this.ajv.addSchema(s,o).getSchema(o)||this.ajv.compile(s)),i(t)}catch(e){return console.warn("Error encountered compiling schema:",e),!1}}}function lc(e={},t){return new la(e,t)}let lh=lc();var lu=r(67156),ld=r.n(lu),lf=r(45810),lp=r.n(lf);let{parse:lm,stringify:lg}=JSON,{keys:ly}=Object,lv=String,lx="string",lb={},lw="object",lk=(e,t)=>t,lA=e=>e instanceof lv?lv(e):e,lS=(e,t)=>typeof t===lx?new lv(t):t,lC=(e,t,r,n)=>{let i=[];for(let s=ly(r),{length:o}=s,l=0;l<o;l++){let o=s[l],a=r[o];if(a instanceof lv){let s=e[a];typeof s!==lw||t.has(s)?r[o]=n.call(r,o,s):(t.add(s),r[o]=lb,i.push({k:o,a:[e,t,s,n]}))}else r[o]!==lb&&(r[o]=n.call(r,o,a))}for(let{length:e}=i,t=0;t<e;t++){let{k:e,a:s}=i[t];r[e]=n.call(r,e,lC.apply(null,s))}return r},lE=(e,t,r)=>{let n=lv(t.push(r)-1);return e.set(r,n),n};function lj(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}let lO=e=>{var t;let r,n,i,s,o={},l=(n=(r=lm(((e,t,r)=>{let n=t&&typeof t===lw?(e,r)=>""===e||-1<t.indexOf(e)?r:void 0:t||lk,i=new Map,s=[],o=[],l=+lE(i,s,n.call({"":e},"",e)),a=!l;for(;l<s.length;)a=!0,o[l]=lg(s[l++],c,r);return"["+o.join(",")+"]";function c(e,t){if(a)return a=!a,t;let r=n.call(this,e,t);switch(typeof r){case lw:if(null===r)break;case lx:return i.get(r)||lE(i,s,r)}return r}})(e),lS).map(lA))[0],i=t||lk,s=typeof n===lw&&n?lC(r,new Set,n,i):n,i.call({"":s},"",s));return!function e(t,r){if(!lj(t))return;let{properties:n,items:i,anyOf:s,oneOf:o,allOf:l,dependencies:a,then:c,else:h}=t;for(let e in t)t.hasOwnProperty(e)&&e.startsWith("ui:")&&(r[e]=t[e],delete t[e]);if(lj(n))for(let t in n){if(!n.hasOwnProperty(t))continue;let i=n[t];if(lj(i)){if(!lj(r[t])){let e={};r[t]=e}e(i,r[t])}}if(lj(i)){let t={};r.items=t,e(i,t)}if(Array.isArray(s))for(let t of s)lj(t)&&e(t,r);if(Array.isArray(o))for(let t of o)lj(t)&&e(t,r);if(Array.isArray(l))for(let t of l)lj(t)&&e(t,r);if(lj(a))for(let t of Object.keys(a)){let n=a[t];lj(n)&&e(n,r)}lj(c)&&e(c,r),lj(h)&&e(h,r)}(l,o),{uiSchema:o,schema:l}};var lP=r(74874),lM=r.n(lP);function lT(){return((e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((e,t)=>((t&=63)<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),""))()}function lI(e){return Array.isArray(e)?e.map(e=>({key:lT(),item:e})):[]}function l$(e){return Array.isArray(e)?e.map(e=>e.item):[]}class lD extends tZ.Component{constructor(e){super(e),this._getNewFormDataRow=()=>{let{schema:e,registry:t}=this.props,{schemaUtils:r}=t,n=e.items;return od(e)&&(!0===e.additionalItems&&console.warn("additionalItems=true is currently not supported"),i7(e.additionalItems))&&(n=e.additionalItems),r.getDefaultFormState(n)},this.onAddClick=e=>{this._handleAddClick(e)},this.onAddIndexClick=e=>t=>{this._handleAddClick(t,e)},this.onCopyIndexClick=e=>t=>{let r;t&&t.preventDefault();let{onChange:n,errorSchema:i}=this.props,{keyedFormData:s}=this.state;if(i)for(let t in r={},i){let n=parseInt(t);n<=e?sX()(r,[n],i[t]):n>e&&sX()(r,[n+1],i[t])}let o={key:lT(),item:t5()(s[e].item)},l=[...s];void 0!==e?l.splice(e+1,0,o):l.push(o),this.setState({keyedFormData:l,updatedKeyedFormData:!0},()=>n(l$(l),r))},this.onDropIndexClick=e=>t=>{let r;t&&t.preventDefault();let{onChange:n,errorSchema:i}=this.props,{keyedFormData:s}=this.state;if(i)for(let t in r={},i){let n=parseInt(t);n<e?sX()(r,[n],i[t]):n>e&&sX()(r,[n-1],i[t])}let o=s.filter((t,r)=>r!==e);this.setState({keyedFormData:o,updatedKeyedFormData:!0},()=>n(l$(o),r))},this.onReorderClick=(e,t)=>r=>{let n,i;r&&(r.preventDefault(),r.currentTarget.blur());let{onChange:s,errorSchema:o}=this.props;if(o)for(let r in n={},o){let i=parseInt(r);i==e?sX()(n,[t],o[e]):i==t?sX()(n,[e],o[t]):sX()(n,[r],o[i])}let{keyedFormData:l}=this.state,a=((i=l.slice()).splice(e,1),i.splice(t,0,l[e]),i);this.setState({keyedFormData:a},()=>s(l$(a),n))},this.onChangeForIndex=e=>(t,r,n)=>{let{formData:i,onChange:s,errorSchema:o}=this.props;s((Array.isArray(i)?i:[]).map((r,n)=>e===n?void 0===t?null:t:r),o&&o&&{...o,[e]:r},n)},this.onSelectChange=e=>{let{onChange:t,idSchema:r}=this.props;t(e,void 0,r&&r.$id)};const{formData:t=[]}=e,r=lI(t);this.state={keyedFormData:r,updatedKeyedFormData:!1}}static getDerivedStateFromProps(e,t){if(t.updatedKeyedFormData)return{updatedKeyedFormData:!1};let r=Array.isArray(e.formData)?e.formData:[],n=t.keyedFormData||[];return{keyedFormData:r.length===n.length?n.map((e,t)=>({key:e.key,item:r[t]})):lI(r)}}get itemTitle(){let{schema:e,registry:t}=this.props,{translateString:r}=t;return sE()(e,[sa,"title"],sE()(e,[sa,"description"],r(uJ.ArrayItemTitle)))}isItemRequired(e){return Array.isArray(e.type)?!e.type.includes("null"):"null"!==e.type}canAddItem(e){let{schema:t,uiSchema:r,registry:n}=this.props,{addable:i}=sv(r,n.globalUiOptions);return!1!==i&&(i=void 0===t.maxItems||e.length<t.maxItems),i}_handleAddClick(e,t){let r;e&&e.preventDefault();let{onChange:n,errorSchema:i}=this.props,{keyedFormData:s}=this.state;if(i)for(let e in r={},i){let n=parseInt(e);void 0===t||n<t?sX()(r,[n],i[e]):n>=t&&sX()(r,[n+1],i[e])}let o={key:lT(),item:this._getNewFormDataRow()},l=[...s];void 0!==t?l.splice(t,0,o):l.push(o),this.setState({keyedFormData:l,updatedKeyedFormData:!0},()=>n(l$(l),r))}render(){let{schema:e,uiSchema:t,idSchema:r,registry:n}=this.props,{schemaUtils:i,translateString:s}=n;if(!(sa in e)){let i=oV("UnsupportedFieldTemplate",n,sv(t));return(0,v.jsx)(i,{schema:e,idSchema:r,reason:s(uJ.MissingItems),registry:n})}return i.isMultiSelect(e)?this.renderMultiSelect():oA(t)?this.renderCustomWidget():od(e)?this.renderFixedArray():i.isFilesArray(e,t)?this.renderFiles():this.renderNormalArray()}renderNormalArray(){let{schema:e,uiSchema:t={},errorSchema:r,idSchema:n,name:i,title:s,disabled:o=!1,readonly:l=!1,autofocus:a=!1,required:c=!1,registry:h,onBlur:u,onFocus:d,idPrefix:f,idSeparator:p="_",rawErrors:m}=this.props,{keyedFormData:g}=this.state,y=e.title||s||i,{schemaUtils:x,formContext:b}=h,w=sv(t),k=s_()(e.items)?e.items:{},A=x.retrieveSchema(k),S=l$(this.state.keyedFormData),C=this.canAddItem(S),E={canAdd:C,items:g.map((e,s)=>{let{key:o,item:l}=e,c=x.retrieveSchema(k,l),h=r?r[s]:void 0,v=n.$id+p+s,b=x.toIdSchema(c,v,l,f,p);return this.renderArrayFieldItem({key:o,index:s,name:i&&`${i}-${s}`,title:y?`${y}-${s+1}`:void 0,canAdd:C,canMoveUp:s>0,canMoveDown:s<S.length-1,itemSchema:c,itemIdSchema:b,itemErrorSchema:h,itemData:l,itemUiSchema:t.items,autofocus:a&&0===s,onBlur:u,onFocus:d,rawErrors:m,totalItems:g.length})}),className:`field field-array field-array-of-${A.type}`,disabled:o,idSchema:n,uiSchema:t,onAddClick:this.onAddClick,readonly:l,required:c,schema:e,title:y,formContext:b,formData:S,rawErrors:m,registry:h},j=oV("ArrayFieldTemplate",h,w);return(0,v.jsx)(j,{...E})}renderCustomWidget(){var e;let{schema:t,idSchema:r,uiSchema:n,disabled:i=!1,readonly:s=!1,autofocus:o=!1,required:l=!1,hideError:a,placeholder:c,onBlur:h,onFocus:u,formData:d=[],registry:f,rawErrors:p,name:m}=this.props,{widgets:g,formContext:y,globalUiOptions:x,schemaUtils:b}=f,{widget:w,title:k,...A}=sv(n,x),S=oq(t,w,g),C=null!=(e=null!=k?k:t.title)?e:m,E=b.getDisplayLabel(t,n,x);return(0,v.jsx)(S,{id:r.$id,name:m,multiple:!0,onChange:this.onSelectChange,onBlur:h,onFocus:u,options:A,schema:t,uiSchema:n,registry:f,value:d,disabled:i,readonly:s,hideError:a,required:l,label:C,hideLabel:!E,placeholder:c,formContext:y,autofocus:o,rawErrors:p})}renderMultiSelect(){var e;let{schema:t,idSchema:r,uiSchema:n,formData:i=[],disabled:s=!1,readonly:o=!1,autofocus:l=!1,required:a=!1,placeholder:c,onBlur:h,onFocus:u,registry:d,rawErrors:f,name:p}=this.props,{widgets:m,schemaUtils:g,formContext:y,globalUiOptions:x}=d,b=o1(g.retrieveSchema(t.items,i),n),{widget:w="select",title:k,...A}=sv(n,x),S=oq(t,w,m),C=null!=(e=null!=k?k:t.title)?e:p,E=g.getDisplayLabel(t,n,x);return(0,v.jsx)(S,{id:r.$id,name:p,multiple:!0,onChange:this.onSelectChange,onBlur:h,onFocus:u,options:{...A,enumOptions:b},schema:t,uiSchema:n,registry:d,value:i,disabled:s,readonly:o,required:a,label:C,hideLabel:!E,placeholder:c,formContext:y,autofocus:l,rawErrors:f})}renderFiles(){var e;let{schema:t,uiSchema:r,idSchema:n,name:i,disabled:s=!1,readonly:o=!1,autofocus:l=!1,required:a=!1,onBlur:c,onFocus:h,registry:u,formData:d=[],rawErrors:f}=this.props,{widgets:p,formContext:m,globalUiOptions:g,schemaUtils:y}=u,{widget:x="files",title:b,...w}=sv(r,g),k=oq(t,x,p),A=null!=(e=null!=b?b:t.title)?e:i,S=y.getDisplayLabel(t,r,g);return(0,v.jsx)(k,{options:w,id:n.$id,name:i,multiple:!0,onChange:this.onSelectChange,onBlur:c,onFocus:h,schema:t,uiSchema:r,value:d,disabled:s,readonly:o,required:a,registry:u,formContext:m,autofocus:l,rawErrors:f,label:A,hideLabel:!S})}renderFixedArray(){let{schema:e,uiSchema:t={},formData:r=[],errorSchema:n,idPrefix:i,idSeparator:s="_",idSchema:o,name:l,title:a,disabled:c=!1,readonly:h=!1,autofocus:u=!1,required:d=!1,registry:f,onBlur:p,onFocus:m,rawErrors:g}=this.props,{keyedFormData:y}=this.state,{formData:x=[]}=this.props,b=e.title||a||l,w=sv(t),{schemaUtils:k,formContext:A}=f,S=(s_()(e.items)?e.items:[]).map((e,t)=>k.retrieveSchema(e,r[t])),C=s_()(e.additionalItems)?k.retrieveSchema(e.additionalItems,r):null;(!x||x.length<S.length)&&(x=(x=x||[]).concat(Array(S.length-x.length)));let E=this.canAddItem(x)&&!!C,j={canAdd:E,className:"field field-array field-array-fixed-items",disabled:c,idSchema:o,formData:r,items:y.map((r,a)=>{let{key:c,item:h}=r,d=a>=S.length,f=(d&&s_()(e.additionalItems)?k.retrieveSchema(e.additionalItems,h):S[a])||{},v=o.$id+s+a,w=k.toIdSchema(f,v,h,i,s),A=d?t.additionalItems||{}:Array.isArray(t.items)?t.items[a]:t.items||{},C=n?n[a]:void 0;return this.renderArrayFieldItem({key:c,index:a,name:l&&`${l}-${a}`,title:b?`${b}-${a+1}`:void 0,canAdd:E,canRemove:d,canMoveUp:a>=S.length+1,canMoveDown:d&&a<x.length-1,itemSchema:f,itemData:h,itemUiSchema:A,itemIdSchema:w,itemErrorSchema:C,autofocus:u&&0===a,onBlur:p,onFocus:m,rawErrors:g,totalItems:y.length})}),onAddClick:this.onAddClick,readonly:h,required:d,registry:f,schema:e,uiSchema:t,title:b,formContext:A,errorSchema:n,rawErrors:g},O=oV("ArrayFieldTemplate",f,w);return(0,v.jsx)(O,{...j})}renderArrayFieldItem(e){let{key:t,index:r,name:n,canAdd:i,canRemove:s=!0,canMoveUp:o,canMoveDown:l,itemSchema:a,itemData:c,itemUiSchema:h,itemIdSchema:u,itemErrorSchema:d,autofocus:f,onBlur:p,onFocus:m,rawErrors:g,totalItems:y,title:x}=e,{disabled:b,hideError:w,idPrefix:k,idSeparator:A,readonly:S,uiSchema:C,registry:E,formContext:j}=this.props,{fields:{ArraySchemaField:O,SchemaField:P},globalUiOptions:M}=E,{orderable:T=!0,removable:I=!0,copyable:$=!1}=sv(C,M),D={moveUp:T&&o,moveDown:T&&l,copy:$&&i,remove:I&&s,toolbar:!1};return D.toolbar=Object.keys(D).some(e=>D[e]),{children:(0,v.jsx)(O||P,{name:n,title:x,index:r,schema:a,uiSchema:h,formData:c,formContext:j,errorSchema:d,idPrefix:k,idSeparator:A,idSchema:u,required:this.isItemRequired(a),onChange:this.onChangeForIndex(r),onBlur:p,onFocus:m,registry:E,disabled:b,readonly:S,hideError:w,autofocus:f,rawErrors:g}),className:"array-item",disabled:b,canAdd:i,hasCopy:D.copy,hasToolbar:D.toolbar,hasMoveUp:D.moveUp,hasMoveDown:D.moveDown,hasRemove:D.remove,index:r,totalItems:y,key:t,onAddIndexClick:this.onAddIndexClick,onCopyIndexClick:this.onCopyIndexClick,onDropIndexClick:this.onDropIndexClick,onReorderClick:this.onReorderClick,readonly:S,registry:E,schema:a,uiSchema:h}}}let lR=function(e){var t,r,n;let i,{schema:s,name:o,uiSchema:l,idSchema:a,formData:c,registry:h,required:u,disabled:d,readonly:f,hideError:p,autofocus:m,title:g,onChange:y,onFocus:x,onBlur:b,rawErrors:w}=e,{title:k}=s,{widgets:A,formContext:S,translateString:C,globalUiOptions:E}=h,{widget:j="checkbox",title:O,label:P=!0,...M}=sv(l,E),T=oq(s,j,A),I=C(uJ.YesLabel),$=C(uJ.NoLabel),D=null!=(r=null!=(t=null!=O?O:k)?t:g)?r:o;if(Array.isArray(s.oneOf))i=o1({oneOf:s.oneOf.map(e=>{if(s_()(e))return{...e,title:e.title||(!0===e.const?I:$)}}).filter(e=>e)},l);else{let e=null!=(n=s.enum)?n:[!0,!1];i=!s.enumNames&&2===e.length&&e.every(e=>"boolean"==typeof e)?[{value:e[0],label:e[0]?I:$},{value:e[1],label:e[1]?I:$}]:o1({enum:e,enumNames:s.enumNames},l)}return(0,v.jsx)(T,{options:{...M,enumOptions:i},schema:s,uiSchema:l,id:a.$id,name:o,onChange:y,onFocus:x,onBlur:b,label:D,hideLabel:!P,value:c,required:u,disabled:d,readonly:f,hideError:p,registry:h,formContext:S,autofocus:m,rawErrors:w})};class lN extends tZ.Component{constructor(e){super(e),this.onOptionChange=e=>{let{selectedOption:t,retrievedOptions:r}=this.state,{formData:n,onChange:i,registry:s}=this.props,{schemaUtils:o}=s,l=void 0!==e?parseInt(e,10):-1;if(l===t)return;let a=l>=0?r[l]:void 0,c=t>=0?r[t]:void 0,h=o.sanitizeDataForNewSchema(a,c,n);a&&(h=o.getDefaultFormState(a,h,"excludeObjectChildren")),this.setState({selectedOption:l},()=>{i(h,void 0,this.getFieldId())})};const{formData:t,options:r,registry:{schemaUtils:n}}=this.props,i=r.map(e=>n.retrieveSchema(e,t));this.state={retrievedOptions:i,selectedOption:this.getMatchingOption(0,t,i)}}componentDidUpdate(e,t){let{formData:r,options:n,idSchema:i}=this.props,{selectedOption:s}=this.state,o=this.state;if(!sS(e.options,n)){let{registry:{schemaUtils:e}}=this.props;o={selectedOption:s,retrievedOptions:n.map(t=>e.retrieveSchema(t,r))}}if(!sS(r,e.formData)&&i.$id===e.idSchema.$id){let{retrievedOptions:e}=o,n=this.getMatchingOption(s,r,e);t&&n!==s&&(o={selectedOption:n,retrievedOptions:e})}o!==this.state&&this.setState(o)}getMatchingOption(e,t,r){let{schema:n,registry:{schemaUtils:i}}=this.props,s=s8(n);return i.getClosestMatchingOption(t,r,e,s)}getFieldId(){let{idSchema:e,schema:t}=this.props;return`${e.$id}${t.oneOf?"__oneof_select":"__anyof_select"}`}render(){let e,{name:t,disabled:r=!1,errorSchema:n={},formContext:i,onBlur:s,onFocus:o,registry:l,schema:a,uiSchema:c}=this.props,{widgets:h,fields:u,translateString:d,globalUiOptions:f,schemaUtils:p}=l,{SchemaField:m}=u,{selectedOption:g,retrievedOptions:y}=this.state,{widget:x="select",placeholder:b,autofocus:w,autocomplete:k,title:A=a.title,...S}=sv(c,f),C=oq({type:"number"},x,h),E=sE()(n,sl,[]),j=sT()(n,[sl]),O=p.getDisplayLabel(a,c,f),P=g>=0&&y[g]||null;if(P){let{required:t}=a;e=t?on({required:t},P):P}let M=[];sh in a&&c&&sh in c?Array.isArray(c[sh])?M=c[sh]:console.warn(`uiSchema.oneOf is not an array for "${A||t}"`):si in a&&c&&si in c&&(Array.isArray(c[si])?M=c[si]:console.warn(`uiSchema.anyOf is not an array for "${A||t}"`));let T=c;g>=0&&M.length>g&&(T=M[g]);let I=A?uJ.TitleOptionPrefix:uJ.OptionPrefix,$=A?[A]:[],D=y.map((e,t)=>{let{title:r=e.title}=sv(M[t]);return{label:r||d(I,$.concat(String(t+1))),value:t}});return(0,v.jsxs)("div",{className:"panel panel-default panel-body",children:[(0,v.jsx)("div",{className:"form-group",children:(0,v.jsx)(C,{id:this.getFieldId(),name:`${t}${a.oneOf?"__oneof_select":"__anyof_select"}`,schema:{type:"number",default:0},onChange:this.onOptionChange,onBlur:s,onFocus:o,disabled:r||sO()(D),multiple:!1,rawErrors:E,errorSchema:j,value:g>=0?g:void 0,options:{enumOptions:D,...S},registry:l,formContext:i,placeholder:b,autocomplete:k,autofocus:w,label:null!=A?A:t,hideLabel:!O})}),e&&(0,v.jsx)(m,{...this.props,schema:e,uiSchema:T})]})}}let lL=/\.([0-9]*0)*$/,lF=/[0.]0*$/,l_=function(e){let{registry:t,onChange:r,formData:n,value:i}=e,[s,o]=(0,tZ.useState)(i),{StringField:l}=t.fields,a=n,c=(0,tZ.useCallback)((e,t,n)=>{o(e),"."===`${e}`.charAt(0)&&(e=`0${e}`),r("string"==typeof e&&e.match(lL)?se(e.replace(lF,"")):se(e),t,n)},[r]);if("string"==typeof s&&"number"==typeof a){let e=RegExp(`^(${String(a).replace(".","\\.")})?\\.?0*$`);s.match(e)&&(a=s)}return(0,v.jsx)(l,{...e,formData:a,onChange:c})};function lB(){return(lB=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}let lz=["children","options"],lW=["allowFullScreen","allowTransparency","autoComplete","autoFocus","autoPlay","cellPadding","cellSpacing","charSet","classId","colSpan","contentEditable","contextMenu","crossOrigin","encType","formAction","formEncType","formMethod","formNoValidate","formTarget","frameBorder","hrefLang","inputMode","keyParams","keyType","marginHeight","marginWidth","maxLength","mediaGroup","minLength","noValidate","radioGroup","readOnly","rowSpan","spellCheck","srcDoc","srcLang","srcSet","tabIndex","useMap"].reduce((e,t)=>(e[t.toLowerCase()]=t,e),{class:"className",for:"htmlFor"}),lV={amp:"&",apos:"'",gt:">",lt:"<",nbsp:"\xa0",quot:""},lH=["style","script","pre"],lU=["src","href","data","formAction","srcDoc","action"],lq=/([-A-Z0-9_:]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|(?:\{((?:\\.|{[^}]*?}|[^}])*)\})))?/gi,lK=/\n{2,}$/,lG=/^(\s*>[\s\S]*?)(?=\n\n|$)/,lJ=/^ *> ?/gm,lY=/^(?:\[!([^\]]*)\]\n)?([\s\S]*)/,lX=/^ {2,}\n/,lZ=/^(?:([-*_])( *\1){2,}) *(?:\n *)+\n/,lQ=/^(?: {1,3})?(`{3,}|~{3,}) *(\S+)? *([^\n]*?)?\n([\s\S]*?)(?:\1\n?|$)/,l0=/^(?: {4}[^\n]+\n*)+(?:\n *)+\n?/,l1=/^(`+)((?:\\`|(?!\1)`|[^`])+)\1/,l2=/^(?:\n *)*\n/,l4=/\r\n?/g,l3=/^\[\^([^\]]+)](:(.*)((\n+ {4,}.*)|(\n(?!\[\^).+))*)/,l5=/^\[\^([^\]]+)]/,l6=/\f/g,l9=/^---[ \t]*\n(.|\n)*\n---[ \t]*\n/,l8=/^\s*?\[(x|\s)\]/,l7=/^ *(#{1,6}) *([^\n]+?)(?: +#*)?(?:\n *)*(?:\n|$)/,ae=/^ *(#{1,6}) +([^\n]+?)(?: +#*)?(?:\n *)*(?:\n|$)/,at=/^([^\n]+)\n *(=|-)\2{2,} *\n/,ar=/^ *(?!<[a-z][^ >/]* ?\/>)<([a-z][^ >/]*) ?((?:[^>]*[^/])?)>\n?(\s*(?:<\1[^>]*?>[\s\S]*?<\/\1>|(?!<\1\b)[\s\S])*?)<\/\1>(?!<\/\1>)\n*/i,an=/&([a-z0-9]+|#[0-9]{1,6}|#x[0-9a-fA-F]{1,6});/gi,ai=/^<!--[\s\S]*?(?:-->)/,as=/^(data|aria|x)-[a-z_][a-z\d_.-]*$/,ao=/^ *<([a-z][a-z0-9:]*)(?:\s+((?:<.*?>|[^>])*))?\/?>(?!<\/\1>)(\s*\n)?/i,al=/^\{.*\}$/,aa=/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,ac=/^<([^ >]+[:@\/][^ >]+)>/,ah=/-([a-z])?/gi,au=/^(\|.*)\n(?: *(\|? *[-:]+ *\|[-| :]*)\n((?:.*\|.*\n)*))?\n?/,ad=/^[^\n]+(?:  \n|\n{2,})/,af=/^\[([^\]]*)\]:\s+<?([^\s>]+)>?\s*("([^"]*)")?/,ap=/^!\[([^\]]*)\] ?\[([^\]]*)\]/,am=/^\[([^\]]*)\] ?\[([^\]]*)\]/,ag=/(\n|^[-*]\s|^#|^ {2,}|^-{2,}|^>\s)/,ay=/\t/g,av=/(^ *\||\| *$)/g,ax=/^ *:-+: *$/,ab=/^ *:-+ *$/,aw=/^ *-+: *$/,ak=e=>`(?=[\\s\\S]+?\\1${e?"\\1":""})`,aA="((?:\\[.*?\\][([].*?[)\\]]|<.*?>(?:.*?<.*?>)?|`.*?`|\\\\\\1|[\\s\\S])+?)",aS=RegExp(`^([*_])\\1${ak(1)}${aA}\\1\\1(?!\\1)`),aC=RegExp(`^([*_])${ak(0)}${aA}\\1(?!\\1)`),aE=RegExp(`^(==)${ak(0)}${aA}\\1`),aj=RegExp(`^(~~)${ak(0)}${aA}\\1`),aO=/^(:[a-zA-Z0-9-_]+:)/,aP=/^\\([^0-9A-Za-z\s])/,aM=/\\([^0-9A-Za-z\s])/g,aT=/^[\s\S](?:(?!  \n|[0-9]\.|http)[^=*_~\-\n:<`\\\[!])*/,aI=/^\n+/,a$=/^([ \t]*)/,aD=/(?:^|\n)( *)$/,aR="(?:\\d+\\.)",aN="(?:[*+-])";function aL(e){return"( *)("+(1===e?aR:aN)+") +"}let aF=aL(1),a_=aL(2);function aB(e){return RegExp("^"+(1===e?aF:a_))}let az=aB(1),aW=aB(2);function aV(e){return RegExp("^"+(1===e?aF:a_)+"[^\\n]*(?:\\n(?!\\1"+(1===e?aR:aN)+" )[^\\n]*)*(\\n|$)","gm")}let aH=aV(1),aU=aV(2);function aq(e){let t=1===e?aR:aN;return RegExp("^( *)("+t+") [\\s\\S]+?(?:\\n{2,}(?! )(?!\\1"+t+" (?!"+t+" ))\\n*|\\s*\\n*$)")}let aK=aq(1),aG=aq(2);function aJ(e,t){let r=1===t,n=r?aK:aG,i=r?aH:aU,s=r?az:aW;return{t:e=>s.test(e),o:a6(function(e,t){let r=aD.exec(t.prevCapture);return r&&(t.list||!t.inline&&!t.simple)?n.exec(e=r[1]+e):null}),i:1,u(e,t,n){let o=r?+e[2]:void 0,l=e[0].replace(lK,"\n").match(i),a=!1;return{items:l.map(function(e,r){let i,o=RegExp("^ {1,"+s.exec(e)[0].length+"}","gm"),c=e.replace(o,"").replace(s,""),h=r===l.length-1,u=-1!==c.indexOf("\n\n")||h&&a;a=u;let d=n.inline,f=n.list;n.list=!0,u?(n.inline=!1,i=aQ(c)+"\n\n"):(n.inline=!0,i=aQ(c));let p=t(i,n);return n.inline=d,n.list=f,p}),ordered:r,start:o}},l:(t,r,n)=>e(t.ordered?"ol":"ul",{key:n.key,start:"20"===t.type?t.start:void 0},t.items.map(function(t,i){return e("li",{key:i},r(t,n))}))}}let aY=RegExp("^\\[((?:\\[[^\\[\\]]*(?:\\[[^\\[\\]]*\\][^\\[\\]]*)*\\]|[^\\[\\]])*)\\]\\(\\s*<?((?:\\([^)]*\\)|[^\\s\\\\]|\\\\.)*?)>?(?:\\s+['\"]([\\s\\S]*?)['\"])?\\s*\\)"),aX=/^!\[(.*?)\]\( *((?:\([^)]*\)|[^() ])*) *"?([^)"]*)?"?\)/;function aZ(e){return"string"==typeof e}function aQ(e){let t=e.length;for(;t>0&&e[t-1]<=" ";)t--;return e.slice(0,t)}function a0(e,t){return e.startsWith(t)}function a1(e){return e.replace(/[]/g,"a").replace(/[]/g,"c").replace(/[]/g,"d").replace(/[]/g,"e").replace(/[]/g,"i").replace(/[]/g,"n").replace(/[]/g,"o").replace(/[]/g,"u").replace(/[]/g,"y").replace(/[^a-z0-9- ]/gi,"").replace(/ /gi,"-").toLowerCase()}function a2(e){return aw.test(e)?"right":ax.test(e)?"center":ab.test(e)?"left":null}function a4(e,t,r,n){let i=r.inTable;r.inTable=!0;let s=[[]],o="";function l(){if(!o)return;let e=s[s.length-1];e.push.apply(e,t(o,r)),o=""}return e.trim().split(/(`[^`]*`|\\\||\|)/).filter(Boolean).forEach((e,t,r)=>{"|"===e.trim()&&(l(),n)?0!==t&&t!==r.length-1&&s.push([]):o+=e}),l(),r.inTable=i,s}function a3(e,t,r){var n;r.inline=!0;let i=e[2]?e[2].replace(av,"").split("|").map(a2):[],s=e[3]?(n=e[3],n.trim().split("\n").map(function(e){return a4(e,t,r,!0)})):[],o=a4(e[1],t,r,!!s.length);return r.inline=!1,s.length?{align:i,cells:s,header:o,type:"25"}:{children:o,type:"21"}}function a5(e,t){return null==e.align[t]?{}:{textAlign:e.align[t]}}function a6(e){return e.inline=1,e}function a9(e){return a6(function(t,r){return r.inline?e.exec(t):null})}function a8(e){return a6(function(t,r){return r.inline||r.simple?e.exec(t):null})}function a7(e){return function(t,r){return r.inline||r.simple?null:e.exec(t)}}function ce(e){return a6(function(t){return e.exec(t)})}let ct=/(javascript|vbscript|data(?!:image)):/i;function cr(e){try{let t=decodeURIComponent(e).replace(/[^A-Za-z0-9/:]/g,"");if(ct.test(t))return null}catch(e){return null}return e}function cn(e){return e?e.replace(aM,"$1"):e}function ci(e,t,r){let n=r.inline||!1,i=r.simple||!1;r.inline=!0,r.simple=!0;let s=e(t,r);return r.inline=n,r.simple=i,s}function cs(e,t,r){let n=r.inline||!1;r.inline=!1;let i=e(t,r);return r.inline=n,i}let co=(e,t,r)=>({children:ci(t,e[2],r)});function cl(){return{}}function ca(){return null}function cc(e,t,r){let n=e,i=t.split(".");for(;i.length&&void 0!==(n=n[i[0]]);)i.shift();return n||r}let ch=e=>{let{children:t,options:r}=e,n=function(e,t){if(null==e)return{};var r,n,i={},s=Object.keys(e);for(n=0;n<s.length;n++)t.indexOf(r=s[n])>=0||(i[r]=e[r]);return i}(e,lz);return tZ.cloneElement(function(e="",t={}){var r,n;t.overrides=t.overrides||{},t.namedCodesToUnicode=t.namedCodesToUnicode?lB({},lV,t.namedCodesToUnicode):lV;let i=t.slugify||a1,s=t.sanitizer||cr,o=t.createElement||tZ.createElement,l=[lG,lQ,l0,t.enforceAtxHeadings?ae:l7,at,au,aK,aG],a=[...l,ad,ar,ai,ao];function c(e,t){for(let r=0;r<e.length;r++)if(e[r].test(t))return!0;return!1}function h(e,r,...n){var i;let s,l=cc(t.overrides,e+".props",{});return o((s=cc(i=t.overrides,e))?"function"==typeof s||"object"==typeof s&&"render"in s?s:cc(i,e+".component",e):e,lB({},r,l,{className:function(...e){return e.filter(Boolean).join(" ")}(null==r?void 0:r.className,l.className)||void 0}),...n)}function u(e){let r;e=e.replace(l9,"");let n=!1;t.forceInline?n=!0:t.forceBlock||(n=!1===ag.test(e));let i=y(g(n?e:aQ(e).replace(aI,"")+"\n\n",{inline:n}));for(;aZ(i[i.length-1])&&!i[i.length-1].trim();)i.pop();if(null===t.wrapper)return i;let s=t.wrapper||(n?"span":"div");if(i.length>1||t.forceWrapper)r=i;else{if(1===i.length)return"string"==typeof(r=i[0])?h("span",{key:"outer"},r):r;r=null}return o(s,{key:"outer"},r)}function d(e,t){if(!t||!t.trim())return null;let r=t.match(lq);return r?r.reduce(function(t,r){let n=r.indexOf("=");if(-1!==n){var i,o,l;let a,c=(-1!==(i=r.slice(0,n)).indexOf("-")&&null===i.match(as)&&(i=i.replace(ah,function(e,t){return t.toUpperCase()})),i).trim(),h=('"'===(a=(o=r.slice(n+1).trim())[0])||"'"===a)&&o.length>=2&&o[o.length-1]===a?o.slice(1,-1):o,d=lW[c]||c;if("ref"===d)return t;let f=t[d]=(l=h,"style"===c?(function(e){let t=[],r="",n=!1,i=!1,s="";if(!e)return t;for(let o=0;o<e.length;o++){let l=e[o];if('"'!==l&&"'"!==l||n||(i?l===s&&(i=!1,s=""):(i=!0,s=l)),"("===l&&r.endsWith("url")?n=!0:")"===l&&n&&(n=!1),";"!==l||i||n)r+=l;else{let e=r.trim();if(e){let r=e.indexOf(":");if(r>0){let n=e.slice(0,r).trim(),i=e.slice(r+1).trim();t.push([n,i])}}r=""}}let o=r.trim();if(o){let e=o.indexOf(":");if(e>0){let r=o.slice(0,e).trim(),n=o.slice(e+1).trim();t.push([r,n])}}return t})(l).reduce(function(t,[r,n]){return t[r.replace(/(-[a-z])/g,e=>e[1].toUpperCase())]=s(n,e,r),t},{}):-1!==lU.indexOf(c)?s(cn(l),e,c):(l.match(al)&&(l=cn(l.slice(1,l.length-1))),"true"===l||"false"!==l&&l));"string"==typeof f&&(ar.test(f)||ao.test(f))&&(t[d]=u(f.trim()))}else"style"!==r&&(t[lW[r]||r]=!0);return t},{}):null}let f=[],p={},m={0:{t:[">"],o:a7(lG),i:1,u(e,t,r){let[,n,i]=e[0].replace(lJ,"").match(lY);return{alert:n,children:t(i,r)}},l(e,t,r){let n={key:r.key};return e.alert&&(n.className="markdown-alert-"+i(e.alert.toLowerCase(),a1),e.children.unshift({attrs:{},children:[{type:"27",text:e.alert}],noInnerParse:!0,type:"11",tag:"header"})),h("blockquote",n,t(e.children,r))}},1:{t:["  "],o:ce(lX),i:1,u:cl,l:(e,t,r)=>h("br",{key:r.key})},2:{t:["--","__","**","- ","* ","_ "],o:a7(lZ),i:1,u:cl,l:(e,t,r)=>h("hr",{key:r.key})},3:{t:["    "],o:a7(l0),i:0,u:e=>({lang:void 0,text:cn(aQ(e[0].replace(/^ {4}/gm,"")))}),l:(e,t,r)=>h("pre",{key:r.key},h("code",lB({},e.attrs,{className:e.lang?"lang-"+e.lang:""}),e.text))},4:{t:["```","~~~"],o:a7(lQ),i:0,u:e=>({attrs:d("code",e[3]||""),lang:e[2]||void 0,text:e[4],type:"3"})},5:{t:["`"],o:a8(l1),i:3,u:e=>({text:cn(e[2])}),l:(e,t,r)=>h("code",{key:r.key},e.text)},6:{t:["[^"],o:a7(l3),i:0,u:e=>(f.push({footnote:e[2],identifier:e[1]}),{}),l:ca},7:{t:["[^"],o:a9(l5),i:1,u:e=>({target:"#"+i(e[1],a1),text:e[1]}),l:(e,t,r)=>h("a",{key:r.key,href:s(e.target,"a","href")},h("sup",{key:r.key},e.text))},8:{t:["[ ]","[x]"],o:a9(l8),i:1,u:e=>({completed:"x"===e[1].toLowerCase()}),l:(e,t,r)=>h("input",{checked:e.completed,key:r.key,readOnly:!0,type:"checkbox"})},9:{t:["#"],o:a7(t.enforceAtxHeadings?ae:l7),i:1,u:(e,t,r)=>({children:ci(t,e[2],r),id:i(e[2],a1),level:e[1].length}),l:(e,t,r)=>h("h"+e.level,{id:e.id,key:r.key},t(e.children,r))},10:{t:e=>{let t=e.indexOf("\n");return t>0&&t<e.length-1&&("="===e[t+1]||"-"===e[t+1])},o:a7(at),i:1,u:(e,t,r)=>({children:ci(t,e[1],r),level:"="===e[2]?1:2,type:"9"})},11:{t:["<"],o:ce(ar),i:1,u(e,t,r){let[,n]=e[3].match(a$),i=RegExp("^"+n,"gm"),s=e[3].replace(i,""),o=c(a,s)?cs:ci,l=e[1].toLowerCase(),h=-1!==lH.indexOf(l),u=(h?l:e[1]).trim(),f={attrs:d(u,e[2]),noInnerParse:h,tag:u};if(r.inAnchor=r.inAnchor||"a"===l,h)f.text=e[3];else{let e=r.inHTML;r.inHTML=!0,f.children=o(t,s,r),r.inHTML=e}return r.inAnchor=!1,f},l:(e,t,r)=>h(e.tag,lB({key:r.key},e.attrs),e.text||(e.children?t(e.children,r):""))},13:{t:["<"],o:ce(ao),i:1,u(e){let t=e[1].trim();return{attrs:d(t,e[2]||""),tag:t}},l:(e,t,r)=>h(e.tag,lB({},e.attrs,{key:r.key}))},12:{t:["\x3c!--"],o:ce(ai),i:1,u:()=>({}),l:ca},14:{t:["!["],o:a8(aX),i:1,u:e=>({alt:cn(e[1]),target:cn(e[2]),title:cn(e[3])}),l:(e,t,r)=>h("img",{key:r.key,alt:e.alt||void 0,title:e.title||void 0,src:s(e.target,"img","src")})},15:{t:["["],o:a9(aY),i:3,u:(e,t,r)=>{var n;let i,s,o;return{children:(n=e[1],i=r.inline||!1,s=r.simple||!1,r.inline=!1,r.simple=!0,o=t(n,r),r.inline=i,r.simple=s,o),target:cn(e[2]),title:cn(e[3])}},l:(e,t,r)=>h("a",{key:r.key,href:s(e.target,"a","href"),title:e.title},t(e.children,r))},16:{t:["<"],o:a9(ac),i:0,u(e){let t=e[1],r=!1;return -1!==t.indexOf("@")&&-1===t.indexOf("//")&&(r=!0,t=t.replace("mailto:","")),{children:[{text:t,type:"27"}],target:r?"mailto:"+t:t,type:"15"}}},17:{t:(e,r)=>!r.inAnchor&&!t.disableAutoLink&&(a0(e,"http://")||a0(e,"https://")),o:a9(aa),i:0,u:e=>({children:[{text:e[1],type:"27"}],target:e[1],title:void 0,type:"15"})},20:aJ(h,1),33:aJ(h,2),19:{t:["\n"],o:a7(l2),i:3,u:cl,l:()=>"\n"},21:{o:a6(function(e,t){if(t.inline||t.simple||t.inHTML&&-1===e.indexOf("\n\n")&&-1===t.prevCapture.indexOf("\n\n"))return null;let r="",n=0;for(;;){let t=e.indexOf("\n",n),i=e.slice(n,-1===t?void 0:t+1);if(c(l,i)||(r+=i,-1===t||!i.trim()))break;n=t+1}let i=aQ(r);return""===i?null:[r,,i]}),i:3,u:co,l:(e,t,r)=>h("p",{key:r.key},t(e.children,r))},22:{t:["["],o:a9(af),i:0,u:e=>(p[e[1]]={target:e[2],title:e[4]},{}),l:ca},23:{t:["!["],o:a8(ap),i:0,u:e=>({alt:e[1]?cn(e[1]):void 0,ref:e[2]}),l:(e,t,r)=>p[e.ref]?h("img",{key:r.key,alt:e.alt,src:s(p[e.ref].target,"img","src"),title:p[e.ref].title}):null},24:{t:e=>"["===e[0]&&-1===e.indexOf("]("),o:a9(am),i:0,u:(e,t,r)=>({children:t(e[1],r),fallbackChildren:e[0],ref:e[2]}),l:(e,t,r)=>p[e.ref]?h("a",{key:r.key,href:s(p[e.ref].target,"a","href"),title:p[e.ref].title},t(e.children,r)):h("span",{key:r.key},e.fallbackChildren)},25:{t:["|"],o:a7(au),i:1,u:a3,l:(e,t,r)=>h("table",{key:r.key},h("thead",null,h("tr",null,e.header.map(function(n,i){return h("th",{key:i,style:a5(e,i)},t(n,r))}))),h("tbody",null,e.cells.map(function(n,i){return h("tr",{key:i},n.map(function(n,i){return h("td",{key:i,style:a5(e,i)},t(n,r))}))})))},27:{o:a6(function(e,t){let r;return a0(e,":")&&(r=aO.exec(e)),r||aT.exec(e)}),i:4,u(e){let r=e[0];return{text:-1===r.indexOf("&")?r:r.replace(an,(e,r)=>t.namedCodesToUnicode[r]||e)}},l:e=>e.text},28:{t:["**","__"],o:a8(aS),i:2,u:(e,t,r)=>({children:t(e[2],r)}),l:(e,t,r)=>h("strong",{key:r.key},t(e.children,r))},29:{t:e=>{let t=e[0];return("*"===t||"_"===t)&&e[1]!==t},o:a8(aC),i:3,u:(e,t,r)=>({children:t(e[2],r)}),l:(e,t,r)=>h("em",{key:r.key},t(e.children,r))},30:{t:["\\"],o:a8(aP),i:1,u:e=>({text:e[1],type:"27"})},31:{t:["=="],o:a8(aE),i:3,u:co,l:(e,t,r)=>h("mark",{key:r.key},t(e.children,r))},32:{t:["~~"],o:a8(aj),i:3,u:co,l:(e,t,r)=>h("del",{key:r.key},t(e.children,r))}};!0===t.disableParsingRawHTML&&(delete m[11],delete m[13]);let g=((r=Object.keys(m)).sort(function(e,t){return m[e].i-m[t].i||(e<t?-1:1)}),function(e,t){return function e(t,n){var i=[];if(n.prevCapture=n.prevCapture||"",t.trim())for(;t;)for(var s=0;s<r.length;){var o=r[s],l=m[o];if(!l.t||function(e,t,r){if(Array.isArray(r)){for(let t=0;t<r.length;t++)if(a0(e,r[t]))return!0;return!1}return r(e,t)}(t,n,l.t)){var a=l.o(t,n);if(a&&a[0]){t=t.substring(a[0].length);var c=l.u(a,e,n);n.prevCapture+=a[0],c.type||(c.type=o),i.push(c);break}s++}else s++}return n.prevCapture="",i}(e.replace(l4,"\n").replace(l6,"").replace(ay,"    "),t)}),y=(n=t.renderRule,function e(t,r={}){var i;let s;if(Array.isArray(t)){let n=r.key,i=[],s=!1;for(let n=0;n<t.length;n++){r.key=n;let o=e(t[n],r),l=aZ(o);l&&s?i[i.length-1]+=o:null!==o&&i.push(o),s=l}return r.key=n,i}return i=e,s=m[t.type].l,n?n(()=>s(t,i,r),t,i,r):s(t,i,r)}),v=u(e);return f.length?h("div",null,v,h("footer",{key:"footer"},f.map(function(e){return h("div",{id:i(e.identifier,a1),key:e.identifier},e.identifier,y(g(e.footnote,{inline:!0})))}))):v}(null==t?"":t,r),n)};var cu=r(73450),cd=r.n(cu);class cf extends tZ.Component{constructor(){super(...arguments),this.state={wasPropertyKeyModified:!1,additionalProperties:{}},this.onPropertyChange=(e,t=!1)=>(r,n,i)=>{let{formData:s,onChange:o,errorSchema:l}=this.props;void 0===r&&t&&(r=""),o({...s,[e]:r},l&&l&&{...l,[e]:n},i)},this.onDropPropertyClick=e=>t=>{t.preventDefault();let{onChange:r,formData:n}=this.props,i={...n};cd()(i,e),r(i)},this.getAvailableKey=(e,t)=>{let{uiSchema:r,registry:n}=this.props,{duplicateKeySuffixSeparator:i="-"}=sv(r,n.globalUiOptions),s=0,o=e;for(;sR()(t,o);)o=`${e}${i}${++s}`;return o},this.onKeyChange=e=>(t,r)=>{if(e===t)return;let{formData:n,onChange:i,errorSchema:s}=this.props;t=this.getAvailableKey(t,n);let o={...n},l={[e]:t},a=Object.assign({},...Object.keys(o).map(e=>({[l[e]||e]:o[e]})));this.setState({wasPropertyKeyModified:!0}),i(a,s&&s&&{...s,[t]:r})},this.handleAddClick=e=>()=>{var t;let r,n,i;if(!e.additionalProperties)return;let{formData:s,onChange:o,registry:l}=this.props,a={...s};if(s_()(e.additionalProperties)){r=e.additionalProperties.type,n=e.additionalProperties.const,i=e.additionalProperties.default;let t=e.additionalProperties;if(sf in t){let{schemaUtils:e}=l;r=(t=e.retrieveSchema({$ref:t[sf]},s)).type,n=t.const,i=t.default}!r&&(si in t||sh in t)&&(r="object")}let c=this.getAvailableKey("newKey",a),h=null!=(t=null!=n?n:i)?t:this.getDefaultValue(r);sX()(a,c,h),o(a)}}isRequired(e){let{schema:t}=this.props;return Array.isArray(t.required)&&-1!==t.required.indexOf(e)}getDefaultValue(e){let{registry:{translateString:t}}=this.props;switch(e){case"array":return[];case"boolean":return!1;case"null":return null;case"number":return 0;case"object":return{};default:return t(uJ.NewStringDefault)}}render(){var e,t,r,n;let i,{schema:s,uiSchema:o={},formData:l,errorSchema:a,idSchema:c,name:h,required:u=!1,disabled:d,readonly:f,hideError:p,idPrefix:m,idSeparator:g,onBlur:y,onFocus:x,registry:b,title:w}=this.props,{fields:k,formContext:A,schemaUtils:S,translateString:C,globalUiOptions:E}=b,{SchemaField:j}=k,O=S.retrieveSchema(s,l),P=sv(o,E),{properties:M={}}=O,T=null!=(r=null!=(t=null!=(e=P.title)?e:O.title)?t:w)?r:h,I=null!=(n=P.description)?n:O.description;try{let e=Object.keys(M);i=function(e,t){if(!Array.isArray(t))return e;let r=e=>e.reduce((e,t)=>(e[t]=!0,e),{}),n=r(e),i=t.filter(e=>"*"===e||n[e]),s=r(i),o=e.filter(e=>!s[e]),l=i.indexOf("*");if(-1===l){if(o.length)throw Error(`uiSchema order list does not contain ${o.length>1?`properties '${o.join("', '")}'`:`property '${o[0]}'`}`);return i}if(l!==i.lastIndexOf("*"))throw Error("uiSchema order list contains more than one wildcard item");let a=[...i];return a.splice(l,1,...o),a}(e,P.order)}catch(e){return(0,v.jsxs)("div",{children:[(0,v.jsx)("p",{className:"config-error",style:{color:"red"},children:(0,v.jsx)(ch,{options:{disableParsingRawHTML:!0},children:C(uJ.InvalidObjectField,[h||"root",e.message])})}),(0,v.jsx)("pre",{children:JSON.stringify(O)})]})}let $=oV("ObjectFieldTemplate",b,P),D={title:!1===P.label?"":T,description:!1===P.label?void 0:I,properties:i.map(e=>{let t=sR()(O,[su,e,st]),r=t?o.additionalProperties:o[e],n="hidden"===sv(r).widget,i=sE()(c,[e],{});return{content:(0,v.jsx)(j,{name:e,required:this.isRequired(e),schema:sE()(O,[su,e],{}),uiSchema:r,errorSchema:sE()(a,e),idSchema:i,idPrefix:m,idSeparator:g,formData:sE()(l,e),formContext:A,wasPropertyKeyModified:this.state.wasPropertyKeyModified,onKeyChange:this.onKeyChange(e),onChange:this.onPropertyChange(e,t),onBlur:y,onFocus:x,registry:b,disabled:d,readonly:f,hideError:p,onDropPropertyClick:this.onDropPropertyClick},e),name:e,readonly:f,disabled:d,required:u,hidden:n}}),readonly:f,disabled:d,required:u,idSchema:c,uiSchema:o,errorSchema:a,schema:O,formData:l,formContext:A,registry:b};return(0,v.jsx)($,{...D,onAddClick:this.handleAddClick})}}let cp={array:"ArrayField",boolean:"BooleanField",integer:"NumberField",number:"NumberField",object:"ObjectField",string:"StringField",null:"NullField"};function cm(e){var t,r,n;let i,{schema:s,idSchema:o,uiSchema:l,formData:a,errorSchema:c,idPrefix:h,idSeparator:u,name:d,onChange:f,onKeyChange:p,onDropPropertyClick:m,required:g,registry:y,wasPropertyKeyModified:x=!1}=e,{formContext:b,schemaUtils:w,globalUiOptions:k}=y,A=sv(l,k),S=oV("FieldTemplate",y,A),C=oV("DescriptionFieldTemplate",y,A),E=oV("FieldHelpTemplate",y,A),j=oV("FieldErrorTemplate",y,A),O=w.retrieveSchema(s,a),P=o.$id,M=op(w.toIdSchema(O,P,a,h,u),o),T=(0,tZ.useCallback)((e,t,r)=>f(e,t,r||P),[P,f]),I=function(e,t,r,n){let i=t.field,{fields:s,translateString:o}=n;if("function"==typeof i)return i;if("string"==typeof i&&i in s)return s[i];let l=or(e),a=Array.isArray(l)?l[0]:l||"",c=e.$id,h=cp[a];return(c&&c in s&&(h=c),!h&&(e.anyOf||e.oneOf))?()=>null:h in s?s[h]:()=>{let i=oV("UnsupportedFieldTemplate",n,t);return(0,v.jsx)(i,{schema:e,idSchema:r,reason:o(uJ.UnknownFieldType,[String(e.type)]),registry:n})}}(O,A,M,y),$=!!(null!=(t=A.disabled)?t:e.disabled),D=!!(null!=(r=A.readonly)?r:e.readonly||e.schema.readOnly||O.readOnly),R=A.hideError,N=void 0===R?e.hideError:!!R,L=!!(null!=(n=A.autofocus)?n:e.autofocus);if(0===Object.keys(O).length)return null;let F=w.getDisplayLabel(O,l,k),{__errors:_,...B}=c||{},z=sT()(l,["ui:classNames","classNames","ui:style"]);sy in z&&(z[sy]=sT()(z[sy],["classNames","style"]));let W=(0,v.jsx)(I,{...e,onChange:T,idSchema:M,schema:O,uiSchema:z,disabled:$,readonly:D,hideError:N,autofocus:L,errorSchema:B,formContext:b,rawErrors:_}),V=M.$id;i=x||st in O?d:A.title||e.schema.title||O.title||e.title||d;let H=A.description||e.schema.description||O.description||"",U=A.enableMarkdownInDescription?(0,v.jsx)(ch,{options:{disableParsingRawHTML:!0},children:H}):H,q=A.help,K="hidden"===A.widget,G=["form-group","field",`field-${or(O)}`];!N&&_&&_.length>0&&G.push("field-error has-error has-danger"),(null==l?void 0:l.classNames)&&G.push(l.classNames),A.classNames&&G.push(A.classNames);let J=(0,v.jsx)(E,{help:q,idSchema:M,schema:O,uiSchema:l,hasErrors:!N&&_&&_.length>0,registry:y}),Y=N||(O.anyOf||O.oneOf)&&!w.isSelect(O)?void 0:(0,v.jsx)(j,{errors:_,errorSchema:c,idSchema:M,schema:O,uiSchema:l,registry:y}),X={description:(0,v.jsx)(C,{id:oG(V),description:U,schema:O,uiSchema:l,registry:y}),rawDescription:H,help:J,rawHelp:"string"==typeof q?q:void 0,errors:Y,rawErrors:N?void 0:_,id:V,label:i,hidden:K,onChange:f,onKeyChange:p,onDropPropertyClick:m,required:g,disabled:$,readonly:D,hideError:N,displayLabel:F,classNames:G.join(" ").trim(),style:A.style,formContext:b,formData:a,schema:O,uiSchema:l,registry:y},Z=y.fields.AnyOfField,Q=y.fields.OneOfField,ee=(null==l?void 0:l["ui:field"])&&(null==l?void 0:l["ui:fieldReplacesAnyOrOneOf"])===!0;return(0,v.jsx)(S,{...X,children:(0,v.jsxs)(v.Fragment,{children:[W,O.anyOf&&!ee&&!w.isSelect(O)&&(0,v.jsx)(Z,{name:d,disabled:$,readonly:D,hideError:N,errorSchema:c,formData:a,formContext:b,idPrefix:h,idSchema:M,idSeparator:u,onBlur:e.onBlur,onChange:e.onChange,onFocus:e.onFocus,options:O.anyOf.map(e=>w.retrieveSchema(s_()(e)?e:{},a)),registry:y,required:g,schema:O,uiSchema:l}),O.oneOf&&!ee&&!w.isSelect(O)&&(0,v.jsx)(Q,{name:d,disabled:$,readonly:D,hideError:N,errorSchema:c,formData:a,formContext:b,idPrefix:h,idSchema:M,idSeparator:u,onBlur:e.onBlur,onChange:e.onChange,onFocus:e.onFocus,options:O.oneOf.map(e=>w.retrieveSchema(s_()(e)?e:{},a)),registry:y,required:g,schema:O,uiSchema:l})]})})}class cg extends tZ.Component{shouldComponentUpdate(e){return!sS(this.props,e)}render(){return(0,v.jsx)(cm,{...this.props})}}let cy=function(e){var t;let{schema:r,name:n,uiSchema:i,idSchema:s,formData:o,required:l,disabled:a=!1,readonly:c=!1,autofocus:h=!1,onChange:u,onBlur:d,onFocus:f,registry:p,rawErrors:m,hideError:g}=e,{title:y,format:x}=r,{widgets:b,formContext:w,schemaUtils:k,globalUiOptions:A}=p,S=k.isSelect(r)?o1(r,i):void 0,C=S?"select":"text";x&&function(e,t,r={}){try{return oq(e,t,r),!0}catch(e){if(e.message&&(e.message.startsWith("No widget")||e.message.startsWith("Unsupported widget")))return!1;throw e}}(r,x,b)&&(C=x);let{widget:E=C,placeholder:j="",title:O,...P}=sv(i),M=k.getDisplayLabel(r,i,A),T=null!=(t=null!=O?O:y)?t:n,I=oq(r,E,b);return(0,v.jsx)(I,{options:{...P,enumOptions:S},schema:r,uiSchema:i,id:s.$id,name:n,label:T,hideLabel:!M,hideError:g,value:o,onChange:u,onBlur:d,onFocus:f,required:l,disabled:a,readonly:c,formContext:w,autofocus:h,registry:p,placeholder:j,rawErrors:m})},cv=function(e){let{formData:t,onChange:r}=e;return(0,tZ.useEffect)(()=>{void 0===t&&r(null)},[t,r]),null};function cx(e){let{idSchema:t,description:r,registry:n,schema:i,uiSchema:s}=e,o=sv(s,n.globalUiOptions),{label:l=!0}=o;if(!r||!l)return null;let a=oV("DescriptionFieldTemplate",n,o);return(0,v.jsx)(a,{id:oG(t),description:r,schema:i,uiSchema:s,registry:n})}function cb(e){let{children:t,className:r,disabled:n,hasToolbar:i,hasMoveDown:s,hasMoveUp:o,hasRemove:l,hasCopy:a,index:c,onCopyIndexClick:h,onDropIndexClick:u,onReorderClick:d,readonly:f,registry:p,uiSchema:m}=e,{CopyButton:g,MoveDownButton:y,MoveUpButton:x,RemoveButton:b}=p.templates.ButtonTemplates,w={flex:1,paddingLeft:6,paddingRight:6,fontWeight:"bold"};return(0,v.jsxs)("div",{className:r,children:[(0,v.jsx)("div",{className:i?"col-xs-9":"col-xs-12",children:t}),i&&(0,v.jsx)("div",{className:"col-xs-3 array-item-toolbox",children:(0,v.jsxs)("div",{className:"btn-group",style:{display:"flex",justifyContent:"space-around"},children:[(o||s)&&(0,v.jsx)(x,{style:w,disabled:n||f||!o,onClick:d(c,c-1),uiSchema:m,registry:p}),(o||s)&&(0,v.jsx)(y,{style:w,disabled:n||f||!s,onClick:d(c,c+1),uiSchema:m,registry:p}),a&&(0,v.jsx)(g,{style:w,disabled:n||f,onClick:h(c),uiSchema:m,registry:p}),l&&(0,v.jsx)(b,{style:w,disabled:n||f,onClick:u(c),uiSchema:m,registry:p})]})})]})}function cw(e){let{canAdd:t,className:r,disabled:n,idSchema:i,uiSchema:s,items:o,onAddClick:l,readonly:a,registry:c,required:h,schema:u,title:d}=e,f=sv(s),p=oV("ArrayFieldDescriptionTemplate",c,f),m=oV("ArrayFieldItemTemplate",c,f),g=oV("ArrayFieldTitleTemplate",c,f),{ButtonTemplates:{AddButton:y}}=c.templates;return(0,v.jsxs)("fieldset",{className:r,id:i.$id,children:[(0,v.jsx)(g,{idSchema:i,title:f.title||d,required:h,schema:u,uiSchema:s,registry:c}),(0,v.jsx)(p,{idSchema:i,description:f.description||u.description,schema:u,uiSchema:s,registry:c}),(0,v.jsx)("div",{className:"row array-item-list",children:o&&o.map(({key:e,...t})=>(0,v.jsx)(m,{...t},e))}),t&&(0,v.jsx)(y,{className:"array-item-add",onClick:l,disabled:n||a,uiSchema:s,registry:c})]})}function ck(e){let{idSchema:t,title:r,schema:n,uiSchema:i,required:s,registry:o}=e,l=sv(i,o.globalUiOptions),{label:a=!0}=l;if(!r||!a)return null;let c=oV("TitleFieldTemplate",o,l);return(0,v.jsx)(c,{id:oZ(t),title:r,required:s,schema:n,uiSchema:i,registry:o})}function cA(e){let t,{id:r,name:n,value:i,readonly:s,disabled:o,autofocus:l,onBlur:a,onFocus:c,onChange:h,onChangeOverride:u,options:d,schema:f,uiSchema:p,formContext:m,registry:g,rawErrors:y,type:x,hideLabel:b,hideError:w,...k}=e;if(!r)throw console.log("No id for",e),Error(`no id for props ${JSON.stringify(e)}`);let A={...k,...oB(f,x,d)};t="number"===A.type||"integer"===A.type?i||0===i?i:"":null==i?"":i;let S=(0,tZ.useCallback)(({target:{value:e}})=>h(""===e?d.emptyValue:e),[h,d]),C=(0,tZ.useCallback)(({target:e})=>a(r,e&&e.value),[a,r]),E=(0,tZ.useCallback)(({target:e})=>c(r,e&&e.value),[c,r]);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("input",{id:r,name:r,className:"form-control",readOnly:s,disabled:o,autoFocus:l,value:t,...A,list:f.examples?oY(r):void 0,onChange:u||S,onBlur:C,onFocus:E,"aria-describedby":oQ(r,!!f.examples)}),Array.isArray(f.examples)&&(0,v.jsx)("datalist",{id:oY(r),children:f.examples.concat(f.default&&!f.examples.includes(f.default)?[f.default]:[]).map(e=>(0,v.jsx)("option",{value:e},e))},`datalist_${r}`)]})}function cS({uiSchema:e}){let{submitText:t,norender:r,props:n={}}=oW(e);return r?null:(0,v.jsx)("div",{children:(0,v.jsx)("button",{type:"submit",...n,className:`btn btn-info ${n.className||""}`,children:t})})}function cC(e){let{iconType:t="default",icon:r,className:n,uiSchema:i,registry:s,...o}=e;return(0,v.jsx)("button",{type:"button",className:`btn btn-${t} ${n}`,...o,children:(0,v.jsx)("i",{className:`glyphicon glyphicon-${r}`})})}function cE(e){let{registry:{translateString:t}}=e;return(0,v.jsx)(cC,{title:t(uJ.CopyButton),className:"array-item-copy",...e,icon:"copy"})}function cj(e){let{registry:{translateString:t}}=e;return(0,v.jsx)(cC,{title:t(uJ.MoveDownButton),className:"array-item-move-down",...e,icon:"arrow-down"})}function cO(e){let{registry:{translateString:t}}=e;return(0,v.jsx)(cC,{title:t(uJ.MoveUpButton),className:"array-item-move-up",...e,icon:"arrow-up"})}function cP(e){let{registry:{translateString:t}}=e;return(0,v.jsx)(cC,{title:t(uJ.RemoveButton),className:"array-item-remove",...e,iconType:"danger",icon:"remove"})}function cM({className:e,onClick:t,disabled:r,registry:n}){let{translateString:i}=n;return(0,v.jsx)("div",{className:"row",children:(0,v.jsx)("p",{className:`col-xs-3 col-xs-offset-9 text-right ${e}`,children:(0,v.jsx)(cC,{iconType:"info",icon:"plus",className:"btn-add col-xs-12",title:i(uJ.AddButton),onClick:t,disabled:r,registry:n})})})}function cT(e){let{id:t,description:r}=e;return r?"string"==typeof r?(0,v.jsx)("p",{id:t,className:"field-description",children:r}):(0,v.jsx)("div",{id:t,className:"field-description",children:r}):null}function cI({errors:e,registry:t}){let{translateString:r}=t;return(0,v.jsxs)("div",{className:"panel panel-danger errors",children:[(0,v.jsx)("div",{className:"panel-heading",children:(0,v.jsx)("h3",{className:"panel-title",children:r(uJ.ErrorsLabel)})}),(0,v.jsx)("ul",{className:"list-group",children:e.map((e,t)=>(0,v.jsx)("li",{className:"list-group-item text-danger",children:e.stack},t))})]})}function c$(e){let{label:t,required:r,id:n}=e;return t?(0,v.jsxs)("label",{className:"control-label",htmlFor:n,children:[t,r&&(0,v.jsx)("span",{className:"required",children:"*"})]}):null}let cD=function(e){let{id:t,label:r,children:n,errors:i,help:s,description:o,hidden:l,required:a,displayLabel:c,registry:h,uiSchema:u}=e,d=oV("WrapIfAdditionalTemplate",h,sv(u));return l?(0,v.jsx)("div",{className:"hidden",children:n}):(0,v.jsxs)(d,{...e,children:[c&&(0,v.jsx)(c$,{label:r,required:a,id:t}),c&&o?o:null,n,i,s]})};function cR(e){let{errors:t=[],idSchema:r}=e;if(0===t.length)return null;let n=oJ(r);return(0,v.jsx)("div",{children:(0,v.jsx)("ul",{id:n,className:"error-detail bs-callout bs-callout-info",children:t.filter(e=>!!e).map((e,t)=>(0,v.jsx)("li",{className:"text-danger",children:e},t))})})}function cN(e){let{idSchema:t,help:r}=e;if(!r)return null;let n=oX(t);return"string"==typeof r?(0,v.jsx)("p",{id:n,className:"help-block",children:r}):(0,v.jsx)("div",{id:n,className:"help-block",children:r})}function cL(e){let{description:t,disabled:r,formData:n,idSchema:i,onAddClick:s,properties:o,readonly:l,registry:a,required:c,schema:h,title:u,uiSchema:d}=e,f=sv(d),p=oV("TitleFieldTemplate",a,f),m=oV("DescriptionFieldTemplate",a,f),{ButtonTemplates:{AddButton:g}}=a.templates;return(0,v.jsxs)("fieldset",{id:i.$id,children:[u&&(0,v.jsx)(p,{id:oZ(i),title:u,required:c,schema:h,uiSchema:d,registry:a}),t&&(0,v.jsx)(m,{id:oG(i),description:t,schema:h,uiSchema:d,registry:a}),o.map(e=>e.content),sx(h,d,n)&&(0,v.jsx)(g,{className:"object-property-expand",onClick:s(h),disabled:r||l,uiSchema:d,registry:a})]})}function cF(e){let{id:t,title:r,required:n}=e;return(0,v.jsxs)("legend",{id:t,children:[r,n&&(0,v.jsx)("span",{className:"required",children:"*"})]})}let c_=function(e){let{schema:t,idSchema:r,reason:n,registry:i}=e,{translateString:s}=i,o=uJ.UnsupportedField,l=[];return r&&r.$id&&(o=uJ.UnsupportedFieldWithId,l.push(r.$id)),n&&(o=o===uJ.UnsupportedField?uJ.UnsupportedFieldWithReason:uJ.UnsupportedFieldWithIdAndReason,l.push(n)),(0,v.jsxs)("div",{className:"unsupported-field",children:[(0,v.jsx)("p",{children:(0,v.jsx)(ch,{options:{disableParsingRawHTML:!0},children:s(o,l)})}),t&&(0,v.jsx)("pre",{children:JSON.stringify(t,null,2)})]})};function cB(e){let{id:t,classNames:r,style:n,disabled:i,label:s,onKeyChange:o,onDropPropertyClick:l,readonly:a,required:c,schema:h,children:u,uiSchema:d,registry:f}=e,{templates:p,translateString:m}=f,{RemoveButton:g}=p.ButtonTemplates,y=m(uJ.KeyLabel,[s]);return st in h?(0,v.jsx)("div",{className:r,style:n,children:(0,v.jsxs)("div",{className:"row",children:[(0,v.jsx)("div",{className:"col-xs-5 form-additional",children:(0,v.jsxs)("div",{className:"form-group",children:[(0,v.jsx)(c$,{label:y,required:c,id:`${t}-key`}),(0,v.jsx)("input",{className:"form-control",type:"text",id:`${t}-key`,onBlur:({target:e})=>o(e&&e.value),defaultValue:s})]})}),(0,v.jsx)("div",{className:"form-additional form-group col-xs-5",children:u}),(0,v.jsx)("div",{className:"col-xs-2",children:(0,v.jsx)(g,{className:"array-item-remove btn-block",style:{border:"0"},disabled:i||a,onClick:l(s),uiSchema:d,registry:f})})]})}):(0,v.jsx)("div",{className:r,style:n,children:u})}function cz({type:e,range:t,value:r,select:n,rootId:i,name:s,disabled:o,readonly:l,autofocus:a,registry:c,onBlur:h,onFocus:u}){let d=i+"_"+e,{SelectWidget:f}=c.widgets;return(0,v.jsx)(f,{schema:{type:"integer"},id:d,name:s,className:"form-control",options:{enumOptions:function e(t,r){if(t<=0&&r<=0)t=new Date().getFullYear()+t,r=new Date().getFullYear()+r;else if(t<0||r<0)throw Error(`Both start (${t}) and stop (${r}) must both be <= 0 or > 0, got one of each`);if(t>r)return e(r,t).reverse();let n=[];for(let e=t;e<=r;e++)n.push({value:e,label:oj(e,2)});return n}(t[0],t[1])},placeholder:e,value:r,disabled:o,readonly:l,autofocus:a,onChange:t=>n(e,t),onBlur:h,onFocus:u,registry:c,label:"","aria-describedby":oQ(i)})}let cW=function({time:e=!1,disabled:t=!1,readonly:r=!1,autofocus:n=!1,options:i,id:s,name:o,registry:l,onBlur:a,onFocus:c,onChange:h,value:u}){let{translateString:d}=l,[f,p]=(0,tZ.useState)(u),[m,g]=(0,tZ.useReducer)((e,t)=>({...e,...t}),o2(u,e));(0,tZ.useEffect)(()=>{let t=o3(m,e);Object.values(m).every(e=>-1!==e)&&t!==u?h(t):f!==u&&(p(u),g(o2(u,e)))},[e,u,h,m,f]);let y=(0,tZ.useCallback)((e,t)=>{g({[e]:t})},[]),x=(0,tZ.useCallback)(n=>{n.preventDefault(),t||r||h(o3(o2(new Date().toJSON(),e),e))},[t,r,e]),b=(0,tZ.useCallback)(e=>{e.preventDefault(),t||r||h(void 0)},[t,r,h]);return(0,v.jsxs)("ul",{className:"list-inline",children:[(function(e,t,r=[1900,new Date().getFullYear()+2],n="YMD"){let{day:i,month:s,year:o,hour:l,minute:a,second:c}=e,h={type:"day",range:[1,31],value:i},u={type:"month",range:[1,12],value:s},d={type:"year",range:r,value:o},f=[];switch(n){case"MDY":f.push(u,h,d);break;case"DMY":f.push(h,u,d);break;default:f.push(d,u,h)}return t&&f.push({type:"hour",range:[0,23],value:l},{type:"minute",range:[0,59],value:a},{type:"second",range:[0,59],value:c}),f})(m,e,i.yearsRange,i.format).map((e,i)=>(0,v.jsx)("li",{className:"list-inline-item",children:(0,v.jsx)(cz,{rootId:s,name:o,select:y,...e,disabled:t,readonly:r,registry:l,onBlur:a,onFocus:c,autofocus:n&&0===i})},i)),("undefined"===i.hideNowButton||!i.hideNowButton)&&(0,v.jsx)("li",{className:"list-inline-item",children:(0,v.jsx)("a",{href:"#",className:"btn btn-info btn-now",onClick:x,children:d(uJ.NowLabel)})}),("undefined"===i.hideClearButton||!i.hideClearButton)&&(0,v.jsx)("li",{className:"list-inline-item",children:(0,v.jsx)("a",{href:"#",className:"btn btn-warning btn-clear",onClick:b,children:d(uJ.ClearLabel)})})]})},cV=function({time:e=!0,...t}){let{AltDateWidget:r}=t.registry.widgets;return(0,v.jsx)(r,{time:e,...t})},cH=function({schema:e,uiSchema:t,options:r,id:n,value:i,disabled:s,readonly:o,label:l,hideLabel:a,autofocus:c=!1,onBlur:h,onFocus:u,onChange:d,registry:f}){var p,m;let g=oV("DescriptionFieldTemplate",f,r),y=o4(e),x=(0,tZ.useCallback)(e=>d(e.target.checked),[d]),b=(0,tZ.useCallback)(e=>h(n,e.target.checked),[h,n]),w=(0,tZ.useCallback)(e=>u(n,e.target.checked),[u,n]),k=null!=(p=r.description)?p:e.description;return(0,v.jsxs)("div",{className:`checkbox ${s||o?"disabled":""}`,children:[!a&&!!k&&(0,v.jsx)(g,{id:oG(n),description:k,schema:e,uiSchema:t,registry:f}),(0,v.jsxs)("label",{children:[(0,v.jsx)("input",{type:"checkbox",id:n,name:n,checked:void 0!==i&&i,required:y,disabled:s||o,autoFocus:c,onChange:x,onBlur:b,onFocus:w,"aria-describedby":oQ(n)}),(m=(0,v.jsx)("span",{children:l}),a?void 0:m)]})]})},cU=function({id:e,disabled:t,options:{inline:r=!1,enumOptions:n,enumDisabled:i,emptyValue:s},value:o,autofocus:l=!1,readonly:a,onChange:c,onBlur:h,onFocus:u}){let d=Array.isArray(o)?o:[o],f=(0,tZ.useCallback)(({target:t})=>h(e,oP(t&&t.value,n,s)),[h,e]),p=(0,tZ.useCallback)(({target:t})=>u(e,oP(t&&t.value,n,s)),[u,e]);return(0,v.jsx)("div",{className:"checkboxes",id:e,children:Array.isArray(n)&&n.map((s,o)=>{let h=oT(s.value,d),u=Array.isArray(i)&&-1!==i.indexOf(s.value),m=t||u||a?"disabled":"",g=(0,v.jsxs)("span",{children:[(0,v.jsx)("input",{type:"checkbox",id:o0(e,o),name:e,checked:h,value:String(o),disabled:t||u||a,autoFocus:l&&0===o,onChange:e=>{e.target.checked?c(oR(o,d,n)):c(oM(o,d,n))},onBlur:f,onFocus:p,"aria-describedby":oQ(e)}),(0,v.jsx)("span",{children:s.label})]});return r?(0,v.jsx)("label",{className:`checkbox-inline ${m}`,children:g},o):(0,v.jsx)("div",{className:`checkbox ${m}`,children:(0,v.jsx)("label",{children:g})},o)})})};function cq(e){let{disabled:t,readonly:r,options:n,registry:i}=e,s=oV("BaseInputTemplate",i,n);return(0,v.jsx)(s,{type:"color",...e,disabled:t||r})}function cK(e){let{onChange:t,options:r,registry:n}=e,i=oV("BaseInputTemplate",n,r),s=(0,tZ.useCallback)(e=>t(e||void 0),[t]);return(0,v.jsx)(i,{type:"date",...e,onChange:s})}function cG(e){let{onChange:t,value:r,options:n,registry:i}=e,s=oV("BaseInputTemplate",i,n);return(0,v.jsx)(s,{type:"datetime-local",...e,value:function(e){if(!e)return"";let t=new Date(e),r=oj(t.getFullYear(),4),n=oj(t.getMonth()+1,2),i=oj(t.getDate(),2),s=oj(t.getHours(),2),o=oj(t.getMinutes(),2),l=oj(t.getSeconds(),2),a=oj(t.getMilliseconds(),3);return`${r}-${n}-${i}T${s}:${o}:${l}.${a}`}(r),onChange:e=>t(e?new Date(e).toJSON():void 0)})}function cJ(e){let{options:t,registry:r}=e,n=oV("BaseInputTemplate",r,t);return(0,v.jsx)(n,{type:"email",...e})}function cY(e){let{name:t,size:r,type:n}=e;return new Promise((i,s)=>{let o=new window.FileReader;o.onerror=s,o.onload=e=>{var s,o;"string"==typeof(null==(s=e.target)?void 0:s.result)?i({dataURL:(o=e.target.result,null===o?null:o.replace(";base64",`;name=${encodeURIComponent(t)};base64`)),name:t,size:r,type:n}):i({dataURL:null,name:t,size:r,type:n})},o.readAsDataURL(e)})}function cX({fileInfo:e,registry:t}){let{translateString:r}=t,{dataURL:n,type:i,name:s}=e;return n?["image/jpeg","image/png"].includes(i)?(0,v.jsx)("img",{src:n,style:{maxWidth:"100%"},className:"file-preview"}):(0,v.jsxs)(v.Fragment,{children:[" ",(0,v.jsx)("a",{download:`preview-${s}`,href:n,className:"file-download",children:r(uJ.PreviewLabel)})]}):null}function cZ({filesInfo:e,registry:t,preview:r,onRemove:n,options:i}){if(0===e.length)return null;let{translateString:s}=t,{RemoveButton:o}=oV("ButtonTemplates",t,i);return(0,v.jsx)("ul",{className:"file-info",children:e.map((e,i)=>{let{name:l,size:a,type:c}=e;return(0,v.jsxs)("li",{children:[(0,v.jsx)(ch,{children:s(uJ.FilesInfo,[l,c,String(a)])}),r&&(0,v.jsx)(cX,{fileInfo:e,registry:t}),(0,v.jsx)(o,{onClick:()=>n(i),registry:t})]},i)})})}let cQ=function(e){let{disabled:t,readonly:r,required:n,multiple:i,onChange:s,value:o,options:l,registry:a}=e,c=oV("BaseInputTemplate",a,l),h=(0,tZ.useCallback)(e=>{e.target.files&&Promise.all(Array.from(e.target.files).map(cY)).then(e=>{let t=e.map(e=>e.dataURL);i?s(o.concat(t)):s(t[0])})},[i,o,s]),u=(0,tZ.useMemo)(()=>(Array.isArray(o)?o:[o]).reduce((e,t)=>{if(!t)return e;try{let{blob:r,name:n}=function(e){var t;if(-1===e.indexOf("data:"))throw Error("File is invalid: URI must be a dataURI");let r=e.slice(5).split(";base64,");if(2!==r.length)throw Error("File is invalid: dataURI must be base64");let[n,i]=r,[s,...o]=n.split(";"),l=decodeURI((null==(t=o.map(e=>e.split("=")).find(([e])=>"name"===e))?void 0:t[1])||"unknown");try{let e=atob(i),t=Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return{blob:new window.Blob([new Uint8Array(t)],{type:s||""}),name:l}}catch(e){throw Error("File is invalid: "+e.message)}}(t);return[...e,{dataURL:t,name:n,size:r.size,type:r.type}]}catch(t){return e}},[]),[o]),d=(0,tZ.useCallback)(e=>{i?s(o.filter((t,r)=>r!==e)):s(void 0)},[i,o,s]);return(0,v.jsxs)("div",{children:[(0,v.jsx)(c,{...e,disabled:t||r,type:"file",required:!o&&n,onChangeOverride:h,value:"",accept:l.accept?String(l.accept):void 0}),(0,v.jsx)(cZ,{filesInfo:u,onRemove:d,registry:a,preview:l.filePreview,options:l})]})},c0=function({id:e,value:t}){return(0,v.jsx)("input",{type:"hidden",id:e,name:e,value:void 0===t?"":t})};function c1(e){let{options:t,registry:r}=e,n=oV("BaseInputTemplate",r,t);return(0,v.jsx)(n,{type:"password",...e})}let c2=function({options:e,value:t,required:r,disabled:n,readonly:i,autofocus:s=!1,onBlur:o,onFocus:l,onChange:a,id:c}){let{enumOptions:h,enumDisabled:u,inline:d,emptyValue:f}=e,p=(0,tZ.useCallback)(({target:e})=>o(c,oP(e&&e.value,h,f)),[o,c]),m=(0,tZ.useCallback)(({target:e})=>l(c,oP(e&&e.value,h,f)),[l,c]);return(0,v.jsx)("div",{className:"field-radio-group",id:c,children:Array.isArray(h)&&h.map((e,o)=>{let l=oT(e.value,t),h=Array.isArray(u)&&-1!==u.indexOf(e.value),f=n||h||i?"disabled":"",g=(0,v.jsxs)("span",{children:[(0,v.jsx)("input",{type:"radio",id:o0(c,o),checked:l,name:c,required:r,value:String(o),disabled:n||h||i,autoFocus:s&&0===o,onChange:()=>a(e.value),onBlur:p,onFocus:m,"aria-describedby":oQ(c)}),(0,v.jsx)("span",{children:e.label})]});return d?(0,v.jsx)("label",{className:`radio-inline ${f}`,children:g},o):(0,v.jsx)("div",{className:`radio ${f}`,children:(0,v.jsx)("label",{children:g})},o)})})};function c4(e){let{value:t,registry:{templates:{BaseInputTemplate:r}}}=e;return(0,v.jsxs)("div",{className:"field-range-wrapper",children:[(0,v.jsx)(r,{type:"range",...e}),(0,v.jsx)("span",{className:"range-view",children:t})]})}function c3(e,t){return t?Array.from(e.target.options).slice().filter(e=>e.selected).map(e=>e.value):e.target.value}let c5=function({schema:e,id:t,options:r,value:n,required:i,disabled:s,readonly:o,multiple:l=!1,autofocus:a=!1,onChange:c,onBlur:h,onFocus:u,placeholder:d}){let{enumOptions:f,enumDisabled:p,emptyValue:m}=r,g=l?[]:"",y=(0,tZ.useCallback)(e=>u(t,oP(c3(e,l),f,m)),[u,t,e,l,f,m]),x=(0,tZ.useCallback)(e=>h(t,oP(c3(e,l),f,m)),[h,t,e,l,f,m]),b=(0,tZ.useCallback)(e=>c(oP(c3(e,l),f,m)),[c,e,l,f,m]),w=oI(n,f,l),k=!l&&void 0===e.default;return(0,v.jsxs)("select",{id:t,name:t,multiple:l,className:"form-control",value:void 0===w?g:w,required:i,disabled:s||o,autoFocus:a,onBlur:x,onFocus:y,onChange:b,"aria-describedby":oQ(t),children:[k&&(0,v.jsx)("option",{value:"",children:d}),Array.isArray(f)&&f.map(({value:e,label:t},r)=>{let n=p&&-1!==p.indexOf(e);return(0,v.jsx)("option",{value:String(r),disabled:n,children:t},r)})]})};function c6({id:e,options:t={},placeholder:r,value:n,required:i,disabled:s,readonly:o,autofocus:l=!1,onChange:a,onBlur:c,onFocus:h}){let u=(0,tZ.useCallback)(({target:{value:e}})=>a(""===e?t.emptyValue:e),[a,t.emptyValue]),d=(0,tZ.useCallback)(({target:t})=>c(e,t&&t.value),[c,e]),f=(0,tZ.useCallback)(({target:t})=>h(e,t&&t.value),[e,h]);return(0,v.jsx)("textarea",{id:e,name:e,className:"form-control",value:n||"",placeholder:r,required:i,disabled:s,readOnly:o,autoFocus:l,rows:t.rows,onBlur:d,onFocus:f,onChange:u,"aria-describedby":oQ(e)})}function c9(e){let{options:t,registry:r}=e,n=oV("BaseInputTemplate",r,t);return(0,v.jsx)(n,{...e})}function c8(e){let{onChange:t,options:r,registry:n}=e,i=oV("BaseInputTemplate",n,r),s=(0,tZ.useCallback)(e=>t(e?`${e}:00`:void 0),[t]);return(0,v.jsx)(i,{type:"time",...e,onChange:s})}function c7(e){let{options:t,registry:r}=e,n=oV("BaseInputTemplate",r,t);return(0,v.jsx)(n,{type:"url",...e})}function he(e){let{options:t,registry:r}=e,n=oV("BaseInputTemplate",r,t);return(0,v.jsx)(n,{type:"number",...e})}c6.defaultProps={autofocus:!1,options:{}};class ht extends tZ.Component{constructor(e){if(super(e),this.getUsedFormData=(e,t)=>{if(0===t.length&&"object"!=typeof e)return e;let r=lM()(e,t);return Array.isArray(e)?Object.keys(r).map(e=>r[e]):r},this.getFieldNames=(e,t)=>{let r=(e,n=[],i=[[]])=>(Object.keys(e).forEach(s=>{if("object"==typeof e[s]){let t=i.map(e=>[...e,s]);e[s][sp]&&""!==e[s][sc]?n.push(e[s][sc]):r(e[s],n,t)}else s===sc&&""!==e[s]&&i.forEach(e=>{let r=sE()(t,e);("object"!=typeof r||sO()(r)||Array.isArray(r)&&r.every(e=>"object"!=typeof e))&&n.push(e)})}),n);return r(e)},this.omitExtraData=e=>{let{schema:t,schemaUtils:r}=this.state,n=r.retrieveSchema(t,e),i=r.toPathSchema(n,"",e),s=this.getFieldNames(i,e);return this.getUsedFormData(e,s)},this.onChange=(e,t,r)=>{let{extraErrors:n,omitExtraData:i,liveOmit:s,noValidate:o,liveValidate:l,onChange:a}=this.props,{schemaUtils:c,schema:h,retrievedSchema:u}=this.state;(i7(e)||Array.isArray(e))&&(e=this.getStateFromProps(this.props,e,u).formData);let d={formData:e,schema:h},f=e;if(!0===i&&!0===s&&(d={formData:f=this.omitExtraData(e)}),!o&&l){let e=this.validate(f,h,c,u),r=e.errors,i=e.errorSchema,s=r,o=i;if(n){let t=o8(e,n);i=t.errorSchema,r=t.errors}t&&(i=op(i,this.filterErrorsBasedOnSchema(t,u,f),"preventDuplicates")),d={formData:f,errors:r,errorSchema:i,schemaValidationErrors:s,schemaValidationErrorSchema:o}}else if(!o&&t){let e=n?op(t,n,"preventDuplicates"):t;d={formData:f,errorSchema:e,errors:o5(e)}}this.setState(d,()=>a&&a({...this.state,...d},r))},this.reset=()=>{let{onChange:e}=this.props,t={formData:this.getStateFromProps(this.props,void 0).formData,errorSchema:{},errors:[],schemaValidationErrors:[],schemaValidationErrorSchema:{}};this.setState(t,()=>e&&e({...this.state,...t}))},this.onBlur=(e,t)=>{let{onBlur:r}=this.props;r&&r(e,t)},this.onFocus=(e,t)=>{let{onFocus:r}=this.props;r&&r(e,t)},this.onSubmit=e=>{if(e.preventDefault(),e.target!==e.currentTarget)return;e.persist();let{omitExtraData:t,extraErrors:r,noValidate:n,onSubmit:i}=this.props,{formData:s}=this.state;if(!0===t&&(s=this.omitExtraData(s)),n||this.validateFormWithFormData(s)){let t=r||{},n=r?o5(r):[];this.setState({formData:s,errors:n,errorSchema:t,schemaValidationErrors:[],schemaValidationErrorSchema:{}},()=>{i&&i({...this.state,formData:s,status:"submitted"},e)})}},this.submit=()=>{if(this.formElement.current){let e=new CustomEvent("submit",{cancelable:!0});e.preventDefault(),this.formElement.current.dispatchEvent(e),this.formElement.current.requestSubmit()}},this.validateFormWithFormData=e=>{let{extraErrors:t,extraErrorsBlockSubmit:r,focusOnFirstError:n,onError:i}=this.props,{errors:s}=this.state,o=this.validate(e),l=o.errors,a=o.errorSchema,c=l,h=a,u=l.length>0||t&&r;if(u){if(t){let e=o8(o,t);a=e.errorSchema,l=e.errors}n&&("function"==typeof n?n(l[0]):this.focusOnError(l[0])),this.setState({errors:l,errorSchema:a,schemaValidationErrors:c,schemaValidationErrorSchema:h},()=>{i?i(l):console.error("Form validation failed",l)})}else s.length>0&&this.setState({errors:[],errorSchema:{},schemaValidationErrors:[],schemaValidationErrorSchema:{}});return!u},!e.validator)throw Error("A validator is required for Form functionality to work");this.state=this.getStateFromProps(e,e.formData),this.props.onChange&&!sS(this.state.formData,this.props.formData)&&this.props.onChange(this.state),this.formElement=(0,tZ.createRef)()}getSnapshotBeforeUpdate(e,t){if(!sS(this.props,e)){let r=!sS(e.schema,this.props.schema),n=!sS(e.formData,this.props.formData),i=this.getStateFromProps(this.props,this.props.formData,r||n?void 0:this.state.retrievedSchema,r),s=!sS(i,t);return{nextState:i,shouldUpdate:s}}return{shouldUpdate:!1}}componentDidUpdate(e,t,r){if(r.shouldUpdate){let{nextState:e}=r;sS(e.formData,this.props.formData)||sS(e.formData,t.formData)||!this.props.onChange||this.props.onChange(e),this.setState(e)}}getStateFromProps(e,t,r,n=!1){var i;let s,o,l=this.state||{},a="schema"in e?e.schema:this.props.schema,c=("uiSchema"in e?e.uiSchema:this.props.uiSchema)||{},h=void 0!==t,u="liveValidate"in e?e.liveValidate:this.props.liveValidate,d=h&&!e.noValidate&&u,f="experimental_defaultFormStateBehavior"in e?e.experimental_defaultFormStateBehavior:this.props.experimental_defaultFormStateBehavior,p="experimental_customMergeAllOf"in e?e.experimental_customMergeAllOf:this.props.experimental_customMergeAllOf,m=l.schemaUtils;(!m||m.doesSchemaUtilsDiffer(e.validator,a,f,p))&&(m=function(e,t,r={},n){return new oE(e,t,r,n)}(e.validator,a,f,p));let g=m.getDefaultFormState(a,t),y=null!=r?r:m.retrieveSchema(a,g),v=l.schemaValidationErrors,x=l.schemaValidationErrorSchema;if(d){let e=this.validate(g,a,m,y);s=e.errors,o=void 0===r?e.errorSchema:op(null==(i=this.state)?void 0:i.errorSchema,e.errorSchema,"preventDuplicates"),v=s,x=o}else{let t=e.noValidate||n?{errors:[],errorSchema:{}}:e.liveValidate?{errors:l.errors||[],errorSchema:l.errorSchema||{}}:{errors:l.schemaValidationErrors||[],errorSchema:l.schemaValidationErrorSchema||{}};s=t.errors,o=t.errorSchema}if(e.extraErrors){let t=o8({errorSchema:o,errors:s},e.extraErrors);o=t.errorSchema,s=t.errors}let b=m.toIdSchema(y,c["ui:rootFieldId"],g,e.idPrefix,e.idSeparator);return{schemaUtils:m,schema:a,uiSchema:c,idSchema:b,formData:g,edit:h,errors:s,errorSchema:o,schemaValidationErrors:v,schemaValidationErrorSchema:x,retrievedSchema:y}}shouldComponentUpdate(e,t){return function(e,t,r){let{props:n,state:i}=e;return!sS(n,t)||!sS(i,r)}(this,e,t)}validate(e,t=this.props.schema,r,n){let i=r||this.state.schemaUtils,{customValidate:s,transformErrors:o,uiSchema:l}=this.props,a=null!=n?n:i.retrieveSchema(t,e);return i.getValidator().validateFormData(e,a,s,o,l)}renderErrors(e){let{errors:t,errorSchema:r,schema:n,uiSchema:i}=this.state,{formContext:s}=this.props,o=oV("ErrorListTemplate",e,sv(i));return t&&t.length?(0,v.jsx)(o,{errors:t,errorSchema:r||{},schema:n,uiSchema:i,formContext:s,registry:e}):null}filterErrorsBasedOnSchema(e,t,r){let{retrievedSchema:n,schemaUtils:i}=this.state,s=null!=t?t:n,o=i.toPathSchema(s,"",r),l=this.getFieldNames(o,r),a=lM()(e,l);(null==t?void 0:t.type)!=="object"&&(null==t?void 0:t.type)!=="array"&&(a.__errors=e.__errors);let c=e=>(le()(e,(t,r)=>{oD()(t)?delete e[r]:"object"!=typeof t||Array.isArray(t.__errors)||c(t)}),e);return c(a)}getRegistry(){var e;let{translateString:t,uiSchema:r={}}=this.props,{schemaUtils:n}=this.state,{fields:i,templates:s,widgets:o,formContext:l,translateString:a}={fields:{AnyOfField:lN,ArrayField:lD,BooleanField:lR,NumberField:l_,ObjectField:cf,OneOfField:lN,SchemaField:cg,StringField:cy,NullField:cv},templates:{ArrayFieldDescriptionTemplate:cx,ArrayFieldItemTemplate:cb,ArrayFieldTemplate:cw,ArrayFieldTitleTemplate:ck,ButtonTemplates:{SubmitButton:cS,AddButton:cM,CopyButton:cE,MoveDownButton:cj,MoveUpButton:cO,RemoveButton:cP},BaseInputTemplate:cA,DescriptionFieldTemplate:cT,ErrorListTemplate:cI,FieldTemplate:cD,FieldErrorTemplate:cR,FieldHelpTemplate:cN,ObjectFieldTemplate:cL,TitleFieldTemplate:cF,UnsupportedFieldTemplate:c_,WrapIfAdditionalTemplate:cB},widgets:{AltDateWidget:cW,AltDateTimeWidget:cV,CheckboxWidget:cH,CheckboxesWidget:cU,ColorWidget:cq,DateWidget:cK,DateTimeWidget:cG,EmailWidget:cJ,FileWidget:cQ,HiddenWidget:c0,PasswordWidget:c1,RadioWidget:c2,RangeWidget:c4,SelectWidget:c5,TextWidget:c9,TextareaWidget:c6,TimeWidget:c8,UpDownWidget:he,URLWidget:c7},rootSchema:{},formContext:{},translateString:oO};return{fields:{...i,...this.props.fields},templates:{...s,...this.props.templates,ButtonTemplates:{...s.ButtonTemplates,...null==(e=this.props.templates)?void 0:e.ButtonTemplates}},widgets:{...o,...this.props.widgets},rootSchema:this.props.schema,formContext:this.props.formContext||l,schemaUtils:n,translateString:t||a,globalUiOptions:r["ui:globalOptions"]}}focusOnError(e){let{idPrefix:t="root",idSeparator:r="_"}=this.props,{property:n}=e,i=o9()(n);""===i[0]?i[0]=t:i.unshift(t);let s=i.join(r),o=this.formElement.current.elements[s];o||(o=this.formElement.current.querySelector(`input[id^="${s}"`)),o&&o.length&&(o=o[0]),o&&o.focus()}validateForm(){let{omitExtraData:e}=this.props,{formData:t}=this.state;return!0===e&&(t=this.omitExtraData(t)),this.validateFormWithFormData(t)}render(){let{children:e,id:t,idPrefix:r,idSeparator:n,className:i="",tagName:s,name:o,method:l,target:a,action:c,autoComplete:h,enctype:u,acceptcharset:d,acceptCharset:f,noHtml5Validate:p=!1,disabled:m,readonly:g,formContext:y,showErrorList:x="top",_internalFormWrapper:b}=this.props,{schema:w,uiSchema:k,formData:A,errorSchema:S,idSchema:C}=this.state,E=this.getRegistry(),{SchemaField:j}=E.fields,{SubmitButton:O}=E.templates.ButtonTemplates,P=b?s:void 0,M=b||s||"form",{[sd]:T={}}=sv(k);m&&(T={...T,props:{...T.props,disabled:!0}});let I={[sy]:{[sd]:T}};return(0,v.jsxs)(M,{className:i||"rjsf",id:t,name:o,method:l,target:a,action:c,autoComplete:h,encType:u,acceptCharset:f||d,noValidate:p,onSubmit:this.onSubmit,as:P,ref:this.formElement,children:["top"===x&&this.renderErrors(E),(0,v.jsx)(j,{name:"",schema:w,uiSchema:k,errorSchema:S,idSchema:C,idPrefix:r,idSeparator:n,formContext:y,formData:A,onChange:this.onChange,onBlur:this.onBlur,onFocus:this.onFocus,registry:E,disabled:m,readonly:g}),e||(0,v.jsx)(O,{uiSchema:I,registry:E}),"bottom"===x&&this.renderErrors(E)]})}}function hr(e){return(0,tZ.forwardRef)(({fields:t,widgets:r,templates:n,...i},s)=>{var o;return t={...null==e?void 0:e.fields,...t},r={...null==e?void 0:e.widgets,...r},n={...null==e?void 0:e.templates,...n,ButtonTemplates:{...null==(o=null==e?void 0:e.templates)?void 0:o.ButtonTemplates,...null==n?void 0:n.ButtonTemplates}},(0,v.jsx)(ht,{...e,...i,fields:t,widgets:r,templates:n,ref:s})})}let hn=e=>{let{id:t,children:r,classNames:n,style:i,disabled:s,displayLabel:o,hidden:l,label:a,onDropPropertyClick:c,onKeyChange:h,readonly:u,required:d,rawErrors:f=[],errors:p,help:m,rawDescription:g,schema:y,uiSchema:x,registry:b}=e,w=oV("WrapIfAdditionalTemplate",b,sv(x));return l?(0,v.jsx)("div",{style:{display:"none"},children:r}):(0,v.jsx)(w,{classNames:n,style:i,disabled:s,id:t,label:a,onDropPropertyClick:c,onKeyChange:h,readonly:u,required:d,schema:y,uiSchema:x,registry:b,children:(0,v.jsx)(rl.g,{displayLabel:o,rawErrors:f,help:m,disabled:s,rawDescription:g,errors:p,required:d,children:r})})},hi=(0,rM.A)(e=>({markdownDescription:{fontSize:e.typography.caption.fontSize,margin:0,color:e.palette.text.secondary,"& :first-child":{margin:0,marginTop:"3px"}}})),hs=e=>{let{id:t,description:r}=e,n=hi();return r?"string"==typeof r?(0,v.jsx)(rz.h,{content:r,linkTarget:"_blank",className:n.markdownDescription}):(0,v.jsx)(rP.A,{id:t,variant:"subtitle2",style:{marginTop:"5px"},children:r}):null};var ho=r(18466);function hl({uiSchema:e,registry:t,...r}){let{translateString:n}=t;return(0,v.jsx)(rq.A,{title:n(uJ.AddItemButton),...r,color:"primary",children:(0,v.jsx)(ho.default,{})})}function ha(e){let{children:t,disabled:r,hasToolbar:n,hasCopy:i,hasMoveDown:s,hasMoveUp:o,hasRemove:l,index:a,onCopyIndexClick:c,onDropIndexClick:h,onReorderClick:u,readonly:d,uiSchema:f,registry:p}=e,{CopyButton:m,MoveDownButton:g,MoveUpButton:y,RemoveButton:x}=p.templates.ButtonTemplates,b={flex:1,paddingLeft:6,paddingRight:6,fontWeight:"bold",minWidth:0};return(0,v.jsxs)(nM.A,{container:!0,alignItems:"center",children:[(0,v.jsx)(nM.A,{item:!0,xs:!0,style:{overflow:"auto"},children:(0,v.jsx)(rO.A,{mb:2,children:(0,v.jsx)(ni.A,{elevation:2,children:(0,v.jsx)(rO.A,{p:2,children:t})})})}),n&&(0,v.jsxs)(nM.A,{item:!0,children:[(o||s)&&(0,v.jsx)(y,{style:b,disabled:r||d||!o,onClick:u(a,a-1),uiSchema:f,registry:p}),(o||s)&&(0,v.jsx)(g,{style:b,disabled:r||d||!s,onClick:u(a,a+1),uiSchema:f,registry:p}),i&&(0,v.jsx)(m,{style:b,disabled:r||d,onClick:c(a),uiSchema:f,registry:p}),l&&(0,v.jsx)(x,{style:b,disabled:r||d,onClick:h(a),uiSchema:f,registry:p})]})]})}function hc(e){let{canAdd:t,disabled:r,idSchema:n,uiSchema:i,items:s,onAddClick:o,readonly:l,registry:a,required:c,schema:h,title:u}=e,d=sv(i),f=oV("ArrayFieldDescriptionTemplate",a,d),p=oV("ArrayFieldItemTemplate",a,d),m=oV("ArrayFieldTitleTemplate",a,d),{ButtonTemplates:{AddButton:g}}=a.templates;return(0,v.jsx)(ni.A,{elevation:2,children:(0,v.jsxs)(rO.A,{p:2,children:[(0,v.jsx)(m,{idSchema:n,title:d.title||u,schema:h,uiSchema:i,required:c,registry:a}),(0,v.jsx)(f,{idSchema:n,description:d.description||h.description,schema:h,uiSchema:i,registry:a}),s&&s.map(({key:e,...t})=>(0,v.jsx)(p,{...t},e)),t&&(0,v.jsx)(nM.A,{container:!0,justifyContent:"flex-end",children:(0,v.jsx)(nM.A,{item:!0,children:(0,v.jsx)(rO.A,{mt:2,children:(0,v.jsx)(g,{className:"array-item-add",onClick:o,disabled:r||l,uiSchema:i,registry:a})})})})]})})}let hh=["date","datetime-local","file","time"];function hu(e){var t;let{id:r,name:n,placeholder:i,required:s,readonly:o,disabled:l,type:a,label:c,hideLabel:h,hideError:u,value:d,onChange:f,onChangeOverride:p,onBlur:m,onFocus:g,autofocus:y,options:x,schema:b,uiSchema:w,rawErrors:k=[],formContext:A,registry:S,InputLabelProps:C,...E}=e,{step:j,min:O,max:P,...M}=oB(b,a,x),T={inputProps:{step:j,min:O,max:P,...b.examples?{list:oY(r)}:void 0},...M},I=hh.includes(a)?{...C,shrink:!0}:C;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(ra.A,{id:r,name:r,placeholder:i,label:(t=c||void 0,!h&&t),autoFocus:y,required:s,disabled:l||o,...T,value:d||0===d?d:"",error:k.length>0,onChange:p||(({target:{value:e}})=>f(""===e?x.emptyValue:e)),onBlur:({target:e})=>m(r,e&&e.value),onFocus:({target:e})=>g(r,e&&e.value),InputLabelProps:I,...E,"aria-describedby":oQ(r,!!b.examples)}),Array.isArray(b.examples)&&(0,v.jsx)("datalist",{id:oY(r),children:b.examples.concat(b.default&&!b.examples.includes(b.default)?[b.default]:[]).map(e=>(0,v.jsx)("option",{value:e},e))})]})}function hd(e){let{id:t,description:r}=e;return r?(0,v.jsx)(rP.A,{id:t,variant:"subtitle2",style:{marginTop:"5px"},children:r}):null}var hf=r(7147);function hp({errors:e,registry:t}){let{translateString:r}=t;return(0,v.jsx)(ni.A,{elevation:2,children:(0,v.jsxs)(rO.A,{mb:2,p:2,children:[(0,v.jsx)(rP.A,{variant:"h6",children:r(uJ.ErrorsLabel)}),(0,v.jsx)(nr.A,{dense:!0,children:e.map((e,t)=>(0,v.jsxs)(nn.A,{children:[(0,v.jsx)(rK.A,{children:(0,v.jsx)(hf.default,{color:"error"})}),(0,v.jsx)(rG.A,{primary:e.stack})]},t))})]})})}var hm=r(89019),hg=r(68594),hy=r(99594),hv=r(80113);function hx(e){let{icon:t,color:r,uiSchema:n,registry:i,...s}=e;return(0,v.jsx)(rq.A,{...s,size:"small",color:r,children:t})}function hb(e){let{registry:{translateString:t}}=e;return(0,v.jsx)(hx,{title:t(uJ.CopyButton),...e,icon:(0,v.jsx)(hy.default,{fontSize:"small"})})}function hw(e){let{registry:{translateString:t}}=e;return(0,v.jsx)(hx,{title:t(uJ.MoveDownButton),...e,icon:(0,v.jsx)(hg.default,{fontSize:"small"})})}function hk(e){let{registry:{translateString:t}}=e;return(0,v.jsx)(hx,{title:t(uJ.MoveUpButton),...e,icon:(0,v.jsx)(hm.default,{fontSize:"small"})})}function hA(e){let{iconType:t,...r}=e,{registry:{translateString:n}}=r;return(0,v.jsx)(hx,{title:n(uJ.RemoveButton),...r,color:"secondary",icon:(0,v.jsx)(hv.default,{fontSize:"default"===t?"medium":"small"})})}var hS=r(51253);function hC(e){let{errors:t=[],idSchema:r}=e;if(0===t.length)return null;let n=oJ(r);return(0,v.jsx)(nr.A,{dense:!0,disablePadding:!0,children:t.map((e,t)=>(0,v.jsx)(nn.A,{disableGutters:!0,children:(0,v.jsx)(hS.A,{id:n,children:e})},t))})}function hE(e){let{idSchema:t,help:r}=e;if(!r)return null;let n=oX(t);return(0,v.jsx)(hS.A,{id:n,children:r})}var hj=r(95061);function hO(e){let{id:t,children:r,classNames:n,style:i,disabled:s,displayLabel:o,hidden:l,label:a,onDropPropertyClick:c,onKeyChange:h,readonly:u,required:d,rawErrors:f=[],errors:p,help:m,description:g,rawDescription:y,schema:x,uiSchema:b,registry:w}=e,k=oV("WrapIfAdditionalTemplate",w,sv(b));return l?(0,v.jsx)("div",{style:{display:"none"},children:r}):(0,v.jsx)(k,{classNames:n,style:i,disabled:s,id:t,label:a,onDropPropertyClick:c,onKeyChange:h,readonly:u,required:d,schema:x,uiSchema:b,registry:w,children:(0,v.jsxs)(hj.A,{fullWidth:!0,error:!!f.length,required:d,children:[r,o&&y?(0,v.jsx)(rP.A,{variant:"caption",color:"textSecondary",children:g}):null,p,m]})})}function hP(e){let{description:t,title:r,properties:n,required:i,disabled:s,readonly:o,uiSchema:l,idSchema:a,schema:c,formData:h,onAddClick:u,registry:d}=e,f=sv(l),p=oV("TitleFieldTemplate",d,f),m=oV("DescriptionFieldTemplate",d,f),{ButtonTemplates:{AddButton:g}}=d.templates;return(0,v.jsxs)(v.Fragment,{children:[r&&(0,v.jsx)(p,{id:oZ(a),title:r,required:i,schema:c,uiSchema:l,registry:d}),t&&(0,v.jsx)(m,{id:oG(a),description:t,schema:c,uiSchema:l,registry:d}),(0,v.jsxs)(nM.A,{container:!0,spacing:2,style:{marginTop:"10px"},children:[n.map((e,t)=>e.hidden?e.content:(0,v.jsx)(nM.A,{item:!0,xs:12,style:{marginBottom:"10px"},children:e.content},t)),sx(c,l,h)&&(0,v.jsx)(nM.A,{container:!0,justifyContent:"flex-end",children:(0,v.jsx)(nM.A,{item:!0,children:(0,v.jsx)(g,{className:"object-property-expand",onClick:u(c),disabled:s||o,uiSchema:l,registry:d})})})]})]})}function hM({uiSchema:e}){let{submitText:t,norender:r,props:n={}}=oW(e);return r?null:(0,v.jsx)(rO.A,{marginTop:3,children:(0,v.jsx)(iF.A,{type:"submit",variant:"contained",color:"primary",...n,children:t})})}function hT({id:e,title:t}){return(0,v.jsxs)(rO.A,{id:e,mb:1,mt:1,children:[(0,v.jsx)(rP.A,{variant:"h5",children:t}),(0,v.jsx)(iw.A,{})]})}function hI(e){let{children:t,classNames:r,style:n,disabled:i,id:s,label:o,onDropPropertyClick:l,onKeyChange:a,readonly:c,required:h,schema:u,uiSchema:d,registry:f}=e,{templates:p,translateString:m}=f,{RemoveButton:g}=p.ButtonTemplates,y=m(uJ.KeyLabel,[o]);return st in u?(0,v.jsxs)(nM.A,{container:!0,alignItems:"center",spacing:2,className:r,style:n,children:[(0,v.jsx)(nM.A,{item:!0,xs:!0,children:(0,v.jsx)(ra.A,{fullWidth:!0,required:h,label:y,defaultValue:o,disabled:i||c,id:`${s}-key`,name:`${s}-key`,onBlur:c?void 0:({target:e})=>a(e.value),type:"text"})}),(0,v.jsx)(nM.A,{item:!0,xs:!0,children:t}),(0,v.jsx)(nM.A,{item:!0,children:(0,v.jsx)(g,{iconType:"default",style:{flex:1,paddingLeft:6,paddingRight:6,fontWeight:"bold"},disabled:i||c,onClick:l(o),uiSchema:d,registry:f})})]},`${s}-key`):(0,v.jsx)("div",{className:r,style:n,children:t})}function h$(){return{ArrayFieldItemTemplate:ha,ArrayFieldTemplate:hc,BaseInputTemplate:hu,ButtonTemplates:{AddButton:hl,CopyButton:hb,MoveDownButton:hw,MoveUpButton:hk,RemoveButton:hA,SubmitButton:hM},DescriptionFieldTemplate:hd,ErrorListTemplate:hp,FieldErrorTemplate:hC,FieldHelpTemplate:hE,FieldTemplate:hO,ObjectFieldTemplate:hP,TitleFieldTemplate:hT,WrapIfAdditionalTemplate:hI}}function hD(e){var t;let{schema:r,id:n,value:i,disabled:s,readonly:o,label:l="",hideLabel:a,autofocus:c,onChange:h,onBlur:u,onFocus:d,registry:f,options:p,uiSchema:m}=e,g=oV("DescriptionFieldTemplate",f,p),y=o4(r),x=null!=(t=p.description)?t:r.description;return(0,v.jsxs)(v.Fragment,{children:[!a&&!!x&&(0,v.jsx)(g,{id:oG(n),description:x,schema:r,uiSchema:m,registry:f}),(0,v.jsx)(ir.A,{control:(0,v.jsx)(it.A,{id:n,name:n,checked:void 0!==i&&!!i,required:y,disabled:s||o,autoFocus:c,onChange:(e,t)=>h(t),onBlur:({target:{value:e}})=>u(n,e),onFocus:({target:{value:e}})=>d(n,e),"aria-describedby":oQ(n)}),label:!a&&l})]})}h$();var hR=r(12981),hN=r(91761);function hL({label:e,hideLabel:t,id:r,disabled:n,options:i,value:s,autofocus:o,readonly:l,required:a,onChange:c,onBlur:h,onFocus:u}){var d;let{enumOptions:f,enumDisabled:p,inline:m,emptyValue:g}=i,y=Array.isArray(s)?s:[s],x=({target:{value:e}})=>h(r,oP(e,f,g)),b=({target:{value:e}})=>u(r,oP(e,f,g));return(0,v.jsxs)(v.Fragment,{children:[(d=(0,v.jsx)(hN.A,{required:a,htmlFor:r,children:e||void 0}),t?void 0:d),(0,v.jsx)(hR.A,{id:r,row:!!m,children:Array.isArray(f)&&f.map((e,t)=>{let i=oT(e.value,y),s=Array.isArray(p)&&-1!==p.indexOf(e.value),a=(0,v.jsx)(it.A,{id:o0(r,t),name:r,checked:i,disabled:n||s||l,autoFocus:o&&0===t,onChange:({target:{checked:e}})=>{e?c(oR(t,y,f)):c(oM(t,y,f))},onBlur:x,onFocus:b,"aria-describedby":oQ(r)});return(0,v.jsx)(ir.A,{control:a,label:e.label},t)})})]})}var hF=r(15492),h_=r(29635);function hB({id:e,options:t,value:r,required:n,disabled:i,readonly:s,label:o,hideLabel:l,onChange:a,onBlur:c,onFocus:h}){var u,d;let{enumOptions:f,enumDisabled:p,emptyValue:m}=t,g=!!t&&t.inline,y=null!=(u=oI(r,f))?u:null;return(0,v.jsxs)(v.Fragment,{children:[(d=(0,v.jsx)(hN.A,{required:n,htmlFor:e,children:o||void 0}),l?void 0:d),(0,v.jsx)(h_.A,{id:e,name:e,value:y,row:g,onChange:(e,t)=>a(oP(t,f,m)),onBlur:({target:{value:t}})=>c(e,oP(t,f,m)),onFocus:({target:{value:t}})=>h(e,oP(t,f,m)),"aria-describedby":oQ(e),children:Array.isArray(f)&&f.map((t,r)=>{let n=Array.isArray(p)&&-1!==p.indexOf(t.value);return(0,v.jsx)(ir.A,{control:(0,v.jsx)(hF.A,{name:e,id:o0(e,r),color:"primary"}),label:t.label,value:String(r),disabled:i||n||s},r)})})]})}var hz=r(34453);function hW(e){var t;let{value:r,readonly:n,disabled:i,onBlur:s,onFocus:o,options:l,schema:a,onChange:c,required:h,label:u,hideLabel:d,id:f}=e,p={value:r,label:u,id:f,name:f,...o_(a)};return(0,v.jsxs)(v.Fragment,{children:[(t=(0,v.jsx)(hN.A,{required:h,htmlFor:f,children:u||void 0}),d?void 0:t),(0,v.jsx)(hz.A,{disabled:i||n,onChange:(e,t)=>{c(null!=t?t:l.emptyValue)},onBlur:({target:{value:e}})=>s(f,e),onFocus:({target:{value:e}})=>o(f,e),valueLabelDisplay:"auto",...p,"aria-describedby":oQ(f)})]})}function hV({schema:e,id:t,name:r,options:n,label:i,hideLabel:s,required:o,disabled:l,readonly:a,placeholder:c,value:h,multiple:u,autofocus:d,onChange:f,onBlur:p,onFocus:m,rawErrors:g=[],registry:y,uiSchema:x,hideError:b,formContext:w,...k}){let{enumOptions:A,enumDisabled:S,emptyValue:C}=n,E=(u=void 0!==u&&!!u)?[]:"",j=void 0===h||u&&h.length<1||!u&&h===E,O=oI(h,A,u),P=!u&&void 0===e.default;return(0,v.jsxs)(ra.A,{id:t,name:t,label:!s&&!!i&&i,value:j||void 0===O?E:O,required:o,disabled:l||a,autoFocus:d,placeholder:c,error:g.length>0,onChange:({target:{value:e}})=>f(oP(e,A,C)),onBlur:({target:e})=>p(t,oP(e&&e.value,A,C)),onFocus:({target:e})=>m(t,oP(e&&e.value,A,C)),...k,select:!0,InputLabelProps:{...k.InputLabelProps,shrink:!j},SelectProps:{...k.SelectProps,multiple:u},"aria-describedby":oQ(t),children:[P&&(0,v.jsx)(rJ.A,{value:"",children:c}),Array.isArray(A)&&A.map(({value:e,label:t},r)=>{let n=Array.isArray(S)&&-1!==S.indexOf(e);return(0,v.jsx)(rJ.A,{value:String(r),disabled:n,children:t},r)})]})}function hH(e){let{options:t,registry:r}=e,n=oV("BaseInputTemplate",r,t),i=5;return("string"==typeof t.rows||"number"==typeof t.rows)&&(i=t.rows),(0,v.jsx)(n,{...e,multiline:!0,rows:i})}function hU(){return{CheckboxWidget:hD,CheckboxesWidget:hL,RadioWidget:hB,RangeWidget:hW,SelectWidget:hV,TextareaWidget:hH}}function hq(){return{templates:h$(),widgets:hU()}}hU();let hK=hq();hr(hq());let hG=hr(hK),hJ=e=>{let t=(0,tZ.useMemo)(()=>Object.fromEntries(Object.entries(e.fields??{}).map(([e,t])=>[e,e=>(0,v.jsx)(t,{...e,uiSchema:e.uiSchema??{},formData:e.formData,rawErrors:e.rawErrors??[],disabled:e.disabled??!1,readonly:e.readonly??!1})])),[e.fields]),r=(0,tZ.useMemo)(()=>({FieldTemplate:hn,DescriptionFieldTemplate:hs,...e.templates}),[e.templates]);return(0,v.jsx)(hG,{...e,templates:r,fields:t})},hY=e=>{let{t}=(0,rU.i)(r6),{value:r,onChange:n,schema:{title:i}}=e;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(ra.A,{id:i,label:i,"aria-describedby":i,onChange:e=>{n(e.target.value)},value:r,autoComplete:"off"}),(0,v.jsx)(hS.A,{error:!0,children:(0,v.jsx)(rz.h,{content:t("passwordWidget.content")})})]})};var hX=r(92881);function hZ(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function hQ(e){return e.split("/").filter(Boolean).map(e=>(0,tX.startCase)(e)).join(" > ")}let h0=e=>{let t=Object.fromEntries(Object.entries(e.formState).flatMap(([t,r])=>{let n=function(e,t,r){for(let n of t){let t=n.mergedSchema,i={};if(t.dependencies&&hZ(t.dependencies))for(let e in t.dependencies)r.hasOwnProperty(e)&&(i[e]=r[e]);if(new tY(t).getSchema({pointer:`#/${e}`,data:i}))return n}return null}(t,e.schemas,e.formState);return n?function e(t,r,n,i){let s=new tY(n.mergedSchema).getSchema({pointer:`#/${t}`,data:i}),o=s?.["ui:backstage"]?.review?.name??s?.title??t;if(s){let l=s["ui:backstage"]?.review;if(l){if(l.mask)return[[o,l.mask]];if(!1===l.show)return[]}if("password"===s["ui:widget"]||s["ui:field"]?.toLocaleLowerCase("en-us")==="secret")return[[o,"******"]];if(s.enum&&s.enumNames)return[[o,s.enumNames[s.enum.indexOf(r)]||r]];if(l?.explode!==!1&&hZ(r))return Object.entries(r).flatMap(([r,s])=>e(`${t}/${r}`,s,n,i))}return[[o,r]]}(t,r,n,e.formState):[[t,r]]}).filter(e=>e.length>0));return(0,v.jsx)(hX.t,{metadata:t,options:{titleFormat:hQ}})};function h1(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}let h2=e=>"type"in e&&"error"===e.type,h4=(e,t,r)=>{async function n(i,s="#",o=i){let l=new tY(e),a={},c=async(e,n,s,o,l)=>{let c=t[e];if(c){let e,t=e={__errors:[],addError:t=>{e.__errors?.push(t)}};try{await c(s,t,{...r,formData:i,schema:o,uiSchema:l})}catch(e){t.addError(e.message)}a[n]=t}};for(let[e,t]of Object.entries(o)){let r=`${s}/${e}`,o=l.getSchema({pointer:r,data:i});if(!o)continue;if(h2(o))throw Error(o.message);let{schema:h,uiSchema:u}=lO(o),d=o&&o.items,f=async(r,n,i)=>{await c(r["ui:field"],e,t,n,i)},p=async e=>{if("ui:field"in e){let{schema:t,uiSchema:r}=lO(o.items);await f(e,t,r)}},m=async e=>{let{schema:r,uiSchema:n}=lO(e);for(let i of(await f(e,r,n),Array.isArray(t)?t:[t]))if(i&&h1(i))for(let e of Object.keys(i))n[e]&&"ui:field"in n[e]&&await c(n[e]["ui:field"],e,i[e],r,n)};if("ui:field"in o)await f(o,h,u);else if(d&&"ui:field"in o.items)await p(o.items);else if(d&&"object"===o.items.type){for(let[,e]of Object.entries(o.items?.properties??[]))await p(e);for(let[,e]of Object.entries(o.items?.dependencies??[]))await m(e)}else h1(t)&&(a[e]=await n(i,r,t))}return a}return async e=>await n(e)};var h3=r(99703),h5=r(95479),h6=r.n(h5);let h9=(0,rM.A)(e=>(0,h3.A)({list:{width:"100%"},text:{textWrap:"wrap"}})),h8=({errors:e,schema:t})=>{let r=h9();return(0,v.jsx)(ni.A,{children:(0,v.jsx)(nr.A,{dense:!0,className:r.list,children:e.map((e,n)=>(0,v.jsxs)(nn.A,{children:[(0,v.jsx)(rK.A,{children:(0,v.jsx)(hf.default,{color:"error"})}),(0,v.jsx)(rG.A,{classes:{primary:r.text},primary:function(e){if(e.property&&e.message){let r=e.property.startsWith(".")?e.property.substring(1):e.property;if(t.properties&&r in t.properties){let n=t.properties[r];if("object"==typeof n&&"title"in n)return`'${n.title}' ${e.message}`}return`'${h6()(r)}' ${e.message}`}return e.stack}(e)})]},n))})})},h7=({description:e})=>e&&(0,v.jsx)(rz.h,{content:e,linkTarget:"_blank"}),ue=lc();ld()(ue.ajv);let ut=(0,rM.A)(e=>({backButton:{marginRight:e.spacing(1)},footer:{display:"flex",flexDirection:"row",justifyContent:"right",marginTop:e.spacing(2)},formWrapper:{padding:e.spacing(2)}}),{name:"BackstageTemplateStepper"}),ur=e=>{var t;let r,n,i,{t:s}=(0,rU.i)(r6),{layouts:o=[],components:l={},onCreate:a,...c}=e,{ReviewStateComponent:h=h0,ReviewStepComponent:u,backButtonText:d=s("stepper.backButtonText"),createButtonText:f=s("stepper.createButtonText"),reviewButtonText:p=s("stepper.reviewButtonText")}=l,m=(0,iy.s)(),{presentation:g,steps:x}=(t=c.manifest,r=(0,k.gf)(i4.B),n=t.steps.map(({title:e,description:t,schema:r})=>({title:e,description:t,mergedSchema:r,...lO(r)})).filter(e=>{let t=e.uiSchema["ui:backstage"]?.featureFlag;return!t||r.isActive(t)}).map(e=>{let{title:t,...n}=e.schema,i={...e,schema:{...n}};return(e.schema?.properties||!e.schema?.dependencies)&&(i.schema.properties=Object.fromEntries(Object.entries(e.schema?.properties??{}).filter(([t])=>{let n=e.uiSchema[t]?.["ui:backstage"]?.featureFlag;return!n||r.isActive(n)}))),i}),{presentation:t.presentation,steps:n}),b=(0,k.Q2)(),[w,A]=(0,tZ.useState)(0),[S,C]=(0,tZ.useState)(!1),[E]=(i=c.initialState,(0,tZ.useState)(()=>{if(i)return i;let e=lp().parse(window.location.search,{ignoreQueryPrefix:!0});try{return JSON.parse(e.formData)}catch(e){return{}}})),[j,O]=(0,tZ.useState)(E),[P,M]=(0,tZ.useState)(),T=ut(),I=g?.buttonLabels?.backButtonText??d,$=g?.buttonLabels?.createButtonText??f,D=g?.buttonLabels?.reviewButtonText??p,R=(0,tZ.useMemo)(()=>Object.fromEntries(c.extensions.map(({name:e,component:t})=>[e,t])),[c.extensions]),N=(0,tZ.useMemo)(()=>({...y,...R}),[R]),L=(0,tZ.useMemo)(()=>Object.fromEntries(c.extensions.map(({name:e,validation:t})=>[e,t])),[c.extensions]),F=(0,tZ.useMemo)(()=>h4(x[w]?.mergedSchema,L,{apiHolder:b}),[x,w,L,b]),_=(0,tZ.useCallback)(()=>{A(e=>e-1)},[A]),B=((e,t={})=>{let{layouts:r=[]}=t,n=e?.uiSchema["ui:ObjectFieldTemplate"];return(0,tZ.useMemo)(()=>{if("string"!=typeof n)return e;let t=r.find(e=>e.name===n)?.component;return t?{...e,uiSchema:{...e.uiSchema,"ui:ObjectFieldTemplate":t}}:e},[r,n,e])})(x[w],{layouts:o}),{formContext:z,uiSchema:W,liveOmit:V,omitExtraData:H,...U}=c.formProps??{},q=(0,tZ.useCallback)(e=>{O(t=>({...t,...e.formData}))},[O]),K=(0,tZ.useCallback)(async({formData:e={}})=>{M(void 0),C(!0);let t=await F(e);O(t=>({...t,...e})),C(!1),function e(t){if(!t)return!1;for(let r of Object.values(t)){if(r&&"__errors"in r){if((r.__errors??[]).length>0)return!0;continue}if(e(r))return!0}return!1}(t)?M(t):(M(void 0),A(e=>{let t=e+1;return m.captureEvent("click",`Next Step (${t})`),t}))},[F,m]);(0,tZ.useEffect)(()=>{let e=document.querySelector("main");e&&"function"==typeof e.scrollTo&&e.scrollTo({top:0,behavior:"auto"})},[w]);let G=(0,tX.merge)({},W,B?.uiSchema),[J,Y]=(0,tZ.useState)(!1),X=(0,tZ.useCallback)(async()=>{Y(!0),m.captureEvent("click",`${$}`);try{await a(j)}finally{Y(!1)}},[m,$,a,j]);return(0,v.jsxs)(v.Fragment,{children:[S&&(0,v.jsx)(i5.A,{variant:"indeterminate"}),(0,v.jsxs)(i8.A,{activeStep:w,alternativeLabel:!0,variant:"elevation",style:{overflowX:"auto"},children:[x.map((e,t)=>{let r=w>t;return(0,v.jsx)(i6.A,{children:(0,v.jsx)(i9.A,{"aria-label":s("stepper.stepIndexLabel",{index:t+1}),style:{cursor:r?"pointer":"default"},onClick:()=>{r&&A(t)},children:e.title})},t)}),(0,v.jsx)(i6.A,{children:(0,v.jsx)(i9.A,{children:D})})]}),(0,v.jsx)("div",{className:T.formWrapper,children:w<x.length?(0,v.jsx)(hJ,{validator:ue,extraErrors:P,formData:j,formContext:{...z,formData:j},schema:B.schema,uiSchema:G,onSubmit:K,fields:N,showErrorList:"top",templates:{ErrorListTemplate:h8},onChange:q,widgets:{password:hY},experimental_defaultFormStateBehavior:{allOf:"populateDefaults"},...U,children:(0,v.jsxs)("div",{className:T.footer,children:[(0,v.jsx)(iF.A,{onClick:_,className:T.backButton,disabled:w<1||S,children:I}),(0,v.jsx)(iF.A,{variant:"contained",color:"primary",type:"submit",disabled:S,children:w===x.length-1?D:s("stepper.nextButtonText")})]})},w):u?(0,v.jsx)(u,{disableButtons:S,formData:j,handleBack:_,handleReset:()=>{},steps:x,handleCreate:X}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(h,{formState:j,schemas:x}),(0,v.jsxs)("div",{className:T.footer,children:[(0,v.jsx)(iF.A,{onClick:_,className:T.backButton,disabled:w<1,children:I}),(0,v.jsx)(iF.A,{disabled:J,variant:"contained",color:"primary",onClick:X,children:$})]})]})})]})},un=(0,rM.A)({markdown:{"& :first-child":{marginTop:0},"& :last-child":{marginBottom:0}}}),ui=e=>{let t,r,{t:n}=(0,rU.i)(r6),{title:i,description:s,namespace:o,templateName:l,onCreate:a,...c}=e,h=(0,iy.s)(),u=un(),d=(0,nq.U2)({kind:"Template",namespace:o,name:l}),f=(0,k.gf)(id.m),{loading:p,manifest:m,error:g}=i1(d),y=(t="backstage:featureFlag",r=(0,k.gf)(i4.B),(0,tZ.useMemo)(()=>{if(!m)return;let e=m?.steps.filter(e=>{let n=e.schema[t];return"string"!=typeof n||r.isActive(n)}).map(e=>{let n=t5()(e),i=[];return n.schema.properties&&(n.schema.properties=Object.fromEntries(Object.entries(n.schema.properties).filter(([e,n])=>!n[t]||!!r.isActive(n[t])||(i.push(e),!1))),n.schema.required=Array.isArray(n.schema.required)?n.schema.required?.filter(e=>!i.includes(e)):n.schema.required),n});return{...m,steps:e}},[m,r])),x=(e=>{let t=(0,k.gf)(nH.v),{value:r}=(0,i3.default)(async()=>{let r=await t.getEntityByRef(e),n=r?.metadata.annotations?.["backstage.io/time-saved"];if(!r||!n)return;let i=nW.dw.fromISO(n).as("minutes");if(!Number.isNaN(i))return i},[t,e]);return r})(d),b=(0,tZ.useCallback)(async e=>{await a(e),h.captureEvent("create","Task has been created",{value:x,attributes:{templateSteps:y?.steps?.length??0}})},[a,h,x,y]);return((0,tZ.useEffect)(()=>{g&&f.post(Error(`Failed to load template, ${g}`))},[g,f]),g)?c.onError(g):(0,v.jsxs)(rH.U,{children:[p&&(0,v.jsx)(rL.k,{}),y&&(0,v.jsx)(i2.n,{title:i??y.title,subheader:(0,v.jsx)(rz.h,{className:u.markdown,linkTarget:"_blank",content:s??y.description??n("workflow.noDescription")}),noPadding:!0,titleTypographyProps:{component:"h2"},children:(0,v.jsx)(ur,{manifest:y,onCreate:b,...c})})]})},us=(0,rM.A)(e=>({button:{color:e.page.fontColor}}));function uo(e){let{editUrl:t}=e,r=us(),[n,i]=(0,tZ.useState)(),{t:s}=(0,rU.i)(r7.W);return t?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(rq.A,{id:"long-menu","aria-label":"more","aria-controls":"long-menu","aria-expanded":!!n,"aria-haspopup":"true",role:"button",onClick:e=>{i(e.currentTarget)},"data-testid":"menu-button",color:"inherit",className:r.button,children:(0,v.jsx)(r4.default,{})}),(0,v.jsx)(rX.Ay,{"aria-labelledby":"long-menu",open:!!n,onClose:()=>{i(void 0)},anchorEl:n,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:(0,v.jsx)(rY.A,{children:(0,v.jsxs)(rJ.A,{component:rB.N_,to:t,children:[(0,v.jsx)(rK.A,{children:(0,v.jsx)(r0.default,{fontSize:"small"})}),(0,v.jsx)(rG.A,{primary:s("templateWizardPage.pageContextMenu.editConfigurationTitle")})]})})})]}):null}var ul=r(31766);class ua{static create(e){return new ua(e.type,new Set(e.versions))}#e;#t;constructor(e,t){this.#e=e,this.#t=t}TPublic=void 0;TInternal=void 0;isType=e=>this.#r(e);toInternal=e=>{if(!this.#r(e))throw TypeError(`Invalid opaque type, expected '${this.#e}', but got '${this.#n(e)}'`);if(!this.#t.has(e.version)){let t=Array.from(this.#t).map(this.#i);t.length>1&&(t[t.length-1]=`or ${t[t.length-1]}`);let r=t.length>2?t.join(", "):t.join(" ");throw TypeError(`Invalid opaque type instance, got version ${this.#i(e.version)}, expected ${r}`)}return e};createInstance(e,t){return Object.assign(t,{$$type:this.#e,...e&&{version:e}})}#r(e){return null!==e&&"object"==typeof e&&e.$$type===this.#e}#n(e){return"object"!=typeof e?`<${typeof e}>`:null===e?"<null>":"$$type"in e?String(e.$$type):String(e)}#i=e=>e?`'${e}'`:"undefined"}let uc=ua.create({type:"@backstage/scaffolder/FormDecorator",versions:["v1"]}),uh=()=>{let e=(0,k.gf)(ul.S),t=(0,k.gf)(id.m),{value:r}=(0,rA.A)(()=>e.getFormDecorators(),[]),n=(0,k.Q2)(),i=(0,tZ.useMemo)(()=>{let e=new Map;for(let i of r??[])try{let{decorator:t,deps:r}=uc.toInternal(i),s=Object.entries(r??{}).map(([e,t])=>{let r=n.get(t);if(!r)throw Error(`Failed to resolve apiRef ${t.id} for form decorator ${i.id} it will be disabled`);return[e,r]});e.set(i.id,{decorator:e=>t(e,Object.fromEntries(s))})}catch(e){t.post(e);return}return e},[n,r,t]),s=(0,tZ.useCallback)(async e=>{let r={...e.formState},n={...e.secrets},s=e.manifest?.EXPERIMENTAL_formDecorators;return s&&await Promise.all(s.map(async e=>{let s=i?.get(e.id);s?await s.decorator({setSecrets:e=>{n={...e(n)}},setFormState:e=>{r={...e(r)}},formState:r,input:e.input??{}}):t.post(Error(`Failed to find form decorator ${e.id}`))})),{formState:r,secrets:n}},[i,t]);return(0,tZ.useMemo)(()=>({run:s}),[s])},uu=e=>{let t=(0,rN.S)(rk.rQ),r=(0,rN.S)(rk.bW),{secrets:n}=(0,t9.Z)(),i=(0,k.gf)(rS.z),s=(0,k.gf)(nH.v),[o,l]=(0,tZ.useState)(!1),a=(0,x.Zp)(),{templateName:c,namespace:h}=(0,i0.K)(rk.sP),{t:u}=(0,rU.i)(r7.W),d=(0,nq.U2)({kind:"Template",namespace:h,name:c}),{manifest:f}=i1(d),p=uh(),{value:m}=(0,rA.A)(async()=>{let e=await s.getEntityByRef(d);return e?.metadata.annotations?.[iQ.P]},[d,s]),g=(0,tZ.useCallback)(async e=>{if(o)return;l(!0);let{formState:t,secrets:s}=await p.run({formState:e,secrets:n,manifest:f}),{taskId:c}=await i.scaffold({templateRef:d,values:t,secrets:s});a(r({taskId:c}))},[n,p,o,f,a,i,r,d]),y=(0,tZ.useCallback)(()=>(0,v.jsx)(x.C5,{to:t()}),[t]);return(0,v.jsx)(iV.I,{attributes:{entityRef:d},children:(0,v.jsxs)(rW.Y,{themeId:"website",children:[(0,v.jsx)(rV.Y,{pageTitleOverride:u("templateWizardPage.pageTitle"),title:u("templateWizardPage.title"),subtitle:u("templateWizardPage.subtitle"),...e.headerOptions,children:(0,v.jsx)(uo,{editUrl:m})}),o&&(0,v.jsx)(rL.k,{}),(0,v.jsx)(ui,{namespace:h,templateName:c,onCreate:g,components:e.components,onError:y,extensions:e.customFieldExtensions,formProps:e.formProps,layouts:e.layouts})]})})};function ud(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];throw Error("[Immer] minified error nr: "+e+(r.length?" "+r.map(function(e){return"'"+e+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function uf(e){return!!e&&!!e[u3]}function up(e){var t;return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object||"function"==typeof r&&Function.toString.call(r)===u5}(e)||Array.isArray(e)||!!e[u4]||!!(null==(t=e.constructor)?void 0:t[u4])||ux(e)||ub(e))}function um(e,t,r){void 0===r&&(r=!1),0===ug(e)?(r?Object.keys:u6)(e).forEach(function(n){r&&"symbol"==typeof n||t(n,e[n],e)}):e.forEach(function(r,n){return t(n,r,e)})}function ug(e){var t=e[u3];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:ux(e)?2:3*!!ub(e)}function uy(e,t){return 2===ug(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function uv(e,t,r){var n=ug(e);2===n?e.set(t,r):3===n?e.add(r):e[t]=r}function ux(e){return uQ&&e instanceof Map}function ub(e){return u0&&e instanceof Set}function uw(e){return e.o||e.t}function uk(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=u9(e);delete t[u3];for(var r=u6(t),n=0;n<r.length;n++){var i=r[n],s=t[i];!1===s.writable&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(t[i]={configurable:!0,writable:!0,enumerable:s.enumerable,value:e[i]})}return Object.create(Object.getPrototypeOf(e),t)}function uA(e,t){return void 0===t&&(t=!1),uC(e)||uf(e)||!up(e)||(ug(e)>1&&(e.set=e.add=e.clear=e.delete=uS),Object.freeze(e),t&&um(e,function(e,t){return uA(t,!0)},!0)),e}function uS(){ud(2)}function uC(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function uE(e){var t=u8[e];return t||ud(18,e),t}function uj(e,t){t&&(uE("Patches"),e.u=[],e.s=[],e.v=t)}function uO(e){uP(e),e.p.forEach(uT),e.p=null}function uP(e){e===uX&&(uX=e.l)}function uM(e){return uX={p:[],l:uX,h:e,m:!0,_:0}}function uT(e){var t=e[u3];0===t.i||1===t.i?t.j():t.g=!0}function uI(e,t){t._=t.p.length;var r=t.p[0],n=void 0!==e&&e!==r;return t.h.O||uE("ES5").S(t,e,n),n?(r[u3].P&&(uO(t),ud(4)),up(e)&&(e=u$(t,e),t.l||uR(t,e)),t.u&&uE("Patches").M(r[u3].t,e,t.u,t.s)):e=u$(t,r,[]),uO(t),t.u&&t.v(t.u,t.s),e!==u2?e:void 0}function u$(e,t,r){if(uC(t))return t;var n=t[u3];if(!n)return um(t,function(i,s){return uD(e,n,t,i,s,r)},!0),t;if(n.A!==e)return t;if(!n.P)return uR(e,n.t,!0),n.t;if(!n.I){n.I=!0,n.A._--;var i=4===n.i||5===n.i?n.o=uk(n.k):n.o,s=i,o=!1;3===n.i&&(s=new Set(i),i.clear(),o=!0),um(s,function(t,s){return uD(e,n,i,t,s,r,o)}),uR(e,i,!1),r&&e.u&&uE("Patches").N(n,r,e.u,e.s)}return n.o}function uD(e,t,r,n,i,s,o){if(uf(i)){var l=u$(e,i,s&&t&&3!==t.i&&!uy(t.R,n)?s.concat(n):void 0);if(uv(r,n,l),!uf(l))return;e.m=!1}else o&&r.add(i);if(up(i)&&!uC(i)){if(!e.h.D&&e._<1)return;u$(e,i),t&&t.A.l||uR(e,i)}}function uR(e,t,r){void 0===r&&(r=!1),!e.l&&e.h.D&&e.m&&uA(t,r)}function uN(e,t){var r=e[u3];return(r?uw(r):e)[t]}function uL(e,t){if(t in e)for(var r=Object.getPrototypeOf(e);r;){var n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Object.getPrototypeOf(r)}}function uF(e){e.P||(e.P=!0,e.l&&uF(e.l))}function u_(e){e.o||(e.o=uk(e.t))}function uB(e,t,r){var n,i,s,o,l,a,c,h=ux(t)?uE("MapSet").F(t,r):ub(t)?uE("MapSet").T(t,r):e.O?(s=i={i:+!!(n=Array.isArray(t)),A:r?r.A:uX,P:!1,I:!1,R:{},l:r,t:t,k:null,o:null,j:null,C:!1},o=u7,n&&(s=[i],o=de),a=(l=Proxy.revocable(s,o)).revoke,i.k=c=l.proxy,i.j=a,c):uE("ES5").J(t,r);return(r?r.A:uX).p.push(h),h}function uz(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return uk(e)}var uW,uV,uH,uU,uq,uK,uG,uJ,uY,uX,uZ="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),uQ="undefined"!=typeof Map,u0="undefined"!=typeof Set,u1="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,u2=uZ?Symbol.for("immer-nothing"):((uY={})["immer-nothing"]=!0,uY),u4=uZ?Symbol.for("immer-draftable"):"__$immer_draftable",u3=uZ?Symbol.for("immer-state"):"__$immer_state",u5=""+Object.prototype.constructor,u6="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,u9=Object.getOwnPropertyDescriptors||function(e){var t={};return u6(e).forEach(function(r){t[r]=Object.getOwnPropertyDescriptor(e,r)}),t},u8={},u7={get:function(e,t){if(t===u3)return e;var r,n,i=uw(e);if(!uy(i,t))return(n=uL(i,t))?"value"in n?n.value:null==(r=n.get)?void 0:r.call(e.k):void 0;var s=i[t];return e.I||!up(s)?s:s===uN(e.t,t)?(u_(e),e.o[t]=uB(e.A.h,s,e)):s},has:function(e,t){return t in uw(e)},ownKeys:function(e){return Reflect.ownKeys(uw(e))},set:function(e,t,r){var n=uL(uw(e),t);if(null==n?void 0:n.set)return n.set.call(e.k,r),!0;if(!e.P){var i=uN(uw(e),t),s=null==i?void 0:i[u3];if(s&&s.t===r)return e.o[t]=r,e.R[t]=!1,!0;if((r===i?0!==r||1/r==1/i:r!=r&&i!=i)&&(void 0!==r||uy(e.t,t)))return!0;u_(e),uF(e)}return e.o[t]===r&&(void 0!==r||t in e.o)||Number.isNaN(r)&&Number.isNaN(e.o[t])||(e.o[t]=r,e.R[t]=!0),!0},deleteProperty:function(e,t){return void 0!==uN(e.t,t)||t in e.t?(e.R[t]=!1,u_(e),uF(e)):delete e.R[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var r=uw(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:n.enumerable,value:r[t]}:n},defineProperty:function(){ud(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){ud(12)}},de={};um(u7,function(e,t){de[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),de.deleteProperty=function(e,t){return de.set.call(this,e,t,void 0)},de.set=function(e,t,r){return u7.set.call(this,e[0],t,r,e[0])};var dt=new(function(){function e(e){var t=this;this.O=u1,this.D=!0,this.produce=function(e,r,n){if("function"==typeof e&&"function"!=typeof r){var i,s=r;return r=e,function(e){var n=this;void 0===e&&(e=s);for(var i=arguments.length,o=Array(i>1?i-1:0),l=1;l<i;l++)o[l-1]=arguments[l];return t.produce(e,function(e){var t;return(t=r).call.apply(t,[n,e].concat(o))})}}if("function"!=typeof r&&ud(6),void 0!==n&&"function"!=typeof n&&ud(7),up(e)){var o=uM(t),l=uB(t,e,void 0),a=!0;try{i=r(l),a=!1}finally{a?uO(o):uP(o)}return"undefined"!=typeof Promise&&i instanceof Promise?i.then(function(e){return uj(o,n),uI(e,o)},function(e){throw uO(o),e}):(uj(o,n),uI(i,o))}if(!e||"object"!=typeof e){if(void 0===(i=r(e))&&(i=e),i===u2&&(i=void 0),t.D&&uA(i,!0),n){var c=[],h=[];uE("Patches").M(e,i,c,h),n(c,h)}return i}ud(21,e)},this.produceWithPatches=function(e,r){if("function"==typeof e)return function(r){for(var n=arguments.length,i=Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];return t.produceWithPatches(r,function(t){return e.apply(void 0,[t].concat(i))})};var n,i,s=t.produce(e,r,function(e,t){n=e,i=t});return"undefined"!=typeof Promise&&s instanceof Promise?s.then(function(e){return[e,n,i]}):[s,n,i]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){up(e)||ud(8),uf(e)&&(uf(t=e)||ud(22,t),e=function e(t){if(!up(t))return t;var r,n=t[u3],i=ug(t);if(n){if(!n.P&&(n.i<4||!uE("ES5").K(n)))return n.t;n.I=!0,r=uz(t,i),n.I=!1}else r=uz(t,i);return um(r,function(t,i){var s;n&&(s=n.t,(2===ug(s)?s.get(t):s[t])===i)||uv(r,t,e(i))}),3===i?new Set(r):r}(t));var t,r=uM(this),n=uB(this,e,void 0);return n[u3].C=!0,uP(r),n},t.finishDraft=function(e,t){var r=(e&&e[u3]).A;return uj(r,t),uI(void 0,r)},t.setAutoFreeze=function(e){this.D=e},t.setUseProxies=function(e){e&&!u1&&ud(20),this.O=e},t.applyPatches=function(e,t){for(r=t.length-1;r>=0;r--){var r,n=t[r];if(0===n.path.length&&"replace"===n.op){e=n.value;break}}r>-1&&(t=t.slice(r+1));var i=uE("Patches").$;return uf(e)?i(e,t):this.produce(e,function(e){return i(e,t)})},e}()),dr=dt.produce;function dn(e,t){switch(t.type){case"INIT":e.steps=t.data.spec.steps.reduce((e,t)=>(e[t.id]={status:"open",id:t.id},e),{}),e.stepLogs=t.data.spec.steps.reduce((e,t)=>(e[t.id]=[],e),{}),e.error=void 0,e.completed=!1,e.task=t.data;return;case"LOGS":{let r=t.data;for(let t of(e.loading&&r.length>0&&(e.loading=!1),r)){let r=`${t.createdAt} ${t.body.message}`;if(!t.body.stepId||!e.steps?.[t.body.stepId])continue;let n=e.stepLogs?.[t.body.stepId],i=e.steps?.[t.body.stepId];i&&t.body.status&&t.body.status!==i.status&&(i.status=t.body.status,"processing"===i.status&&(i.startedAt=t.createdAt),["cancelled","completed","failed"].includes(i.status)&&(i.endedAt=t.createdAt)),n?.push(r)}return}case"COMPLETED":e.completed=!0,e.output=t.data.body.output,e.error=t.data.body.error;return;case"CANCELLED":e.cancelled=!0;return;case"RECOVERED":for(let t in e.cancelled=!1,e.completed=!1,e.output=void 0,e.error=void 0,e.steps)e.steps.hasOwnProperty(t)&&(e.steps[t].startedAt=void 0,e.steps[t].endedAt=void 0,e.steps[t].status="open");return;case"ERROR":e.error=t.data,e.loading=!1,e.completed=!0;return;default:return}}dt.produceWithPatches.bind(dt),dt.setAutoFreeze.bind(dt),dt.setUseProxies.bind(dt),dt.applyPatches.bind(dt),dt.createDraft.bind(dt),dt.finishDraft.bind(dt);let di=e=>{var t,r;let n=(0,k.gf)(rS.z),[i,s]=(t={cancelled:!1,loading:!0,completed:!1,stepLogs:{},steps:{}},r=(0,tZ.useMemo)(function(){return dr(dn)},[dn]),(0,tZ.useReducer)(r,t,void 0));return(0,tZ.useEffect)(()=>{let t,r,i=!1,o=1,l=!1,a=()=>n.getTask(e).then(c=>{if(i)return;l=c.spec.EXPERIMENTAL_recovery?.EXPERIMENTAL_strategy==="startOver",s({type:"INIT",data:c});let h=n.streamLogs({isTaskRecoverable:l,taskId:e}),u=[];function d(){u.length&&s({type:"LOGS",data:u.splice(0,u.length)})}r=setInterval(d,500),t=h.subscribe({next:e=>{switch(o=1,e.type){case"log":return u.push(e);case"cancelled":s({type:"CANCELLED"});return;case"completion":d(),s({type:"COMPLETED",data:e});return;case"recovered":s({type:"RECOVERED",data:e});return;default:throw Error(`Unhandled event type ${e.type} in observer`)}},error:e=>{d(),e.message||(e.message=`We cannot connect at the moment, trying again in some seconds... Retrying (${o>3?3:o}/3 retries)`),setTimeout(()=>{o+=1,a()},15e3),s({type:"ERROR",data:e})}})},e=>{i||s({type:"ERROR",data:e})});return a(),()=>{!l&&(i=!0,t&&t.unsubscribe(),r&&clearInterval(r))}},[n,s,e]),i};var ds=r(92399),dl=r(55534),da=r(64118),dc=r(25283),dh=r(86868);let du=(0,rM.A)(()=>({button:{color:({fontColor:e})=>e}})),dd=e=>{let{cancelEnabled:t,canRetry:r,isRetryableTask:n,logsVisible:i,buttonBarVisible:s,onRetry:o,onStartOver:l,onToggleLogs:a,onToggleButtonBar:c,taskId:h}=e,{getPageTheme:u}=(0,ik.A)(),d=du({fontColor:u({themeId:"website"}).fontColor}),[f,p]=(0,tZ.useState)(),{t:m}=(0,rU.i)(r7.W),{allowed:g}=(0,r3.J)({permission:r5.Xw,resourceRef:h}),{allowed:y}=(0,r3.J)({permission:r5.X6});return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(rq.A,{"aria-label":"more","aria-controls":"long-menu","aria-haspopup":"true",onClick:e=>{p(e.currentTarget)},"data-testid":"menu-button",className:d.button,children:(0,v.jsx)(r4.default,{})}),(0,v.jsx)(rX.Ay,{open:!!f,onClose:()=>p(void 0),anchorEl:f,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:(0,v.jsxs)(rY.A,{children:[(0,v.jsxs)(rJ.A,{onClick:()=>a?.(!i),children:[(0,v.jsx)(rK.A,{children:(0,v.jsx)(dc.default,{fontSize:"small"})}),(0,v.jsx)(rG.A,{primary:m(i?"ongoingTask.contextMenu.hideLogs":"ongoingTask.contextMenu.showLogs")})]}),(0,v.jsxs)(rJ.A,{onClick:()=>c?.(!s),children:[(0,v.jsx)(rK.A,{children:(0,v.jsx)(dh.default,{fontSize:"small"})}),(0,v.jsx)(rG.A,{primary:m(s?"ongoingTask.contextMenu.hideButtonBar":"ongoingTask.contextMenu.showButtonBar")})]}),(0,v.jsxs)(rJ.A,{onClick:l,disabled:t||!(g&&y),"data-testid":"start-over-task",children:[(0,v.jsx)(rK.A,{children:(0,v.jsx)(dl.default,{fontSize:"small"})}),(0,v.jsx)(rG.A,{primary:m("ongoingTask.contextMenu.startOver")})]}),n&&(0,v.jsxs)(rJ.A,{onClick:o,disabled:t||!r,"data-testid":"retry-task",children:[(0,v.jsx)(rK.A,{children:(0,v.jsx)(da.default,{fontSize:"small"})}),(0,v.jsx)(rG.A,{primary:m("ongoingTask.contextMenu.retry")})]}),(0,v.jsxs)(rJ.A,{onClick:e.onCancel,disabled:e.isCancelButtonDisabled,"data-testid":"cancel-task",children:[(0,v.jsx)(rK.A,{children:(0,v.jsx)(ds.default,{fontSize:"small"})}),(0,v.jsx)(rG.A,{primary:m("ongoingTask.contextMenu.cancel")})]})]})})]})},df=(0,rM.A)({root:{"&:hover":{textDecoration:"none"}}}),dp=e=>{let{links:t=[]}=e.output,r=df(),n=(0,nQ.n)(),i=(0,rN.S)(iC.s);return(0,v.jsx)(v.Fragment,{children:t.filter(({url:e,entityRef:t})=>e||t).map(({url:e,entityRef:t,title:r,icon:n})=>t?{title:r,icon:n,url:i((0,nq.KU)(t))}:{title:r,icon:n,url:e}).map(({url:e,title:t,icon:i},s)=>{let o=n.getSystemIcon(i)??rI.default;return(0,v.jsx)(rB.N_,{to:e,classes:{root:r.root},children:(0,v.jsx)(iF.A,{startIcon:(0,v.jsx)(o,{}),component:"div",color:"primary",children:t})},s)})})},dm=e=>{let{output:{text:t=[]},index:r,setIndex:n}=e,i=(0,nQ.n)();return(0,v.jsx)(v.Fragment,{children:t.filter(({content:e})=>void 0!==e).map(({title:e,icon:t},s)=>{let o=i.getSystemIcon(t)??rQ.default;return(0,v.jsx)(iF.A,{startIcon:(0,v.jsx)(o,{}),component:"div",color:"primary",onClick:()=>{r!==s&&n?.(s)},variant:r===s?"outlined":void 0,children:e},s)})})},dg=e=>{let{t}=(0,rU.i)(r6),{output:r}=e,[n,i]=(0,tZ.useState)(void 0);(0,tZ.useEffect)(()=>{if(void 0===n&&r?.text){let e=r.text.findIndex(e=>e.default);i(e>=0?e:0)}},[n,r]);let s=(0,tZ.useMemo)(()=>void 0!==n?r?.text?.[n]:null,[r,n]);if(!r)return null;let o=(r.text||[]).length>1,l=0===(r.links||[]).length&&!o;return(0,v.jsxs)(v.Fragment,{children:[l?null:(0,v.jsx)(rO.A,{paddingBottom:2,"data-testid":"output-box",children:(0,v.jsx)(ni.A,{children:(0,v.jsxs)(rO.A,{padding:2,justifyContent:"center",display:"flex",gridGap:16,flexWrap:"wrap",children:[o&&(0,v.jsx)(dm,{"data-testid":"text-outputs",output:r,index:n,setIndex:i}),(0,v.jsx)(dp,{output:r})]})})}),s?(0,v.jsx)(rO.A,{paddingBottom:2,"data-testid":"text-output-box",children:(0,v.jsx)(i2.n,{title:s.title??t("templateOutputs.title"),noPadding:!0,titleTypographyProps:{component:"h2"},children:(0,v.jsx)(rO.A,{padding:2,height:"100%",children:(0,v.jsx)(rz.h,{content:s.content??""})})})}):null]})};var dy=r(54819),dv=r(78467),dx=r(51767),db=r(25711),dw=r(7707),dk=r(9181);let dA=(0,rM.A)(e=>({root:{color:e.palette.text.disabled},completed:{color:e.palette.status.ok},error:{color:e.palette.status.error}})),dS=e=>{let t=dA(),{active:r,completed:n,error:i,skipped:s}=e;return(0,v.jsx)("div",{className:nm()(t.root,{[t.completed]:n,[t.error]:i}),children:r?(0,v.jsx)(dv.A,{size:"20px"}):n?(0,v.jsx)(dw.default,{}):i?(0,v.jsx)(dk.default,{}):s?(0,v.jsx)(dx.default,{}):(0,v.jsx)(db.default,{})})};var dC=r(45313);let dE=e=>{let[t,r]=(0,tZ.useState)(""),{step:n}=e,i=(0,tZ.useCallback)(()=>{if(!n.startedAt)return void r("");let e=n.endedAt?nW.c9.fromISO(n.endedAt):nW.c9.local(),t=nW.c9.fromISO(n.startedAt),i=nW.IX.fromDateTimes(t,e).toDuration().valueOf();r(t1()(i,{round:!0}))},[n.endedAt,n.startedAt]);return(0,w.u)(i),(0,dC.A)(i,n.startedAt&&n.endedAt&&t?null:n.startedAt&&n.endedAt?1:1e3),(0,v.jsx)(rP.A,{variant:"caption",children:t})},dj=(0,rM.A)(e=>({failed:{backgroundColor:e.palette.error.main},success:{backgroundColor:e.palette.success.main}})),dO=e=>{let t=dj();return e.isComplete?(0,v.jsx)(i5.A,{variant:"determinate",classes:{bar:e.isError?t.failed:t.success},value:100}):(0,v.jsx)(i5.A,{variant:"indeterminate"})},dP=e=>(0,v.jsxs)(ni.A,{style:{position:"relative",overflow:"hidden"},children:[(0,v.jsx)(dO,{isComplete:e.isComplete??!1,isError:e.isError??!1}),(0,v.jsx)(rO.A,{padding:2,children:(0,v.jsx)(i8.A,{activeStep:e.activeStep,alternativeLabel:!0,variant:"elevation",style:{overflowX:"auto"},children:e.steps.map(e=>{let t="completed"===e.status,r="failed"===e.status,n="processing"===e.status,i="skipped"===e.status;return(0,v.jsx)(i6.A,{children:(0,v.jsx)(dy.A,{children:(0,v.jsxs)(i9.A,{StepIconProps:{completed:t,error:r,active:n,skipped:i},StepIconComponent:dS,"data-testid":"step-label",children:[(0,v.jsx)(rO.A,{children:e.name}),!i&&(0,v.jsx)(dE,{step:e})]})})},e.id)})})})]});var dM=r(67296);let dT=(0,rM.A)({root:{width:"100%",height:"100%",position:"relative",minHeight:240}}),dI=e=>{let t=dT();return(0,v.jsx)("div",{className:t.root,children:(0,v.jsx)(dM.r,{text:Object.values(e.logs).map(e=>e.join("\n")).filter(Boolean).join("\n")})})};var d$=r(91072);let dD=(0,rM.A)(e=>({contentWrapper:{display:"flex",flexDirection:"column"},buttonBar:{display:"flex",flexDirection:"row",justifyContent:"right"},cancelButton:{marginRight:e.spacing(1)},retryButton:{marginRight:e.spacing(1)},logsVisibilityButton:{marginRight:e.spacing(1)}})),dR=e=>{let{taskId:t}=(0,x.g)(),r=di(t),{namespace:n,name:i}=r.task?.spec.templateInfo?.entity?.metadata??{};return(0,v.jsx)(iV.I,{attributes:{entityRef:i&&(0,nq.U2)({kind:"template",namespace:n,name:i}),taskId:t},children:(0,v.jsx)(rW.Y,{themeId:"website",children:(0,v.jsx)(dN,{...e})})})};function dN(e){let{taskId:t}=(0,x.g)(),r=(0,rN.S)(rk.sP),n=(0,x.Zp)(),i=(0,iy.s)(),s=(0,k.gf)(rS.z),o=(0,k.gf)(d$.n),l=di(t),a=dD(),c=(0,tZ.useMemo)(()=>l.task?.spec.steps.map(e=>({...e,...l?.steps?.[e.id]}))??[],[l]),{t:h}=(0,rU.i)(r7.W),[u,d]=(0,tZ.useState)(!1),[f,p]=(0,tZ.useState)(!0),{allowed:m}=(0,r3.J)({permission:r5.lu,resourceRef:t}),{allowed:g}=(0,r3.J)({permission:r5.Xw,resourceRef:t}),{allowed:y}=(0,r3.J)({permission:r5.X6}),w=g&&y;(0,tZ.useEffect)(()=>{l.error&&d(!0)},[l.error]),(0,tZ.useEffect)(()=>{l.completed&&!l.error&&(d(!0),p(!1))},[l.error,l.completed]);let{value:A}=(0,rA.A)(async()=>{let e=l.task?.spec.templateInfo?.entityRef;if(e)return o.forEntity(e).promise},[o,l.task?.spec.templateInfo?.entityRef]),S=(0,tZ.useMemo)(()=>{for(let e=c.length-1;e>=0;e--)if("open"!==c[e].status)return e;return 0},[c]),C=l.task?.spec.EXPERIMENTAL_recovery?.EXPERIMENTAL_strategy==="startOver",E=g&&y&&C,j=(0,tZ.useCallback)(()=>{let{namespace:e,name:t}=l.task?.spec.templateInfo?.entity?.metadata??{},s=l.task?.spec.parameters??{};e&&t&&(i.captureEvent("click","Task has been started over"),n({pathname:r({namespace:e,templateName:t}),search:`?${lp().stringify({formData:JSON.stringify(s)})}`}))},[i,n,l.task?.spec.parameters,l.task?.spec.templateInfo?.entity?.metadata,r]),[,{execute:O}]=(0,b.Y)(async()=>{t&&(i.captureEvent("retried","Template has been retried"),await s.retry?.(t))}),[{status:P},{execute:M}]=(0,b.Y)(async()=>{t&&(i.captureEvent("cancelled","Template has been cancelled"),await s.cancelTask(t))}),T=e.TemplateOutputsComponent??dg,I=!(l.cancelled||l.completed),$=!I||"not-executed"!==P||!m;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(rV.Y,{pageTitleOverride:A?h("ongoingTask.pageTitle.hasTemplateName",{templateName:A.primaryTitle}):h("ongoingTask.pageTitle.noTemplateName"),title:(0,v.jsxs)("div",{children:[h("ongoingTask.title")," ",(0,v.jsx)("code",{children:A?A.primaryTitle:""})]}),subtitle:h("ongoingTask.subtitle",{taskId:t}),children:(0,v.jsx)(dd,{cancelEnabled:I,canRetry:E,isRetryableTask:C,logsVisible:u,buttonBarVisible:f,onStartOver:j,onRetry:O,onToggleLogs:d,onToggleButtonBar:p,taskId:t,onCancel:M,isCancelButtonDisabled:$})}),(0,v.jsxs)(rH.U,{className:a.contentWrapper,children:[l.error?(0,v.jsx)(rO.A,{paddingBottom:2,children:(0,v.jsx)(rF.b,{error:l.error,titleFormat:"markdown",title:l.error.message})}):null,(0,v.jsx)(rO.A,{paddingBottom:2,children:(0,v.jsx)(dP,{steps:c,activeStep:S,isComplete:l.completed,isError:!!l.error})}),(0,v.jsx)(T,{output:l.output}),f?(0,v.jsx)(rO.A,{paddingBottom:2,children:(0,v.jsx)(ni.A,{children:(0,v.jsx)(rO.A,{padding:2,children:(0,v.jsxs)("div",{className:a.buttonBar,children:[(0,v.jsx)(iF.A,{className:a.cancelButton,disabled:!I||"not-executed"!==P&&!C||!m,onClick:M,"data-testid":"cancel-button",children:h("ongoingTask.cancelButtonTitle")}),C&&(0,v.jsx)(iF.A,{className:a.retryButton,disabled:I||!E,onClick:O,"data-testid":"retry-button",children:h("ongoingTask.retryButtonTitle")}),(0,v.jsx)(iF.A,{className:a.logsVisibilityButton,color:"primary",variant:"outlined",onClick:()=>d(!u),children:h(u?"ongoingTask.hideLogsButtonTitle":"ongoingTask.showLogsButtonTitle")}),(0,v.jsx)(iF.A,{variant:"contained",color:"primary",disabled:I||!w,onClick:j,"data-testid":"start-over-button",children:h("ongoingTask.startOverButtonTitle")})]})})})}):null,u?(0,v.jsx)(ni.A,{style:{height:"100%"},children:(0,v.jsx)(rO.A,{padding:2,height:"100%",children:(0,v.jsx)(dI,{logs:l.stepLogs})})}):null]})]})}var dL=r(28966);let dF={"template.yaml":`
apiVersion: scaffolder.backstage.io/v1beta3
# https://backstage.io/docs/features/software-catalog/descriptor-format#kind-template
kind: Template
metadata:
  name: generated-example-template
  title: Scaffolder Example Template
  description: An example template for the scaffolder
spec:
  owner: user:guest
  type: service
  # These parameters are used to generate the input form in the frontend, and are
  # used to gather input data for the execution of the template.
  parameters:
    - title: Fill in some steps
      required:
        - name
      properties:
        name:
          title: Name
          type: string
          description: Unique name of the component
        owner:
          title: Owner
          type: string
          description: Owner of the component
          ui:field: OwnerPicker
          ui:options:
            catalogFilter:
              kind: Group
    - title: Choose a location
      required:
        - repoUrl
      properties:
        repoUrl:
          title: Repository Location
          type: string
          ui:field: RepoUrlPicker
          ui:options:
            allowedHosts:
              - github.com
  steps:
    - id: fetch-base
      name: Fetch Base
      action: fetch:template
      input:
        url: ./skeleton
        values:
          name: \${{parameters.name}}
          owner: \${{parameters.owner}}
          destination: \${{ parameters.repoUrl | parseRepoUrl }}`,"skeleton/README.md":"# This service is named ${{values.name}}!","skeleton/catalog-info.yaml":`apiVersion: backstage.io/v1alpha1
kind: Component
metadata:
  name: \${{values.component_id | dump}}
  {%- if values.description %}
  description: \${{values.description | dump}}
  {%- endif %}
  annotations:
    github.com/project-slug: \${{values.destination.owner + "/" + values.destination.repo}}
    backstage.io/techdocs-ref: dir:.
spec:
  type: service
  lifecycle: experimental
  owner: \${{values.owner | dump}}`};async function d_(e){for(let[t,r]of Object.entries(dF))await e.createFile({name:t,data:r});return e}let dB=function(){let e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(t=>{let r=()=>indexedDB.databases().finally(t);e=setInterval(r,100),r()}).finally(()=>clearInterval(e)):Promise.resolve()};function dz(e){return new Promise((t,r)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>r(e.error)})}function dW(){var e;let t;return i||(e="keyval",t=dB().then(()=>{let t=indexedDB.open("keyval-store");return t.onupgradeneeded=()=>t.result.createObjectStore(e),dz(t)}),i=(r,n)=>t.then(t=>n(t.transaction(e,r).objectStore(e)))),i}class dV{static key="scalfolder-template-editor-directory";static async getDirectory(){return(await function(e,t=dW()){return t("readonly",t=>dz(t.get(e)))}(dV.key)).handle}static async setDirectory(e){return function(e,t,r=dW()){return r("readwrite",r=>(r.put(t,e),dz(r.transaction)))}(dV.key,e)}}let dH=window.showDirectoryPicker;class dU{path;handle;constructor(e,t){this.path=e,this.handle=t}file(){return this.handle.getFile()}async save(e){let t=await this.handle.createWritable();await t.write(e),await t.close()}}class dq{handle;constructor(e){this.handle=e}async listFiles(){let e=[];for await(let t of this.listDirectoryContents(this.handle))e.push(t);return e}async *listDirectoryContents(e,t=[]){for await(let r of e.values())if("file"===r.kind)yield new dU([...t,r.name].join("/"),r);else if("directory"===r.kind){if(".git"===r.name)continue;yield*this.listDirectoryContents(r,[...t,r.name])}}async createFile(e){let t,{name:r,data:n}=e;if(r.includes("/")){let[e,n]=r.split("/"),i=await this.handle.getDirectoryHandle(e,{create:!0});t=await i.getFileHandle(n,{create:!0})}else t=await this.handle.getFileHandle(r,{create:!0});let i=await t.createWritable();await i.write(n),await i.close()}}class dK{static isSupported(){return!!dH}static fromHandle(e){return new dq(e)}static async requestDirectoryAccess(){if(!dH)throw Error("File system access is not supported");return new dq(await dH())}constructor(){}}function dG(){let{value:e,loading:t,error:r,retry:n}=(0,dL.A)(async()=>{let e=await dV.getDirectory();if(e)return dK.fromHandle(e)},[]),i=(0,tZ.useCallback)(()=>dK.requestDirectoryAccess().then(dV.setDirectory).then(n),[n]);return{directory:e,loading:t,error:r,openDirectory:i,createDirectory:(0,tZ.useCallback)(()=>dK.requestDirectoryAccess().then(d_).then(dV.setDirectory).then(n),[n]),closeDirectory:(0,tZ.useCallback)(()=>dV.setDirectory(void 0).then(n),[n])}}let dJ=e=>(e+1)%Number.MAX_SAFE_INTEGER;class dY{#s;#o;#l;#a;constructor(e,t){this.#s=e,this.#o=t}get path(){return this.#s.path}get content(){return this.#l??"This file is too large to be displayed"}updateContent(e){void 0!==this.#l&&(this.#l=e,this.#o())}get dirty(){return this.#l!==this.#a}async save(){void 0!==this.#l&&(await this.#s.save(this.#l),this.#a=this.#l,this.#o())}async reload(){let e=await this.#s.file();if(e.size>1048576){void 0!==this.#l&&(this.#l=void 0,this.#a=void 0,this.#o());return}let t=await e.text();this.#l!==t&&(this.#l=t,this.#a=t,this.#o())}}class dX{#s;#c=new Set;#h=[];#u;constructor(e){this.#s=e}get files(){return this.#h}get selectedFile(){return this.#u}setSelectedFile=e=>{let t=this.#u,r=this.#h.find(t=>t.path===e);t!==r&&(this.#u=r,this.#o())};get dirty(){return this.#h.some(e=>e.dirty)}async save(){await Promise.all(this.#h.map(e=>e.save()))}async reload(){let e=this.#u?.path,t=await this.#s.listFiles(),r=await Promise.all(t.map(async e=>{let t=new dY(e,this.#o);return await t.reload(),t}));this.#h.length=0,this.#h.push(...r),this.setSelectedFile(e),this.#o()}subscribe(e){return this.#c.add(e),()=>{this.#c.delete(e)}}#o=()=>{this.#c.forEach(e=>e())}}let dZ=(0,tZ.createContext)(void 0);function dQ(){let e=(0,tZ.useContext)(dZ),t=function(){let[,e]=(0,tZ.useState)(0);return(0,tZ.useCallback)(()=>{e(dJ)},[])}();return(0,tZ.useEffect)(()=>e?.subscribe(t),[e,t]),e}function d0(e){let{directory:t}=e,[{result:r,error:n},{execute:i}]=(0,b.Y)(async e=>{if(!e)return;let t=new dX(e);await t.reload();let r=t.files.find(e=>e.path.match(/\.ya?ml$/));return r&&t.setSelectedFile(r.path),t});return((0,tZ.useEffect)(()=>{i(t)},[i,t]),n)?(0,v.jsx)(rF.b,{error:n}):(0,v.jsx)(dZ.Provider,{value:r,children:e.children})}var d1=r(7031);let d2=(0,tZ.createContext)(null);d2.displayName="PanelGroupContext";let d4="data-panel-group-direction",d3="data-panel-group-id",d5="data-resize-handle",d6="data-panel-resize-handle-id",d9=tZ.useLayoutEffect,d8=tQ["useId".toString()],d7="function"==typeof d8?d8:()=>null,fe=0;function ft(e=null){let t=d7(),r=(0,tZ.useRef)(e||t||null);return null===r.current&&(r.current=""+fe++),null!=e?e:r.current}function fr({children:e,className:t="",collapsedSize:r,collapsible:n,defaultSize:i,forwardedRef:s,id:o,maxSize:l,minSize:a,onCollapse:c,onExpand:h,onResize:u,order:d,style:f,tagName:p="div",...m}){let g=(0,tZ.useContext)(d2);if(null===g)throw Error("Panel components must be rendered within a PanelGroup container");let{collapsePanel:y,expandPanel:v,getPanelSize:x,getPanelStyle:b,groupId:w,isPanelCollapsed:k,reevaluatePanelConstraints:A,registerPanel:S,resizePanel:C,unregisterPanel:E}=g,j=ft(o),O=(0,tZ.useRef)({callbacks:{onCollapse:c,onExpand:h,onResize:u},constraints:{collapsedSize:r,collapsible:n,defaultSize:i,maxSize:l,minSize:a},id:j,idIsFromProps:void 0!==o,order:d});(0,tZ.useRef)({didLogMissingDefaultSizeWarning:!1}),d9(()=>{let{callbacks:e,constraints:t}=O.current,s={...t};O.current.id=j,O.current.idIsFromProps=void 0!==o,O.current.order=d,e.onCollapse=c,e.onExpand=h,e.onResize=u,t.collapsedSize=r,t.collapsible=n,t.defaultSize=i,t.maxSize=l,t.minSize=a,(s.collapsedSize!==t.collapsedSize||s.collapsible!==t.collapsible||s.maxSize!==t.maxSize||s.minSize!==t.minSize)&&A(O.current,s)}),d9(()=>{let e=O.current;return S(e),()=>{E(e)}},[d,j,S,E]),(0,tZ.useImperativeHandle)(s,()=>({collapse:()=>{y(O.current)},expand:e=>{v(O.current,e)},getId:()=>j,getSize:()=>x(O.current),isCollapsed:()=>k(O.current),isExpanded:()=>!k(O.current),resize:e=>{C(O.current,e)}}),[y,v,x,k,j,C]);let P=b(O.current,i);return(0,tZ.createElement)(p,{...m,children:e,className:t,id:j,style:{...P,...f},[d3]:w,"data-panel":"","data-panel-collapsible":n||void 0,"data-panel-id":j,"data-panel-size":parseFloat(""+P.flexGrow).toFixed(1)})}let fn=(0,tZ.forwardRef)((e,t)=>(0,tZ.createElement)(fr,{...e,forwardedRef:t}));fr.displayName="Panel",fn.displayName="forwardRef(Panel)";let fi=null,fs=-1,fo=null;function fl(e,t,r){var n,i,o;let l=function(e,t,r){let n=(t&fy)!=0,i=(t&fv)!=0,s=(t&fx)!=0,o=(t&fb)!=0;if(t){if(n)if(s)return"se-resize";else if(o)return"ne-resize";else return"e-resize";else if(i)if(s)return"sw-resize";else if(o)return"nw-resize";else return"w-resize";else if(s)return"s-resize";else if(o)return"n-resize"}switch(e){case"horizontal":return"ew-resize";case"intersection":return"move";case"vertical":return"ns-resize"}}(e,t,0);fi!==l&&(fi=l,null===fo&&(fo=document.createElement("style"),s&&fo.setAttribute("nonce",s),document.head.appendChild(fo)),fs>=0&&(null==(o=fo.sheet)||o.removeRule(fs)),fs=null!=(n=null==(i=fo.sheet)?void 0:i.insertRule(`*{cursor: ${l} !important;}`))?n:-1)}function fa(e){return"keydown"===e.type}function fc(e){return e.type.startsWith("pointer")}function fh(e){return e.type.startsWith("mouse")}function fu(e){if(fc(e)){if(e.isPrimary)return{x:e.clientX,y:e.clientY}}else if(fh(e))return{x:e.clientX,y:e.clientY};return{x:1/0,y:1/0}}let fd=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function ff(e){let t=e.length;for(;t--;){let r=e[t];if(fR(r,"Missing node"),function(e){var t;let r,n=getComputedStyle(e);return"fixed"===n.position||!!("auto"!==n.zIndex&&("static"!==n.position||"flex"===(r=getComputedStyle(null!=(t=fg(e))?t:e).display)||"inline-flex"===r)||1>+n.opacity||"transform"in n&&"none"!==n.transform||"webkitTransform"in n&&"none"!==n.webkitTransform||"mixBlendMode"in n&&"normal"!==n.mixBlendMode||"filter"in n&&"none"!==n.filter||"webkitFilter"in n&&"none"!==n.webkitFilter||"isolation"in n&&"isolate"===n.isolation||fd.test(n.willChange))||"touch"===n.webkitOverflowScrolling}(r))return r}return null}function fp(e){return e&&Number(getComputedStyle(e).zIndex)||0}function fm(e){let t=[];for(;e;)t.push(e),e=fg(e);return t}function fg(e){let{parentNode:t}=e;return t&&t instanceof ShadowRoot?t.host:t}let fy=1,fv=2,fx=4,fb=8,fw="coarse"===function(){if("function"==typeof matchMedia)return matchMedia("(pointer:coarse)").matches?"coarse":"fine"}(),fk=[],fA=!1,fS=new Map,fC=new Map,fE=new Set;function fj(e){let{target:t}=e,{x:r,y:n}=fu(e);fA=!0,fT({target:t,x:r,y:n}),f$(),fk.length>0&&(fD("down",e),fI(),e.preventDefault(),fM(t)||e.stopImmediatePropagation())}function fO(e){let{x:t,y:r}=fu(e);if(fA&&"pointerleave"!==e.type&&0===e.buttons&&(fA=!1,fD("up",e)),!fA){let{target:n}=e;fT({target:n,x:t,y:r})}fD("move",e),fI(),fk.length>0&&e.preventDefault()}function fP(e){let{target:t}=e,{x:r,y:n}=fu(e);fC.clear(),fA=!1,fk.length>0&&(e.preventDefault(),fM(t)||e.stopImmediatePropagation()),fD("up",e),fT({target:t,x:r,y:n}),fI(),f$()}function fM(e){let t=e;for(;t;){if(t.hasAttribute(d5))return!0;t=t.parentElement}return!1}function fT({target:e,x:t,y:r}){fk.splice(0);let n=null;(e instanceof HTMLElement||e instanceof SVGElement)&&(n=e),fE.forEach(e=>{let{element:i,hitAreaMargins:s}=e,o=i.getBoundingClientRect(),{bottom:l,left:a,right:c,top:h}=o,u=fw?s.coarse:s.fine;if(t>=a-u&&t<=c+u&&r>=h-u&&r<=l+u){if(null!==n&&document.contains(n)&&i!==n&&!i.contains(n)&&!n.contains(i)&&function(e,t){let r;if(e===t)throw Error("Cannot compare node with itself");let n={a:fm(e),b:fm(t)};for(;n.a.at(-1)===n.b.at(-1);)e=n.a.pop(),t=n.b.pop(),r=e;fR(r,"Stacking order can only be calculated for elements with a common ancestor");let i={a:fp(ff(n.a)),b:fp(ff(n.b))};if(i.a===i.b){let e=r.childNodes,t={a:n.a.at(-1),b:n.b.at(-1)},i=e.length;for(;i--;){let r=e[i];if(r===t.a)return 1;if(r===t.b)return -1}}return Math.sign(i.a-i.b)}(n,i)>0){let e=n,t=!1;for(;e;){var d;if(e.contains(i))break;if(d=e.getBoundingClientRect(),d.x<o.x+o.width&&d.x+d.width>o.x&&d.y<o.y+o.height&&d.y+d.height>o.y){t=!0;break}e=e.parentElement}if(t)return}fk.push(e)}})}function fI(){let e=!1,t=!1;fk.forEach(r=>{let{direction:n}=r;"horizontal"===n?e=!0:t=!0});let r=0;fC.forEach(e=>{r|=e}),e&&t?fl("intersection",r,fA):e?fl("horizontal",r,fA):t?fl("vertical",r,fA):null!==fo&&(document.head.removeChild(fo),fi=null,fo=null,fs=-1)}function f$(){var e;null==(e=o)||e.abort();let t={capture:!0,signal:(o=new AbortController).signal};fE.size&&(fA?(fk.length>0&&fS.forEach((e,r)=>{let{body:n}=r;e>0&&(n.addEventListener("contextmenu",fP,t),n.addEventListener("pointerleave",fO,t),n.addEventListener("pointermove",fO,t))}),fS.forEach((e,r)=>{let{body:n}=r;n.addEventListener("pointerup",fP,t),n.addEventListener("pointercancel",fP,t)})):fS.forEach((e,r)=>{let{body:n}=r;e>0&&(n.addEventListener("pointerdown",fj,t),n.addEventListener("pointermove",fO,t))}))}function fD(e,t){fE.forEach(r=>{let{setResizeHandlerState:n}=r;n(e,fk.includes(r),t)})}function fR(e,t){if(!e)throw console.error(t),Error(t)}function fN(e,t,r=10){return e.toFixed(r)===t.toFixed(r)?0:e>t?1:-1}function fL(e,t,r=10){return 0===fN(e,t,r)}function fF(e,t,r){return 0===fN(e,t,r)}function f_({panelConstraints:e,panelIndex:t,size:r}){let n=e[t];fR(null!=n,`Panel constraints not found for index ${t}`);let{collapsedSize:i=0,collapsible:s,maxSize:o=100,minSize:l=0}=n;return 0>fN(r,l)&&(r=s&&0>fN(r,(i+l)/2)?i:l),r=parseFloat((r=Math.min(o,r)).toFixed(10))}function fB({delta:e,initialLayout:t,panelConstraints:r,pivotIndices:n,prevLayout:i,trigger:s}){if(fF(e,0))return t;let o=[...t],[l,a]=n;fR(null!=l,"Invalid first pivot index"),fR(null!=a,"Invalid second pivot index");let c=0;if("keyboard"===s){{let n=e<0?a:l,i=r[n];fR(i,`Panel constraints not found for index ${n}`);let{collapsedSize:s=0,collapsible:o,minSize:c=0}=i;if(o){let r=t[n];if(fR(null!=r,`Previous layout not found for panel index ${n}`),fF(r,s)){let t=c-r;fN(t,Math.abs(e))>0&&(e=e<0?0-t:t)}}}{let n=e<0?l:a,i=r[n];fR(i,`No panel constraints found for index ${n}`);let{collapsedSize:s=0,collapsible:o,minSize:c=0}=i;if(o){let r=t[n];if(fR(null!=r,`Previous layout not found for panel index ${n}`),fF(r,c)){let t=r-s;fN(t,Math.abs(e))>0&&(e=e<0?0-t:t)}}}}{let n=e<0?1:-1,i=e<0?a:l,s=0;for(;;){let e=t[i];if(fR(null!=e,`Previous layout not found for panel index ${i}`),s+=f_({panelConstraints:r,panelIndex:i,size:100})-e,(i+=n)<0||i>=r.length)break}let o=Math.min(Math.abs(e),Math.abs(s));e=e<0?0-o:o}{let n=e<0?l:a;for(;n>=0&&n<r.length;){let i=Math.abs(e)-Math.abs(c),s=t[n];fR(null!=s,`Previous layout not found for panel index ${n}`);let l=f_({panelConstraints:r,panelIndex:n,size:s-i});if(!fF(s,l)&&(c+=s-l,o[n]=l,c.toFixed(3).localeCompare(Math.abs(e).toFixed(3),void 0,{numeric:!0})>=0))break;e<0?n--:n++}}if(function(e,t,r){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!fF(e[r],t[r],void 0))return!1;return!0}(i,o))return i;{let n=e<0?a:l,i=t[n];fR(null!=i,`Previous layout not found for panel index ${n}`);let s=i+c,h=f_({panelConstraints:r,panelIndex:n,size:s});if(o[n]=h,!fF(h,s)){let t=s-h,n=e<0?a:l;for(;n>=0&&n<r.length;){let i=o[n];fR(null!=i,`Previous layout not found for panel index ${n}`);let s=f_({panelConstraints:r,panelIndex:n,size:i+t});if(fF(i,s)||(t-=s-i,o[n]=s),fF(t,0))break;e>0?n--:n++}}}return fF(o.reduce((e,t)=>t+e,0),100)?o:i}function fz(e,t=document){return Array.from(t.querySelectorAll(`[${d6}][data-panel-group-id="${e}"]`))}function fW(e,t,r=document){let n=fz(e,r).findIndex(e=>e.getAttribute(d6)===t);return null!=n?n:null}function fV(e,t,r){let n=fW(e,t,r);return null!=n?[n,n+1]:[-1,-1]}function fH(e,t=document){if((t instanceof HTMLElement||"object"==typeof t&&null!==t&&"tagName"in t&&"getAttribute"in t)&&t.dataset.panelGroupId==e)return t;let r=t.querySelector(`[data-panel-group][data-panel-group-id="${e}"]`);return r||null}function fU(e,t=document){let r=t.querySelector(`[${d6}="${e}"]`);return r||null}function fq(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function fK(e,t){let{x:r,y:n}=fu(t);return"horizontal"===e?r:n}function fG(e,t,r){t.forEach((t,n)=>{let i=e[n];fR(i,`Panel data not found for index ${n}`);let{callbacks:s,constraints:o,id:l}=i,{collapsedSize:a=0,collapsible:c}=o,h=r[l];if(null==h||t!==h){r[l]=t;let{onCollapse:e,onExpand:n,onResize:i}=s;i&&i(t,h),c&&(e||n)&&(n&&(null==h||fL(h,a))&&!fL(t,a)&&n(),e&&(null==h||!fL(h,a))&&fL(t,a)&&e())}})}function fJ(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!=t[r])return!1;return!0}function fY(e){try{if("undefined"!=typeof localStorage)e.getItem=e=>localStorage.getItem(e),e.setItem=(e,t)=>{localStorage.setItem(e,t)};else throw Error("localStorage not supported in this environment")}catch(t){console.error(t),e.getItem=()=>null,e.setItem=()=>{}}}function fX(e){return`react-resizable-panels:${e}`}function fZ(e){return e.map(e=>{let{constraints:t,id:r,idIsFromProps:n,order:i}=e;return n?r:i?`${i}:${JSON.stringify(t)}`:JSON.stringify(t)}).sort((e,t)=>e.localeCompare(t)).join(",")}function fQ(e,t){try{let r=fX(e),n=t.getItem(r);if(n){let e=JSON.parse(n);if("object"==typeof e&&null!=e)return e}}catch(e){}return null}function f0(e,t,r,n,i){var s;let o=fX(e),l=fZ(t),a=null!=(s=fQ(e,i))?s:{};a[l]={expandToSizes:Object.fromEntries(r.entries()),layout:n};try{i.setItem(o,JSON.stringify(a))}catch(e){console.error(e)}}function f1({layout:e,panelConstraints:t}){let r=[...e],n=r.reduce((e,t)=>e+t,0);if(r.length!==t.length)throw Error(`Invalid ${t.length} panel layout: ${r.map(e=>`${e}%`).join(", ")}`);if(!fF(n,100)&&r.length>0)for(let e=0;e<t.length;e++){let t=r[e];fR(null!=t,`No layout data found for index ${e}`);let i=100/n*t;r[e]=i}let i=0;for(let e=0;e<t.length;e++){let n=r[e];fR(null!=n,`No layout data found for index ${e}`);let s=f_({panelConstraints:t,panelIndex:e,size:n});n!=s&&(i+=n-s,r[e]=s)}if(!fF(i,0))for(let e=0;e<t.length;e++){let n=r[e];fR(null!=n,`No layout data found for index ${e}`);let s=f_({panelConstraints:t,panelIndex:e,size:n+i});if(n!==s&&(i-=s-n,r[e]=s,fF(i,0)))break}return r}let f2={getItem:e=>(fY(f2),f2.getItem(e)),setItem:(e,t)=>{fY(f2),f2.setItem(e,t)}},f4={};function f3({autoSaveId:e=null,children:t,className:r="",direction:n,forwardedRef:i,id:s=null,onLayout:o=null,keyboardResizeBy:l=null,storage:a=f2,style:c,tagName:h="div",...u}){let d=ft(s),f=(0,tZ.useRef)(null),[p,m]=(0,tZ.useState)(null),[g,y]=(0,tZ.useState)([]),v=function(){let[e,t]=(0,tZ.useState)(0);return(0,tZ.useCallback)(()=>t(e=>e+1),[])}(),x=(0,tZ.useRef)({}),b=(0,tZ.useRef)(new Map),w=(0,tZ.useRef)(0),k=(0,tZ.useRef)({autoSaveId:e,direction:n,dragState:p,id:d,keyboardResizeBy:l,onLayout:o,storage:a}),A=(0,tZ.useRef)({layout:g,panelDataArray:[],panelDataArrayChanged:!1});(0,tZ.useRef)({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),(0,tZ.useImperativeHandle)(i,()=>({getId:()=>k.current.id,getLayout:()=>{let{layout:e}=A.current;return e},setLayout:e=>{let{onLayout:t}=k.current,{layout:r,panelDataArray:n}=A.current,i=f1({layout:e,panelConstraints:n.map(e=>e.constraints)});fq(r,i)||(y(i),A.current.layout=i,t&&t(i),fG(n,i,x.current))}}),[]),d9(()=>{k.current.autoSaveId=e,k.current.direction=n,k.current.dragState=p,k.current.id=d,k.current.onLayout=o,k.current.storage=a}),function({committedValuesRef:e,eagerValuesRef:t,groupId:r,layout:n,panelDataArray:i,panelGroupElement:s,setLayout:o}){(0,tZ.useRef)({didWarnAboutMissingResizeHandle:!1}),d9(()=>{if(!s)return;let e=fz(r,s);for(let t=0;t<i.length-1;t++){let{valueMax:r,valueMin:s,valueNow:o}=function({layout:e,panelsArray:t,pivotIndices:r}){let n=0,i=100,s=0,o=0,l=r[0];return fR(null!=l,"No pivot index found"),t.forEach((e,t)=>{let{constraints:r}=e,{maxSize:a=100,minSize:c=0}=r;t===l?(n=c,i=a):(s+=c,o+=a)}),{valueMax:Math.min(i,100-s),valueMin:Math.max(n,100-o),valueNow:e[l]}}({layout:n,panelsArray:i,pivotIndices:[t,t+1]}),l=e[t];if(null==l);else{let e=i[t];fR(e,`No panel data found for index "${t}"`),l.setAttribute("aria-controls",e.id),l.setAttribute("aria-valuemax",""+Math.round(r)),l.setAttribute("aria-valuemin",""+Math.round(s)),l.setAttribute("aria-valuenow",null!=o?""+Math.round(o):"")}}return()=>{e.forEach((e,t)=>{e.removeAttribute("aria-controls"),e.removeAttribute("aria-valuemax"),e.removeAttribute("aria-valuemin"),e.removeAttribute("aria-valuenow")})}},[r,n,i,s]),(0,tZ.useEffect)(()=>{if(!s)return;let e=t.current;fR(e,"Eager values not found");let{panelDataArray:i}=e;fR(null!=fH(r,s),`No group found for id "${r}"`);let l=fz(r,s);fR(l,`No resize handles found for group id "${r}"`);let a=l.map(e=>{let t=e.getAttribute(d6);fR(t,"Resize handle element has no handle id attribute");let[l,a]=function(e,t,r,n=document){var i,s,o,l;let a=fU(t,n),c=fz(e,n),h=a?c.indexOf(a):-1;return[null!=(i=null==(s=r[h])?void 0:s.id)?i:null,null!=(o=null==(l=r[h+1])?void 0:l.id)?o:null]}(r,t,i,s);if(null==l||null==a)return()=>{};let c=e=>{if(!e.defaultPrevented&&"Enter"===e.key){e.preventDefault();let a=i.findIndex(e=>e.id===l);if(a>=0){let e=i[a];fR(e,`No panel data found for index ${a}`);let l=n[a],{collapsedSize:c=0,collapsible:h,minSize:u=0}=e.constraints;if(null!=l&&h){let e=fB({delta:fF(l,c)?u-c:c-l,initialLayout:n,panelConstraints:i.map(e=>e.constraints),pivotIndices:fV(r,t,s),prevLayout:n,trigger:"keyboard"});n!==e&&o(e)}}}};return e.addEventListener("keydown",c),()=>{e.removeEventListener("keydown",c)}});return()=>{a.forEach(e=>e())}},[s,e,t,r,n,i,o])}({committedValuesRef:k,eagerValuesRef:A,groupId:d,layout:g,panelDataArray:A.current.panelDataArray,setLayout:y,panelGroupElement:f.current}),(0,tZ.useEffect)(()=>{let{panelDataArray:t}=A.current;if(e){if(0===g.length||g.length!==t.length)return;let r=f4[e];null==r&&(r=function(e,t=10){let r=null;return(...n)=>{null!==r&&clearTimeout(r),r=setTimeout(()=>{e(...n)},t)}}(f0,100),f4[e]=r),r(e,[...t],new Map(b.current),g,a)}},[e,g,a]),(0,tZ.useEffect)(()=>{});let S=(0,tZ.useCallback)(e=>{let{onLayout:t}=k.current,{layout:r,panelDataArray:n}=A.current;if(e.constraints.collapsible){let i=n.map(e=>e.constraints),{collapsedSize:s=0,panelSize:o,pivotIndices:l}=f9(n,e,r);if(fR(null!=o,`Panel size not found for panel "${e.id}"`),!fL(o,s)){b.current.set(e.id,o);let a=fB({delta:f6(n,e)===n.length-1?o-s:s-o,initialLayout:r,panelConstraints:i,pivotIndices:l,prevLayout:r,trigger:"imperative-api"});fJ(r,a)||(y(a),A.current.layout=a,t&&t(a),fG(n,a,x.current))}}},[]),C=(0,tZ.useCallback)((e,t)=>{let{onLayout:r}=k.current,{layout:n,panelDataArray:i}=A.current;if(e.constraints.collapsible){let s=i.map(e=>e.constraints),{collapsedSize:o=0,panelSize:l=0,minSize:a=0,pivotIndices:c}=f9(i,e,n),h=null!=t?t:a;if(fL(l,o)){let t=b.current.get(e.id),o=null!=t&&t>=h?t:h,a=fB({delta:f6(i,e)===i.length-1?l-o:o-l,initialLayout:n,panelConstraints:s,pivotIndices:c,prevLayout:n,trigger:"imperative-api"});fJ(n,a)||(y(a),A.current.layout=a,r&&r(a),fG(i,a,x.current))}}},[]),E=(0,tZ.useCallback)(e=>{let{layout:t,panelDataArray:r}=A.current,{panelSize:n}=f9(r,e,t);return fR(null!=n,`Panel size not found for panel "${e.id}"`),n},[]),j=(0,tZ.useCallback)((e,t)=>{let{panelDataArray:r}=A.current,n=f6(r,e);return function({defaultSize:e,dragState:t,layout:r,panelData:n,panelIndex:i,precision:s=3}){let o=r[i];return{flexBasis:0,flexGrow:null==o?void 0!=e?e.toFixed(s):"1":1===n.length?"1":o.toFixed(s),flexShrink:1,overflow:"hidden",pointerEvents:null!==t?"none":void 0}}({defaultSize:t,dragState:p,layout:g,panelData:r,panelIndex:n})},[p,g]),O=(0,tZ.useCallback)(e=>{let{layout:t,panelDataArray:r}=A.current,{collapsedSize:n=0,collapsible:i,panelSize:s}=f9(r,e,t);return fR(null!=s,`Panel size not found for panel "${e.id}"`),!0===i&&fL(s,n)},[]),P=(0,tZ.useCallback)(e=>{let{layout:t,panelDataArray:r}=A.current,{collapsedSize:n=0,collapsible:i,panelSize:s}=f9(r,e,t);return fR(null!=s,`Panel size not found for panel "${e.id}"`),!i||fN(s,n)>0},[]),M=(0,tZ.useCallback)(e=>{let{panelDataArray:t}=A.current;t.push(e),t.sort((e,t)=>{let r=e.order,n=t.order;return null==r&&null==n?0:null==r?-1:null==n?1:r-n}),A.current.panelDataArrayChanged=!0,v()},[v]);d9(()=>{if(A.current.panelDataArrayChanged){A.current.panelDataArrayChanged=!1;let{autoSaveId:r,onLayout:n,storage:i}=k.current,{layout:s,panelDataArray:o}=A.current,l=null;if(r){var e,t;let n=null!=(t=(null!=(e=fQ(r,i))?e:{})[fZ(o)])?t:null;n&&(b.current=new Map(Object.entries(n.expandToSizes)),l=n.layout)}null==l&&(l=function({panelDataArray:e}){let t=Array(e.length),r=e.map(e=>e.constraints),n=0,i=100;for(let s=0;s<e.length;s++){let e=r[s];fR(e,`Panel constraints not found for index ${s}`);let{defaultSize:o}=e;null!=o&&(n++,t[s]=o,i-=o)}for(let s=0;s<e.length;s++){let o=r[s];fR(o,`Panel constraints not found for index ${s}`);let{defaultSize:l}=o;if(null!=l)continue;let a=i/(e.length-n);n++,t[s]=a,i-=a}return t}({panelDataArray:o}));let a=f1({layout:l,panelConstraints:o.map(e=>e.constraints)});fq(s,a)||(y(a),A.current.layout=a,n&&n(a),fG(o,a,x.current))}}),d9(()=>{let e=A.current;return()=>{e.layout=[]}},[]);let T=(0,tZ.useCallback)(e=>{let t=!1,r=f.current;return r&&"rtl"===window.getComputedStyle(r,null).getPropertyValue("direction")&&(t=!0),function(r){var n,i;r.preventDefault();let s=f.current;if(!s)return()=>null;let{direction:o,dragState:l,id:a,keyboardResizeBy:c,onLayout:h}=k.current,{layout:u,panelDataArray:d}=A.current,{initialLayout:p}=null!=l?l:{},m=fV(a,e,s),g=function(e,t,r,n,i,s){if(fa(e)){let t="horizontal"===r,n=0;n=e.shiftKey?100:null!=i?i:10;let s=0;switch(e.key){case"ArrowDown":s=t?0:n;break;case"ArrowLeft":s=t?-n:0;break;case"ArrowRight":s=t?n:0;break;case"ArrowUp":s=t?0:-n;break;case"End":s=100;break;case"Home":s=-100}return s}return null==n?0:function(e,t,r,n,i){let s="horizontal"===r,o=fU(t,i);fR(o,`No resize handle element found for id "${t}"`);let l=o.getAttribute(d3);fR(l,"Resize handle element has no group id attribute");let{initialCursorPosition:a}=n,c=fK(r,e),h=fH(l,i);fR(h,`No group element found for id "${l}"`);let u=h.getBoundingClientRect();return(c-a)/(s?u.width:u.height)*100}(e,t,r,n,s)}(r,e,o,l,c,s),v="horizontal"===o;v&&t&&(g=-g);let b=fB({delta:g,initialLayout:null!=p?p:u,panelConstraints:d.map(e=>e.constraints),pivotIndices:m,prevLayout:u,trigger:fa(r)?"keyboard":"mouse-or-touch"}),S=!fJ(u,b);(fc(r)||fh(r))&&w.current!=g&&((w.current=g,S||0===g)?fC.set(e,0):v?(n=g<0?fy:fv,fC.set(e,n)):(i=g<0?fx:fb,fC.set(e,i))),S&&(y(b),A.current.layout=b,h&&h(b),fG(d,b,x.current))}},[]),I=(0,tZ.useCallback)((e,t)=>{let{onLayout:r}=k.current,{layout:n,panelDataArray:i}=A.current,s=i.map(e=>e.constraints),{panelSize:o,pivotIndices:l}=f9(i,e,n);fR(null!=o,`Panel size not found for panel "${e.id}"`);let a=fB({delta:f6(i,e)===i.length-1?o-t:t-o,initialLayout:n,panelConstraints:s,pivotIndices:l,prevLayout:n,trigger:"imperative-api"});fJ(n,a)||(y(a),A.current.layout=a,r&&r(a),fG(i,a,x.current))},[]),$=(0,tZ.useCallback)((e,t)=>{let{layout:r,panelDataArray:n}=A.current,{collapsedSize:i=0,collapsible:s}=t,{collapsedSize:o=0,collapsible:l,maxSize:a=100,minSize:c=0}=e.constraints,{panelSize:h}=f9(n,e,r);null!=h&&(s&&l&&fL(h,i)?fL(i,o)||I(e,o):h<c?I(e,c):h>a&&I(e,a))},[I]),D=(0,tZ.useCallback)((e,t)=>{let{direction:r}=k.current,{layout:n}=A.current;if(!f.current)return;let i=fU(e,f.current);fR(i,`Drag handle element not found for id "${e}"`);let s=fK(r,t);m({dragHandleId:e,dragHandleRect:i.getBoundingClientRect(),initialCursorPosition:s,initialLayout:n})},[]),R=(0,tZ.useCallback)(()=>{m(null)},[]),N=(0,tZ.useCallback)(e=>{let{panelDataArray:t}=A.current,r=f6(t,e);r>=0&&(t.splice(r,1),delete x.current[e.id],A.current.panelDataArrayChanged=!0,v())},[v]),L=(0,tZ.useMemo)(()=>({collapsePanel:S,direction:n,dragState:p,expandPanel:C,getPanelSize:E,getPanelStyle:j,groupId:d,isPanelCollapsed:O,isPanelExpanded:P,reevaluatePanelConstraints:$,registerPanel:M,registerResizeHandle:T,resizePanel:I,startDragging:D,stopDragging:R,unregisterPanel:N,panelGroupElement:f.current}),[S,p,n,C,E,j,d,O,P,$,M,T,I,D,R,N]);return(0,tZ.createElement)(d2.Provider,{value:L},(0,tZ.createElement)(h,{...u,children:t,className:r,id:s,ref:f,style:{display:"flex",flexDirection:"horizontal"===n?"row":"column",height:"100%",overflow:"hidden",width:"100%",...c},"data-panel-group":"",[d4]:n,[d3]:d}))}let f5=(0,tZ.forwardRef)((e,t)=>(0,tZ.createElement)(f3,{...e,forwardedRef:t}));function f6(e,t){return e.findIndex(e=>e===t||e.id===t.id)}function f9(e,t,r){let n=f6(e,t),i=n===e.length-1,s=r[n];return{...t.constraints,panelSize:s,pivotIndices:i?[n-1,n]:[n,n+1]}}function f8({children:e=null,className:t="",disabled:r=!1,hitAreaMargins:n,id:i,onBlur:s,onClick:o,onDragging:l,onFocus:a,onPointerDown:c,onPointerUp:h,style:u={},tabIndex:d=0,tagName:f="div",...p}){var m,g;let y=(0,tZ.useRef)(null),v=(0,tZ.useRef)({onClick:o,onDragging:l,onPointerDown:c,onPointerUp:h});(0,tZ.useEffect)(()=>{v.current.onClick=o,v.current.onDragging=l,v.current.onPointerDown=c,v.current.onPointerUp=h});let x=(0,tZ.useContext)(d2);if(null===x)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");let{direction:b,groupId:w,registerResizeHandle:k,startDragging:A,stopDragging:S,panelGroupElement:C}=x,E=ft(i),[j,O]=(0,tZ.useState)("inactive"),[P,M]=(0,tZ.useState)(!1),[T,I]=(0,tZ.useState)(null),$=(0,tZ.useRef)({state:j});d9(()=>{$.current.state=j}),(0,tZ.useEffect)(()=>{if(r)I(null);else{let e=k(E);I(()=>e)}},[r,E,k]);let D=null!=(m=null==n?void 0:n.coarse)?m:15,R=null!=(g=null==n?void 0:n.fine)?g:5;return(0,tZ.useEffect)(()=>{if(r||null==T)return;let e=y.current;fR(e,"Element ref not attached");let t=!1;return function(e,t,r,n,i){var s;let{ownerDocument:o}=t,l={direction:r,element:t,hitAreaMargins:n,setResizeHandlerState:i},a=null!=(s=fS.get(o))?s:0;return fS.set(o,a+1),fE.add(l),f$(),function(){var t;fC.delete(e),fE.delete(l);let r=null!=(t=fS.get(o))?t:1;if(fS.set(o,r-1),f$(),1===r&&fS.delete(o),fk.includes(l)){let e=fk.indexOf(l);e>=0&&fk.splice(e,1),fI(),i("up",!0,null)}}}(E,e,b,{coarse:D,fine:R},(e,r,n)=>{if(!r)return void O("inactive");switch(e){case"down":{O("drag"),t=!1,fR(n,'Expected event to be defined for "down" action'),A(E,n);let{onDragging:e,onPointerDown:r}=v.current;null==e||e(!0),null==r||r();break}case"move":{let{state:e}=$.current;t=!0,"drag"!==e&&O("hover"),fR(n,'Expected event to be defined for "move" action'),T(n);break}case"up":{O("hover"),S();let{onClick:e,onDragging:r,onPointerUp:n}=v.current;null==r||r(!1),null==n||n(),t||null==e||e()}}})},[D,b,r,R,k,E,T,A,S]),!function({disabled:e,handleId:t,resizeHandler:r,panelGroupElement:n}){(0,tZ.useEffect)(()=>{if(e||null==r||null==n)return;let i=fU(t,n);if(null==i)return;let s=e=>{if(!e.defaultPrevented)switch(e.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":e.preventDefault(),r(e);break;case"F6":{e.preventDefault();let r=i.getAttribute(d3);fR(r,`No group element found for id "${r}"`);let s=fz(r,n),o=fW(r,t,n);fR(null!==o,`No resize element found for id "${t}"`);let l=e.shiftKey?o>0?o-1:s.length-1:o+1<s.length?o+1:0;s[l].focus()}}};return i.addEventListener("keydown",s),()=>{i.removeEventListener("keydown",s)}},[n,e,t,r])}({disabled:r,handleId:E,resizeHandler:T,panelGroupElement:C}),(0,tZ.createElement)(f,{...p,children:e,className:t,id:i,onBlur:()=>{M(!1),null==s||s()},onFocus:()=>{M(!0),null==a||a()},ref:y,role:"separator",style:{touchAction:"none",userSelect:"none",...u},tabIndex:d,[d4]:b,[d3]:w,[d5]:"","data-resize-handle-active":"drag"===j?"pointer":P?"keyboard":void 0,"data-panel-resize-handle-enabled":!r,[d6]:E,"data-resize-handle-state":j})}f3.displayName="PanelGroup",f5.displayName="forwardRef(PanelGroup)",f8.displayName="PanelResizeHandle";let f7=(0,d1.A)(e=>({root:{height:"100%",gridArea:"pageContent",display:"grid",gridTemplateAreas:`
      "toolbar"
      "browser"
      "editor"
      "preview"
      "results"
    `,[e.breakpoints.up("md")]:{gridTemplateAreas:`
      "toolbar toolbar toolbar"
      "browser editor preview"
      "results results results"
    `,gridTemplateColumns:"1fr 5fr",gridTemplateRows:"auto 1fr auto"}}}),{name:"ScaffolderTemplateEditorLayout"})(({children:e,classes:t})=>(0,v.jsx)("main",{className:t.root,children:e})),pe=(0,d1.A)({root:{gridArea:"toolbar"}},{name:"ScaffolderTemplateEditorLayoutToolbar"})(({children:e,classes:t})=>(0,v.jsx)("section",{className:t.root,children:e})),pt=(0,d1.A)(e=>({root:{gridArea:"browser",overflow:"auto",[e.breakpoints.up("md")]:{borderRight:`1px solid ${e.palette.divider}`}}}),{name:"ScaffolderTemplateEditorLayoutBrowser"})(({children:e,classes:t})=>(0,v.jsx)("section",{className:t.root,children:e})),pr=(0,d1.A)(e=>({root:{gridArea:"editor",overflow:"auto",[e.breakpoints.up("md")]:{height:"100%"}}}),{name:"ScaffolderTemplateEditorLayoutFiles"})(({children:e,classes:t})=>(0,v.jsx)("section",{className:t.root,children:e})),pn=(0,d1.A)(e=>({root:{gridArea:"preview",position:"relative",backgroundColor:e.palette.background.default,[e.breakpoints.up("md")]:{height:"100%"}},scroll:{height:"100%",padding:e.spacing(1),[e.breakpoints.up("md")]:{position:"absolute",top:0,left:0,right:0,bottom:0,overflow:"auto"}}}),{name:"ScaffolderTemplateEditorLayoutPreview"})(({children:e,classes:t})=>(0,v.jsx)("section",{className:t.root,children:(0,v.jsx)("div",{className:t.scroll,children:e})})),pi=(0,d1.A)({root:{gridArea:"results"}},{name:"ScaffolderTemplateEditorLayoutConsole"})(({children:e,classes:t})=>(0,v.jsx)("section",{className:t.root,children:e})),ps=(0,d1.A)({root:{width:8,cursor:"col-resize",background:"rgba(0,0,0,0.04)"}},{name:"ScaffolderTemplateEditorPanelResizeHandle"})(({classes:e})=>(0,v.jsx)(f8,{className:e.root}));function po({files:e,preview:t,autoSaveId:r="template-editor-panels"}){let n=(0,ik.A)();return(0,iq.A)(n.breakpoints.up("md"))?(0,v.jsxs)(f5,{direction:"horizontal",autoSaveId:r,children:[(0,v.jsx)(fn,{minSize:15,defaultSize:50,children:e}),(0,v.jsx)(ps,{}),(0,v.jsx)(fn,{minSize:15,defaultSize:50,children:t})]}):(0,v.jsxs)(v.Fragment,{children:[e,t]})}var pl=r(16679),pa=r(75173),pc=r(91413),ph=r(73845),pu=r(76891),pd=r(61477),pf=r(46805),pp=r(59461),pm=r(93453),pg=r(17400),py=r(64402),pv=r(89575),px=r(17502);let pb=[],pw=[],pk="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,t=0;e<pk.length;e++)(e%2?pw:pb).push(t+=pk[e]);function pA(e){return e>=127462&&e<=127487}function pS(e,t,r){if(t==e.length)return t;t&&pE(e.charCodeAt(t))&&pj(e.charCodeAt(t-1))&&t--;let n=pC(e,t);for(t+=pO(n);t<e.length;){let i=pC(e,t);if(8205==n||8205==i||r&&function(e){if(e<768)return!1;for(let t=0,r=pb.length;;){let n=t+r>>1;if(e<pb[n])r=n;else{if(!(e>=pw[n]))return!0;t=n+1}if(t==r)return!1}}(i))t+=pO(i),n=i;else if(pA(i)){let r=0,n=t-2;for(;n>=0&&pA(pC(e,n));)r++,n-=2;if(r%2==0)break;t+=2}else break}return t}function pC(e,t){let r=e.charCodeAt(t);if(!pj(r)||t+1==e.length)return r;let n=e.charCodeAt(t+1);return pE(n)?(r-55296<<10)+(n-56320)+65536:r}function pE(e){return e>=56320&&e<57344}function pj(e){return e>=55296&&e<56320}function pO(e){return e<65536?1:2}class pP{lineAt(e){if(e<0||e>this.length)throw RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,r){[e,t]=pL(this,e,t);let n=[];return this.decompose(0,e,n,2),r.length&&r.decompose(0,r.length,n,3),this.decompose(t,this.length,n,1),pT.from(n,this.length-(t-e)+r.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=pL(this,e,t);let r=[];return this.decompose(e,t,r,0),pT.from(r,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),r=this.length-this.scanIdentical(e,-1),n=new p$(this),i=new p$(e);for(let e=t,s=t;;){if(n.next(e),i.next(e),e=0,n.lineBreak!=i.lineBreak||n.done!=i.done||n.value!=i.value)return!1;if(s+=n.value.length,n.done||s>=r)return!0}}iter(e=1){return new p$(this,e)}iterRange(e,t=this.length){return new pD(this,e,t)}iterLines(e,t){let r;if(null==e)r=this.iter();else{null==t&&(t=this.lines+1);let n=this.line(e).from;r=this.iterRange(n,Math.max(n,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new pR(r)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(0==e.length)throw RangeError("A document must have at least one line");return 1!=e.length||e[0]?e.length<=32?new pM(e):pT.from(pM.split(e,[])):pP.empty}}class pM extends pP{constructor(e,t=function(e){let t=-1;for(let r of e)t+=r.length+1;return t}(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,r,n){for(let i=0;;i++){let s=this.text[i],o=n+s.length;if((t?r:o)>=e)return new pN(n,o,r,s);n=o+1,r++}}decompose(e,t,r,n){var i;let s=e<=0&&t>=this.length?this:new pM((i=this.text,pI(i,[""],e,t)),Math.min(t,this.length)-Math.max(0,e));if(1&n){let e=r.pop(),t=pI(s.text,e.text.slice(),0,s.length);if(t.length<=32)r.push(new pM(t,e.length+s.length));else{let e=t.length>>1;r.push(new pM(t.slice(0,e)),new pM(t.slice(e)))}}else r.push(s)}replace(e,t,r){var n;if(!(r instanceof pM))return super.replace(e,t,r);[e,t]=pL(this,e,t);let i=pI(this.text,pI(r.text,(n=this.text,pI(n,[""],0,e))),t),s=this.length+r.length-(t-e);return i.length<=32?new pM(i,s):pT.from(pM.split(i,[]),s)}sliceString(e,t=this.length,r="\n"){[e,t]=pL(this,e,t);let n="";for(let i=0,s=0;i<=t&&s<this.text.length;s++){let o=this.text[s],l=i+o.length;i>e&&s&&(n+=r),e<l&&t>i&&(n+=o.slice(Math.max(0,e-i),t-i)),i=l+1}return n}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let r=[],n=-1;for(let i of e)r.push(i),n+=i.length+1,32==r.length&&(t.push(new pM(r,n)),r=[],n=-1);return n>-1&&t.push(new pM(r,n)),t}}class pT extends pP{constructor(e,t){for(let r of(super(),this.children=e,this.length=t,this.lines=0,e))this.lines+=r.lines}lineInner(e,t,r,n){for(let i=0;;i++){let s=this.children[i],o=n+s.length,l=r+s.lines-1;if((t?l:o)>=e)return s.lineInner(e,t,r,n);n=o+1,r=l+1}}decompose(e,t,r,n){for(let i=0,s=0;s<=t&&i<this.children.length;i++){let o=this.children[i],l=s+o.length;if(e<=l&&t>=s){let i=n&(s<=e|2*(l>=t));s>=e&&l<=t&&!i?r.push(o):o.decompose(e-s,t-s,r,i)}s=l+1}}replace(e,t,r){if([e,t]=pL(this,e,t),r.lines<this.lines)for(let n=0,i=0;n<this.children.length;n++){let s=this.children[n],o=i+s.length;if(e>=i&&t<=o){let l=s.replace(e-i,t-i,r),a=this.lines-s.lines+l.lines;if(l.lines<a>>4&&l.lines>a>>6){let i=this.children.slice();return i[n]=l,new pT(i,this.length-(t-e)+r.length)}return super.replace(i,o,l)}i=o+1}return super.replace(e,t,r)}sliceString(e,t=this.length,r="\n"){[e,t]=pL(this,e,t);let n="";for(let i=0,s=0;i<this.children.length&&s<=t;i++){let o=this.children[i],l=s+o.length;s>e&&i&&(n+=r),e<l&&t>s&&(n+=o.sliceString(e-s,t-s,r)),s=l+1}return n}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof pT))return 0;let r=0,[n,i,s,o]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;n+=t,i+=t){if(n==s||i==o)return r;let l=this.children[n],a=e.children[i];if(l!=a)return r+l.scanIdentical(a,t);r+=l.length+1}}static from(e,t=e.reduce((e,t)=>e+t.length+1,-1)){let r=0;for(let t of e)r+=t.lines;if(r<32){let r=[];for(let t of e)t.flatten(r);return new pM(r,t)}let n=Math.max(32,r>>5),i=n<<1,s=n>>1,o=[],l=0,a=-1,c=[];function h(){0!=l&&(o.push(1==c.length?c[0]:pT.from(c,a)),a=-1,l=c.length=0)}for(let t of e)!function e(t){let r;if(t.lines>i&&t instanceof pT)for(let r of t.children)e(r);else t.lines>s&&(l>s||!l)?(h(),o.push(t)):t instanceof pM&&l&&(r=c[c.length-1])instanceof pM&&t.lines+r.lines<=32?(l+=t.lines,a+=t.length+1,c[c.length-1]=new pM(r.text.concat(t.text),r.length+1+t.length)):(l+t.lines>n&&h(),l+=t.lines,a+=t.length+1,c.push(t))}(t);return h(),1==o.length?o[0]:new pT(o,t)}}function pI(e,t,r=0,n=1e9){for(let i=0,s=0,o=!0;s<e.length&&i<=n;s++){let l=e[s],a=i+l.length;a>=r&&(a>n&&(l=l.slice(0,n-i)),i<r&&(l=l.slice(r-i)),o?(t[t.length-1]+=l,o=!1):t.push(l)),i=a+1}return t}pP.empty=new pM([""],0);class p${constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof pM?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let r=this.nodes.length-1,n=this.nodes[r],i=this.offsets[r],s=i>>1,o=n instanceof pM?n.text.length:n.children.length;if(s==(t>0?o:0)){if(0==r)return this.done=!0,this.value="",this;t>0&&this.offsets[r-1]++,this.nodes.pop(),this.offsets.pop()}else if((1&i)==(t>0?0:1)){if(this.offsets[r]+=t,0==e)return this.lineBreak=!0,this.value="\n",this;e--}else if(n instanceof pM){let i=n.text[s+(t<0?-1:0)];if(this.offsets[r]+=t,i.length>Math.max(0,e))return this.value=0==e?i:t>0?i.slice(e):i.slice(0,i.length-e),this;e-=i.length}else{let i=n.children[s+(t<0?-1:0)];e>i.length?(e-=i.length,this.offsets[r]+=t):(t<0&&this.offsets[r]--,this.nodes.push(i),this.offsets.push(t>0?1:(i instanceof pM?i.text.length:i.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class pD{constructor(e,t,r){this.value="",this.done=!1,this.cursor=new p$(e,t>r?-1:1),this.pos=t>r?e.length:0,this.from=Math.min(t,r),this.to=Math.max(t,r)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let r=t<0?this.pos-this.from:this.to-this.pos;e>r&&(e=r),r-=e;let{value:n}=this.cursor.next(e);return this.pos+=(n.length+e)*t,this.value=n.length<=r?n:t<0?n.slice(n.length-r):n.slice(0,r),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&""!=this.value}}class pR{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:r,value:n}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):r?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=n,this.afterBreak=!1),this}get lineBreak(){return!1}}"undefined"!=typeof Symbol&&(pP.prototype[Symbol.iterator]=function(){return this.iter()},p$.prototype[Symbol.iterator]=pD.prototype[Symbol.iterator]=pR.prototype[Symbol.iterator]=function(){return this});class pN{constructor(e,t,r,n){this.from=e,this.to=t,this.number=r,this.text=n}get length(){return this.to-this.from}}function pL(e,t,r){return[t=Math.max(0,Math.min(e.length,t)),Math.max(t,Math.min(e.length,r))]}function pF(e,t,r=!0,n=!0){return function(e,t,r=!0,n=!0){return(r?pS:function(e,t,r){for(;t>0;){let n=pS(e,t-2,r);if(n<t)return n;t--}return 0})(e,t,n)}(e,t,r,n)}function p_(e,t){let r=e.charCodeAt(t);if(!(r>=55296&&r<56320)||t+1==e.length)return r;let n=e.charCodeAt(t+1);return n>=56320&&n<57344?(r-55296<<10)+(n-56320)+65536:r}function pB(e){return e<=65535?String.fromCharCode(e):String.fromCharCode(((e-=65536)>>10)+55296,(1023&e)+56320)}function pz(e){return e<65536?1:2}let pW=/\r\n?|\n/;var pV=((c=pV||(pV={}))[c.Simple=0]="Simple",c[c.TrackDel=1]="TrackDel",c[c.TrackBefore=2]="TrackBefore",c[c.TrackAfter=3]="TrackAfter",c);class pH{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let r=this.sections[t+1];e+=r<0?this.sections[t]:r}return e}get empty(){return 0==this.sections.length||2==this.sections.length&&this.sections[1]<0}iterGaps(e){for(let t=0,r=0,n=0;t<this.sections.length;){let i=this.sections[t++],s=this.sections[t++];s<0?(e(r,n,i),n+=i):n+=s,r+=i}}iterChangedRanges(e,t=!1){pG(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let r=this.sections[t++],n=this.sections[t++];n<0?e.push(r,n):e.push(n,r)}return new pH(e)}composeDesc(e){return this.empty?e:e.empty?this:pY(this,e)}mapDesc(e,t=!1){return e.empty?this:pJ(this,e,t)}mapPos(e,t=-1,r=pV.Simple){let n=0,i=0;for(let s=0;s<this.sections.length;){let o=this.sections[s++],l=this.sections[s++],a=n+o;if(l<0){if(a>e)return i+(e-n);i+=o}else{if(r!=pV.Simple&&a>=e&&(r==pV.TrackDel&&n<e&&a>e||r==pV.TrackBefore&&n<e||r==pV.TrackAfter&&a>e))return null;if(a>e||a==e&&t<0&&!o)return e==n||t<0?i:i+l;i+=l}n=a}if(e>n)throw RangeError(`Position ${e} is out of range for changeset of length ${n}`);return i}touchesRange(e,t=e){for(let r=0,n=0;r<this.sections.length&&n<=t;){let i=this.sections[r++],s=this.sections[r++],o=n+i;if(s>=0&&n<=t&&o>=e)return!(n<e)||!(o>t)||"cover";n=o}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let r=this.sections[t++],n=this.sections[t++];e+=(e?" ":"")+r+(n>=0?":"+n:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(e=>"number"!=typeof e))throw RangeError("Invalid JSON representation of ChangeDesc");return new pH(e)}static create(e){return new pH(e)}}class pU extends pH{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw RangeError("Applying change set to a document with the wrong length");return pG(this,(t,r,n,i,s)=>e=e.replace(n,n+(r-t),s),!1),e}mapDesc(e,t=!1){return pJ(this,e,t,!0)}invert(e){let t=this.sections.slice(),r=[];for(let n=0,i=0;n<t.length;n+=2){let s=t[n],o=t[n+1];if(o>=0){t[n]=o,t[n+1]=s;let l=n>>1;for(;r.length<l;)r.push(pP.empty);r.push(s?e.slice(i,i+s):pP.empty)}i+=s}return new pU(t,r)}compose(e){return this.empty?e:e.empty?this:pY(this,e,!0)}map(e,t=!1){return e.empty?this:pJ(this,e,t,!0)}iterChanges(e,t=!1){pG(this,e,t)}get desc(){return pH.create(this.sections)}filter(e){let t=[],r=[],n=[],i=new pX(this);e:for(let s=0,o=0;;){let l=s==e.length?1e9:e[s++];for(;o<l||o==l&&0==i.len;){if(i.done)break e;let e=Math.min(i.len,l-o);pq(n,e,-1);let s=-1==i.ins?-1:0==i.off?i.ins:0;pq(t,e,s),s>0&&pK(r,t,i.text),i.forward(e),o+=e}let a=e[s++];for(;o<a;){if(i.done)break e;let e=Math.min(i.len,a-o);pq(t,e,-1),pq(n,e,-1==i.ins?-1:0==i.off?i.ins:0),i.forward(e),o+=e}}return{changes:new pU(t,r),filtered:pH.create(n)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let r=this.sections[t],n=this.sections[t+1];n<0?e.push(r):0==n?e.push([r]):e.push([r].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,r){let n=[],i=[],s=0,o=null;function l(e=!1){if(!e&&!n.length)return;s<t&&pq(n,t-s,-1);let r=new pU(n,i);o=o?o.compose(r.map(o)):r,n=[],i=[],s=0}return!function e(a){if(Array.isArray(a))for(let t of a)e(t);else if(a instanceof pU){if(a.length!=t)throw RangeError(`Mismatched change set length (got ${a.length}, expected ${t})`);l(),o=o?o.compose(a.map(o)):a}else{let{from:e,to:o=e,insert:c}=a;if(e>o||e<0||o>t)throw RangeError(`Invalid change range ${e} to ${o} (in doc of length ${t})`);let h=c?"string"==typeof c?pP.of(c.split(r||pW)):c:pP.empty,u=h.length;if(e==o&&0==u)return;e<s&&l(),e>s&&pq(n,e-s,-1),pq(n,o-e,u),pK(i,n,h),s=o}}(e),l(!o),o}static empty(e){return new pU(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw RangeError("Invalid JSON representation of ChangeSet");let t=[],r=[];for(let n=0;n<e.length;n++){let i=e[n];if("number"==typeof i)t.push(i,-1);else if(!Array.isArray(i)||"number"!=typeof i[0]||i.some((e,t)=>t&&"string"!=typeof e))throw RangeError("Invalid JSON representation of ChangeSet");else if(1==i.length)t.push(i[0],0);else{for(;r.length<n;)r.push(pP.empty);r[n]=pP.of(i.slice(1)),t.push(i[0],r[n].length)}}return new pU(t,r)}static createSet(e,t){return new pU(e,t)}}function pq(e,t,r,n=!1){if(0==t&&r<=0)return;let i=e.length-2;i>=0&&r<=0&&r==e[i+1]?e[i]+=t:i>=0&&0==t&&0==e[i]?e[i+1]+=r:n?(e[i]+=t,e[i+1]+=r):e.push(t,r)}function pK(e,t,r){if(0==r.length)return;let n=t.length-2>>1;if(n<e.length)e[e.length-1]=e[e.length-1].append(r);else{for(;e.length<n;)e.push(pP.empty);e.push(r)}}function pG(e,t,r){let n=e.inserted;for(let i=0,s=0,o=0;o<e.sections.length;){let l=e.sections[o++],a=e.sections[o++];if(a<0)i+=l,s+=l;else{let c=i,h=s,u=pP.empty;for(;c+=l,h+=a,a&&n&&(u=u.append(n[o-2>>1])),!r&&o!=e.sections.length&&!(e.sections[o+1]<0);)l=e.sections[o++],a=e.sections[o++];t(i,c,s,h,u),i=c,s=h}}}function pJ(e,t,r,n=!1){let i=[],s=n?[]:null,o=new pX(e),l=new pX(t);for(let e=-1;;)if(o.done&&l.len||l.done&&o.len)throw Error("Mismatched change set lengths");else if(-1==o.ins&&-1==l.ins){let e=Math.min(o.len,l.len);pq(i,e,-1),o.forward(e),l.forward(e)}else if(l.ins>=0&&(o.ins<0||e==o.i||0==o.off&&(l.len<o.len||l.len==o.len&&!r))){let t=l.len;for(pq(i,l.ins,-1);t;){let r=Math.min(o.len,t);o.ins>=0&&e<o.i&&o.len<=r&&(pq(i,0,o.ins),s&&pK(s,i,o.text),e=o.i),o.forward(r),t-=r}l.next()}else if(o.ins>=0){let t=0,r=o.len;for(;r;)if(-1==l.ins){let e=Math.min(r,l.len);t+=e,r-=e,l.forward(e)}else if(0==l.ins&&l.len<r)r-=l.len,l.next();else break;pq(i,t,e<o.i?o.ins:0),s&&e<o.i&&pK(s,i,o.text),e=o.i,o.forward(o.len-r)}else if(o.done&&l.done)return s?pU.createSet(i,s):pH.create(i);else throw Error("Mismatched change set lengths")}function pY(e,t,r=!1){let n=[],i=r?[]:null,s=new pX(e),o=new pX(t);for(let e=!1;;)if(s.done&&o.done)return i?pU.createSet(n,i):pH.create(n);else if(0==s.ins)pq(n,s.len,0,e),s.next();else if(0!=o.len||o.done)if(s.done||o.done)throw Error("Mismatched change set lengths");else{let t=Math.min(s.len2,o.len),r=n.length;if(-1==s.ins){let r=-1==o.ins?-1:o.off?0:o.ins;pq(n,t,r,e),i&&r&&pK(i,n,o.text)}else -1==o.ins?(pq(n,s.off?0:s.len,t,e),i&&pK(i,n,s.textBit(t))):(pq(n,s.off?0:s.len,o.off?0:o.ins,e),i&&!o.off&&pK(i,n,o.text));e=(s.ins>t||o.ins>=0&&o.len>t)&&(e||n.length>r),s.forward2(t),o.forward(t)}else pq(n,0,o.ins,e),i&&pK(i,n,o.text),o.next()}class pX{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return -2==this.ins}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?pP.empty:e[t]}textBit(e){let{inserted:t}=this.set,r=this.i-2>>1;return r>=t.length&&!e?pP.empty:t[r].slice(this.off,null==e?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){-1==this.ins?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class pZ{constructor(e,t,r){this.from=e,this.to=t,this.flags=r}get anchor(){return 32&this.flags?this.to:this.from}get head(){return 32&this.flags?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return 8&this.flags?-1:16&this.flags?1:0}get bidiLevel(){let e=7&this.flags;return 7==e?null:e}get goalColumn(){let e=this.flags>>6;return 0xffffff==e?void 0:e}map(e,t=-1){let r,n;return this.empty?r=n=e.mapPos(this.from,t):(r=e.mapPos(this.from,1),n=e.mapPos(this.to,-1)),r==this.from&&n==this.to?this:new pZ(r,n,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return pQ.range(e,t);let r=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return pQ.range(this.anchor,r)}eq(e,t=!1){return this.anchor==e.anchor&&this.head==e.head&&(!t||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||"number"!=typeof e.anchor||"number"!=typeof e.head)throw RangeError("Invalid JSON representation for SelectionRange");return pQ.range(e.anchor,e.head)}static create(e,t,r){return new pZ(e,t,r)}}class pQ{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:pQ.create(this.ranges.map(r=>r.map(e,t)),this.mainIndex)}eq(e,t=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let r=0;r<this.ranges.length;r++)if(!this.ranges[r].eq(e.ranges[r],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return 1==this.ranges.length?this:new pQ([this.main],0)}addRange(e,t=!0){return pQ.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let r=this.ranges.slice();return r[t]=e,pQ.create(r,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||"number"!=typeof e.main||e.main>=e.ranges.length)throw RangeError("Invalid JSON representation for EditorSelection");return new pQ(e.ranges.map(e=>pZ.fromJSON(e)),e.main)}static single(e,t=e){return new pQ([pQ.range(e,t)],0)}static create(e,t=0){if(0==e.length)throw RangeError("A selection needs at least one range");for(let r=0,n=0;n<e.length;n++){let i=e[n];if(i.empty?i.from<=r:i.from<r)return pQ.normalized(e.slice(),t);r=i.to}return new pQ(e,t)}static cursor(e,t=0,r,n){return pZ.create(e,e,(0==t?0:t<0?8:16)|(null==r?7:Math.min(6,r))|(null!=n?n:0xffffff)<<6)}static range(e,t,r,n){let i=(null!=r?r:0xffffff)<<6|(null==n?7:Math.min(6,n));return t<e?pZ.create(t,e,48|i):pZ.create(e,t,8*(t>e)|i)}static normalized(e,t=0){let r=e[t];e.sort((e,t)=>e.from-t.from),t=e.indexOf(r);for(let r=1;r<e.length;r++){let n=e[r],i=e[r-1];if(n.empty?n.from<=i.to:n.from<i.to){let s=i.from,o=Math.max(n.to,i.to);r<=t&&t--,e.splice(--r,2,n.anchor>n.head?pQ.range(o,s):pQ.range(s,o))}}return new pQ(e,t)}}function p0(e,t){for(let r of e.ranges)if(r.to>t)throw RangeError("Selection points outside of document")}let p1=0;class p2{constructor(e,t,r,n,i){this.combine=e,this.compareInput=t,this.compare=r,this.isStatic=n,this.id=p1++,this.default=e([]),this.extensions="function"==typeof i?i(this):i}get reader(){return this}static define(e={}){return new p2(e.combine||(e=>e),e.compareInput||((e,t)=>e===t),e.compare||(!e.combine?p4:(e,t)=>e===t),!!e.static,e.enables)}of(e){return new p3([],this,0,e)}compute(e,t){if(this.isStatic)throw Error("Can't compute a static facet");return new p3(e,this,1,t)}computeN(e,t){if(this.isStatic)throw Error("Can't compute a static facet");return new p3(e,this,2,t)}from(e,t){return t||(t=e=>e),this.compute([e],r=>t(r.field(e)))}}function p4(e,t){return e==t||e.length==t.length&&e.every((e,r)=>e===t[r])}class p3{constructor(e,t,r,n){this.dependencies=e,this.facet=t,this.type=r,this.value=n,this.id=p1++}dynamicSlot(e){var t;let r=this.value,n=this.facet.compareInput,i=this.id,s=e[i]>>1,o=2==this.type,l=!1,a=!1,c=[];for(let r of this.dependencies)"doc"==r?l=!0:"selection"==r?a=!0:((null!=(t=e[r.id])?t:1)&1)==0&&c.push(e[r.id]);return{create:e=>(e.values[s]=r(e),1),update(e,t){if(l&&t.docChanged||a&&(t.docChanged||t.selection)||p6(e,c)){let t=r(e);if(o?!p5(t,e.values[s],n):!n(t,e.values[s]))return e.values[s]=t,1}return 0},reconfigure:(e,t)=>{let l,a=t.config.address[i];if(null!=a){let i=mo(t,a);if(this.dependencies.every(r=>r instanceof p2?t.facet(r)===e.facet(r):!(r instanceof p8)||t.field(r,!1)==e.field(r,!1))||(o?p5(l=r(e),i,n):n(l=r(e),i)))return e.values[s]=i,0}else l=r(e);return e.values[s]=l,1}}}}function p5(e,t,r){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!r(e[n],t[n]))return!1;return!0}function p6(e,t){let r=!1;for(let n of t)1&ms(e,n)&&(r=!0);return r}let p9=p2.define({static:!0});class p8{constructor(e,t,r,n,i){this.id=e,this.createF=t,this.updateF=r,this.compareF=n,this.spec=i,this.provides=void 0}static define(e){let t=new p8(p1++,e.create,e.update,e.compare||((e,t)=>e===t),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(p9).find(e=>e.field==this);return((null==t?void 0:t.create)||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:e=>(e.values[t]=this.create(e),1),update:(e,r)=>{let n=e.values[t],i=this.updateF(n,r);return this.compareF(n,i)?0:(e.values[t]=i,1)},reconfigure:(e,r)=>{let n=e.facet(p9),i=r.facet(p9),s;return(s=n.find(e=>e.field==this))&&s!=i.find(e=>e.field==this)?(e.values[t]=s.create(e),1):null!=r.config.address[this.id]?(e.values[t]=r.field(this),0):(e.values[t]=this.create(e),1)}}}init(e){return[this,p9.of({field:this,create:e})]}get extension(){return this}}function p7(e){return t=>new mt(t,e)}let me={highest:p7(0),high:p7(1),default:p7(2),low:p7(3),lowest:p7(4)};class mt{constructor(e,t){this.inner=e,this.prec=t}}class mr{of(e){return new mn(this,e)}reconfigure(e){return mr.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class mn{constructor(e,t){this.compartment=e,this.inner=t}}class mi{constructor(e,t,r,n,i,s){for(this.base=e,this.compartments=t,this.dynamicSlots=r,this.address=n,this.staticValues=i,this.facets=s,this.statusTemplate=[];this.statusTemplate.length<r.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return null==t?e.default:this.staticValues[t>>1]}static resolve(e,t,r){var n,i,s;let o,l,a=[],c=Object.create(null),h=new Map;for(let r of(n=e,i=t,s=h,o=[[],[],[],[],[]],l=new Map,!function e(t,r){let n=l.get(t);if(null!=n){if(n<=r)return;let e=o[n].indexOf(t);e>-1&&o[n].splice(e,1),t instanceof mn&&s.delete(t.compartment)}if(l.set(t,r),Array.isArray(t))for(let n of t)e(n,r);else if(t instanceof mn){if(s.has(t.compartment))throw RangeError("Duplicate use of compartment in extensions");let n=i.get(t.compartment)||t.inner;s.set(t.compartment,n),e(n,r)}else if(t instanceof mt)e(t.inner,t.prec);else if(t instanceof p8)o[r].push(t),t.provides&&e(t.provides,r);else if(t instanceof p3)o[r].push(t),t.facet.extensions&&e(t.facet.extensions,2);else{let n=t.extension;if(!n)throw Error(`Unrecognized extension value in extension set (${t}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);e(n,r)}}(n,2),o.reduce((e,t)=>e.concat(t))))r instanceof p8?a.push(r):(c[r.facet.id]||(c[r.facet.id]=[])).push(r);let u=Object.create(null),d=[],f=[];for(let e of a)u[e.id]=f.length<<1,f.push(t=>e.slot(t));let p=null==r?void 0:r.config.facets;for(let e in c){let t=c[e],n=t[0].facet,i=p&&p[e]||[];if(t.every(e=>0==e.type))if(u[n.id]=d.length<<1|1,p4(i,t))d.push(r.facet(n));else{let e=n.combine(t.map(e=>e.value));d.push(r&&n.compare(e,r.facet(n))?r.facet(n):e)}else{for(let e of t)0==e.type?(u[e.id]=d.length<<1|1,d.push(e.value)):(u[e.id]=f.length<<1,f.push(t=>e.dynamicSlot(t)));u[n.id]=f.length<<1,f.push(e=>(function(e,t,r){let n=r.map(t=>e[t.id]),i=r.map(e=>e.type),s=n.filter(e=>!(1&e)),o=e[t.id]>>1;function l(e){let r=[];for(let t=0;t<n.length;t++){let s=mo(e,n[t]);if(2==i[t])for(let e of s)r.push(e);else r.push(s)}return t.combine(r)}return{create(e){for(let t of n)ms(e,t);return e.values[o]=l(e),1},update(e,r){if(!p6(e,s))return 0;let n=l(e);return t.compare(n,e.values[o])?0:(e.values[o]=n,1)},reconfigure(e,i){let s=p6(e,n),a=i.config.facets[t.id],c=i.facet(t);if(a&&!s&&p4(r,a))return e.values[o]=c,0;let h=l(e);return t.compare(h,c)?(e.values[o]=c,0):(e.values[o]=h,1)}}})(e,n,t))}}return new mi(e,h,f.map(e=>e(u)),u,d,c)}}function ms(e,t){if(1&t)return 2;let r=t>>1,n=e.status[r];if(4==n)throw Error("Cyclic dependency between fields and/or facets");if(2&n)return n;e.status[r]=4;let i=e.computeSlot(e,e.config.dynamicSlots[r]);return e.status[r]=2|i}function mo(e,t){return 1&t?e.config.staticValues[t>>1]:e.values[t>>1]}let ml=p2.define(),ma=p2.define({combine:e=>e.some(e=>e),static:!0}),mc=p2.define({combine:e=>e.length?e[0]:void 0,static:!0}),mh=p2.define(),mu=p2.define(),md=p2.define(),mf=p2.define({combine:e=>!!e.length&&e[0]});class mp{constructor(e,t){this.type=e,this.value=t}static define(){return new mm}}class mm{of(e){return new mp(this,e)}}class mg{constructor(e){this.map=e}of(e){return new my(this,e)}}class my{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return void 0===t?void 0:t==this.value?this:new my(this.type,t)}is(e){return this.type==e}static define(e={}){return new mg(e.map||(e=>e))}static mapEffects(e,t){if(!e.length)return e;let r=[];for(let n of e){let e=n.map(t);e&&r.push(e)}return r}}my.reconfigure=my.define(),my.appendConfig=my.define();class mv{constructor(e,t,r,n,i,s){this.startState=e,this.changes=t,this.selection=r,this.effects=n,this.annotations=i,this.scrollIntoView=s,this._doc=null,this._state=null,r&&p0(r,t.newLength),i.some(e=>e.type==mv.time)||(this.annotations=i.concat(mv.time.of(Date.now())))}static create(e,t,r,n,i,s){return new mv(e,t,r,n,i,s)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(mv.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&"."==t[e.length]))}}function mx(e,t,r){var n;let i,s,o;return r?(i=t.changes,s=pU.empty(t.changes.length),o=e.changes.compose(t.changes)):(i=t.changes.map(e.changes),s=e.changes.mapDesc(t.changes,!0),o=e.changes.compose(i)),{changes:o,selection:t.selection?t.selection.map(s):null==(n=e.selection)?void 0:n.map(i),effects:my.mapEffects(e.effects,i).concat(my.mapEffects(t.effects,s)),annotations:e.annotations.length?e.annotations.concat(t.annotations):t.annotations,scrollIntoView:e.scrollIntoView||t.scrollIntoView}}function mb(e,t,r){let n=t.selection,i=mk(t.annotations);return t.userEvent&&(i=i.concat(mv.userEvent.of(t.userEvent))),{changes:t.changes instanceof pU?t.changes:pU.of(t.changes||[],r,e.facet(mc)),selection:n&&(n instanceof pQ?n:pQ.single(n.anchor,n.head)),effects:mk(t.effects),annotations:i,scrollIntoView:!!t.scrollIntoView}}mv.time=mp.define(),mv.userEvent=mp.define(),mv.addToHistory=mp.define(),mv.remote=mp.define();let mw=[];function mk(e){return null==e?mw:Array.isArray(e)?e:[e]}var mA=((h=mA||(mA={}))[h.Word=0]="Word",h[h.Space=1]="Space",h[h.Other=2]="Other",h);let mS=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;try{l=RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch(e){}class mC{constructor(e,t,r,n,i,s){this.config=e,this.doc=t,this.selection=r,this.values=n,this.status=e.statusTemplate.slice(),this.computeSlot=i,s&&(s._state=this);for(let e=0;e<this.config.dynamicSlots.length;e++)ms(this,e<<1);this.computeSlot=null}field(e,t=!0){let r=this.config.address[e.id];if(null==r){if(t)throw RangeError("Field is not present in this state");return}return ms(this,r),mo(this,r)}update(...e){return function e(t,r,n){let i=mb(t,r.length?r[0]:{},t.doc.length);r.length&&!1===r[0].filter&&(n=!1);for(let e=1;e<r.length;e++){!1===r[e].filter&&(n=!1);let s=!!r[e].sequential;i=mx(i,mb(t,r[e],s?i.changes.newLength:t.doc.length),s)}let s=mv.create(t,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return function(e){let t=e.startState,r=t.facet(md),n=e;for(let i=r.length-1;i>=0;i--){let s=r[i](e);s&&Object.keys(s).length&&(n=mx(n,mb(t,s,e.changes.newLength),!0))}return n==e?e:mv.create(t,e.changes,e.selection,n.effects,n.annotations,n.scrollIntoView)}(n?function(t){let r=t.startState,n=!0;for(let e of r.facet(mh)){let r=e(t);if(!1===r){n=!1;break}Array.isArray(r)&&(n=!0===n?r:function(e,t){let r=[];for(let n=0,i=0;;){let s,o;if(n<e.length&&(i==t.length||t[i]>=e[n]))s=e[n++],o=e[n++];else{if(!(i<t.length))return r;s=t[i++],o=t[i++]}!r.length||r[r.length-1]<s?r.push(s,o):r[r.length-1]<o&&(r[r.length-1]=o)}}(n,r))}if(!0!==n){let e,i;if(!1===n)i=t.changes.invertedDesc,e=pU.empty(r.doc.length);else{let r=t.changes.filter(n);e=r.changes,i=r.filtered.mapDesc(r.changes).invertedDesc}t=mv.create(r,e,t.selection&&t.selection.map(i),my.mapEffects(t.effects,i),t.annotations,t.scrollIntoView)}let i=r.facet(mu);for(let n=i.length-1;n>=0;n--){let s=i[n](t);t=s instanceof mv?s:Array.isArray(s)&&1==s.length&&s[0]instanceof mv?s[0]:e(r,mk(s),!1)}return t}(s):s)}(this,e,!0)}applyTransaction(e){let t,r=this.config,{base:n,compartments:i}=r;for(let t of e.effects)t.is(mr.reconfigure)?(r&&(i=new Map,r.compartments.forEach((e,t)=>i.set(t,e)),r=null),i.set(t.value.compartment,t.value.extension)):t.is(my.reconfigure)?(r=null,n=t.value):t.is(my.appendConfig)&&(r=null,n=mk(n).concat(t.value));t=r?e.startState.values.slice():new mC(r=mi.resolve(n,i,this),this.doc,this.selection,r.dynamicSlots.map(()=>null),(e,t)=>t.reconfigure(e,this),null).values;let s=e.startState.facet(ma)?e.newSelection:e.newSelection.asSingle();new mC(r,e.newDoc,s,t,(t,r)=>r.update(t,e),e)}replaceSelection(e){return"string"==typeof e&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:pQ.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,r=e(t.ranges[0]),n=this.changes(r.changes),i=[r.range],s=mk(r.effects);for(let r=1;r<t.ranges.length;r++){let o=e(t.ranges[r]),l=this.changes(o.changes),a=l.map(n);for(let e=0;e<r;e++)i[e]=i[e].map(a);let c=n.mapDesc(l,!0);i.push(o.range.map(c)),n=n.compose(a),s=my.mapEffects(s,a).concat(my.mapEffects(mk(o.effects),c))}return{changes:n,selection:pQ.create(i,t.mainIndex),effects:s}}changes(e=[]){return e instanceof pU?e:pU.of(e,this.doc.length,this.facet(mC.lineSeparator))}toText(e){return pP.of(e.split(this.facet(mC.lineSeparator)||pW))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return null==t?e.default:(ms(this,t),mo(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let r in e){let n=e[r];n instanceof p8&&null!=this.config.address[n.id]&&(t[r]=n.spec.toJSON(this.field(e[r]),this))}return t}static fromJSON(e,t={},r){if(!e||"string"!=typeof e.doc)throw RangeError("Invalid JSON representation for EditorState");let n=[];if(r){for(let t in r)if(Object.prototype.hasOwnProperty.call(e,t)){let i=r[t],s=e[t];n.push(i.init(e=>i.spec.fromJSON(s,e)))}}return mC.create({doc:e.doc,selection:pQ.fromJSON(e.selection),extensions:t.extensions?n.concat([t.extensions]):n})}static create(e={}){let t=mi.resolve(e.extensions||[],new Map),r=e.doc instanceof pP?e.doc:pP.of((e.doc||"").split(t.staticFacet(mC.lineSeparator)||pW)),n=e.selection?e.selection instanceof pQ?e.selection:pQ.single(e.selection.anchor,e.selection.head):pQ.single(0);return p0(n,r.length),t.staticFacet(ma)||(n=n.asSingle()),new mC(t,r,n,t.dynamicSlots.map(()=>null),(e,t)=>t.create(e),null)}get tabSize(){return this.facet(mC.tabSize)}get lineBreak(){return this.facet(mC.lineSeparator)||"\n"}get readOnly(){return this.facet(mf)}phrase(e,...t){for(let t of this.facet(mC.phrases))if(Object.prototype.hasOwnProperty.call(t,e)){e=t[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(e,r)=>{if("$"==r)return"$";let n=+(r||1);return!n||n>t.length?e:t[n-1]})),e}languageDataAt(e,t,r=-1){let n=[];for(let i of this.facet(ml))for(let s of i(this,t,r))Object.prototype.hasOwnProperty.call(s,e)&&n.push(s[e]);return n}charCategorizer(e){var t;return t=this.languageDataAt("wordChars",e).join(""),e=>{if(!/\S/.test(e))return mA.Space;if(function(e){if(l)return l.test(e);for(let t=0;t<e.length;t++){let r=e[t];if(/\w/.test(r)||r>"\x80"&&(r.toUpperCase()!=r.toLowerCase()||mS.test(r)))return!0}return!1}(e))return mA.Word;for(let r=0;r<t.length;r++)if(e.indexOf(t[r])>-1)return mA.Word;return mA.Other}}wordAt(e){let{text:t,from:r,length:n}=this.doc.lineAt(e),i=this.charCategorizer(e),s=e-r,o=e-r;for(;s>0;){let e=pF(t,s,!1);if(i(t.slice(e,s))!=mA.Word)break;s=e}for(;o<n;){let e=pF(t,o);if(i(t.slice(o,e))!=mA.Word)break;o=e}return s==o?null:pQ.range(s+r,o+r)}}function mE(e,t,r={}){let n={};for(let t of e)for(let e of Object.keys(t)){let i=t[e],s=n[e];if(void 0===s)n[e]=i;else if(s===i||void 0===i);else if(Object.hasOwnProperty.call(r,e))n[e]=r[e](s,i);else throw Error("Config merge conflict for field "+e)}for(let e in t)void 0===n[e]&&(n[e]=t[e]);return n}mC.allowMultipleSelections=ma,mC.tabSize=p2.define({combine:e=>e.length?e[0]:4}),mC.lineSeparator=mc,mC.readOnly=mf,mC.phrases=p2.define({compare(e,t){let r=Object.keys(e),n=Object.keys(t);return r.length==n.length&&r.every(r=>e[r]==t[r])}}),mC.languageData=ml,mC.changeFilter=mh,mC.transactionFilter=mu,mC.transactionExtender=md,mr.reconfigure=my.define();class mj{eq(e){return this==e}range(e,t=e){return mO.create(e,t,this)}}mj.prototype.startSide=mj.prototype.endSide=0,mj.prototype.point=!1,mj.prototype.mapMode=pV.TrackDel;class mO{constructor(e,t,r){this.from=e,this.to=t,this.value=r}static create(e,t,r){return new mO(e,t,r)}}function mP(e,t){return e.from-t.from||e.value.startSide-t.value.startSide}class mM{constructor(e,t,r,n){this.from=e,this.to=t,this.value=r,this.maxPoint=n}get length(){return this.to[this.to.length-1]}findIndex(e,t,r,n=0){let i=r?this.to:this.from;for(let s=n,o=i.length;;){if(s==o)return s;let n=s+o>>1,l=i[n]-e||(r?this.value[n].endSide:this.value[n].startSide)-t;if(n==s)return l>=0?s:o;l>=0?o=n:s=n+1}}between(e,t,r,n){for(let i=this.findIndex(t,-1e9,!0),s=this.findIndex(r,1e9,!1,i);i<s;i++)if(!1===n(this.from[i]+e,this.to[i]+e,this.value[i]))return!1}map(e,t){let r=[],n=[],i=[],s=-1,o=-1;for(let l=0;l<this.value.length;l++){let a=this.value[l],c=this.from[l]+e,h=this.to[l]+e,u,d;if(c==h){let e=t.mapPos(c,a.startSide,a.mapMode);if(null==e||(u=d=e,a.startSide!=a.endSide&&(d=t.mapPos(c,a.endSide))<u))continue}else if((u=t.mapPos(c,a.startSide))>(d=t.mapPos(h,a.endSide))||u==d&&a.startSide>0&&a.endSide<=0)continue;0>(d-u||a.endSide-a.startSide)||(s<0&&(s=u),a.point&&(o=Math.max(o,d-u)),r.push(a),n.push(u-s),i.push(d-s))}return{mapped:r.length?new mM(n,i,r,o):null,pos:s}}}class mT{constructor(e,t,r,n){this.chunkPos=e,this.chunk=t,this.nextLayer=r,this.maxPoint=n}static create(e,t,r,n){return new mT(e,t,r,n)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:r=!1,filterFrom:n=0,filterTo:i=this.length}=e,s=e.filter;if(0==t.length&&!s)return this;if(r&&(t=t.slice().sort(mP)),this.isEmpty)return t.length?mT.of(t):this;let o=new mD(this,null,-1).goto(0),l=0,a=[],c=new mI;for(;o.value||l<t.length;)if(l<t.length&&(o.from-t[l].from||o.startSide-t[l].value.startSide)>=0){let e=t[l++];c.addInner(e.from,e.to,e.value)||a.push(e)}else 1==o.rangeIndex&&o.chunkIndex<this.chunk.length&&(l==t.length||this.chunkEnd(o.chunkIndex)<t[l].from)&&(!s||n>this.chunkEnd(o.chunkIndex)||i<this.chunkPos[o.chunkIndex])&&c.addChunk(this.chunkPos[o.chunkIndex],this.chunk[o.chunkIndex])?o.nextChunk():((!s||n>o.to||i<o.from||s(o.from,o.to,o.value))&&!c.addInner(o.from,o.to,o.value)&&a.push(mO.create(o.from,o.to,o.value)),o.next());return c.finishInner(this.nextLayer.isEmpty&&!a.length?mT.empty:this.nextLayer.update({add:a,filter:s,filterFrom:n,filterTo:i}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],r=[],n=-1;for(let i=0;i<this.chunk.length;i++){let s=this.chunkPos[i],o=this.chunk[i],l=e.touchesRange(s,s+o.length);if(!1===l)n=Math.max(n,o.maxPoint),t.push(o),r.push(e.mapPos(s));else if(!0===l){let{mapped:i,pos:l}=o.map(s,e);i&&(n=Math.max(n,i.maxPoint),t.push(i),r.push(l))}}let i=this.nextLayer.map(e);return 0==t.length?i:new mT(r,t,i||mT.empty,n)}between(e,t,r){if(!this.isEmpty){for(let n=0;n<this.chunk.length;n++){let i=this.chunkPos[n],s=this.chunk[n];if(t>=i&&e<=i+s.length&&!1===s.between(i,e-i,t-i,r))return}this.nextLayer.between(e,t,r)}}iter(e=0){return mR.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return mR.from(e).goto(t)}static compare(e,t,r,n,i=-1){let s=e.filter(e=>e.maxPoint>0||!e.isEmpty&&e.maxPoint>=i),o=t.filter(e=>e.maxPoint>0||!e.isEmpty&&e.maxPoint>=i),l=m$(s,o,r),a=new mL(s,l,i),c=new mL(o,l,i);r.iterGaps((e,t,r)=>mF(a,e,c,t,r,n)),r.empty&&0==r.length&&mF(a,0,c,0,0,n)}static eq(e,t,r=0,n){null==n&&(n=0x3b9ac9ff);let i=e.filter(e=>!e.isEmpty&&0>t.indexOf(e)),s=t.filter(t=>!t.isEmpty&&0>e.indexOf(t));if(i.length!=s.length)return!1;if(!i.length)return!0;let o=m$(i,s),l=new mL(i,o,0).goto(r),a=new mL(s,o,0).goto(r);for(;;){if(l.to!=a.to||!m_(l.active,a.active)||l.point&&(!a.point||!l.point.eq(a.point)))return!1;if(l.to>n)return!0;l.next(),a.next()}}static spans(e,t,r,n,i=-1){let s=new mL(e,null,i).goto(t),o=t,l=s.openStart;for(;;){let e=Math.min(s.to,r);if(s.point){let r=s.activeForPoint(s.to),i=s.pointFrom<t?r.length+1:s.point.startSide<0?r.length:Math.min(r.length,l);n.point(o,e,s.point,r,i,s.pointRank),l=Math.min(s.openEnd(e),r.length)}else e>o&&(n.span(o,e,s.active,l),l=s.openEnd(e));if(s.to>r)return l+(s.point&&s.to>r?1:0);o=s.to,s.next()}}static of(e,t=!1){let r=new mI;for(let n of e instanceof mO?[e]:t?function(e){if(e.length>1)for(let t=e[0],r=1;r<e.length;r++){let n=e[r];if(mP(t,n)>0)return e.slice().sort(mP);t=n}return e}(e):e)r.add(n.from,n.to,n.value);return r.finish()}static join(e){if(!e.length)return mT.empty;let t=e[e.length-1];for(let r=e.length-2;r>=0;r--)for(let n=e[r];n!=mT.empty;n=n.nextLayer)t=new mT(n.chunkPos,n.chunk,t,Math.max(n.maxPoint,t.maxPoint));return t}}mT.empty=new mT([],[],null,-1),mT.empty.nextLayer=mT.empty;class mI{finishChunk(e){this.chunks.push(new mM(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,r){this.addInner(e,t,r)||(this.nextLayer||(this.nextLayer=new mI)).add(e,t,r)}addInner(e,t,r){let n=e-this.lastTo||r.startSide-this.last.endSide;if(n<=0&&0>(e-this.lastFrom||r.startSide-this.last.startSide))throw Error("Ranges must be added sorted by `from` position and `startSide`");return!(n<0)&&(250==this.from.length&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=r,this.lastFrom=e,this.lastTo=t,this.value.push(r),r.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if(0>(e-this.lastTo||t.value[0].startSide-this.last.endSide))return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let r=t.value.length-1;return this.last=t.value[r],this.lastFrom=t.from[r]+e,this.lastTo=t.to[r]+e,!0}finish(){return this.finishInner(mT.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),0==this.chunks.length)return e;let t=mT.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function m$(e,t,r){let n=new Map;for(let t of e)for(let e=0;e<t.chunk.length;e++)t.chunk[e].maxPoint<=0&&n.set(t.chunk[e],t.chunkPos[e]);let i=new Set;for(let e of t)for(let t=0;t<e.chunk.length;t++){let s=n.get(e.chunk[t]);null==s||(r?r.mapPos(s):s)!=e.chunkPos[t]||(null==r?void 0:r.touchesRange(s,s+e.chunk[t].length))||i.add(e.chunk[t])}return i}class mD{constructor(e,t,r,n=0){this.layer=e,this.skip=t,this.minPoint=r,this.rank=n}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,r){for(;this.chunkIndex<this.layer.chunk.length;){let t=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(t)||this.layer.chunkEnd(this.chunkIndex)<e||t.maxPoint<this.minPoint))break;this.chunkIndex++,r=!1}if(this.chunkIndex<this.layer.chunk.length){let n=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!r||this.rangeIndex<n)&&this.setRangeIndex(n)}this.next()}forward(e,t){0>(this.to-e||this.endSide-t)&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],r=e+t.from[this.rangeIndex];if(this.from=r,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class mR{constructor(e){this.heap=e}static from(e,t=null,r=-1){let n=[];for(let i=0;i<e.length;i++)for(let s=e[i];!s.isEmpty;s=s.nextLayer)s.maxPoint>=r&&n.push(new mD(s,t,r,i));return 1==n.length?n[0]:new mR(n)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let r of this.heap)r.goto(e,t);for(let e=this.heap.length>>1;e>=0;e--)mN(this.heap,e);return this.next(),this}forward(e,t){for(let r of this.heap)r.forward(e,t);for(let e=this.heap.length>>1;e>=0;e--)mN(this.heap,e);0>(this.to-e||this.value.endSide-t)&&this.next()}next(){if(0==this.heap.length)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),mN(this.heap,0)}}}function mN(e,t){for(let r=e[t];;){let n=(t<<1)+1;if(n>=e.length)break;let i=e[n];if(n+1<e.length&&i.compare(e[n+1])>=0&&(i=e[n+1],n++),0>r.compare(i))break;e[n]=r,e[t]=i,t=n}}class mL{constructor(e,t,r){this.minPoint=r,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=mR.from(e,t,r)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&0>(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t);)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){mB(this.active,e),mB(this.activeTo,e),mB(this.activeRank,e),this.minActive=mW(this.active,this.activeTo)}addActive(e){let t=0,{value:r,to:n,rank:i}=this.cursor;for(;t<this.activeRank.length&&(i-this.activeRank[t]||n-this.activeTo[t])>0;)t++;mz(this.active,t,r),mz(this.activeTo,t,n),mz(this.activeRank,t,i),e&&mz(e,t,this.cursor.from),this.minActive=mW(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let r=this.openStart<0?[]:null;for(;;){let n=this.minActive;if(n>-1&&0>(this.activeTo[n]-this.cursor.from||this.active[n].endSide-this.cursor.startSide)){if(this.activeTo[n]>e){this.to=this.activeTo[n],this.endSide=this.active[n].endSide;break}this.removeActive(n),r&&mB(r,n)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let e=this.cursor.value;if(e.point)if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=e,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=e.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}else this.addActive(r),this.cursor.next()}else{this.to=this.endSide=1e9;break}}if(r){this.openStart=0;for(let t=r.length-1;t>=0&&r[t]<e;t--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let r=this.active.length-1;r>=0&&!(this.activeRank[r]<this.pointRank);r--)(this.activeTo[r]>e||this.activeTo[r]==e&&this.active[r].endSide>=this.point.endSide)&&t.push(this.active[r]);return t.reverse()}openEnd(e){let t=0;for(let r=this.activeTo.length-1;r>=0&&this.activeTo[r]>e;r--)t++;return t}}function mF(e,t,r,n,i,s){e.goto(t),r.goto(n);let o=n+i,l=n,a=n-t;for(;;){let t=e.to+a-r.to,n=t||e.endSide-r.endSide,i=n<0?e.to+a:r.to,c=Math.min(i,o);if(e.point||r.point?e.point&&r.point&&(e.point==r.point||e.point.eq(r.point))&&m_(e.activeForPoint(e.to),r.activeForPoint(r.to))||s.comparePoint(l,c,e.point,r.point):c>l&&!m_(e.active,r.active)&&s.compareRange(l,c,e.active,r.active),i>o)break;(t||e.openEnd!=r.openEnd)&&s.boundChange&&s.boundChange(i),l=i,n<=0&&e.next(),n>=0&&r.next()}}function m_(e,t){if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!=t[r]&&!e[r].eq(t[r]))return!1;return!0}function mB(e,t){for(let r=t,n=e.length-1;r<n;r++)e[r]=e[r+1];e.pop()}function mz(e,t,r){for(let r=e.length-1;r>=t;r--)e[r+1]=e[r];e[t]=r}function mW(e,t){let r=-1,n=1e9;for(let i=0;i<t.length;i++)0>(t[i]-n||e[i].endSide-e[r].endSide)&&(r=i,n=t[i]);return r}function mV(e,t,r=e.length){let n=0;for(let i=0;i<r&&i<e.length;)9==e.charCodeAt(i)?(n+=t-n%t,i++):(n++,i=pF(e,i));return n}function mH(e,t,r,n){for(let n=0,i=0;;){if(i>=t)return n;if(n==e.length)break;i+=9==e.charCodeAt(n)?r-i%r:1,n=pF(e,n)}return!0===n?-1:e.length}let mU="undefined"==typeof Symbol?"__":Symbol.for(""),mq="undefined"==typeof Symbol?"__styleSet"+Math.floor(1e8*Math.random()):Symbol("styleSet"),mK="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:{};class mG{constructor(e,t){this.rules=[];let{finish:r}=t||{};function n(e){return/^@/.test(e)?[e]:e.split(/,\s*/)}for(let t in e)!function e(t,i,s,o){let l=[],a=/^@(\w+)\b/.exec(t[0]),c=a&&"keyframes"==a[1];if(a&&null==i)return s.push(t[0]+";");for(let r in i){let o=i[r];if(/&/.test(r))e(r.split(/,\s*/).map(e=>t.map(t=>e.replace(/&/,t))).reduce((e,t)=>e.concat(t)),o,s);else if(o&&"object"==typeof o){if(!a)throw RangeError("The value of a property ("+r+") should be a primitive value.");e(n(r),o,l,c)}else null!=o&&l.push(r.replace(/_.*/,"").replace(/[A-Z]/g,e=>"-"+e.toLowerCase())+": "+o+";")}(l.length||c)&&s.push((r&&!a&&!o?t.map(r):t).join(", ")+" {"+l.join(" ")+"}")}(n(t),e[t],this.rules)}getRules(){return this.rules.join("\n")}static newName(){let e=mK[mU]||1;return mK[mU]=e+1,""+e.toString(36)}static mount(e,t,r){let n=e[mq],i=r&&r.nonce;n?i&&n.setNonce(i):n=new mY(e,i),n.mount(Array.isArray(t)?t:[t],e)}}let mJ=new Map;class mY{constructor(e,t){let r=e.ownerDocument||e,n=r.defaultView;if(!e.head&&e.adoptedStyleSheets&&n.CSSStyleSheet){let t=mJ.get(r);if(t)return e[mq]=t;this.sheet=new n.CSSStyleSheet,mJ.set(r,this)}else this.styleTag=r.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);this.modules=[],e[mq]=this}mount(e,t){let r=this.sheet,n=0,i=0;for(let t=0;t<e.length;t++){let s=e[t],o=this.modules.indexOf(s);if(o<i&&o>-1&&(this.modules.splice(o,1),i--,o=-1),-1==o){if(this.modules.splice(i++,0,s),r)for(let e=0;e<s.rules.length;e++)r.insertRule(s.rules[e],n++)}else{for(;i<o;)n+=this.modules[i++].rules.length;n+=s.rules.length,i++}}if(r)0>t.adoptedStyleSheets.indexOf(this.sheet)&&(t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets]);else{let e="";for(let t=0;t<this.modules.length;t++)e+=this.modules[t].getRules()+"\n";this.styleTag.textContent=e;let r=t.head||t;this.styleTag.parentNode!=r&&r.insertBefore(this.styleTag,r.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}for(var mX={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},mZ={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},mQ="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),m0="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),m1=0;m1<10;m1++)mX[48+m1]=mX[96+m1]=String(m1);for(var m1=1;m1<=24;m1++)mX[m1+111]="F"+m1;for(var m1=65;m1<=90;m1++)mX[m1]=String.fromCharCode(m1+32),mZ[m1]=String.fromCharCode(m1);for(var m2 in mX)mZ.hasOwnProperty(m2)||(mZ[m2]=mX[m2]);let m4="undefined"!=typeof navigator?navigator:{userAgent:"",vendor:"",platform:""},m3="undefined"!=typeof document?document:{documentElement:{style:{}}},m5=/Edge\/(\d+)/.exec(m4.userAgent),m6=/MSIE \d/.test(m4.userAgent),m9=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(m4.userAgent),m8=!!(m6||m9||m5),m7=!m8&&/gecko\/(\d+)/i.test(m4.userAgent),ge=!m8&&/Chrome\/(\d+)/.exec(m4.userAgent),gt="webkitFontSmoothing"in m3.documentElement.style,gr=!m8&&/Apple Computer/.test(m4.vendor),gn=gr&&(/Mobile\/\w+/.test(m4.userAgent)||m4.maxTouchPoints>2);var gi={mac:gn||/Mac/.test(m4.platform),windows:/Win/.test(m4.platform),linux:/Linux|X11/.test(m4.platform),ie:m8,ie_version:m6?m3.documentMode||6:m9?+m9[1]:m5?+m5[1]:0,gecko:m7,gecko_version:m7?+(/Firefox\/(\d+)/.exec(m4.userAgent)||[0,0])[1]:0,chrome:!!ge,chrome_version:ge?+ge[1]:0,ios:gn,android:/Android\b/.test(m4.userAgent),webkit:gt,webkit_version:gt?+(/\bAppleWebKit\/(\d+)/.exec(m4.userAgent)||[0,0])[1]:0,safari:gr,safari_version:gr?+(/\bVersion\/(\d+(\.\d+)?)/.exec(m4.userAgent)||[0,0])[1]:0,tabSize:null!=m3.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};function gs(e){return(11==e.nodeType?e.getSelection?e:e.ownerDocument:e).getSelection()}function go(e,t){return!!t&&(e==t||e.contains(1!=t.nodeType?t.parentNode:t))}function gl(e,t){if(!t.anchorNode)return!1;try{return go(e,t.anchorNode)}catch(e){return!1}}function ga(e){return 3==e.nodeType?gx(e,0,e.nodeValue.length).getClientRects():1==e.nodeType?e.getClientRects():[]}function gc(e,t,r,n){return!!r&&(gd(e,t,r,n,-1)||gd(e,t,r,n,1))}function gh(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t}function gu(e){return 1==e.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(e.nodeName)}function gd(e,t,r,n,i){for(;;){if(e==r&&t==n)return!0;if(t==(i<0?0:gf(e))){if("DIV"==e.nodeName)return!1;let r=e.parentNode;if(!r||1!=r.nodeType)return!1;t=gh(e)+(i<0?0:1),e=r}else{if(1!=e.nodeType||1==(e=e.childNodes[t+(i<0?-1:0)]).nodeType&&"false"==e.contentEditable)return!1;t=i<0?gf(e):0}}}function gf(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function gp(e,t){let r=t?e.left:e.right;return{left:r,right:r,top:e.top,bottom:e.bottom}}function gm(e,t){let r=t.width/e.offsetWidth,n=t.height/e.offsetHeight;return(r>.995&&r<1.005||!isFinite(r)||1>Math.abs(t.width-e.offsetWidth))&&(r=1),(n>.995&&n<1.005||!isFinite(n)||1>Math.abs(t.height-e.offsetHeight))&&(n=1),{scaleX:r,scaleY:n}}class gg{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:r}=e;this.set(t,Math.min(e.anchorOffset,t?gf(t):0),r,Math.min(e.focusOffset,r?gf(r):0))}set(e,t,r,n){this.anchorNode=e,this.anchorOffset=t,this.focusNode=r,this.focusOffset=n}}let gy=null;function gv(e){if(e.setActive)return e.setActive();if(gy)return e.focus(gy);let t=[];for(let r=e;r&&(t.push(r,r.scrollTop,r.scrollLeft),r!=r.ownerDocument);r=r.parentNode);if(e.focus(null==gy?{get preventScroll(){return gy={preventScroll:!0},!0}}:void 0),!gy){gy=!1;for(let e=0;e<t.length;){let r=t[e++],n=t[e++],i=t[e++];r.scrollTop!=n&&(r.scrollTop=n),r.scrollLeft!=i&&(r.scrollLeft=i)}}}function gx(e,t,r=t){let n=a||(a=document.createRange());return n.setEnd(e,r),n.setStart(e,t),n}function gb(e,t,r,n){let i={key:t,code:t,keyCode:r,which:r,cancelable:!0};n&&({altKey:i.altKey,ctrlKey:i.ctrlKey,shiftKey:i.shiftKey,metaKey:i.metaKey}=n);let s=new KeyboardEvent("keydown",i);s.synthetic=!0,e.dispatchEvent(s);let o=new KeyboardEvent("keyup",i);return o.synthetic=!0,e.dispatchEvent(o),s.defaultPrevented||o.defaultPrevented}function gw(e){for(;e.attributes.length;)e.removeAttributeNode(e.attributes[0])}function gk(e){return e.scrollTop>Math.max(1,e.scrollHeight-e.clientHeight-4)}function gA(e,t){for(let r=e,n=t;;)if(3==r.nodeType&&n>0)return{node:r,offset:n};else if(1==r.nodeType&&n>0){if("false"==r.contentEditable)return null;n=gf(r=r.childNodes[n-1])}else{if(!r.parentNode||gu(r))return null;n=gh(r),r=r.parentNode}}function gS(e,t){for(let r=e,n=t;;)if(3==r.nodeType&&n<r.nodeValue.length)return{node:r,offset:n};else if(1==r.nodeType&&n<r.childNodes.length){if("false"==r.contentEditable)return null;r=r.childNodes[n],n=0}else{if(!r.parentNode||gu(r))return null;n=gh(r)+1,r=r.parentNode}}gi.safari&&gi.safari_version>=26&&(gy=!1);class gC{constructor(e,t,r=!0){this.node=e,this.offset=t,this.precise=r}static before(e,t){return new gC(e.parentNode,gh(e),t)}static after(e,t){return new gC(e.parentNode,gh(e)+1,t)}}let gE=[];class gj{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let r of this.children){if(r==e)return t;t+=r.length+r.breakAfter}throw RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,t){if(2&this.flags){let r=this.dom,n=null,i;for(let s of this.children){if(7&s.flags){if(!s.dom&&(i=n?n.nextSibling:r.firstChild)){let e=gj.get(i);(!e||!e.parent&&e.canReuseDOM(s))&&s.reuseDOM(i)}s.sync(e,t),s.flags&=-8}if(i=n?n.nextSibling:r.firstChild,t&&!t.written&&t.node==r&&i!=s.dom&&(t.written=!0),s.dom.parentNode==r)for(;i&&i!=s.dom;)i=gO(i);else r.insertBefore(s.dom,i);n=s.dom}for((i=n?n.nextSibling:r.firstChild)&&t&&t.node==r&&(t.written=!0);i;)i=gO(i)}else if(1&this.flags)for(let r of this.children)7&r.flags&&(r.sync(e,t),r.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,t){let r;if(e==this.dom)r=this.dom.childNodes[t];else{let n=0==gf(e)?0:0==t?-1:1;for(;;){let t=e.parentNode;if(t==this.dom)break;0==n&&t.firstChild!=t.lastChild&&(n=e==t.firstChild?-1:1),e=t}r=n<0?e:e.nextSibling}if(r==this.dom.firstChild)return 0;for(;r&&!gj.get(r);)r=r.nextSibling;if(!r)return this.length;for(let e=0,t=0;;e++){let n=this.children[e];if(n.dom==r)return t;t+=n.length+n.breakAfter}}domBoundsAround(e,t,r=0){let n=-1,i=-1,s=-1,o=-1;for(let l=0,a=r,c=r;l<this.children.length;l++){let r=this.children[l],h=a+r.length;if(a<e&&h>t)return r.domBoundsAround(e,t,a);if(h>=e&&-1==n&&(n=l,i=a),a>t&&r.dom.parentNode==this.dom){s=l,o=c;break}c=h,a=h+r.breakAfter}return{from:i,to:o<0?r+this.length:o,startDOM:(n?this.children[n-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:s<this.children.length&&s>=0?this.children[s].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.flags|=2),1&t.flags)return;t.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,7&this.flags&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,r=gE){this.markDirty();for(let n=e;n<t;n++){let e=this.children[n];e.parent==this&&0>r.indexOf(e)&&e.destroy()}r.length<250?this.children.splice(e,t-e,...r):this.children=[].concat(this.children.slice(0,e),r,this.children.slice(t));for(let e=0;e<r.length;e++)r[e].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new gP(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==e?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,t,r,n,i,s){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}function gO(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}gj.prototype.breakAfter=0;class gP{constructor(e,t,r){this.children=e,this.pos=t,this.i=r,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||0==this.i||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let r=this.children[--this.i];this.pos-=r.length+r.breakAfter}}}function gM(e,t,r,n,i,s,o,l,a){let{children:c}=e,h=c.length?c[t]:null,u=s.length?s[s.length-1]:null,d=u?u.breakAfter:o;if(!(t==n&&h&&!o&&!d&&s.length<2&&h.merge(r,i,s.length?u:null,0==r,l,a))){if(n<c.length){let e=c[n];e&&(i<e.length||e.breakAfter&&(null==u?void 0:u.breakAfter))?(t==n&&(e=e.split(i),i=0),!d&&u&&e.merge(0,i,u,!0,0,a)?s[s.length-1]=e:((i||e.children.length&&!e.children[0].length)&&e.merge(0,i,null,!1,0,a),s.push(e))):(null==e?void 0:e.breakAfter)&&(u?u.breakAfter=1:o=1),n++}for(h&&(h.breakAfter=o,r>0&&(!o&&s.length&&h.merge(r,h.length,s[0],!1,l,0)?h.breakAfter=s.shift().breakAfter:(r<h.length||h.children.length&&0==h.children[h.children.length-1].length)&&h.merge(r,h.length,null,!1,l,0),t++));t<n&&s.length;)if(c[n-1].become(s[s.length-1]))n--,s.pop(),a=s.length?0:l;else if(c[t].become(s[0]))t++,s.shift(),l=s.length?0:a;else break;!s.length&&t&&n<c.length&&!c[t-1].breakAfter&&c[n].merge(0,0,c[t-1],!1,l,a)&&t--,(t<n||s.length)&&e.replaceChildren(t,n,s)}}function gT(e,t,r,n,i,s){let o=e.childCursor(),{i:l,off:a}=o.findPos(r,1),{i:c,off:h}=o.findPos(t,-1),u=t-r;for(let e of n)u+=e.length;e.length+=u,gM(e,c,h,l,a,n,0,i,s)}class gI extends gj{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){3==e.nodeType&&this.createDOM(e)}merge(e,t,r){return!(8&this.flags)&&(!r||r instanceof gI&&!(this.length-(t-e)+r.length>256)&&!(8&r.flags))&&(this.text=this.text.slice(0,e)+(r?r.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new gI(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t.flags|=8&this.flags,t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new gC(this.dom,e)}domBoundsAround(e,t,r){return{from:r,to:r+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return function(e,t,r){let n=e.nodeValue.length;t>n&&(t=n);let i=t,s=t,o=0;0==t&&r<0||t==n&&r>=0?!(gi.chrome||gi.gecko)&&(t?(i--,o=1):s<n&&(s++,o=-1)):r<0?i--:s<n&&s++;let l=gx(e,i,s).getClientRects();if(!l.length)return null;let a=l[(o?o<0:r>=0)?0:l.length-1];return gi.safari&&!o&&0==a.width&&(a=Array.prototype.find.call(l,e=>e.width)||a),o?gp(a,o<0):a||null}(this.dom,e,t)}}class g$ extends gj{constructor(e,t=[],r=0){for(let n of(super(),this.mark=e,this.children=t,this.length=r,t))n.setParent(this)}setAttrs(e){if(gw(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,t){this.dom?4&this.flags&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(e,t,r,n,i,s){return(!r||!!(r instanceof g$&&r.mark.eq(this.mark))&&(!e||!(i<=0))&&(!(t<this.length)||!(s<=0)))&&(gT(this,e,t,r?r.children.slice():[],i-1,s-1),this.markDirty(),!0)}split(e){let t=[],r=0,n=-1,i=0;for(let s of this.children){let o=r+s.length;o>e&&t.push(r<e?s.split(e-r):s),n<0&&r>=e&&(n=i),r=o,i++}let s=this.length-e;return this.length=e,n>-1&&(this.children.length=n,this.markDirty()),new g$(this.mark,t,s)}domAtPos(e){return gN(this,e)}coordsAt(e,t){return gL(this,e,t)}}class gD extends gj{static create(e,t,r){return new gD(e,t,r)}constructor(e,t,r){super(),this.widget=e,this.length=t,this.side=r,this.prevWidget=null}split(e){let t=gD.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(e){this.dom&&this.widget.updateDOM(this.dom,e)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,t,r,n,i,s){return(!r||r instanceof gD&&!!this.widget.compare(r.widget)&&(!(e>0)||!(i<=0))&&(!(t<this.length)||!(s<=0)))&&(this.length=e+(r?r.length:0)+(this.length-t),!0)}become(e){return e instanceof gD&&e.side==this.side&&this.widget.constructor==e.widget.constructor&&(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0)}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(0==this.length)return pP.empty;let e=this;for(;e.parent;)e=e.parent;let{view:t}=e,r=t&&t.state.doc,n=this.posAtStart;return r?r.slice(n,n+this.length):pP.empty}domAtPos(e){return(this.length?0==e:this.side>0)?gC.before(this.dom):gC.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let r=this.widget.coordsAt(this.dom,e,t);if(r)return r;let n=this.dom.getClientRects(),i=null;if(!n.length)return null;let s=this.side?this.side<0:e>0;for(let t=s?n.length-1:0;i=n[t],e>0?0!=t:t!=n.length-1&&!(i.top<i.bottom);t+=s?-1:1);return gp(i,!s)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class gR extends gj{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof gR&&e.side==this.side}split(){return new gR(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?gC.before(this.dom):gC.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return pP.empty}get isHidden(){return!0}}function gN(e,t){let r=e.dom,{children:n}=e,i=0;for(let e=0;i<n.length;i++){let s=n[i],o=e+s.length;if(!(o==e&&0>=s.getSide())){if(t>e&&t<o&&s.dom.parentNode==r)return s.domAtPos(t-e);if(t<=e)break;e=o}}for(let e=i;e>0;e--){let t=n[e-1];if(t.dom.parentNode==r)return t.domAtPos(t.length)}for(let e=i;e<n.length;e++){let t=n[e];if(t.dom.parentNode==r)return t.domAtPos(0)}return new gC(r,0)}function gL(e,t,r){let n=null,i=-1,s=null,o=-1;!function e(t,l){for(let a=0,c=0;a<t.children.length&&c<=l;a++){let h=t.children[a],u=c+h.length;u>=l&&(h.children.length?e(h,l-c):(!s||s.isHidden&&(r>0||function(e,t){let r=e.coordsAt(0,1),n=t.coordsAt(0,1);return r&&n&&n.top<r.bottom}(s,h)))&&(u>l||c==u&&h.getSide()>0)?(s=h,o=l-c):(c<l||c==u&&0>h.getSide()&&!h.isHidden)&&(n=h,i=l-c)),c=u}}(e,t);let l=(r<0?n:s)||n||s;return l?l.coordsAt(Math.max(0,l==n?i:o),r):function(e){let t=e.dom.lastChild;if(!t)return e.dom.getBoundingClientRect();let r=ga(t);return r[r.length-1]||null}(e)}function gF(e,t){for(let r in e)"class"==r&&t.class?t.class+=" "+e.class:"style"==r&&t.style?t.style+=";"+e.style:t[r]=e[r];return t}gI.prototype.children=gD.prototype.children=gR.prototype.children=gE;let g_=Object.create(null);function gB(e,t,r){if(e==t)return!0;e||(e=g_),t||(t=g_);let n=Object.keys(e),i=Object.keys(t);if(n.length-(r&&n.indexOf(r)>-1?1:0)!=i.length-(r&&i.indexOf(r)>-1?1:0))return!1;for(let s of n)if(s!=r&&(-1==i.indexOf(s)||e[s]!==t[s]))return!1;return!0}function gz(e,t,r){let n=!1;if(t)for(let i in t)r&&i in r||(n=!0,"style"==i?e.style.cssText="":e.removeAttribute(i));if(r)for(let i in r)t&&t[i]==r[i]||(n=!0,"style"==i?e.style.cssText=r[i]:e.setAttribute(i,r[i]));return n}class gW{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return -1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,r){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var gV=((u=gV||(gV={}))[u.Text=0]="Text",u[u.WidgetBefore=1]="WidgetBefore",u[u.WidgetAfter=2]="WidgetAfter",u[u.WidgetRange=3]="WidgetRange",u);class gH extends mj{constructor(e,t,r,n){super(),this.startSide=e,this.endSide=t,this.widget=r,this.spec=n}get heightRelevant(){return!1}static mark(e){return new gU(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),r=!!e.block;return t+=r&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new gK(e,t,t,r,e.widget||null,!1)}static replace(e){let t=!!e.block,r,n;if(e.isBlockGap)r=-5e8,n=4e8;else{let{start:i,end:s}=gG(e,t);r=(i?t?-3e8:-1:5e8)-1,n=(s?t?2e8:1:-6e8)+1}return new gK(e,r,n,t,e.widget||null,!0)}static line(e){return new gq(e)}static set(e,t=!1){return mT.of(e,t)}hasHeight(){return!!this.widget&&this.widget.estimatedHeight>-1}}gH.none=mT.empty;class gU extends gH{constructor(e){let{start:t,end:r}=gG(e);super(t?-1:5e8,r?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var t,r;return this==e||e instanceof gU&&this.tagName==e.tagName&&(this.class||(null==(t=this.attrs)?void 0:t.class))==(e.class||(null==(r=e.attrs)?void 0:r.class))&&gB(this.attrs,e.attrs,"class")}range(e,t=e){if(e>=t)throw RangeError("Mark decorations may not be empty");return super.range(e,t)}}gU.prototype.point=!1;class gq extends gH{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof gq&&this.spec.class==e.spec.class&&gB(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}gq.prototype.mapMode=pV.TrackBefore,gq.prototype.point=!0;class gK extends gH{constructor(e,t,r,n,i,s){super(t,r,i,e),this.block=n,this.isReplace=s,this.mapMode=n?t<=0?pV.TrackBefore:pV.TrackAfter:pV.TrackDel}get type(){return this.startSide!=this.endSide?gV.WidgetRange:this.startSide<=0?gV.WidgetBefore:gV.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){var t,r;return e instanceof gK&&(t=this.widget,t==(r=e.widget)||!!(t&&r&&t.compare(r)))&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}function gG(e,t=!1){let{inclusiveStart:r,inclusiveEnd:n}=e;return null==r&&(r=e.inclusive),null==n&&(n=e.inclusive),{start:null!=r?r:t,end:null!=n?n:t}}function gJ(e,t,r,n=0){let i=r.length-1;i>=0&&r[i]+n>=e?r[i]=Math.max(r[i],t):r.push(e,t)}gK.prototype.point=!0;class gY extends gj{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,r,n,i,s){if(r){if(!(r instanceof gY))return!1;this.dom||r.transferDOM(this)}return n&&this.setDeco(r?r.attrs:null),gT(this,e,t,r?r.children.slice():[],i,s),!0}split(e){let t=new gY;if(t.breakAfter=this.breakAfter,0==this.length)return t;let{i:r,off:n}=this.childPos(e);n&&(t.append(this.children[r].split(n),0),this.children[r].merge(n,this.children[r].length,null,!1,0,0),r++);for(let e=r;e<this.children.length;e++)t.append(this.children[e],0);for(;r>0&&0==this.children[r-1].length;)this.children[--r].destroy();return this.children.length=r,this.markDirty(),this.length=e,t}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){gB(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){!function e(t,r,n){let i,{children:s}=t;n>0&&r instanceof g$&&s.length&&(i=s[s.length-1])instanceof g$&&i.mark.eq(r.mark)?e(i,r.children[0],n-1):(s.push(r),r.setParent(t)),t.length+=r.length}(this,e,t)}addLineDeco(e){let t=e.spec.attributes,r=e.spec.class;t&&(this.attrs=gF(t,this.attrs||{})),r&&(this.attrs=gF({class:r},this.attrs||{}))}domAtPos(e){return gN(this,e)}reuseDOM(e){"DIV"==e.nodeName&&(this.setDOM(e),this.flags|=6)}sync(e,t){var r;this.dom?4&this.flags&&(gw(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(gz(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let n=this.dom.lastChild;for(;n&&gj.get(n)instanceof g$;)n=n.lastChild;if(!n||!this.length||"BR"!=n.nodeName&&(null==(r=gj.get(n))?void 0:r.isEditable)==!1&&(!gi.ios||!this.children.some(e=>e instanceof gI))){let e=document.createElement("BR");e.cmIgnore=!0,this.dom.appendChild(e)}}measureTextSize(){if(0==this.children.length||this.length>20)return null;let e=0,t;for(let r of this.children){if(!(r instanceof gI)||/[^ -~]/.test(r.text))return null;let n=ga(r.dom);if(1!=n.length)return null;e+=n[0].width,t=n[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(e,t){let r=gL(this,e,t);if(!this.children.length&&r&&this.parent){let{heightOracle:e}=this.parent.view.viewState,t=r.bottom-r.top;if(2>Math.abs(t-e.lineHeight)&&e.textHeight<t){let n=(t-e.textHeight)/2;return{top:r.top+n,bottom:r.bottom-n,left:r.left,right:r.left}}}return r}become(e){return e instanceof gY&&0==this.children.length&&0==e.children.length&&gB(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,t){for(let r=0,n=0;r<e.children.length;r++){let i=e.children[r],s=n+i.length;if(s>=t){if(i instanceof gY)return i;if(s>t)break}n=s+i.breakAfter}return null}}class gX extends gj{constructor(e,t,r){super(),this.widget=e,this.length=t,this.deco=r,this.breakAfter=0,this.prevWidget=null}merge(e,t,r,n,i,s){return(!r||r instanceof gX&&!!this.widget.compare(r.widget)&&(!(e>0)||!(i<=0))&&(!(t<this.length)||!(s<=0)))&&(this.length=e+(r?r.length:0)+(this.length-t),!0)}domAtPos(e){return 0==e?gC.before(this.dom):gC.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let r=new gX(this.widget,t,this.deco);return r.breakAfter=this.breakAfter,r}get children(){return gE}sync(e){this.dom&&this.widget.updateDOM(this.dom,e)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):pP.empty}domBoundsAround(){return null}become(e){return e instanceof gX&&e.widget.constructor==this.widget.constructor&&(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0)}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,t){let r=this.widget.coordsAt(this.dom,e,t);return r||(this.widget instanceof gZ?null:gp(this.dom.getBoundingClientRect(),this.length?0==e:t<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:t,endSide:r}=this.deco;return t!=r&&(e<0?t<0:r>0)}}class gZ extends gW{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class gQ{constructor(e,t,r,n){this.doc=e,this.pos=t,this.end=r,this.disallowBlockEffectsFor=n,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof gX&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new gY),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(g0(new gR(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||e&&this.content.length&&this.content[this.content.length-1]instanceof gX||this.getLine()}buildText(e,t,r){for(;e>0;){if(this.textOff==this.text.length){let{value:t,lineBreak:r,done:n}=this.cursor.next(this.skip);if(this.skip=0,n)throw Error("Ran out of text content when drawing inline views");if(r){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}this.text=t,this.textOff=0}let n=Math.min(this.text.length-this.textOff,e),i=Math.min(n,512);this.flushBuffer(t.slice(t.length-r)),this.getLine().append(g0(new gI(this.text.slice(this.textOff,this.textOff+i)),t),r),this.atCursorPos=!0,this.textOff+=i,e-=i,r=n<=i?0:t.length}}span(e,t,r,n){this.buildText(t-e,r,n),this.pos=t,this.openStart<0&&(this.openStart=n)}point(e,t,r,n,i,s){if(this.disallowBlockEffectsFor[s]&&r instanceof gK){if(r.block)throw RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw RangeError("Decorations that replace line breaks may not be specified via plugins")}let o=t-e;if(r instanceof gK)if(r.block)r.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new gX(r.widget||g1.block,o,r));else{let s=gD.create(r.widget||g1.inline,o,o?0:r.startSide),l=this.atCursorPos&&!s.isEditable&&i<=n.length&&(e<t||r.startSide>0),a=!s.isEditable&&(e<t||i>n.length||r.startSide<=0),c=this.getLine();2!=this.pendingBuffer||l||s.isEditable||(this.pendingBuffer=0),this.flushBuffer(n),l&&(c.append(g0(new gR(1),n),i),i=n.length+Math.max(0,i-n.length)),c.append(g0(s,n),i),this.atCursorPos=a,this.pendingBuffer=a?e<t||i>n.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=n.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(r);o&&(this.textOff+o<=this.text.length?this.textOff+=o:(this.skip+=o-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=i)}static build(e,t,r,n,i){let s=new gQ(e,t,r,i);return s.openEnd=mT.spans(n,t,r,s),s.openStart<0&&(s.openStart=s.openEnd),s.finish(s.openEnd),s}}function g0(e,t){for(let r of t)e=new g$(r,[e],e.length);return e}class g1 extends gW{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}g1.inline=new g1("span"),g1.block=new g1("div");var g2=((d=g2||(g2={}))[d.LTR=0]="LTR",d[d.RTL=1]="RTL",d);let g4=g2.LTR,g3=g2.RTL;function g5(e){let t=[];for(let r=0;r<e.length;r++)t.push(1<<e[r]);return t}let g6=g5("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),g9=g5("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),g8=Object.create(null),g7=[];for(let e of["()","[]","{}"]){let t=e.charCodeAt(0),r=e.charCodeAt(1);g8[t]=r,g8[r]=-t}function ye(e){return e<=247?g6[e]:1424<=e&&e<=1524?2:1536<=e&&e<=1785?g9[e-1536]:1774<=e&&e<=2220?4:8192<=e&&e<=8204?256:64336<=e&&e<=65023?4:1}let yt=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class yr{get dir(){return this.level%2?g3:g4}constructor(e,t,r){this.from=e,this.to=t,this.level=r}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,r,n){let i=-1;for(let s=0;s<e.length;s++){let o=e[s];if(o.from<=t&&o.to>=t){if(o.level==r)return s;(i<0||(0!=n?n<0?o.from<t:o.to>t:e[i].level>o.level))&&(i=s)}}if(i<0)throw RangeError("Index out of range");return i}}let yn=[];function yi(e){return[new yr(0,e,0)]}let ys="",yo=p2.define(),yl=p2.define(),ya=p2.define(),yc=p2.define(),yh=p2.define(),yu=p2.define(),yd=p2.define(),yf=p2.define(),yp=p2.define(),ym=p2.define({combine:e=>e.some(e=>e)}),yg=p2.define({combine:e=>e.some(e=>e)}),yy=p2.define();class yv{constructor(e,t="nearest",r="nearest",n=5,i=5,s=!1){this.range=e,this.y=t,this.x=r,this.yMargin=n,this.xMargin=i,this.isSnapshot=s}map(e){return e.empty?this:new yv(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new yv(pQ.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}let yx=my.define({map:(e,t)=>e.map(t)}),yb=my.define();function yw(e,t,r){let n=e.facet(yc);n.length?n[0](t):window.onerror&&window.onerror(String(t),r,void 0,void 0,t)||(r?console.error(r+":",t):console.error(t))}let yk=p2.define({combine:e=>!e.length||e[0]}),yA=0,yS=p2.define({combine:e=>e.filter((t,r)=>{for(let n=0;n<r;n++)if(e[n].plugin==t.plugin)return!1;return!0})});class yC{constructor(e,t,r,n,i){this.id=e,this.create=t,this.domEventHandlers=r,this.domEventObservers=n,this.baseExtensions=i(this),this.extension=this.baseExtensions.concat(yS.of({plugin:this,arg:void 0}))}of(e){return this.baseExtensions.concat(yS.of({plugin:this,arg:e}))}static define(e,t){let{eventHandlers:r,eventObservers:n,provide:i,decorations:s}=t||{};return new yC(yA++,e,r,n,e=>{let t=[];return s&&t.push(yP.of(t=>{let r=t.plugin(e);return r?s(r):gH.none})),i&&t.push(i(e)),t})}static fromClass(e,t){return yC.define((t,r)=>new e(t,r),t)}}class yE{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(e){if(this.value){if(this.mustUpdate){let e=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(e)}catch(t){if(yw(e.state,t,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(e){}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(e,this.spec.arg)}catch(t){yw(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(null==(t=this.value)?void 0:t.destroy)try{this.value.destroy()}catch(t){yw(e.state,t,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}let yj=p2.define(),yO=p2.define(),yP=p2.define(),yM=p2.define(),yT=p2.define(),yI=p2.define();function y$(e,t){let r=e.state.facet(yI);if(!r.length)return r;let n=r.map(t=>t instanceof Function?t(e):t),i=[];return mT.spans(n,t.from,t.to,{point(){},span(e,r,n,s){let o=e-t.from,l=r-t.from,a=i;for(let e=n.length-1;e>=0;e--,s--){let r=n[e].spec.bidiIsolate,i;if(null==r&&(r=function(e,t,r){for(let n=t;n<r;n++){let t=ye(e.charCodeAt(n));if(1==t)break;if(2==t||4==t)return g3}return g4}(t.text,o,l)),s>0&&a.length&&(i=a[a.length-1]).to==o&&i.direction==r)i.to=l,a=i.inner;else{let e={from:o,to:l,direction:r,inner:[]};a.push(e),a=e.inner}}}}),i}let yD=p2.define();function yR(e){let t=0,r=0,n=0,i=0;for(let s of e.state.facet(yD)){let o=s(e);o&&(null!=o.left&&(t=Math.max(t,o.left)),null!=o.right&&(r=Math.max(r,o.right)),null!=o.top&&(n=Math.max(n,o.top)),null!=o.bottom&&(i=Math.max(i,o.bottom)))}return{left:t,right:r,top:n,bottom:i}}let yN=p2.define();class yL{constructor(e,t,r,n){this.fromA=e,this.toA=t,this.fromB=r,this.toB=n}join(e){return new yL(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,r=this;for(;t>0;t--){let n=e[t-1];if(!(n.fromA>r.toA)){if(n.toA<r.fromA)break;r=r.join(n),e.splice(t-1,1)}}return e.splice(t,0,r),e}static extendWithRanges(e,t){if(0==t.length)return e;let r=[];for(let n=0,i=0,s=0,o=0;;n++){let l=n==e.length?null:e[n],a=s-o,c=l?l.fromB:1e9;for(;i<t.length&&t[i]<c;){let e=t[i],n=t[i+1],s=Math.max(o,e),l=Math.min(c,n);if(s<=l&&new yL(s+a,l+a,s,l).addToSet(r),n>c)break;i+=2}if(!l)return r;new yL(l.fromA,l.toA,l.fromB,l.toB).addToSet(r),s=l.toA,o=l.toB}}}class yF{constructor(e,t,r){for(let n of(this.view=e,this.state=t,this.transactions=r,this.flags=0,this.startState=e.state,this.changes=pU.empty(this.startState.doc.length),r))this.changes=this.changes.compose(n.changes);let n=[];this.changes.iterChangedRanges((e,t,r,i)=>n.push(new yL(e,t,r,i))),this.changedRanges=n}static create(e,t,r){return new yF(e,t,r)}get viewportChanged(){return(4&this.flags)>0}get viewportMoved(){return(8&this.flags)>0}get heightChanged(){return(2&this.flags)>0}get geometryChanged(){return this.docChanged||(18&this.flags)>0}get focusChanged(){return(1&this.flags)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return 0==this.flags&&0==this.transactions.length}}class y_ extends gj{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=gH.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new gY],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new yL(0,0,0,e.state.doc.length)],0,null)}update(e){var t,r,n,i,s,o;let l,a,c=e.changedRanges;this.minWidth>0&&c.length&&(c.every(({fromA:e,toA:t})=>t<this.minWidthFrom||e>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let h=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&((null==(t=this.domChanged)?void 0:t.newSel)?h=this.domChanged.newSel.head:(r=e.changes,n=this.hasComposition,l=!1,n&&r.iterChangedRanges((e,t)=>{e<n.to&&t>n.from&&(l=!0)}),l||e.selectionSet||(h=e.state.selection.main.head)));let u=h>-1?function(e,t,r){let n=yB(e,r);if(!n)return null;let{node:i,from:s,to:o}=n,l=i.nodeValue;if(/[\n\r]/.test(l)||e.state.doc.sliceString(n.from,n.to)!=l)return null;let a=t.invertedDesc,c=new yL(a.mapPos(s),a.mapPos(o),s,o),h=[];for(let t=i.parentNode;;t=t.parentNode){let r=gj.get(t);if(r instanceof g$)h.push({node:t,deco:r.mark});else{if(r instanceof gY||"DIV"==t.nodeName&&t.parentNode==e.contentDOM)return{range:c,text:i,marks:h,line:t};if(t==e.contentDOM)return null;h.push({node:t,deco:new gU({inclusive:!0,attributes:function(e){let t=Object.create(null);for(let r=0;r<e.attributes.length;r++){let n=e.attributes[r];t[n.name]=n.value}return t}(t),tagName:t.tagName.toLowerCase()})})}}}(this.view,e.changes,h):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:t,to:r}=this.hasComposition;c=new yL(t,r,e.changes.mapPos(t,-1),e.changes.mapPos(r,1)).addToSet(c.slice())}this.hasComposition=u?{from:u.range.fromB,to:u.range.toB}:null,(gi.ie||gi.chrome)&&!u&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let d=(i=this.decorations,s=this.updateDeco(),o=e.changes,a=new yz,mT.compare(i,s,o,a),a.changes);return c=yL.extendWithRanges(c,d),(!!(7&this.flags)||0!=c.length)&&(this.updateInner(c,e.startState.doc.length,u),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t,r){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t,r);let{observer:n}=this.view;n.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let e=gi.chrome||gi.ios?{node:n.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,e),this.flags&=-8,e&&(e.written||n.selectionRange.focusNode!=e.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(e=>e.flags&=-9);let i=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let e of this.children)e instanceof gX&&e.widget instanceof gZ&&i.push(e.dom);n.updateGaps(i)}updateChildren(e,t,r){let n=r?r.range.addToSet(e.slice()):e,i=this.childCursor(t);for(let e=n.length-1;;e--){let t=e>=0?n[e]:null;if(!t)break;let{fromA:s,toA:o,fromB:l,toB:a}=t,c,h,u,d;if(r&&r.range.fromB<a&&r.range.toB>l){let e=gQ.build(this.view.state.doc,l,r.range.fromB,this.decorations,this.dynamicDecorationMap),t=gQ.build(this.view.state.doc,r.range.toB,a,this.decorations,this.dynamicDecorationMap);h=e.breakAtStart,u=e.openStart,d=t.openEnd;let n=this.compositionView(r);t.breakAtStart?n.breakAfter=1:t.content.length&&n.merge(n.length,n.length,t.content[0],!1,t.openStart,0)&&(n.breakAfter=t.content[0].breakAfter,t.content.shift()),e.content.length&&n.merge(0,0,e.content[e.content.length-1],!0,0,e.openEnd)&&e.content.pop(),c=e.content.concat(n).concat(t.content)}else({content:c,breakAtStart:h,openStart:u,openEnd:d}=gQ.build(this.view.state.doc,l,a,this.decorations,this.dynamicDecorationMap));let{i:f,off:p}=i.findPos(o,1),{i:m,off:g}=i.findPos(s,-1);gM(this,m,g,f,p,c,h,u,d)}r&&this.fixCompositionDOM(r)}updateEditContextFormatting(e){for(let t of(this.editContextFormatting=this.editContextFormatting.map(e.changes),e.transactions))for(let e of t.effects)e.is(yb)&&(this.editContextFormatting=e.value)}compositionView(e){let t=new gI(e.text.nodeValue);for(let{deco:r}of(t.flags|=8,e.marks))t=new g$(r,[t],t.length);let r=new gY;return r.append(t,0),r}fixCompositionDOM(e){let t=(e,t)=>{t.flags|=8|!!t.children.some(e=>7&e.flags),this.markedForComposition.add(t);let r=gj.get(e);r&&r!=t&&(r.dom=null),t.setDOM(e)},r=this.childPos(e.range.fromB,1),n=this.children[r.i];t(e.line,n);for(let i=e.marks.length-1;i>=-1;i--)r=n.childPos(r.off,1),n=n.children[r.i],t(i>=0?e.marks[i].node:e.text,n)}updateSelection(e=!1,t=!1){var r;(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let n=this.view.root.activeElement,i=n==this.dom,s=!i&&!(this.view.state.facet(yk)||this.dom.tabIndex>-1)&&gl(this.dom,this.view.observer.selectionRange)&&!(n&&this.dom.contains(n));if(!(i||t||s))return;let o=this.forceSelection;this.forceSelection=!1;let l=this.view.state.selection.main,a=this.moveToLine(this.domAtPos(l.anchor)),c=l.empty?a:this.moveToLine(this.domAtPos(l.head));if(gi.gecko&&l.empty&&!this.hasComposition&&1==(r=a).node.nodeType&&r.node.firstChild&&(0==r.offset||"false"==r.node.childNodes[r.offset-1].contentEditable)&&(r.offset==r.node.childNodes.length||"false"==r.node.childNodes[r.offset].contentEditable)){let e=document.createTextNode("");this.view.observer.ignore(()=>a.node.insertBefore(e,a.node.childNodes[a.offset]||null)),a=c=new gC(e,0),o=!0}let h=this.view.observer.selectionRange;!o&&h.focusNode&&(gc(a.node,a.offset,h.anchorNode,h.anchorOffset)&&gc(c.node,c.offset,h.focusNode,h.focusOffset)||this.suppressWidgetCursorChange(h,l))||(this.view.observer.ignore(()=>{gi.android&&gi.chrome&&this.dom.contains(h.focusNode)&&function(e,t){for(let r=e;r&&r!=t;r=r.assignedSlot||r.parentNode)if(1==r.nodeType&&"false"==r.contentEditable)return!0;return!1}(h.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let e=gs(this.view.root);if(e)if(l.empty){if(gi.gecko){var t,r;let e=(t=a.node,r=a.offset,1!=t.nodeType?0:(r&&"false"==t.childNodes[r-1].contentEditable?1:0)|2*(r<t.childNodes.length&&"false"==t.childNodes[r].contentEditable));if(e&&3!=e){let t=(1==e?gA:gS)(a.node,a.offset);t&&(a=new gC(t.node,t.offset))}}e.collapse(a.node,a.offset),null!=l.bidiLevel&&void 0!==e.caretBidiLevel&&(e.caretBidiLevel=l.bidiLevel)}else if(e.extend){e.collapse(a.node,a.offset);try{e.extend(c.node,c.offset)}catch(e){}}else{let t=document.createRange();l.anchor>l.head&&([a,c]=[c,a]),t.setEnd(c.node,c.offset),t.setStart(a.node,a.offset),e.removeAllRanges(),e.addRange(t)}s&&this.view.root.activeElement==this.dom&&(this.dom.blur(),n&&n.focus())}),this.view.observer.setSelectionRange(a,c)),this.impreciseAnchor=a.precise?null:new gC(h.anchorNode,h.anchorOffset),this.impreciseHead=c.precise?null:new gC(h.focusNode,h.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&gc(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,r=gs(e.root),{anchorNode:n,anchorOffset:i}=e.observer.selectionRange;if(!r||!t.empty||!t.assoc||!r.modify)return;let s=gY.find(this,t.head);if(!s)return;let o=s.posAtStart;if(t.head==o||t.head==o+s.length)return;let l=this.coordsAt(t.head,-1),a=this.coordsAt(t.head,1);if(!l||!a||l.bottom>a.top)return;let c=this.domAtPos(t.head+t.assoc);r.collapse(c.node,c.offset),r.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let h=e.observer.selectionRange;e.docView.posFromDOM(h.anchorNode,h.anchorOffset)!=t.from&&r.collapse(n,i)}moveToLine(e){let t=this.dom,r;if(e.node!=t)return e;for(let n=e.offset;!r&&n<t.childNodes.length;n++){let e=gj.get(t.childNodes[n]);e instanceof gY&&(r=e.domAtPos(0))}for(let n=e.offset-1;!r&&n>=0;n--){let e=gj.get(t.childNodes[n]);e instanceof gY&&(r=e.domAtPos(e.length))}return r?new gC(r.node,r.offset,!0):e}nearest(e){for(let t=e;t;){let e=gj.get(t);if(e&&e.rootView==this)return e;t=t.parentNode}return null}posFromDOM(e,t){let r=this.nearest(e);if(!r)throw RangeError("Trying to find position for a DOM position outside of the document");return r.localPosFromDOM(e,t)+r.posAtStart}domAtPos(e){let{i:t,off:r}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let e=this.children[t];if(r<e.length||e instanceof gY)break;t++,r=0}return this.children[t].domAtPos(r)}coordsAt(e,t){let r=null,n=0;for(let i=this.length,s=this.children.length-1;s>=0;s--){let o=this.children[s],l=i-o.breakAfter,a=l-o.length;if(l<e)break;if(a<=e&&(a<e||o.covers(-1))&&(l>e||o.covers(1))&&(!r||o instanceof gY&&!(r instanceof gY&&t>=0)))r=o,n=a;else if(r&&a==e&&l==e&&o instanceof gX&&2>Math.abs(t))if(o.deco.startSide<0)break;else s&&(r=null);i=a}return r?r.coordsAt(e-n,t):null}coordsForChar(e){let{i:t,off:r}=this.childPos(e,1),n=this.children[t];if(!(n instanceof gY))return null;for(;n.children.length;){let{i:e,off:t}=n.childPos(r,1);for(;;e++){if(e==n.children.length)return null;if((n=n.children[e]).length)break}r=t}if(!(n instanceof gI))return null;let i=pF(n.text,r);if(i==r)return null;let s=gx(n.dom,r,i).getClientRects();for(let e=0;e<s.length;e++){let t=s[e];if(e==s.length-1||t.top<t.bottom&&t.left<t.right)return t}return null}measureVisibleLineHeights(e){let t=[],{from:r,to:n}=e,i=this.view.contentDOM.clientWidth,s=i>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,o=-1,l=this.view.textDirection==g2.LTR;for(let e=0,a=0;a<this.children.length;a++){let c=this.children[a],h=e+c.length;if(h>n)break;if(e>=r){let r=c.dom.getBoundingClientRect();if(t.push(r.height),s){let t=c.dom.lastChild,n=t?ga(t):[];if(n.length){let t=n[n.length-1],s=l?t.right-r.left:r.right-t.left;s>o&&(o=s,this.minWidth=i,this.minWidthFrom=e,this.minWidthTo=h)}}}e=h+c.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return"rtl"==getComputedStyle(this.children[t].dom).direction?g2.RTL:g2.LTR}measureTextSize(){for(let e of this.children)if(e instanceof gY){let t=e.measureTextSize();if(t)return t}let e=document.createElement("div"),t,r,n;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let i=ga(e.firstChild)[0];t=e.getBoundingClientRect().height,r=i?i.width/27:7,n=i?i.height:t,e.remove()}),{lineHeight:t,charWidth:r,textHeight:n}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new gP(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let r=0,n=0;;n++){let i=n==t.viewports.length?null:t.viewports[n],s=i?i.from-1:this.length;if(s>r){let n=(t.lineBlockAt(s).bottom-t.lineBlockAt(r).top)/this.view.scaleY;e.push(gH.replace({widget:new gZ(n),block:!0,inclusive:!0,isBlockGap:!0}).range(r,s))}if(!i)break;r=i.to+1}return gH.set(e)}updateDeco(){let e=1,t=this.view.state.facet(yP).map(t=>(this.dynamicDecorationMap[e++]="function"==typeof t)?t(this.view):t),r=!1,n=this.view.state.facet(yM).map((e,t)=>{let n="function"==typeof e;return n&&(r=!0),n?e(this.view):e});for(n.length&&(this.dynamicDecorationMap[e++]=r,t.push(mT.join(n))),this.decorations=[this.editContextFormatting,...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let t=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=t.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let t of this.view.state.facet(yy))try{if(t(this.view,e.range,e))return!0}catch(e){yw(this.view.state,e,"scroll handler")}let{range:t}=e,r=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),n;if(!r)return;!t.empty&&(n=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(r={left:Math.min(r.left,n.left),top:Math.min(r.top,n.top),right:Math.max(r.right,n.right),bottom:Math.max(r.bottom,n.bottom)});let i=yR(this.view),s={left:r.left-i.left,top:r.top-i.top,right:r.right+i.right,bottom:r.bottom+i.bottom},{offsetWidth:o,offsetHeight:l}=this.view.scrollDOM;!function(e,t,r,n,i,s,o,l){let a=e.ownerDocument,c=a.defaultView||window;for(let h=e,u=!1;h&&!u;)if(1==h.nodeType){let e,d=h==a.body,f=1,p=1;if(d)e=function(e){let t=e.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:e.innerWidth,top:0,bottom:e.innerHeight}}(c);else{if(/^(fixed|sticky)$/.test(getComputedStyle(h).position)&&(u=!0),h.scrollHeight<=h.clientHeight&&h.scrollWidth<=h.clientWidth){h=h.assignedSlot||h.parentNode;continue}let t=h.getBoundingClientRect();({scaleX:f,scaleY:p}=gm(h,t)),e={left:t.left,right:t.left+h.clientWidth*f,top:t.top,bottom:t.top+h.clientHeight*p}}let m=0,g=0;if("nearest"==i)t.top<e.top?(g=t.top-(e.top+o),r>0&&t.bottom>e.bottom+g&&(g=t.bottom-e.bottom+o)):t.bottom>e.bottom&&(g=t.bottom-e.bottom+o,r<0&&t.top-g<e.top&&(g=t.top-(e.top+o)));else{let n=t.bottom-t.top,s=e.bottom-e.top;g=("center"==i&&n<=s?t.top+n/2-s/2:"start"==i||"center"==i&&r<0?t.top-o:t.bottom-s+o)-e.top}if("nearest"==n?t.left<e.left?(m=t.left-(e.left+s),r>0&&t.right>e.right+m&&(m=t.right-e.right+s)):t.right>e.right&&(m=t.right-e.right+s,r<0&&t.left<e.left+m&&(m=t.left-(e.left+s))):m=("center"==n?t.left+(t.right-t.left)/2-(e.right-e.left)/2:"start"==n==l?t.left-s:t.right-(e.right-e.left)+s)-e.left,m||g)if(d)c.scrollBy(m,g);else{let e=0,r=0;if(g){let e=h.scrollTop;h.scrollTop+=g/p,r=(h.scrollTop-e)*p}if(m){let t=h.scrollLeft;h.scrollLeft+=m/f,e=(h.scrollLeft-t)*f}t={left:t.left-e,top:t.top-r,right:t.right-e,bottom:t.bottom-r},e&&1>Math.abs(e-m)&&(n="nearest"),r&&1>Math.abs(r-g)&&(i="nearest")}if(d)break;(t.top<e.top||t.bottom>e.bottom||t.left<e.left||t.right>e.right)&&(t={left:Math.max(t.left,e.left),right:Math.min(t.right,e.right),top:Math.max(t.top,e.top),bottom:Math.min(t.bottom,e.bottom)}),h=h.assignedSlot||h.parentNode}else if(11==h.nodeType)h=h.host;else break}(this.view.scrollDOM,s,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,o),-o),Math.max(Math.min(e.yMargin,l),-l),this.view.textDirection==g2.LTR)}lineHasWidget(e){let{i:t}=this.childCursor().findPos(e);if(t==this.children.length)return!1;let r=e=>e instanceof gD||e.children.some(r);return r(this.children[t])}}function yB(e,t){let r=e.observer.selectionRange;if(!r.focusNode)return null;let n=gA(r.focusNode,r.focusOffset),i=gS(r.focusNode,r.focusOffset),s=n||i;if(i&&n&&i.node!=n.node){let t=gj.get(i.node);if(!t||t instanceof gI&&t.text!=i.node.nodeValue)s=i;else if(e.docView.lastCompositionAfterCursor){let e=gj.get(n.node);!e||e instanceof gI&&e.text!=n.node.nodeValue||(s=i)}}if(e.docView.lastCompositionAfterCursor=s!=n,!s)return null;let o=t-s.offset;return{from:o,to:o+s.node.nodeValue.length,node:s.node}}let yz=class{constructor(){this.changes=[]}compareRange(e,t){gJ(e,t,this.changes)}comparePoint(e,t){gJ(e,t,this.changes)}boundChange(e){gJ(e,e,this.changes)}};function yW(e,t){return e.top<t.bottom-1&&e.bottom>t.top+1}function yV(e,t){return t<e.top?{top:t,left:e.left,right:e.right,bottom:e.bottom}:e}function yH(e,t){return t>e.bottom?{top:e.top,left:e.left,right:e.right,bottom:t}:e}function yU(e,t,r){let n=e.nodeValue.length,i=-1,s=1e9,o=0;for(let l=0;l<n;l++){let n=gx(e,l,l+1).getClientRects();for(let a=0;a<n.length;a++){let c=n[a];if(c.top==c.bottom)continue;o||(o=t-c.left);let h=(c.top>r?c.top-r:r-c.bottom)-1;if(c.left-1<=t&&c.right+1>=t&&h<s){let r=t>=(c.left+c.right)/2,n=r;if((gi.chrome||gi.gecko)&&gx(e,l).getBoundingClientRect().left==c.right&&(n=!r),h<=0)return{node:e,offset:l+ +!!n};i=l+ +!!n,s=h}}}return{node:e,offset:i>-1?i:o>0?e.nodeValue.length:0}}function yq(e,t,r,n=-1){var i,s;let o=e.contentDOM.getBoundingClientRect(),l=o.top+e.viewState.paddingTop,a,{docHeight:c}=e.viewState,{x:h,y:u}=t,d=u-l;if(d<0)return 0;if(d>c)return e.state.doc.length;for(let t=e.viewState.heightOracle.textHeight/2,i=!1;(a=e.elementAtHeight(d)).type!=gV.Text;)for(;!((d=n>0?a.bottom+t:a.top-t)>=0)||!(d<=c);){if(i)return r?null:0;i=!0,n=-n}u=l+d;let f=a.from;if(f<e.viewport.from)return 0==e.viewport.from?0:r?null:yK(e,o,a,h,u);if(f>e.viewport.to)return e.viewport.to==e.state.doc.length?e.state.doc.length:r?null:yK(e,o,a,h,u);let p=e.dom.ownerDocument,m=e.root.elementFromPoint?e.root:p,g=m.elementFromPoint(h,u);g&&!e.contentDOM.contains(g)&&(g=null),!g&&(h=Math.max(o.left+1,Math.min(o.right-1,h)),(g=m.elementFromPoint(h,u))&&!e.contentDOM.contains(g)&&(g=null));let y,v=-1;if(g&&(null==(i=e.docView.nearest(g))?void 0:i.isEditable)!=!1){if(p.caretPositionFromPoint){let e=p.caretPositionFromPoint(h,u);e&&({offsetNode:y,offset:v}=e)}else if(p.caretRangeFromPoint){let e=p.caretRangeFromPoint(h,u);e&&({startContainer:y,startOffset:v}=e)}y&&(!e.contentDOM.contains(y)||gi.safari&&yG(y,v,h)||gi.chrome&&function(e,t,r){if(0!=t)return yG(e,t,r);for(let t=e;;){let e=t.parentNode;if(!e||1!=e.nodeType||e.firstChild!=t)return!1;if(e.classList.contains("cm-line"))break;t=e}return r-(1==e.nodeType?e.getBoundingClientRect():gx(e,0,Math.max(e.nodeValue.length,1)).getBoundingClientRect()).left>5}(y,v,h))&&(y=void 0),y&&(v=Math.min(gf(y),v))}if(!y||!e.docView.dom.contains(y)){let t=gY.find(e.docView,f);if(!t)return d>a.top+a.height/2?a.to:a.from;({node:y,offset:v}=function e(t,r,n){let i,s,o,l,a,c,h,u,d=!1;for(let m=t.firstChild;m;m=m.nextSibling){let t=ga(m);for(let g=0;g<t.length;g++){var f,p;let y=t[g];c&&yW(c,y)&&(y=yV(yH(y,c.bottom),c.top));let v=(f=y).left>r?f.left-r:Math.max(0,r-f.right),x=(p=y).top>n?p.top-n:Math.max(0,n-p.bottom);if(0==v&&0==x)return 3==m.nodeType?yU(m,r,n):e(m,r,n);(!a||u>x||u==x&&h>v)&&(a=m,c=y,h=v,u=x,d=!v||(r<y.left?g>0:g<t.length-1)),0==v?n>y.bottom&&(!o||o.bottom<y.bottom)?(i=m,o=y):n<y.top&&(!l||l.top>y.top)&&(s=m,l=y):o&&yW(o,y)?o=yH(o,y.bottom):l&&yW(l,y)&&(l=yV(l,y.top))}}if(o&&o.bottom>=n?(a=i,c=o):l&&l.top<=n&&(a=s,c=l),!a)return{node:t,offset:0};let m=Math.max(c.left,Math.min(c.right,r));if(3==a.nodeType)return yU(a,m,n);if(d&&"false"!=a.contentEditable)return e(a,m,n);let g=Array.prototype.indexOf.call(t.childNodes,a)+ +(r>=(c.left+c.right)/2);return{node:t,offset:g}}(t.dom,h,u))}let x=e.docView.nearest(y);if(!x)return null;if(!x.isWidget||(null==(s=x.dom)?void 0:s.nodeType)!=1)return x.localPosFromDOM(y,v)+x.posAtStart;{let e=x.dom.getBoundingClientRect();return t.y<e.top||t.y<=e.bottom&&t.x<=(e.left+e.right)/2?x.posAtStart:x.posAtEnd}}function yK(e,t,r,n,i){let s=Math.round((n-t.left)*e.defaultCharacterWidth);if(e.lineWrapping&&r.height>1.5*e.defaultLineHeight){let t=e.viewState.heightOracle.textHeight;s+=Math.floor((i-r.top-(e.defaultLineHeight-t)*.5)/t)*e.viewState.heightOracle.lineLength}let o=e.state.sliceDoc(r.from,r.to);return r.from+mH(o,s,e.state.tabSize)}function yG(e,t,r){let n,i=e;if(3!=e.nodeType||t!=(n=e.nodeValue.length))return!1;for(;;){let e=i.nextSibling;if(e){if("BR"==e.nodeName)break;return!1}{let e=i.parentNode;if(!e||"DIV"==e.nodeName)break;i=e}}return gx(e,n-1,n).getBoundingClientRect().right>r}function yJ(e,t,r){let n=e.lineBlockAt(t);if(Array.isArray(n.type)){let e;for(let i of n.type){if(i.from>t)break;if(!(i.to<t)){if(i.from<t&&i.to>t)return i;(!e||i.type==gV.Text&&(e.type!=i.type||(r<0?i.from<t:i.to>t)))&&(e=i)}}return e||n}return n}function yY(e,t,r,n){let i=e.state.doc.lineAt(t.head),s=e.bidiSpans(i),o=e.textDirectionAt(i.from);for(let l=t,a=null;;){let t=function(e,t,r,n,i){var s;let o=n.head-e.from,l=yr.find(t,o,null!=(s=n.bidiLevel)?s:-1,n.assoc),a=t[l],c=a.side(i,r);if(o==c){let e=l+=i?1:-1;if(e<0||e>=t.length)return null;o=(a=t[l=e]).side(!i,r),c=a.side(i,r)}let h=pF(e.text,o,a.forward(i,r));(h<a.from||h>a.to)&&(h=c),ys=e.text.slice(Math.min(o,h),Math.max(o,h));let u=l==(i?t.length-1:0)?null:t[l+(i?1:-1)];return u&&h==c&&u.level+ +!i<a.level?pQ.cursor(u.side(!i,r)+e.from,u.forward(i,r)?1:-1,u.level):pQ.cursor(h+e.from,a.forward(i,r)?-1:1,a.level)}(i,s,o,l,r),c=ys;if(!t){if(i.number==(r?e.state.doc.lines:1))return l;c="\n",i=e.state.doc.line(i.number+(r?1:-1)),s=e.bidiSpans(i),t=e.visualLineSide(i,!r)}if(a){if(!a(c))return l}else{if(!n)return t;a=n(c)}l=t}}function yX(e,t,r){for(;;){let n=0;for(let i of e)i.between(t-1,t+1,(e,i,s)=>{if(t>e&&t<i){let s=n||r||(t-e<i-t?-1:1);t=s<0?e:i,n=s}});if(!n)return t}}function yZ(e,t){let r=null;for(let n=0;n<t.ranges.length;n++){let i=t.ranges[n],s=null;if(i.empty){let t=yX(e,i.from,0);t!=i.from&&(s=pQ.cursor(t,-1))}else{let t=yX(e,i.from,-1),r=yX(e,i.to,1);(t!=i.from||r!=i.to)&&(s=pQ.range(i.from==i.anchor?t:r,i.from==i.head?t:r))}s&&(r||(r=t.ranges.slice()),r[n]=s)}return r?pQ.create(r,t.mainIndex):t}function yQ(e,t,r){let n=yX(e.state.facet(yT).map(t=>t(e)),r.from,t.head>r.from?-1:1);return n==r.from?r:pQ.cursor(n,n<r.from?1:-1)}class y0{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(mC.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=""}readRange(e,t){if(!e)return this;let r=e.parentNode;for(let n=e;;){this.findPointBefore(r,n);let e=this.text.length;this.readNode(n);let i=n.nextSibling;if(i==t)break;let s=gj.get(n),o=gj.get(i);(s&&o?s.breakAfter:(s?s.breakAfter:gu(n))||gu(i)&&("BR"!=n.nodeName||n.cmIgnore)&&this.text.length>e)&&!function(e,t){let r;for(;e!=t&&e;e=e.nextSibling){let t=gj.get(e);if(!((null==t?void 0:t.isWidget)||e.cmIgnore))return!1;t&&(r||(r=[])).push(t)}if(r)for(let e of r){let t=e.overrideDOMText;if(null==t?void 0:t.length)return!1}return!0}(i,t)&&this.lineBreak(),n=i}return this.findPointBefore(r,t),this}readTextNode(e){let t=e.nodeValue;for(let r of this.points)r.node==e&&(r.pos=this.text.length+Math.min(r.offset,t.length));for(let r=0,n=this.lineSeparator?null:/\r\n?|\n/g;;){let i=-1,s=1,o;if(this.lineSeparator?(i=t.indexOf(this.lineSeparator,r),s=this.lineSeparator.length):(o=n.exec(t))&&(i=o.index,s=o[0].length),this.append(t.slice(r,i<0?t.length:i)),i<0)break;if(this.lineBreak(),s>1)for(let t of this.points)t.node==e&&t.pos>this.text.length&&(t.pos-=s-1);r=i+s}}readNode(e){if(e.cmIgnore)return;let t=gj.get(e),r=t&&t.overrideDOMText;if(null!=r){this.findPointInside(e,r.length);for(let e=r.iter();!e.next().done;)e.lineBreak?this.lineBreak():this.append(e.value)}else 3==e.nodeType?this.readTextNode(e):"BR"==e.nodeName?e.nextSibling&&this.lineBreak():1==e.nodeType&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let r of this.points)r.node==e&&e.childNodes[r.offset]==t&&(r.pos=this.text.length)}findPointInside(e,t){for(let r of this.points)(3==e.nodeType?r.node==e:e.contains(r.node))&&(r.pos=this.text.length+(!function(e,t,r){for(;;){if(!t||r<gf(t))return!1;if(t==e)return!0;r=gh(t)+1,t=t.parentNode}}(e,r.node,r.offset)?0:t))}}class y1{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class y2{constructor(e,t,r,n){this.typeOver=n,this.bounds=null,this.text="",this.domChanged=t>-1;let{impreciseHead:i,impreciseAnchor:s}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=e.docView.domBoundsAround(t,r,0))){let t=i||s?[]:function(e){let t=[];if(e.root.activeElement!=e.contentDOM)return t;let{anchorNode:r,anchorOffset:n,focusNode:i,focusOffset:s}=e.observer.selectionRange;return r&&(t.push(new y1(r,n)),(i!=r||s!=n)&&t.push(new y1(i,s))),t}(e),r=new y0(t,e.state);r.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=r.text,this.newSel=function(e,t){if(0==e.length)return null;let r=e[0].pos,n=2==e.length?e[1].pos:r;return r>-1&&n>-1?pQ.single(r+t,n+t):null}(t,this.bounds.from)}else{let t=e.observer.selectionRange,r=i&&i.node==t.focusNode&&i.offset==t.focusOffset||!go(e.contentDOM,t.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(t.focusNode,t.focusOffset),n=s&&s.node==t.anchorNode&&s.offset==t.anchorOffset||!go(e.contentDOM,t.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(t.anchorNode,t.anchorOffset),o=e.viewport;if((gi.ios||gi.chrome)&&e.state.selection.main.empty&&r!=n&&(o.from>0||o.to<e.state.doc.length)){let t=Math.min(r,n),i=Math.max(r,n),s=o.from-t,l=o.to-i;(0==s||1==s||0==t)&&(0==l||-1==l||i==e.state.doc.length)&&(r=0,n=e.state.doc.length)}this.newSel=pQ.single(n,r)}}}function y4(e,t){let r,{newSel:n}=t,i=e.state.selection.main,s=e.inputState.lastKeyTime>Date.now()-100?e.inputState.lastKeyCode:-1;if(t.bounds){let{from:n,to:o}=t.bounds,l=i.from,a=null;(8===s||gi.android&&t.text.length<o-n)&&(l=i.to,a="end");let c=y5(e.state.doc.sliceString(n,o,""),t.text,l-n,a);c&&(gi.chrome&&13==s&&c.toB==c.from+2&&""==t.text.slice(c.from,c.toB)&&c.toB--,r={from:n+c.from,to:n+c.toA,insert:pP.of(t.text.slice(c.from,c.toB).split(""))})}else n&&(!e.hasFocus&&e.state.facet(yk)||n.main.eq(i))&&(n=null);if(!r&&!n)return!1;if(!r&&t.typeOver&&!i.empty&&n&&n.main.empty?r={from:i.from,to:i.to,insert:e.state.doc.slice(i.from,i.to)}:(gi.mac||gi.android)&&r&&r.from==r.to&&r.from==i.head-1&&/^\. ?$/.test(r.insert.toString())&&"off"==e.contentDOM.getAttribute("autocorrect")?(n&&2==r.insert.length&&(n=pQ.single(n.main.anchor-1,n.main.head-1)),r={from:r.from,to:r.to,insert:pP.of([r.insert.toString().replace("."," ")])}):r&&r.from>=i.from&&r.to<=i.to&&(r.from!=i.from||r.to!=i.to)&&i.to-i.from-(r.to-r.from)<=4?r={from:i.from,to:i.to,insert:e.state.doc.slice(i.from,r.from).append(r.insert).append(e.state.doc.slice(r.to,i.to))}:e.state.doc.lineAt(i.from).to<i.to&&e.docView.lineHasWidget(i.to)&&e.inputState.insertingTextAt>Date.now()-50?r={from:i.from,to:i.to,insert:e.state.toText(e.inputState.insertingText)}:gi.chrome&&r&&r.from==r.to&&r.from==i.head&&"\n "==r.insert.toString()&&e.lineWrapping&&(n&&(n=pQ.single(n.main.anchor-1,n.main.head-1)),r={from:i.from,to:i.to,insert:pP.of([" "])}),r)return y3(e,r,n,s);if(!n||n.main.eq(i))return!1;{let t=!1,r="select";return e.inputState.lastSelectionTime>Date.now()-50&&("select"==e.inputState.lastSelectionOrigin&&(t=!0),"select.pointer"==(r=e.inputState.lastSelectionOrigin)&&(n=yZ(e.state.facet(yT).map(t=>t(e)),n))),e.dispatch({selection:n,scrollIntoView:t,userEvent:r}),!0}}function y3(e,t,r,n=-1){let i;if(gi.ios&&e.inputState.flushIOSKey(t))return!0;let s=e.state.selection.main;if(gi.android&&(t.to==s.to&&(t.from==s.from||t.from==s.from-1&&" "==e.state.sliceDoc(t.from,s.from))&&1==t.insert.length&&2==t.insert.lines&&gb(e.contentDOM,"Enter",13)||(t.from==s.from-1&&t.to==s.to&&0==t.insert.length||8==n&&t.insert.length<t.to-t.from&&t.to>s.head)&&gb(e.contentDOM,"Backspace",8)||t.from==s.from&&t.to==s.to+1&&0==t.insert.length&&gb(e.contentDOM,"Delete",46)))return!0;let o=t.insert.toString();e.inputState.composing>=0&&e.inputState.composing++;let l=()=>i||(i=function(e,t,r){let n,i=e.state,s=i.selection.main,o=-1;if(t.from==t.to&&t.from<s.from||t.from>s.to){let r=t.from<s.from?-1:1,n=r<0?s.from:s.to,l=yX(i.facet(yT).map(t=>t(e)),n,r);t.from==l&&(o=l)}if(o>-1)n={changes:t,selection:pQ.cursor(t.from+t.insert.length,-1)};else if(t.from>=s.from&&t.to<=s.to&&t.to-t.from>=(s.to-s.from)/3&&(!r||r.main.empty&&r.main.from==t.from+t.insert.length)&&e.inputState.composing<0){let r=s.from<t.from?i.sliceDoc(s.from,t.from):"",o=s.to>t.to?i.sliceDoc(t.to,s.to):"";n=i.replaceSelection(e.state.toText(r+t.insert.sliceString(0,void 0,e.state.lineBreak)+o))}else{let o=i.changes(t),l=r&&r.main.to<=o.newLength?r.main:void 0;if(i.selection.ranges.length>1&&e.inputState.composing>=0&&t.to<=s.to+10&&t.to>=s.to-10){let a=e.state.sliceDoc(t.from,t.to),c,h=r&&yB(e,r.main.head);if(h){let e=t.insert.length-(t.to-t.from);c={from:h.from,to:h.to-e}}else c=e.state.doc.lineAt(s.head);let u=s.to-t.to,d=s.to-s.from;n=i.changeByRange(r=>{if(r.from==s.from&&r.to==s.to)return{changes:o,range:l||r.map(o)};let n=r.to-u,h=n-a.length;if(r.to-r.from!=d||e.state.sliceDoc(h,n)!=a||r.to>=c.from&&r.from<=c.to)return{range:r};let f=i.changes({from:h,to:n,insert:t.insert}),p=r.to-s.to;return{changes:f,range:l?pQ.range(Math.max(0,l.anchor+p),Math.max(0,l.head+p)):r.map(f)}})}else n={changes:o,selection:l&&i.selection.replaceRange(l)}}let l="input.type";return(e.composing||e.inputState.compositionPendingChange&&e.inputState.compositionEndedAt>Date.now()-50)&&(e.inputState.compositionPendingChange=!1,l+=".compose",e.inputState.compositionFirstChange&&(l+=".start",e.inputState.compositionFirstChange=!1)),i.update(n,{userEvent:l,scrollIntoView:!0})}(e,t,r));return e.state.facet(yu).some(r=>r(e,t.from,t.to,o,l))||e.dispatch(l()),!0}function y5(e,t,r,n){let i=Math.min(e.length,t.length),s=0;for(;s<i&&e.charCodeAt(s)==t.charCodeAt(s);)s++;if(s==i&&e.length==t.length)return null;let o=e.length,l=t.length;for(;o>0&&l>0&&e.charCodeAt(o-1)==t.charCodeAt(l-1);)o--,l--;if("end"==n){let e=Math.max(0,s-Math.min(o,l));r-=o+e-s}if(o<s&&e.length<t.length){let e=r<=s&&r>=o?s-r:0;s-=e,l=s+(l-o),o=s}else if(l<s){let e=r<=s&&r>=l?s-r:0;s-=e,o=s+(o-l),l=s}return{from:s,toA:o,toB:l}}class y6{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.insertingText="",this.insertingTextAt=0,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,gi.safari&&e.contentDOM.addEventListener("input",()=>null),gi.gecko&&function(e){vw.has(e)||(vw.add(e),e.addEventListener("copy",()=>{}),e.addEventListener("cut",()=>{}))}(e.contentDOM.ownerDocument)}handleEvent(e){!function(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let r=t.target,n;r!=e.contentDOM;r=r.parentNode)if(!r||11==r.nodeType||(n=gj.get(r))&&n.ignoreEvent(t))return!1;return!0}(this.view,e)||this.ignoreDuringComposition(e)||"keydown"==e.type&&this.keydown(e)||(0!=this.view.updateState?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,t){let r=this.handlers[e];if(r){for(let e of r.observers)e(this.view,t);for(let e of r.handlers){if(t.defaultPrevented)break;if(e(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=function(e){let t=Object.create(null);function r(e){return t[e]||(t[e]={observers:[],handlers:[]})}for(let t of e){let e=t.spec,n=e&&e.plugin.domEventHandlers,i=e&&e.plugin.domEventObservers;if(n)for(let e in n){let i=n[e];i&&r(e).handlers.push(y9(t.value,i))}if(i)for(let e in i){let n=i[e];n&&r(e).observers.push(y9(t.value,n))}}for(let e in vn)r(e).handlers.push(vn[e]);for(let e in vi)r(e).observers.push(vi[e]);return t}(e),r=this.handlers,n=this.view.contentDOM;for(let e in t)if("scroll"!=e){let i=!t[e].handlers.length,s=r[e];s&&!s.handlers.length!=i&&(n.removeEventListener(e,this.handleEvent),s=null),s||n.addEventListener(e,this.handleEvent,{passive:i})}for(let e in r)"scroll"==e||t[e]||n.removeEventListener(e,this.handleEvent);this.handlers=t}keydown(e){let t;return this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),!!(9==e.keyCode&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))||((this.tabFocusMode>0&&27!=e.keyCode&&0>ve.indexOf(e.keyCode)&&(this.tabFocusMode=-1),gi.android&&gi.chrome&&!e.synthetic&&(13==e.keyCode||8==e.keyCode))?(this.view.observer.delayAndroidKey(e.key,e.keyCode),!0):gi.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=y8.find(t=>t.keyCode==e.keyCode))&&!e.ctrlKey||y7.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(229!=e.keyCode&&this.view.observer.forceFlush(),!1))}flushIOSKey(e){let t=this.pendingIOSKey;return!(!t||"Enter"==t.key&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString()))&&(this.pendingIOSKey=void 0,gb(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return!!/^key/.test(e.type)&&!e.synthetic&&(this.composing>0||!!(gi.safari&&!gi.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100)&&(this.compositionPendingKey=!1,!0))}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function y9(e,t){return(r,n)=>{try{return t.call(e,n,r)}catch(e){yw(r.state,e)}}}let y8=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],y7="dthko",ve=[16,17,18,20,91,92,224,225];function vt(e){return .7*Math.max(0,e)+8}class vr{constructor(e,t,r,n){this.view=e,this.startEvent=t,this.style=r,this.mustSelect=n,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParents=function(e){let t=e.ownerDocument,r,n;for(let i=e.parentNode;i;)if(i==t.body||r&&n)break;else if(1==i.nodeType)!n&&i.scrollHeight>i.clientHeight&&(n=i),!r&&i.scrollWidth>i.clientWidth&&(r=i),i=i.assignedSlot||i.parentNode;else if(11==i.nodeType)i=i.host;else break;return{x:r,y:n}}(e.contentDOM),this.atoms=e.state.facet(yT).map(t=>t(e));let i=e.contentDOM.ownerDocument;i.addEventListener("mousemove",this.move=this.move.bind(this)),i.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(mC.allowMultipleSelections)&&function(e,t){let r=e.state.facet(yo);return r.length?r[0](t):gi.mac?t.metaKey:t.ctrlKey}(e,t),this.dragging=!!function(e,t){let{main:r}=e.state.selection;if(r.empty)return!1;let n=gs(e.root);if(!n||0==n.rangeCount)return!0;let i=n.getRangeAt(0).getClientRects();for(let e=0;e<i.length;e++){let r=i[e];if(r.left<=t.clientX&&r.right>=t.clientX&&r.top<=t.clientY&&r.bottom>=t.clientY)return!0}return!1}(e,t)&&1==vm(t)&&null}start(e){!1===this.dragging&&this.select(e)}move(e){var t;if(0==e.buttons)return this.destroy();if(this.dragging||null==this.dragging&&10>(t=this.startEvent,Math.max(Math.abs(t.clientX-e.clientX),Math.abs(t.clientY-e.clientY))))return;this.select(this.lastEvent=e);let r=0,n=0,i=0,s=0,o=this.view.win.innerWidth,l=this.view.win.innerHeight;this.scrollParents.x&&({left:i,right:o}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:s,bottom:l}=this.scrollParents.y.getBoundingClientRect());let a=yR(this.view);e.clientX-a.left<=i+6?r=-vt(i-e.clientX):e.clientX+a.right>=o-6&&(r=vt(e.clientX-o)),e.clientY-a.top<=s+6?n=-vt(s-e.clientY):e.clientY+a.bottom>=l-6&&(n=vt(e.clientY-l)),this.setScrollSpeed(r,n)}up(e){null==this.dragging&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:t}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),t&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=t,t=0),(e||t)&&this.view.win.scrollBy(e,t),!1===this.dragging&&this.select(this.lastEvent)}select(e){let{view:t}=this,r=yZ(this.atoms,this.style.get(e,this.extend,this.multiple));(this.mustSelect||!r.eq(t.state.selection,!1===this.dragging))&&this.view.dispatch({selection:r,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(e=>e.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}let vn=Object.create(null),vi=Object.create(null),vs=gi.ie&&gi.ie_version<15||gi.ios&&gi.webkit_version<604;function vo(e,t,r){for(let n of e.facet(t))r=n(r,e);return r}function vl(e,t){t=vo(e.state,yf,t);let{state:r}=e,n,i=1,s=r.toText(t),o=s.lines==r.selection.ranges.length;if(null!=vy&&r.selection.ranges.every(e=>e.empty)&&vy==s.toString()){let e=-1;n=r.changeByRange(n=>{let l=r.doc.lineAt(n.from);if(l.from==e)return{range:n};e=l.from;let a=r.toText((o?s.line(i++).text:t)+r.lineBreak);return{changes:{from:l.from,insert:a},range:pQ.cursor(n.from+a.length)}})}else n=o?r.changeByRange(e=>{let t=s.line(i++);return{changes:{from:e.from,to:e.to,insert:t.text},range:pQ.cursor(e.from+t.length)}}):r.replaceSelection(s);e.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}function va(e,t,r,n){if(1==n)return pQ.cursor(t,r);{if(2==n)return function(e,t,r=1){let n=e.charCategorizer(t),i=e.doc.lineAt(t),s=t-i.from;if(0==i.length)return pQ.cursor(t);0==s?r=1:s==i.length&&(r=-1);let o=s,l=s;r<0?o=pF(i.text,s,!1):l=pF(i.text,s);let a=n(i.text.slice(o,l));for(;o>0;){let e=pF(i.text,o,!1);if(n(i.text.slice(e,o))!=a)break;o=e}for(;l<i.length;){let e=pF(i.text,l);if(n(i.text.slice(l,e))!=a)break;l=e}return pQ.range(o+i.from,l+i.from)}(e.state,t,r);let i=gY.find(e.docView,t),s=e.state.doc.lineAt(i?i.posAtEnd:t),o=i?i.posAtStart:s.from,l=i?i.posAtEnd:s.to;return l<e.state.doc.length&&l==s.to&&l++,pQ.range(o,l)}}vi.scroll=e=>{e.inputState.lastScrollTop=e.scrollDOM.scrollTop,e.inputState.lastScrollLeft=e.scrollDOM.scrollLeft},vn.keydown=(e,t)=>(e.inputState.setSelectionOrigin("select"),27==t.keyCode&&0!=e.inputState.tabFocusMode&&(e.inputState.tabFocusMode=Date.now()+2e3),!1),vi.touchstart=(e,t)=>{e.inputState.lastTouchTime=Date.now(),e.inputState.setSelectionOrigin("select.pointer")},vi.touchmove=e=>{e.inputState.setSelectionOrigin("select.pointer")},vn.mousedown=(e,t)=>{var r,n;let i,s,o;if(e.observer.flush(),e.inputState.lastTouchTime>Date.now()-2e3)return!1;let l=null;for(let r of e.state.facet(ya))if(l=r(e,t))break;if(l||0!=t.button||(i=vh(r=e,n=t),s=vm(n),o=r.state.selection,l={update(e){e.docChanged&&(i.pos=e.changes.mapPos(i.pos),o=o.map(e.changes))},get(e,t,n){let l=vh(r,e),a,c=va(r,l.pos,l.bias,s);if(i.pos!=l.pos&&!t){let e=va(r,i.pos,i.bias,s),t=Math.min(e.from,c.from),n=Math.max(e.to,c.to);c=t<c.from?pQ.range(t,n):pQ.range(n,t)}return t?o.replaceRange(o.main.extend(c.from,c.to)):n&&1==s&&o.ranges.length>1&&(a=function(e,t){for(let r=0;r<e.ranges.length;r++){let{from:n,to:i}=e.ranges[r];if(n<=t&&i>=t)return pQ.create(e.ranges.slice(0,r).concat(e.ranges.slice(r+1)),e.mainIndex==r?0:e.mainIndex-(e.mainIndex>r))}return null}(o,l.pos))?a:n?o.addRange(c):pQ.create([c])}}),l){let r=!e.hasFocus;e.inputState.startMouseSelection(new vr(e,t,l,r)),r&&e.observer.ignore(()=>{gv(e.contentDOM);let t=e.root.activeElement;t&&!t.contains(e.contentDOM)&&t.blur()});let n=e.inputState.mouseSelection;if(n)return n.start(t),!1===n.dragging}else e.inputState.setSelectionOrigin("select.pointer");return!1};let vc=(e,t,r)=>t>=r.top&&t<=r.bottom&&e>=r.left&&e<=r.right;function vh(e,t){let r=e.posAtCoords({x:t.clientX,y:t.clientY},!1);return{pos:r,bias:function(e,t,r,n){let i=gY.find(e.docView,t);if(!i)return 1;let s=t-i.posAtStart;if(0==s)return 1;if(s==i.length)return -1;let o=i.coordsAt(s,-1);if(o&&vc(r,n,o))return -1;let l=i.coordsAt(s,1);return l&&vc(r,n,l)?1:o&&o.bottom>=n?-1:1}(e,r,t.clientX,t.clientY)}}let vu=gi.ie&&gi.ie_version<=11,vd=null,vf=0,vp=0;function vm(e){if(!vu)return e.detail;let t=vd,r=vp;return vd=e,vp=Date.now(),vf=!t||r>Date.now()-400&&2>Math.abs(t.clientX-e.clientX)&&2>Math.abs(t.clientY-e.clientY)?(vf+1)%3:1}function vg(e,t,r,n){let i;if(!(r=vo(e.state,yf,r)))return;let s=e.posAtCoords({x:t.clientX,y:t.clientY},!1),{draggedContent:o}=e.inputState,l=n&&o&&((i=e.state.facet(yl)).length?i[0](t):gi.mac?!t.altKey:!t.ctrlKey)?{from:o.from,to:o.to}:null,a={from:s,insert:r},c=e.state.changes(l?[l,a]:a);e.focus(),e.dispatch({changes:c,selection:{anchor:c.mapPos(s,-1),head:c.mapPos(s,1)},userEvent:l?"move.drop":"input.drop"}),e.inputState.draggedContent=null}vn.dragstart=(e,t)=>{let{selection:{main:r}}=e.state;if(t.target.draggable){let n=e.docView.nearest(t.target);if(n&&n.isWidget){let e=n.posAtStart,t=e+n.length;(e>=r.to||t<=r.from)&&(r=pQ.range(e,t))}}let{inputState:n}=e;return n.mouseSelection&&(n.mouseSelection.dragging=!0),n.draggedContent=r,t.dataTransfer&&(t.dataTransfer.setData("Text",vo(e.state,yp,e.state.sliceDoc(r.from,r.to))),t.dataTransfer.effectAllowed="copyMove"),!1},vn.dragend=e=>(e.inputState.draggedContent=null,!1),vn.drop=(e,t)=>{if(!t.dataTransfer)return!1;if(e.state.readOnly)return!0;let r=t.dataTransfer.files;if(r&&r.length){let n=Array(r.length),i=0,s=()=>{++i==r.length&&vg(e,t,n.filter(e=>null!=e).join(e.state.lineBreak),!1)};for(let e=0;e<r.length;e++){let t=new FileReader;t.onerror=s,t.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(t.result)||(n[e]=t.result),s()},t.readAsText(r[e])}return!0}{let r=t.dataTransfer.getData("Text");if(r)return vg(e,t,r,!0),!0}return!1},vn.paste=(e,t)=>{if(e.state.readOnly)return!0;e.observer.flush();let r=vs?null:t.clipboardData;return r?(vl(e,r.getData("text/plain")||r.getData("text/uri-list")),!0):(!function(e){let t=e.dom.parentNode;if(!t)return;let r=t.appendChild(document.createElement("textarea"));r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus(),setTimeout(()=>{e.focus(),r.remove(),vl(e,r.value)},50)}(e),!1)};let vy=null;vn.copy=vn.cut=(e,t)=>{let{text:r,ranges:n,linewise:i}=function(e){let t=[],r=[],n=!1;for(let n of e.selection.ranges)n.empty||(t.push(e.sliceDoc(n.from,n.to)),r.push(n));if(!t.length){let i=-1;for(let{from:n}of e.selection.ranges){let s=e.doc.lineAt(n);s.number>i&&(t.push(s.text),r.push({from:s.from,to:Math.min(e.doc.length,s.to+1)})),i=s.number}n=!0}return{text:vo(e,yp,t.join(e.lineBreak)),ranges:r,linewise:n}}(e.state);if(!r&&!i)return!1;vy=i?r:null,"cut"!=t.type||e.state.readOnly||e.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"});let s=vs?null:t.clipboardData;return s?(s.clearData(),s.setData("text/plain",r),!0):(!function(e,t){let r=e.dom.parentNode;if(!r)return;let n=r.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=t,n.focus(),n.selectionEnd=t.length,n.selectionStart=0,setTimeout(()=>{n.remove(),e.focus()},50)}(e,r),!1)};let vv=mp.define();function vx(e,t){let r=[];for(let n of e.facet(yd)){let i=n(e,t);i&&r.push(i)}return r.length?e.update({effects:r,annotations:vv.of(!0)}):null}function vb(e){setTimeout(()=>{let t=e.hasFocus;if(t!=e.inputState.notifiedFocused){let r=vx(e.state,t);r?e.dispatch(r):e.update([])}},10)}vi.focus=e=>{e.inputState.lastFocusTime=Date.now(),!e.scrollDOM.scrollTop&&(e.inputState.lastScrollTop||e.inputState.lastScrollLeft)&&(e.scrollDOM.scrollTop=e.inputState.lastScrollTop,e.scrollDOM.scrollLeft=e.inputState.lastScrollLeft),vb(e)},vi.blur=e=>{e.observer.clearSelectionRange(),vb(e)},vi.compositionstart=vi.compositionupdate=e=>{!e.observer.editContext&&(null==e.inputState.compositionFirstChange&&(e.inputState.compositionFirstChange=!0),e.inputState.composing<0&&(e.inputState.composing=0))},vi.compositionend=e=>{e.observer.editContext||(e.inputState.composing=-1,e.inputState.compositionEndedAt=Date.now(),e.inputState.compositionPendingKey=!0,e.inputState.compositionPendingChange=e.observer.pendingRecords().length>0,e.inputState.compositionFirstChange=null,gi.chrome&&gi.android?e.observer.flushSoon():e.inputState.compositionPendingChange?Promise.resolve().then(()=>e.observer.flush()):setTimeout(()=>{e.inputState.composing<0&&e.docView.hasComposition&&e.update([])},50))},vi.contextmenu=e=>{e.inputState.lastContextMenu=Date.now()},vn.beforeinput=(e,t)=>{var r,n;let i;if(("insertText"==t.inputType||"insertCompositionText"==t.inputType)&&(e.inputState.insertingText=t.data,e.inputState.insertingTextAt=Date.now()),"insertReplacementText"==t.inputType&&e.observer.editContext){let n=null==(r=t.dataTransfer)?void 0:r.getData("text/plain"),i=t.getTargetRanges();if(n&&i.length){let t=i[0],r=e.posAtDOM(t.startContainer,t.startOffset),s=e.posAtDOM(t.endContainer,t.endOffset);return y3(e,{from:r,to:s,insert:e.state.toText(n)},null),!0}}if(gi.chrome&&gi.android&&(i=y8.find(e=>e.inputType==t.inputType))&&(e.observer.delayAndroidKey(i.key,i.keyCode),"Backspace"==i.key||"Delete"==i.key)){let t=(null==(n=window.visualViewport)?void 0:n.height)||0;setTimeout(()=>{var r;((null==(r=window.visualViewport)?void 0:r.height)||0)>t+10&&e.hasFocus&&(e.contentDOM.blur(),e.focus())},100)}return gi.ios&&"deleteContentForward"==t.inputType&&e.observer.flushSoon(),gi.safari&&"insertText"==t.inputType&&e.inputState.composing>=0&&setTimeout(()=>vi.compositionend(e,t),20),!1};let vw=new Set,vk=["pre-wrap","normal","pre-line","break-spaces"],vA=!1;class vS{constructor(e){this.lineWrapping=e,this.doc=pP.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,t){let r=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(r+=Math.max(0,Math.ceil((t-e-r*this.lineLength*.5)/this.lineLength))),this.lineHeight*r}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/Math.max(1,this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return vk.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let r=0;r<e.length;r++){let n=e[r];n<0?r++:this.heightSamples[Math.floor(10*n)]||(t=!0,this.heightSamples[Math.floor(10*n)]=!0)}return t}refresh(e,t,r,n,i,s){let o=vk.indexOf(e)>-1,l=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=o;if(this.lineWrapping=o,this.lineHeight=t,this.charWidth=r,this.textHeight=n,this.lineLength=i,l){this.heightSamples={};for(let e=0;e<s.length;e++){let t=s[e];t<0?e++:this.heightSamples[Math.floor(10*t)]=!0}}return l}}class vC{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class vE{constructor(e,t,r,n,i){this.from=e,this.length=t,this.top=r,this.height=n,this._content=i}get type(){return"number"==typeof this._content?gV.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof gK?this._content.widget:null}get widgetLineBreaks(){return"number"==typeof this._content?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new vE(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var vj=((f=vj||(vj={}))[f.ByPos=0]="ByPos",f[f.ByHeight=1]="ByHeight",f[f.ByPosNoHeight=2]="ByPosNoHeight",f);class vO{constructor(e,t,r=2){this.length=e,this.height=t,this.flags=r}get outdated(){return(2&this.flags)>0}set outdated(e){this.flags=2*!!e|-3&this.flags}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>.001&&(vA=!0),this.height=e)}replace(e,t,r){return vO.of(r)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,r,n){let i=this,s=r.doc;for(let o=n.length-1;o>=0;o--){let{fromA:l,toA:a,fromB:c,toB:h}=n[o],u=i.lineAt(l,vj.ByPosNoHeight,r.setDoc(t),0,0),d=u.to>=a?u:i.lineAt(a,vj.ByPosNoHeight,r,0,0);for(h+=d.to-a,a=d.to;o>0&&u.from<=n[o-1].toA;)l=n[o-1].fromA,c=n[o-1].fromB,o--,l<u.from&&(u=i.lineAt(l,vj.ByPosNoHeight,r,0,0));c+=u.from-l,l=u.from;let f=vR.build(r.setDoc(s),e,c,h);i=vP(i,i.replace(l,a,f))}return i.updateHeight(r,0)}static empty(){return new vT(0,0)}static of(e){if(1==e.length)return e[0];let t=0,r=e.length,n=0,i=0;for(;;)if(t==r)if(n>2*i){let i=e[t-1];i.break?e.splice(--t,1,i.left,null,i.right):e.splice(--t,1,i.left,i.right),r+=1+i.break,n-=i.size}else if(i>2*n){let t=e[r];t.break?e.splice(r,1,t.left,null,t.right):e.splice(r,1,t.left,t.right),r+=2+t.break,i-=t.size}else break;else if(n<i){let r=e[t++];r&&(n+=r.size)}else{let t=e[--r];t&&(i+=t.size)}let s=0;return null==e[t-1]?(s=1,t--):null==e[t]&&(s=1,r++),new v$(vO.of(e.slice(0,t)),s,vO.of(e.slice(r)))}}function vP(e,t){return e==t?e:(e.constructor!=t.constructor&&(vA=!0),t)}vO.prototype.size=1;class vM extends vO{constructor(e,t,r){super(e,t),this.deco=r}blockAt(e,t,r,n){return new vE(n,this.length,r,this.height,this.deco||0)}lineAt(e,t,r,n,i){return this.blockAt(0,r,n,i)}forEachLine(e,t,r,n,i,s){e<=i+this.length&&t>=i&&s(this.blockAt(0,r,n,i))}updateHeight(e,t=0,r=!1,n){return n&&n.from<=t&&n.more&&this.setHeight(n.heights[n.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class vT extends vM{constructor(e,t){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,t,r,n){return new vE(n,this.length,r,this.height,this.breaks)}replace(e,t,r){let n=r[0];return 1==r.length&&(n instanceof vT||n instanceof vI&&4&n.flags)&&10>Math.abs(this.length-n.length)?(n instanceof vI?n=new vT(n.length,this.height):n.height=this.height,this.outdated||(n.outdated=!1),n):vO.of(r)}updateHeight(e,t=0,r=!1,n){return n&&n.from<=t&&n.more?this.setHeight(n.heights[n.index++]):(r||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class vI extends vO{constructor(e){super(e,0)}heightMetrics(e,t){let r=e.doc.lineAt(t).number,n=e.doc.lineAt(t+this.length).number,i=n-r+1,s,o=0;if(e.lineWrapping){let t=Math.min(this.height,e.lineHeight*i);s=t/i,this.length>i+1&&(o=(this.height-t)/(this.length-i-1))}else s=this.height/i;return{firstLine:r,lastLine:n,perLine:s,perChar:o}}blockAt(e,t,r,n){let{firstLine:i,lastLine:s,perLine:o,perChar:l}=this.heightMetrics(t,n);if(t.lineWrapping){let i=n+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-r)/this.height))*this.length)),s=t.doc.lineAt(i),a=o+s.length*l,c=Math.max(r,e-a/2);return new vE(s.from,s.length,c,a,0)}{let n=Math.max(0,Math.min(s-i,Math.floor((e-r)/o))),{from:l,length:a}=t.doc.line(i+n);return new vE(l,a,r+o*n,o,0)}}lineAt(e,t,r,n,i){if(t==vj.ByHeight)return this.blockAt(e,r,n,i);if(t==vj.ByPosNoHeight){let{from:t,to:n}=r.doc.lineAt(e);return new vE(t,n-t,0,0,0)}let{firstLine:s,perLine:o,perChar:l}=this.heightMetrics(r,i),a=r.doc.lineAt(e),c=o+a.length*l,h=a.number-s,u=n+o*h+l*(a.from-i-h);return new vE(a.from,a.length,Math.max(n,Math.min(u,n+this.height-c)),c,0)}forEachLine(e,t,r,n,i,s){e=Math.max(e,i),t=Math.min(t,i+this.length);let{firstLine:o,perLine:l,perChar:a}=this.heightMetrics(r,i);for(let c=e,h=n;c<=t;){let t=r.doc.lineAt(c);if(c==e){let r=t.number-o;h+=l*r+a*(e-i-r)}let n=l+a*t.length;s(new vE(t.from,t.length,h,n,0)),h+=n,c=t.to+1}}replace(e,t,r){let n=this.length-t;if(n>0){let e=r[r.length-1];e instanceof vI?r[r.length-1]=new vI(e.length+n):r.push(null,new vI(n-1))}if(e>0){let t=r[0];t instanceof vI?r[0]=new vI(e+t.length):r.unshift(new vI(e-1),null)}return vO.of(r)}decomposeLeft(e,t){t.push(new vI(e-1),null)}decomposeRight(e,t){t.push(null,new vI(this.length-e-1))}updateHeight(e,t=0,r=!1,n){let i=t+this.length;if(n&&n.from<=t+this.length&&n.more){let r=[],s=Math.max(t,n.from),o=-1;for(n.from>t&&r.push(new vI(n.from-t-1).updateHeight(e,t));s<=i&&n.more;){let t=e.doc.lineAt(s).length;r.length&&r.push(null);let i=n.heights[n.index++];-1==o?o=i:Math.abs(i-o)>=.001&&(o=-2);let l=new vT(t,i);l.outdated=!1,r.push(l),s+=t+1}s<=i&&r.push(null,new vI(i-s).updateHeight(e,s));let l=vO.of(r);return(o<0||Math.abs(l.height-this.height)>=.001||Math.abs(o-this.heightMetrics(e,t).perLine)>=.001)&&(vA=!0),vP(this,l)}return(r||this.outdated)&&(this.setHeight(e.heightForGap(t,t+this.length)),this.outdated=!1),this}toString(){return`gap(${this.length})`}}class v$ extends vO{constructor(e,t,r){super(e.length+t+r.length,e.height+r.height,t|(e.outdated||r.outdated?2:0)),this.left=e,this.right=r,this.size=e.size+r.size}get break(){return 1&this.flags}blockAt(e,t,r,n){let i=r+this.left.height;return e<i?this.left.blockAt(e,t,r,n):this.right.blockAt(e,t,i,n+this.left.length+this.break)}lineAt(e,t,r,n,i){let s=n+this.left.height,o=i+this.left.length+this.break,l=t==vj.ByHeight?e<s:e<o,a=l?this.left.lineAt(e,t,r,n,i):this.right.lineAt(e,t,r,s,o);if(this.break||(l?a.to<o:a.from>o))return a;let c=t==vj.ByPosNoHeight?vj.ByPosNoHeight:vj.ByPos;return l?a.join(this.right.lineAt(o,c,r,s,o)):this.left.lineAt(o,c,r,n,i).join(a)}forEachLine(e,t,r,n,i,s){let o=n+this.left.height,l=i+this.left.length+this.break;if(this.break)e<l&&this.left.forEachLine(e,t,r,n,i,s),t>=l&&this.right.forEachLine(e,t,r,o,l,s);else{let a=this.lineAt(l,vj.ByPos,r,n,i);e<a.from&&this.left.forEachLine(e,a.from-1,r,n,i,s),a.to>=e&&a.from<=t&&s(a),t>a.to&&this.right.forEachLine(a.to+1,t,r,o,l,s)}}replace(e,t,r){let n=this.left.length+this.break;if(t<n)return this.balanced(this.left.replace(e,t,r),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-n,t-n,r));let i=[];e>0&&this.decomposeLeft(e,i);let s=i.length;for(let e of r)i.push(e);if(e>0&&vD(i,s-1),t<this.length){let e=i.length;this.decomposeRight(t,i),vD(i,e)}return vO.of(i)}decomposeLeft(e,t){let r=this.left.length;if(e<=r)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&e>=++r&&t.push(null),e>r&&this.right.decomposeLeft(e-r,t)}decomposeRight(e,t){let r=this.left.length,n=r+this.break;if(e>=n)return this.right.decomposeRight(e-n,t);e<r&&this.left.decomposeRight(e,t),this.break&&e<n&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?vO.of(this.break?[e,null,t]:[e,t]):(this.left=vP(this.left,e),this.right=vP(this.right,t),this.setHeight(e.height+t.height),this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,r=!1,n){let{left:i,right:s}=this,o=t+i.length+this.break,l=null;return(n&&n.from<=t+i.length&&n.more?l=i=i.updateHeight(e,t,r,n):i.updateHeight(e,t,r),n&&n.from<=o+s.length&&n.more?l=s=s.updateHeight(e,o,r,n):s.updateHeight(e,o,r),l)?this.balanced(i,s):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function vD(e,t){let r,n;null==e[t]&&(r=e[t-1])instanceof vI&&(n=e[t+1])instanceof vI&&e.splice(t-1,3,new vI(r.length+1+n.length))}class vR{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let e=Math.min(t,this.lineEnd),r=this.nodes[this.nodes.length-1];r instanceof vT?r.length+=e-this.pos:(e>this.pos||!this.isCovered)&&this.nodes.push(new vT(e-this.pos,-1)),this.writtenTo=e,t>e&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,r){if(e<t||r.heightRelevant){let n=r.widget?r.widget.estimatedHeight:0,i=r.widget?r.widget.lineBreaks:0;n<0&&(n=this.oracle.lineHeight);let s=t-e;r.block?this.addBlock(new vM(s,n,r)):(s||i||n>=5)&&this.addLineDeco(n,i,s)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new vT(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let r=new vI(t-e);return this.oracle.doc.lineAt(e).to==t&&(r.flags|=4),r}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof vT)return e;let t=new vT(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,r){let n=this.ensureLine();n.length+=r,n.collapsed+=r,n.widgetHeight=Math.max(n.widgetHeight,e),n.breaks+=t,this.writtenTo=this.pos=this.pos+r}finish(e){let t=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||t instanceof vT||this.isCovered?(this.writtenTo<this.pos||null==t)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new vT(0,-1));let r=e;for(let e of this.nodes)e instanceof vT&&e.updateHeight(this.oracle,r),r+=e?e.length:1;return this.nodes}static build(e,t,r,n){let i=new vR(r,e);return mT.spans(t,r,n,i,0),i.finish(r)}}class vN{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,r,n){(e<t||r&&r.heightRelevant||n&&n.heightRelevant)&&gJ(e,t,this.changes,5)}}class vL{constructor(e,t,r,n){this.from=e,this.to=t,this.size=r,this.displaySize=n}static same(e,t){if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++){let n=e[r],i=t[r];if(n.from!=i.from||n.to!=i.to||n.size!=i.size)return!1}return!0}draw(e,t){return gH.replace({widget:new vF(this.displaySize*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class vF extends gW{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class v_{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=vV,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=g2.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(yO).some(e=>"function"!=typeof e&&"cm-lineWrapping"==e.class);this.heightOracle=new vS(t),this.stateDeco=e.facet(yP).filter(e=>"function"!=typeof e),this.heightMap=vO.empty().applyChanges(this.stateDeco,pP.empty,this.heightOracle.setDoc(e.doc),[new yL(0,0,0,e.doc.length)]);for(let e=0;e<2&&(this.viewport=this.getViewport(0,null),this.updateForViewport());e++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=gH.set(this.lineGaps.map(e=>e.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let r=0;r<=1;r++){let n=r?t.head:t.anchor;if(!e.some(({from:e,to:t})=>n>=e&&n<=t)){let{from:t,to:r}=this.lineBlockAt(n);e.push(new vB(t,r))}}return this.viewports=e.sort((e,t)=>e.from-t.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?vV:new vH(this.heightOracle,this.heightMap,this.viewports),2*!e.eq(this.scaler)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(vU(e,this.scaler))})}update(e,t=null){var r,n;let i;this.state=e.state;let s=this.stateDeco;this.stateDeco=this.state.facet(yP).filter(e=>"function"!=typeof e);let o=e.changedRanges,l=yL.extendWithRanges(o,(r=this.stateDeco,n=e?e.changes:pU.empty(this.state.doc.length),i=new vN,mT.compare(s,r,n,i,0),i.changes)),a=this.heightMap.height,c=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);vA=!1,this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),l),(this.heightMap.height!=a||vA)&&(e.flags|=2),c?(this.scrollAnchorPos=e.changes.mapPos(c.from,-1),this.scrollAnchorHeight=c.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=a);let h=l.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<h.from||t.range.head>h.to)||!this.viewportIsAppropriate(h))&&(h=this.getViewport(0,t));let u=h.from!=this.viewport.from||h.to!=this.viewport.to;this.viewport=h,e.flags|=this.updateForViewport(),(u||!e.changes.empty||2&e.flags)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(yg)&&(this.mustEnforceCursorAssoc=!0)}measure(e){var t;let r,n,i=e.contentDOM,s=window.getComputedStyle(i),o=this.heightOracle,l=s.whiteSpace;this.defaultTextDirection="rtl"==s.direction?g2.RTL:g2.LTR;let a=this.heightOracle.mustRefreshForWrapping(l),c=i.getBoundingClientRect(),h=a||this.mustMeasureContent||this.contentDOMHeight!=c.height;this.contentDOMHeight=c.height,this.mustMeasureContent=!1;let u=0,d=0;if(c.width&&c.height){let{scaleX:e,scaleY:t}=gm(i,c);(e>.005&&Math.abs(this.scaleX-e)>.005||t>.005&&Math.abs(this.scaleY-t)>.005)&&(this.scaleX=e,this.scaleY=t,u|=16,a=h=!0)}let f=(parseInt(s.paddingTop)||0)*this.scaleY,p=(parseInt(s.paddingBottom)||0)*this.scaleY;(this.paddingTop!=f||this.paddingBottom!=p)&&(this.paddingTop=f,this.paddingBottom=p,u|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(o.lineWrapping&&(h=!0),this.editorWidth=e.scrollDOM.clientWidth,u|=16);let m=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=m&&(this.scrollAnchorHeight=-1,this.scrollTop=m),this.scrolledToBottom=gk(e.scrollDOM);let g=(this.printing?function(e,t){let r=e.getBoundingClientRect();return{left:0,right:r.right-r.left,top:t,bottom:r.bottom-(r.top+t)}}:function(e,t){let r=e.getBoundingClientRect(),n=e.ownerDocument,i=n.defaultView||window,s=Math.max(0,r.left),o=Math.min(i.innerWidth,r.right),l=Math.max(0,r.top),a=Math.min(i.innerHeight,r.bottom);for(let t=e.parentNode;t&&t!=n.body;)if(1==t.nodeType){let r=t,n=window.getComputedStyle(r);if((r.scrollHeight>r.clientHeight||r.scrollWidth>r.clientWidth)&&"visible"!=n.overflow){let n=r.getBoundingClientRect();s=Math.max(s,n.left),o=Math.min(o,n.right),l=Math.max(l,n.top),a=Math.min(t==e.parentNode?i.innerHeight:a,n.bottom)}t="absolute"==n.position||"fixed"==n.position?r.offsetParent:r.parentNode}else if(11==t.nodeType)t=t.host;else break;return{left:s-r.left,right:Math.max(s,o)-r.left,top:l-(r.top+t),bottom:Math.max(l,a)-(r.top+t)}})(i,this.paddingTop),y=g.top-this.pixelViewport.top,v=g.bottom-this.pixelViewport.bottom;this.pixelViewport=g;let x=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(x!=this.inView&&(this.inView=x,x&&(h=!0)),!this.inView&&!this.scrollTarget&&(r=(t=e.dom).getBoundingClientRect(),n=t.ownerDocument.defaultView||window,!(r.left<n.innerWidth)||!(r.right>0)||!(r.top<n.innerHeight)||!(r.bottom>0)))return 0;let b=c.width;if((this.contentDOMWidth!=b||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=c.width,this.editorHeight=e.scrollDOM.clientHeight,u|=16),h){let t=e.docView.measureVisibleLineHeights(this.viewport);if(o.mustRefreshForHeights(t)&&(a=!0),a||o.lineWrapping&&Math.abs(b-this.contentDOMWidth)>o.charWidth){let{lineHeight:r,charWidth:n,textHeight:i}=e.docView.measureTextSize();(a=r>0&&o.refresh(l,r,n,i,Math.max(5,b/n),t))&&(e.docView.minWidth=0,u|=16)}for(let r of(y>0&&v>0?d=Math.max(y,v):y<0&&v<0&&(d=Math.min(y,v)),vA=!1,this.viewports)){let n=r.from==this.viewport.from?t:e.docView.measureVisibleLineHeights(r);this.heightMap=(a?vO.empty().applyChanges(this.stateDeco,pP.empty,this.heightOracle,[new yL(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(o,0,a,new vC(r.from,n))}vA&&(u|=2)}let w=!this.viewportIsAppropriate(this.viewport,d)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return w&&(2&u&&(u|=this.updateScaler()),this.viewport=this.getViewport(d,this.scrollTarget),u|=this.updateForViewport()),(2&u||w)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(a?[]:this.lineGaps,e)),u|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),u}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let r=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),n=this.heightMap,i=this.heightOracle,{visibleTop:s,visibleBottom:o}=this,l=new vB(n.lineAt(s-1e3*r,vj.ByHeight,i,0,0).from,n.lineAt(o+(1-r)*1e3,vj.ByHeight,i,0,0).to);if(t){let{head:e}=t.range;if(e<l.from||e>l.to){let r=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),s=n.lineAt(e,vj.ByPos,i,0,0),o;o="center"==t.y?(s.top+s.bottom)/2-r/2:"start"==t.y||"nearest"==t.y&&e<l.from?s.top:s.bottom-r,l=new vB(n.lineAt(o-500,vj.ByHeight,i,0,0).from,n.lineAt(o+r+500,vj.ByHeight,i,0,0).to)}}return l}mapViewport(e,t){let r=t.mapPos(e.from,-1),n=t.mapPos(e.to,1);return new vB(this.heightMap.lineAt(r,vj.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(n,vj.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},r=0){if(!this.inView)return!0;let{top:n}=this.heightMap.lineAt(e,vj.ByPos,this.heightOracle,0,0),{bottom:i}=this.heightMap.lineAt(t,vj.ByPos,this.heightOracle,0,0),{visibleTop:s,visibleBottom:o}=this;return(0==e||n<=s-Math.max(10,Math.min(-r,250)))&&(t==this.state.doc.length||i>=o+Math.max(10,Math.min(r,250)))&&n>s-2e3&&i<o+2e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let r=[];for(let n of e)t.touchesRange(n.from,n.to)||r.push(new vL(t.mapPos(n.from),t.mapPos(n.to),n.size,n.displaySize));return r}ensureLineGaps(e,t){let r=this.heightOracle.lineWrapping,n=r?1e4:2e3,i=n>>1,s=n<<1;if(this.defaultTextDirection!=g2.LTR&&!r)return[];let o=[],l=(n,s,a,c)=>{if(s-n<i)return;let h=this.state.selection.main,u=[h.from];for(let e of(h.empty||u.push(h.to),u))if(e>n&&e<s){l(n,e-10,a,c),l(e+10,s,a,c);return}let d=function(e,t){for(let r of e)if(t(r))return r}(e,e=>e.from>=a.from&&e.to<=a.to&&Math.abs(e.from-n)<i&&Math.abs(e.to-s)<i&&!u.some(t=>e.from<t&&e.to>t));if(!d){if(s<a.to&&t&&r&&t.visibleRanges.some(e=>e.from<=s&&e.to>=s)){let e=t.moveToLineBoundary(pQ.cursor(s),!1,!0).head;e>n&&(s=e)}let e=this.gapSize(a,n,s,c),i=r||e<2e6?e:2e6;d=new vL(n,s,e,i)}o.push(d)},a=t=>{var i,o,a;let c,h,u,d,f;if(t.length<s||t.type!=gV.Text)return;let p=(i=t.from,o=t.to,a=this.stateDeco,u=[],d=i,f=0,mT.spans(a,i,o,{span(){},point(e,t){e>d&&(u.push({from:d,to:e}),f+=e-d),d=t}},20),d<o&&(u.push({from:d,to:o}),f+=o-d),{total:f,ranges:u});if(p.total<s)return;let m=this.scrollTarget?this.scrollTarget.range.head:null;if(r){let e,r,i=n/this.heightOracle.lineLength*this.heightOracle.lineHeight;if(null!=m){let n=vW(p,m),s=((this.visibleBottom-this.visibleTop)/2+i)/t.height;e=n-s,r=n+s}else e=(this.visibleTop-t.top-i)/t.height,r=(this.visibleBottom-t.top+i)/t.height;c=vz(p,e),h=vz(p,r)}else{let r,i,s=p.total*this.heightOracle.charWidth,o=n*this.heightOracle.charWidth,l=0;if(s>2e6)for(let r of e)r.from>=t.from&&r.from<t.to&&r.size!=r.displaySize&&r.from*this.heightOracle.charWidth+l<this.pixelViewport.left&&(l=r.size-r.displaySize);let a=this.pixelViewport.left+l,u=this.pixelViewport.right+l;if(null!=m){let e=vW(p,m),t=((u-a)/2+o)/s;r=e-t,i=e+t}else r=(a-o)/s,i=(u+o)/s;c=vz(p,r),h=vz(p,i)}c>t.from&&l(t.from,c,t,p),h<t.to&&l(h,t.to,t,p)};for(let e of this.viewportLines)Array.isArray(e.type)?e.type.forEach(a):a(e);return o}gapSize(e,t,r,n){let i=vW(n,r)-vW(n,t);return this.heightOracle.lineWrapping?e.height*i:n.total*this.heightOracle.charWidth*i}updateLineGaps(e){vL.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=gH.set(e.map(e=>e.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let r=[];mT.spans(t,this.viewport.from,this.viewport.to,{span(e,t){r.push({from:e,to:t})},point(){}},20);let n=0;if(r.length!=this.visibleRanges.length)n=12;else for(let t=0;t<r.length&&!(8&n);t++){let i=this.visibleRanges[t],s=r[t];(i.from!=s.from||i.to!=s.to)&&(n|=4,e&&e.mapPos(i.from,-1)==s.from&&e.mapPos(i.to,1)==s.to||(n|=8))}return this.visibleRanges=r,n}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||vU(this.heightMap.lineAt(e,vj.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(t=>t.top<=e&&t.bottom>=e)||vU(this.heightMap.lineAt(this.scaler.fromDOM(e),vj.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return vU(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class vB{constructor(e,t){this.from=e,this.to=t}}function vz({total:e,ranges:t},r){if(r<=0)return t[0].from;if(r>=1)return t[t.length-1].to;let n=Math.floor(e*r);for(let e=0;;e++){let{from:r,to:i}=t[e],s=i-r;if(n<=s)return r+n;n-=s}}function vW(e,t){let r=0;for(let{from:n,to:i}of e.ranges){if(t<=i){r+=t-n;break}r+=i-n}return r/e.total}let vV={toDOM:e=>e,fromDOM:e=>e,scale:1,eq(e){return e==this}};class vH{constructor(e,t,r){let n=0,i=0,s=0;for(let o of(this.viewports=r.map(({from:r,to:i})=>{let s=t.lineAt(r,vj.ByPos,e,0,0).top,o=t.lineAt(i,vj.ByPos,e,0,0).bottom;return n+=o-s,{from:r,to:i,top:s,bottom:o,domTop:0,domBottom:0}}),this.scale=(7e6-n)/(t.height-n),this.viewports))o.domTop=s+(o.top-i)*this.scale,s=o.domBottom=o.domTop+(o.bottom-o.top),i=o.bottom}toDOM(e){for(let t=0,r=0,n=0;;t++){let i=t<this.viewports.length?this.viewports[t]:null;if(!i||e<i.top)return n+(e-r)*this.scale;if(e<=i.bottom)return i.domTop+(e-i.top);r=i.bottom,n=i.domBottom}}fromDOM(e){for(let t=0,r=0,n=0;;t++){let i=t<this.viewports.length?this.viewports[t]:null;if(!i||e<i.domTop)return r+(e-n)/this.scale;if(e<=i.domBottom)return i.top+(e-i.domTop);r=i.bottom,n=i.domBottom}}eq(e){return e instanceof vH&&this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((t,r)=>t.from==e.viewports[r].from&&t.to==e.viewports[r].to)}}function vU(e,t){if(1==t.scale)return e;let r=t.toDOM(e.top),n=t.toDOM(e.bottom);return new vE(e.from,e.length,r,n-r,Array.isArray(e._content)?e._content.map(e=>vU(e,t)):e._content)}let vq=p2.define({combine:e=>e.join(" ")}),vK=p2.define({combine:e=>e.indexOf(!0)>-1}),vG=mG.newName(),vJ=mG.newName(),vY=mG.newName(),vX={"&light":"."+vJ,"&dark":"."+vY};function vZ(e,t,r){return new mG(t,{finish:t=>/&/.test(t)?t.replace(/&\w*/,t=>{if("&"==t)return e;if(!r||!r[t])throw RangeError(`Unsupported selector: ${t}`);return r[t]}):e+" "+t})}let vQ=vZ("."+vG,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>\')',backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},vX),v0={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},v1=gi.ie&&gi.ie_version<=11;class v2{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new gg,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let e of t)this.queue.push(e);(gi.ie&&gi.ie_version<=11||gi.ios&&e.composing)&&t.some(e=>"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&gi.android&&!1!==e.constructor.EDIT_CONTEXT&&!(gi.chrome&&gi.chrome_version<126)&&(this.editContext=new v5(e),e.state.facet(yk)&&(e.contentDOM.editContext=this.editContext.editContext)),v1&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),"function"==typeof ResizeObserver&&(this.resizeScroll=new ResizeObserver(()=>{var e;(null==(e=this.view.docView)?void 0:e.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver(e=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),e.length>0&&e[e.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(e=>{e.length>0&&e[e.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){("change"!=e.type&&e.type||e.matches)&&(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,r)=>t!=e[r]))){for(let t of(this.gapIntersection.disconnect(),e))this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:r}=this,n=this.selectionRange;if(r.state.facet(yk)?r.root.activeElement!=this.dom:!gl(this.dom,n))return;let i=n.anchorNode&&r.docView.nearest(n.anchorNode);if(i&&i.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(gi.ie&&gi.ie_version<=11||gi.android&&gi.chrome)&&!r.state.selection.main.empty&&n.focusNode&&gc(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=gs(e.root);if(!t)return!1;let r=gi.safari&&11==e.root.nodeType&&e.root.activeElement==this.dom&&function(e,t){if(t.getComposedRanges){let r=t.getComposedRanges(e.root)[0];if(r)return v3(e,r)}let r=null;function n(e){e.preventDefault(),e.stopImmediatePropagation(),r=e.getTargetRanges()[0]}return e.contentDOM.addEventListener("beforeinput",n,!0),e.dom.ownerDocument.execCommand("indent"),e.contentDOM.removeEventListener("beforeinput",n,!0),r?v3(e,r):null}(this.view,t)||t;if(!r||this.selectionRange.eq(r))return!1;let n=gl(this.dom,r);return n&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&function(e,t){let r=t.focusNode,n=t.focusOffset;if(!r||t.anchorNode!=r||t.anchorOffset!=n)return!1;for(n=Math.min(n,gf(r));;)if(n){if(1!=r.nodeType)return!1;let e=r.childNodes[n-1];"false"==e.contentEditable?n--:n=gf(r=e)}else{if(r==e)return!0;n=gh(r),r=r.parentNode}}(this.dom,r)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(r),n&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let r=this.dom;r;)if(1==r.nodeType)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==r?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(r),r=r.assignedSlot||r.parentNode;else if(11==r.nodeType)r=r.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let e of this.scrollTargets)e.removeEventListener("scroll",this.onScroll);for(let e of this.scrollTargets=t)e.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,v0),v1&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),v1&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var r;if(!this.delayedAndroidKey){let e=()=>{let e=this.delayedAndroidKey;e&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=e.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&e.force&&gb(this.dom,e.key,e.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(e)}this.delayedAndroidKey&&"Enter"!=e||(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(null==(r=this.delayedAndroidKey)?void 0:r.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,r=-1,n=!1;for(let i of e){let e=this.readMutation(i);e&&(e.typeOver&&(n=!0),-1==t?{from:t,to:r}=e:(t=Math.min(e.from,t),r=Math.max(e.to,r)))}return{from:t,to:r,typeOver:n}}readChange(){let{from:e,to:t,typeOver:r}=this.processRecords(),n=this.selectionChanged&&gl(this.dom,this.selectionRange);if(e<0&&!n)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let i=new y2(this.view,e,t,r);return this.view.docView.domChanged={newSel:i.newSel?i.newSel.main:null},i}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let r=this.view.state,n=y4(this.view,t);return this.view.state==r&&(t.domChanged||t.newSel&&!t.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),n}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty("attributes"==e.type),"attributes"==e.type&&(t.flags|=4),"childList"==e.type){let r=v4(t,e.previousSibling||e.target.previousSibling,-1),n=v4(t,e.nextSibling||e.target.nextSibling,1);return{from:r?t.posAfter(r):t.posAtStart,to:n?t.posBefore(n):t.posAtEnd,typeOver:!1}}return"characterData"==e.type?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(yk)!=e.state.facet(yk)&&(e.view.contentDOM.editContext=e.state.facet(yk)?this.editContext.editContext:null))}destroy(){var e,t,r;for(let n of(this.stop(),null==(e=this.intersection)||e.disconnect(),null==(t=this.gapIntersection)||t.disconnect(),null==(r=this.resizeScroll)||r.disconnect(),this.scrollTargets))n.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function v4(e,t,r){for(;t;){let n=gj.get(t);if(n&&n.parent==e)return n;let i=t.parentNode;t=i!=e.dom?i:r>0?t.nextSibling:t.previousSibling}return null}function v3(e,t){let r=t.startContainer,n=t.startOffset,i=t.endContainer,s=t.endOffset,o=e.docView.domAtPos(e.state.selection.main.anchor);return gc(o.node,o.offset,i,s)&&([r,n,i,s]=[i,s,r,n]),{anchorNode:r,anchorOffset:n,focusNode:i,focusOffset:s}}class v5{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let t=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});for(let r in this.handlers.textupdate=r=>{let n=e.state.selection.main,{anchor:i,head:s}=n,o=this.toEditorPos(r.updateRangeStart),l=this.toEditorPos(r.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:r.updateRangeStart,editorBase:o,drifted:!1});let a=l-o>r.text.length;o==this.from&&i<this.from?o=i:l==this.to&&i>this.to&&(l=i);let c=y5(e.state.sliceDoc(o,l),r.text,(a?n.from:n.to)-o,a?"end":null);if(!c){let t=pQ.single(this.toEditorPos(r.selectionStart),this.toEditorPos(r.selectionEnd));t.main.eq(n)||e.dispatch({selection:t,userEvent:"select"});return}let h={from:c.from+o,to:c.toA+o,insert:pP.of(r.text.slice(c.from,c.toB).split("\n"))};if((gi.mac||gi.android)&&h.from==s-1&&/^\. ?$/.test(r.text)&&"off"==e.contentDOM.getAttribute("autocorrect")&&(h={from:o,to:l,insert:pP.of([r.text.replace("."," ")])}),this.pendingContextChange=h,!e.state.readOnly){let t=this.to-this.from+(h.to-h.from+h.insert.length);y3(e,h,pQ.single(this.toEditorPos(r.selectionStart,t),this.toEditorPos(r.selectionEnd,t)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state)),h.from<h.to&&!h.insert.length&&e.inputState.composing>=0&&!/[\\p{Alphabetic}\\p{Number}_]/.test(t.text.slice(Math.max(0,r.updateRangeStart-1),Math.min(t.text.length,r.updateRangeStart+1)))&&this.handlers.compositionend(r)},this.handlers.characterboundsupdate=r=>{let n=[],i=null;for(let t=this.toEditorPos(r.rangeStart),s=this.toEditorPos(r.rangeEnd);t<s;t++){let r=e.coordsForChar(t);i=r&&new DOMRect(r.left,r.top,r.right-r.left,r.bottom-r.top)||i||new DOMRect,n.push(i)}t.updateCharacterBounds(r.rangeStart,n)},this.handlers.textformatupdate=t=>{let r=[];for(let e of t.getTextFormats()){let t=e.underlineStyle,n=e.underlineThickness;if(!/none/i.test(t)&&!/none/i.test(n)){let i=this.toEditorPos(e.rangeStart),s=this.toEditorPos(e.rangeEnd);if(i<s){let e=`text-decoration: underline ${/^[a-z]/.test(t)?t+" ":"Dashed"==t?"dashed ":"Squiggle"==t?"wavy ":""}${/thin/i.test(n)?1:2}px`;r.push(gH.mark({attributes:{style:e}}).range(i,s))}}}e.dispatch({effects:yb.of(gH.set(r))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:t}=this.composing;this.composing=null,t&&this.reset(e.state)}},this.handlers)t.addEventListener(r,this.handlers[r]);this.measureReq={read:e=>{this.editContext.updateControlBounds(e.contentDOM.getBoundingClientRect());let t=gs(e.root);t&&t.rangeCount&&this.editContext.updateSelectionBounds(t.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let t=0,r=!1,n=this.pendingContextChange;return e.changes.iterChanges((i,s,o,l,a)=>{if(r)return;let c=a.length-(s-i);if(n&&s>=n.to)if(n.from==i&&n.to==s&&n.insert.eq(a)){n=this.pendingContextChange=null,t+=c,this.to+=c;return}else n=null,this.revertPending(e.state);if(i+=t,(s+=t)<=this.from)this.from+=c,this.to+=c;else if(i<this.to){if(i<this.from||s>this.to||this.to-this.from+a.length>3e4){r=!0;return}this.editContext.updateText(this.toContextPos(i),this.toContextPos(s),a.toString()),this.to+=c}t+=c}),n&&!r&&this.revertPending(e.state),!r}update(e){let t=this.pendingContextChange,r=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(r.from,r.to)&&e.transactions.some(e=>!e.isUserEvent("input.type")&&e.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):this.applyEdits(e)&&this.rangeIsValid(e.state)?(e.docChanged||e.selectionSet||t)&&this.setSelection(e.state):(this.pendingContextChange=null,this.reset(e.state)),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:t}=e.selection.main;this.from=Math.max(0,t-1e4),this.to=Math.min(e.doc.length,t+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let t=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(t.from),this.toContextPos(t.from+t.insert.length),e.doc.sliceString(t.from,t.to))}setSelection(e){let{main:t}=e.selection,r=this.toContextPos(Math.max(this.from,Math.min(this.to,t.anchor))),n=this.toContextPos(t.head);(this.editContext.selectionStart!=r||this.editContext.selectionEnd!=n)&&this.editContext.updateSelection(r,n)}rangeIsValid(e){let{head:t}=e.selection.main;return!(this.from>0&&t-this.from<500||this.to<e.doc.length&&this.to-t<500||this.to-this.from>3e4)}toEditorPos(e,t=this.to-this.from){e=Math.min(e,t);let r=this.composing;return r&&r.drifted?r.editorBase+(e-r.contextBase):e+this.from}toContextPos(e){let t=this.composing;return t&&t.drifted?t.contextBase+(e-t.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class v6{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var t;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:r}=e;for(let t of(this.dispatchTransactions=e.dispatchTransactions||r&&(e=>e.forEach(e=>r(e,this)))||(e=>this.update(e)),this.dispatch=this.dispatch.bind(this),this._root=e.root||function(e){for(;e;){if(e&&(9==e.nodeType||11==e.nodeType&&e.host))return e;e=e.assignedSlot||e.parentNode}return null}(e.parent)||document,this.viewState=new v_(e.state||mC.create(e)),e.scrollTo&&e.scrollTo.is(yx)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(yS).map(e=>new yE(e)),this.plugins))t.update(this);this.observer=new v2(this),this.inputState=new y6(this),this.inputState.ensureHandlers(this.plugins),this.docView=new y_(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),(null==(t=document.fonts)?void 0:t.ready)&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...e){let t=1==e.length&&e[0]instanceof mv?e:1==e.length&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(0!=this.updateState)throw Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,r=!1,n,i=this.state;for(let t of e){if(t.startState!=i)throw RangeError("Trying to update state with a transaction that doesn't start from the previous state.");i=t.state}if(this.destroyed){this.viewState.state=i;return}let s=this.hasFocus,o=0,l=null;e.some(e=>e.annotation(vv))?(this.inputState.notifiedFocused=s,o=1):s!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=s,(l=vx(i,s))||(o=1));let a=this.observer.delayedAndroidKey,c=null;if(a?(this.observer.clearDelayedAndroidKey(),((c=this.observer.readChange())&&!this.state.doc.eq(i.doc)||!this.state.selection.eq(i.selection))&&(c=null)):this.observer.clear(),i.facet(mC.phrases)!=this.state.facet(mC.phrases))return this.setState(i);n=yF.create(this,i,e),n.flags|=o;let h=this.viewState.scrollTarget;try{for(let t of(this.updateState=2,e)){if(h&&(h=h.map(t.changes)),t.scrollIntoView){let{main:e}=t.state.selection;h=new yv(e.empty?e:pQ.cursor(e.head,e.head>e.anchor?-1:1))}for(let e of t.effects)e.is(yx)&&(h=e.value.clip(this.state))}this.viewState.update(n,h),this.bidiCache=v7.update(this.bidiCache,n.changes),n.empty||(this.updatePlugins(n),this.inputState.update(n)),t=this.docView.update(n),this.state.facet(yN)!=this.styleModules&&this.mountStyles(),r=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(e=>e.isUserEvent("select.pointer")))}finally{this.updateState=0}if(n.startState.facet(vq)!=n.state.facet(vq)&&(this.viewState.mustMeasureContent=!0),(t||r||h||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),t&&this.docViewUpdate(),!n.empty)for(let e of this.state.facet(yh))try{e(n)}catch(e){yw(this.state,e,"update listener")}(l||c)&&Promise.resolve().then(()=>{l&&this.state==l.startState&&this.dispatch(l),c&&!y4(this,c)&&a.force&&gb(this.contentDOM,a.key,a.keyCode)})}setState(e){if(0!=this.updateState)throw Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let e of this.plugins)e.destroy(this);for(let t of(this.viewState=new v_(e),this.plugins=e.facet(yS).map(e=>new yE(e)),this.pluginMap.clear(),this.plugins))t.update(this);this.docView.destroy(),this.docView=new y_(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(yS),r=e.state.facet(yS);if(t!=r){let n=[];for(let i of r){let r=t.indexOf(i);if(r<0)n.push(new yE(i));else{let t=this.plugins[r];t.mustUpdate=e,n.push(t)}}for(let t of this.plugins)t.mustUpdate!=e&&t.destroy(this);this.plugins=n,this.pluginMap.clear()}else for(let t of this.plugins)t.mustUpdate=e;for(let e=0;e<this.plugins.length;e++)this.plugins[e].update(this);t!=r&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let t=e.value;if(t&&t.docViewUpdate)try{t.docViewUpdate(this)}catch(e){yw(this.state,e,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,r=this.scrollDOM,n=r.scrollTop*this.scaleY,{scrollAnchorPos:i,scrollAnchorHeight:s}=this.viewState;Math.abs(n-this.viewState.scrollTop)>1&&(s=-1),this.viewState.scrollAnchorHeight=-1;try{for(let e=0;;e++){if(s<0)if(gk(r))i=-1,s=this.viewState.heightMap.height;else{let e=this.viewState.scrollAnchorAt(n);i=e.from,s=e.top}this.updateState=1;let o=this.viewState.measure(this);if(!o&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(e>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let l=[];4&o||([this.measureRequests,l]=[l,this.measureRequests]);let a=l.map(e=>{try{return e.read(this)}catch(e){return yw(this.state,e),v8}}),c=yF.create(this,this.state,[]),h=!1;c.flags|=o,t?t.flags|=o:t=c,this.updateState=2,!c.empty&&(this.updatePlugins(c),this.inputState.update(c),this.updateAttrs(),(h=this.docView.update(c))&&this.docViewUpdate());for(let e=0;e<l.length;e++)if(a[e]!=v8)try{let t=l[e];t.write&&t.write(a[e],this)}catch(e){yw(this.state,e)}if(h&&this.docView.updateSelection(!0),!c.viewportChanged&&0==this.measureRequests.length){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,s=-1;continue}else{let e=(i<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(i).top)-s;if(e>1||e<-1){r.scrollTop=(n+=e)/this.scaleY,s=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let e of this.state.facet(yh))e(t)}get themeClasses(){return vG+" "+(this.state.facet(vK)?vY:vJ)+" "+this.state.facet(vq)}updateAttrs(){let e=xe(this,yj,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(yk)?"true":"false",class:"cm-content",style:`${gi.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),xe(this,yO,t);let r=this.observer.ignore(()=>{let r=gz(this.contentDOM,this.contentAttrs,t),n=gz(this.dom,this.editorAttrs,e);return r||n});return this.editorAttrs=e,this.contentAttrs=t,r}showAnnouncements(e){let t=!0;for(let r of e)for(let e of r.effects)e.is(v6.announce)&&(t&&(this.announceDOM.textContent=""),t=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=e.value)}mountStyles(){this.styleModules=this.state.facet(yN);let e=this.state.facet(v6.cspNonce);mG.mount(this.root,this.styleModules.concat(vQ).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(2==this.updateState)throw Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if((this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e)&&!(this.measureRequests.indexOf(e)>-1)){if(null!=e.key){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(void 0===t||t&&t.plugin!=e)&&this.pluginMap.set(e,t=this.plugins.find(t=>t.plugin==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,r){return yQ(this,e,yY(this,e,t,r))}moveByGroup(e,t){return yQ(this,e,yY(this,e,t,t=>{var r;let n,i;return r=e.head,i=(n=this.state.charCategorizer(r))(t),e=>{let t=n(e);return i==mA.Space&&(i=t),i==t}}))}visualLineSide(e,t){let r=this.bidiSpans(e),n=this.textDirectionAt(e.from),i=r[t?r.length-1:0];return pQ.cursor(i.side(t,n)+e.from,i.forward(!t,n)?1:-1)}moveToLineBoundary(e,t,r=!0){return function(e,t,r,n){let i=yJ(e,t.head,t.assoc||-1),s=n&&i.type==gV.Text&&(e.lineWrapping||i.widgetLineBreaks)?e.coordsAtPos(t.assoc<0&&t.head>i.from?t.head-1:t.head):null;if(s){let t=e.dom.getBoundingClientRect(),n=e.textDirectionAt(i.from),o=e.posAtCoords({x:r==(n==g2.LTR)?t.right-1:t.left+1,y:(s.top+s.bottom)/2});if(null!=o)return pQ.cursor(o,r?-1:1)}return pQ.cursor(r?i.to:i.from,r?-1:1)}(this,e,t,r)}moveVertically(e,t,r){return yQ(this,e,function(e,t,r,n){let i=t.head,s=r?1:-1;if(i==(r?e.state.doc.length:0))return pQ.cursor(i,t.assoc);let o=t.goalColumn,l,a=e.contentDOM.getBoundingClientRect(),c=e.coordsAtPos(i,t.assoc||-1),h=e.documentTop;if(c)null==o&&(o=c.left-a.left),l=s<0?c.top:c.bottom;else{let t=e.viewState.lineBlockAt(i);null==o&&(o=Math.min(a.right-a.left,e.defaultCharacterWidth*(i-t.from))),l=(s<0?t.top:t.bottom)+h}let u=a.left+o,d=null!=n?n:e.viewState.heightOracle.textHeight>>1;for(let t=0;;t+=10){let r=l+(d+t)*s,n=yq(e,{x:u,y:r},!1,s);if(r<a.top||r>a.bottom||(s<0?n<i:n>i)){let t=e.docView.coordsForChar(n),i=!t||r<t.top?-1:1;return pQ.cursor(n,i,void 0,o)}}}(this,e,t,r))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),yq(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let r=this.docView.coordsAt(e,t);if(!r||r.left==r.right)return r;let n=this.state.doc.lineAt(e),i=this.bidiSpans(n);return gp(r,i[yr.find(i,e-n.from,-1,t)].dir==g2.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(ym)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>v9)return yi(e.length);let t=this.textDirectionAt(e.from),r;for(let n of this.bidiCache)if(n.from==e.from&&n.dir==t&&(n.fresh||function e(t,r){if(t.length!=r.length)return!1;for(let n=0;n<t.length;n++){let i=t[n],s=r[n];if(i.from!=s.from||i.to!=s.to||i.direction!=s.direction||!e(i.inner,s.inner))return!1}return!0}(n.isolates,r=y$(this,e))))return n.order;r||(r=y$(this,e));let n=function(e,t,r){if(!e)return[new yr(0,0,+(t==g3))];if(t==g4&&!r.length&&!yt.test(e))return yi(e.length);if(r.length)for(;e.length>yn.length;)yn[yn.length]=256;let n=[],i=+(t!=g4);return function e(t,r,n,i,s,o,l){let a=r%2?2:1;!function(e,t,r,n,i){for(let s=0;s<=n.length;s++){let o=s?n[s-1].to:t,l=s<n.length?n[s].from:r,a=s?256:i;for(let t=o,r=a,n=a;t<l;t++){let i=ye(e.charCodeAt(t));512==i?i=r:8==i&&4==n&&(i=16),yn[t]=4==i?2:i,7&i&&(n=i),r=i}for(let e=o,t=a,n=a;e<l;e++){let i=yn[e];if(128==i)e<l-1&&t==yn[e+1]&&24&t?i=yn[e]=t:yn[e]=256;else if(64==i){let i=e+1;for(;i<l&&64==yn[i];)i++;let s=e&&8==t||i<r&&8==yn[i]?1==n?1:8:256;for(let t=e;t<i;t++)yn[t]=s;e=i-1}else 8==i&&1==n&&(yn[e]=1);t=i,7&i&&(n=i)}}}(t,s,o,i,a),function(e,t,r,n,i){let s=1==i?2:1;for(let o=0,l=0,a=0;o<=n.length;o++){let c=o?n[o-1].to:t,h=o<n.length?n[o].from:r;for(let t=c,r,n,o;t<h;t++)if(n=g8[r=e.charCodeAt(t)])if(n<0){for(let e=l-3;e>=0;e-=3)if(g7[e+1]==-n){let r=g7[e+2],n=2&r?i:4&r?1&r?s:i:0;n&&(yn[t]=yn[g7[e]]=n),l=e;break}}else if(189==g7.length)break;else g7[l++]=t,g7[l++]=r,g7[l++]=a;else if(2==(o=yn[t])||1==o){let e=o==i;a=+!e;for(let t=l-3;t>=0;t-=3){let r=g7[t+2];if(2&r)break;if(e)g7[t+2]|=2;else{if(4&r)break;g7[t+2]|=4}}}}}(t,s,o,i,a),function(e,t,r,n){for(let i=0,s=n;i<=r.length;i++){let o=i?r[i-1].to:e,l=i<r.length?r[i].from:t;for(let a=o;a<l;){let o=yn[a];if(256==o){let o=a+1;for(;;)if(o==l){if(i==r.length)break;o=r[i++].to,l=i<r.length?r[i].from:t}else if(256==yn[o])o++;else break;let c=1==s,h=c==((o<t?yn[o]:n)==1)?c?1:2:n;for(let t=o,n=i,s=n?r[n-1].to:e;t>a;)t==s&&(t=r[--n].from,s=n?r[n-1].to:e),yn[--t]=h;a=o}else s=o,a++}}}(s,o,i,a),function t(r,n,i,s,o,l,a){let c=s%2?2:1;if(s%2==o%2)for(let h=n,u=0;h<i;){let n=!0,d=!1;if(u==l.length||h<l[u].from){let e=yn[h];e!=c&&(n=!1,d=16==e)}let f=n||1!=c?null:[],p=n?s:s+1,m=h;t:for(;;)if(u<l.length&&m==l[u].from){if(d)break;let t=l[u];if(!n)for(let e=t.to,r=u+1;;){if(e==i)break t;if(r<l.length&&l[r].from==e)e=l[r++].to;else if(yn[e]==c)break t;else break}u++,f?f.push(t):(t.from>h&&a.push(new yr(h,t.from,p)),e(r,t.direction==g4!=!(p%2)?s+1:s,o,t.inner,t.from,t.to,a),h=t.to),m=t.to}else if(m==i||(n?yn[m]!=c:yn[m]==c))break;else m++;f?t(r,h,m,s+1,o,f,a):h<m&&a.push(new yr(h,m,p)),h=m}else for(let h=i,u=l.length;h>n;){let i=!0,d=!1;if(!u||h>l[u-1].to){let e=yn[h-1];e!=c&&(i=!1,d=16==e)}let f=i||1!=c?null:[],p=i?s:s+1,m=h;t:for(;;)if(u&&m==l[u-1].to){if(d)break;let t=l[--u];if(!i)for(let e=t.from,r=u;;){if(e==n)break t;if(r&&l[r-1].to==e)e=l[--r].from;else if(yn[e-1]==c)break t;else break}f?f.push(t):(t.to<h&&a.push(new yr(t.to,h,p)),e(r,t.direction==g4!=!(p%2)?s+1:s,o,t.inner,t.from,t.to,a),h=t.from),m=t.from}else if(m==n||(i?yn[m-1]!=c:yn[m-1]==c))break;else m--;f?t(r,m,h,s+1,o,f,a):m<h&&a.push(new yr(m,h,p)),h=m}}(t,s,o,r,n,i,l)}(e,i,i,r,0,e.length,n),n}(e.text,t,r);return this.bidiCache.push(new v7(e.from,e.to,t,r,!0,n)),n}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||gi.safari&&(null==(e=this.inputState)?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{gv(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((9==e.nodeType?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let e of(this.root.activeElement==this.contentDOM&&this.contentDOM.blur(),this.plugins))e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return yx.of(new yv("number"==typeof e?pQ.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,r=this.viewState.scrollAnchorAt(e);return yx.of(new yv(pQ.cursor(r.from),"start","start",r.top-e,t,!0))}setTabFocusMode(e){null==e?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:"boolean"==typeof e?this.inputState.tabFocusMode=e?0:-1:0!=this.inputState.tabFocusMode&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return yC.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return yC.define(()=>({}),{eventObservers:e})}static theme(e,t){let r=mG.newName(),n=[vq.of(r),yN.of(vZ(`.${r}`,e))];return t&&t.dark&&n.push(vK.of(!0)),n}static baseTheme(e){return me.lowest(yN.of(vZ("."+vG,e,vX)))}static findFromDOM(e){var t;let r=e.querySelector(".cm-content"),n=r&&gj.get(r)||gj.get(e);return(null==(t=null==n?void 0:n.rootView)?void 0:t.view)||null}}v6.styleModule=yN,v6.inputHandler=yu,v6.clipboardInputFilter=yf,v6.clipboardOutputFilter=yp,v6.scrollHandler=yy,v6.focusChangeEffect=yd,v6.perLineTextDirection=ym,v6.exceptionSink=yc,v6.updateListener=yh,v6.editable=yk,v6.mouseSelectionStyle=ya,v6.dragMovesSelection=yl,v6.clickAddsSelectionRange=yo,v6.decorations=yP,v6.outerDecorations=yM,v6.atomicRanges=yT,v6.bidiIsolatedRanges=yI,v6.scrollMargins=yD,v6.darkTheme=vK,v6.cspNonce=p2.define({combine:e=>e.length?e[0]:""}),v6.contentAttributes=yO,v6.editorAttributes=yj,v6.lineWrapping=v6.contentAttributes.of({class:"cm-lineWrapping"}),v6.announce=my.define();let v9=4096,v8={};class v7{constructor(e,t,r,n,i,s){this.from=e,this.to=t,this.dir=r,this.isolates=n,this.fresh=i,this.order=s}static update(e,t){if(t.empty&&!e.some(e=>e.fresh))return e;let r=[],n=e.length?e[e.length-1].dir:g2.LTR;for(let i=Math.max(0,e.length-10);i<e.length;i++){let s=e[i];s.dir!=n||t.touchesRange(s.from,s.to)||r.push(new v7(t.mapPos(s.from,1),t.mapPos(s.to,-1),s.dir,s.isolates,!1,s.order))}return r}}function xe(e,t,r){for(let n=e.state.facet(t),i=n.length-1;i>=0;i--){let t=n[i],s="function"==typeof t?t(e):t;s&&gF(s,r)}return r}let xt=gi.mac?"mac":gi.windows?"win":gi.linux?"linux":"key";function xr(e,t,r){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),!1!==r&&t.shiftKey&&(e="Shift-"+e),e}let xn=me.default(v6.domEventHandlers({keydown:(e,t)=>xc(xo(t.state),e,t,"editor")})),xi=p2.define({enables:xn}),xs=new WeakMap;function xo(e){let t=e.facet(xi),r=xs.get(t);return r||xs.set(t,r=function(e,t=xt){let r=Object.create(null),n=Object.create(null),i=(e,t)=>{let r=n[e];if(null==r)n[e]=t;else if(r!=t)throw Error("Key binding "+e+" is used both as a regular binding and as a multi-stroke prefix")},s=(e,n,s,o,l)=>{var a,c;let h=r[e]||(r[e]=Object.create(null)),u=n.split(/ (?!$)/).map(e=>(function(e,t){let r,n,i,s,o=e.split(/-(?!$)/),l=o[o.length-1];"Space"==l&&(l=" ");for(let e=0;e<o.length-1;++e){let l=o[e];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))n=!0;else if(/^s(hift)?$/i.test(l))i=!0;else if(/^mod$/i.test(l))"mac"==t?s=!0:n=!0;else throw Error("Unrecognized modifier name: "+l)}return r&&(l="Alt-"+l),n&&(l="Ctrl-"+l),s&&(l="Meta-"+l),i&&(l="Shift-"+l),l})(e,t));for(let t=1;t<u.length;t++){let r=u.slice(0,t).join(" ");i(r,!0),h[r]||(h[r]={preventDefault:!0,stopPropagation:!1,run:[t=>{let n=xl={view:t,prefix:r,scope:e};return setTimeout(()=>{xl==n&&(xl=null)},4e3),!0}]})}let d=u.join(" ");i(d,!1);let f=h[d]||(h[d]={preventDefault:!1,stopPropagation:!1,run:(null==(c=null==(a=h._any)?void 0:a.run)?void 0:c.slice())||[]});s&&f.run.push(s),o&&(f.preventDefault=!0),l&&(f.stopPropagation=!0)};for(let n of e){let e=n.scope?n.scope.split(" "):["editor"];if(n.any)for(let t of e){let e=r[t]||(r[t]=Object.create(null));e._any||(e._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:i}=n;for(let t in e)e[t].run.push(e=>i(e,xa))}let i=n[t]||n.key;if(i)for(let t of e)s(t,i,n.run,n.preventDefault,n.stopPropagation),n.shift&&s(t,"Shift-"+i,n.shift,n.preventDefault,n.stopPropagation)}return r}(t.reduce((e,t)=>e.concat(t),[]))),r}let xl=null,xa=null;function xc(e,t,r,n){var i;xa=t;let s=("Esc"==(i=!(mQ&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||m0&&t.shiftKey&&t.key&&1==t.key.length||"Unidentified"==t.key)&&t.key||(t.shiftKey?mZ:mX)[t.keyCode]||t.key||"Unidentified")&&(i="Escape"),"Del"==i&&(i="Delete"),"Left"==i&&(i="ArrowLeft"),"Up"==i&&(i="ArrowUp"),"Right"==i&&(i="ArrowRight"),"Down"==i&&(i="ArrowDown"),i),o=pz(p_(s,0))==s.length&&" "!=s,l="",a=!1,c=!1,h=!1;xl&&xl.view==r&&xl.scope==n&&(l=xl.prefix+" ",0>ve.indexOf(t.keyCode)&&(c=!0,xl=null));let u=new Set,d=e=>{if(e){for(let t of e.run)if(!u.has(t)&&(u.add(t),t(r)))return e.stopPropagation&&(h=!0),!0;e.preventDefault&&(e.stopPropagation&&(h=!0),c=!0)}return!1},f=e[n],p,m;return f&&(d(f[l+xr(s,t,!o)])?a=!0:o&&(t.altKey||t.metaKey||t.ctrlKey)&&!(gi.windows&&t.ctrlKey&&t.altKey)&&!(gi.mac&&t.altKey&&!(t.ctrlKey||t.metaKey))&&(p=mX[t.keyCode])&&p!=s?d(f[l+xr(p,t,!0)])?a=!0:t.shiftKey&&(m=mZ[t.keyCode])!=s&&m!=p&&d(f[l+xr(m,t,!1)])&&(a=!0):o&&t.shiftKey&&d(f[l+xr(s,t,!0)])&&(a=!0),!a&&d(f._any)&&(a=!0)),c&&(a=!0),a&&h&&t.stopPropagation(),xa=null,a}class xh{constructor(e,t,r,n,i){this.className=e,this.left=t,this.top=r,this.width=n,this.height=i}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className==this.className&&(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",null!=this.width&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,r){if(!r.empty)return function(e,t,r){if(r.to<=e.viewport.from||r.from>=e.viewport.to)return[];let n=Math.max(r.from,e.viewport.from),i=Math.min(r.to,e.viewport.to),s=e.textDirection==g2.LTR,o=e.contentDOM,l=o.getBoundingClientRect(),a=xu(e),c=o.querySelector(".cm-line"),h=c&&window.getComputedStyle(c),u=l.left+(h?parseInt(h.paddingLeft)+Math.min(0,parseInt(h.textIndent)):0),d=l.right-(h?parseInt(h.paddingRight):0),f=yJ(e,n,1),p=yJ(e,i,-1),m=f.type==gV.Text?f:null,g=p.type==gV.Text?p:null;if(m&&(e.lineWrapping||f.widgetLineBreaks)&&(m=xd(e,n,1,m)),g&&(e.lineWrapping||p.widgetLineBreaks)&&(g=xd(e,i,-1,g)),m&&g&&m.from==g.from&&m.to==g.to)return v(x(r.from,r.to,m));{let t=m?x(r.from,null,m):b(f,!1),n=g?x(null,r.to,g):b(p,!0),i=[];return(m||f).to<(g||p).from-(m&&g?1:0)||f.widgetLineBreaks>1&&t.bottom+e.defaultLineHeight/2<n.top?i.push(y(u,t.bottom,d,n.top)):t.bottom<n.top&&e.elementAtHeight((t.bottom+n.top)/2).type==gV.Text&&(t.bottom=n.top=(t.bottom+n.top)/2),v(t).concat(i).concat(v(n))}function y(e,r,n,i){return new xh(t,e-a.left,r-a.top,n-e,i-r)}function v({top:e,bottom:t,horizontal:r}){let n=[];for(let i=0;i<r.length;i+=2)n.push(y(r[i],e,r[i+1],t));return n}function x(t,r,n){let i=1e9,o=-1e9,l=[];function a(t,r,a,c,h){let f=e.coordsAtPos(t,t==n.to?-2:2),p=e.coordsAtPos(a,a==n.from?2:-2);f&&p&&(i=Math.min(f.top,p.top,i),o=Math.max(f.bottom,p.bottom,o),h==g2.LTR?l.push(s&&r?u:f.left,s&&c?d:p.right):l.push(!s&&c?u:p.left,!s&&r?d:f.right))}let c=null!=t?t:n.from,h=null!=r?r:n.to;for(let n of e.visibleRanges)if(n.to>c&&n.from<h)for(let i=Math.max(n.from,c),s=Math.min(n.to,h);;){let n=e.state.doc.lineAt(i);for(let o of e.bidiSpans(n)){let e=o.from+n.from,l=o.to+n.from;if(e>=s)break;l>i&&a(Math.max(e,i),null==t&&e<=c,Math.min(l,s),null==r&&l>=h,o.dir)}if((i=n.to+1)>=s)break}return 0==l.length&&a(c,null==t,h,null==r,e.textDirection),{top:i,bottom:o,horizontal:l}}function b(e,t){let r=l.top+(t?e.top:e.bottom);return{top:r,bottom:r,horizontal:[]}}}(e,t,r);{let n=e.coordsAtPos(r.head,r.assoc||1);if(!n)return[];let i=xu(e);return[new xh(t,n.left-i.left,n.top-i.top,null,n.bottom-n.top)]}}}function xu(e){let t=e.scrollDOM.getBoundingClientRect();return{left:(e.textDirection==g2.LTR?t.left:t.right-e.scrollDOM.clientWidth*e.scaleX)-e.scrollDOM.scrollLeft*e.scaleX,top:t.top-e.scrollDOM.scrollTop*e.scaleY}}function xd(e,t,r,n){let i=e.coordsAtPos(t,2*r);if(!i)return n;let s=e.dom.getBoundingClientRect(),o=(i.top+i.bottom)/2,l=e.posAtCoords({x:s.left+1,y:o}),a=e.posAtCoords({x:s.right-1,y:o});return null==l||null==a?n:{from:Math.max(n.from,Math.min(l,a)),to:Math.min(n.to,Math.max(l,a))}}class xf{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(xp)!=e.state.facet(xp)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){!1!==this.layer.updateOnDocViewUpdate&&e.requestMeasure(this.measureReq)}setOrder(e){let t=0,r=e.facet(xp);for(;t<r.length&&r[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some((e,t)=>{var r;return r=this.drawn[t],!(e.constructor==r.constructor&&e.eq(r))})){let t=this.dom.firstChild,r=0;for(let n of e)n.update&&t&&n.constructor&&this.drawn[r].constructor&&n.update(t,this.drawn[r])?(t=t.nextSibling,r++):this.dom.insertBefore(n.draw(),t);for(;t;){let e=t.nextSibling;t.remove(),t=e}this.drawn=e,gi.safari&&gi.safari_version>=26&&(this.dom.style.display=this.dom.firstChild?"":"none")}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}let xp=p2.define();function xm(e){return[yC.define(t=>new xf(t,e)),xp.of(e)]}let xg=p2.define({combine:e=>mE(e,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})});function xy(e){return e.startState.facet(xg)!=e.state.facet(xg)}let xv=xm({above:!0,markers(e){let{state:t}=e,r=t.facet(xg),n=[];for(let i of t.selection.ranges){let s=i==t.selection.main;if(i.empty||r.drawRangeCursor){let t=s?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",r=i.empty?i:pQ.cursor(i.head,i.head>i.anchor?-1:1);for(let i of xh.forRange(e,t,r))n.push(i)}}return n},update(e,t){e.transactions.some(e=>e.selection)&&(t.style.animationName="cm-blink"==t.style.animationName?"cm-blink2":"cm-blink");let r=xy(e);return r&&xx(e.state,t),e.docChanged||e.selectionSet||r},mount(e,t){xx(t.state,e)},class:"cm-cursorLayer"});function xx(e,t){t.style.animationDuration=e.facet(xg).cursorBlinkRate+"ms"}let xb=xm({above:!1,markers:e=>e.state.selection.ranges.map(t=>t.empty?[]:xh.forRange(e,"cm-selectionBackground",t)).reduce((e,t)=>e.concat(t)),update:(e,t)=>e.docChanged||e.selectionSet||e.viewportChanged||xy(e),class:"cm-selectionLayer"}),xw=me.highest(v6.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),xk=my.define({map:(e,t)=>null==e?null:t.mapPos(e)}),xA=p8.define({create:()=>null,update:(e,t)=>(null!=e&&(e=t.changes.mapPos(e)),t.effects.reduce((e,t)=>t.is(xk)?t.value:e,e))}),xS=yC.fromClass(class{constructor(e){this.view=e,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(e){var t;let r=e.state.field(xA);null==r?null!=this.cursor&&(null==(t=this.cursor)||t.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(e.startState.field(xA)!=r||e.docChanged||e.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:e}=this,t=e.state.field(xA),r=null!=t&&e.coordsAtPos(t);if(!r)return null;let n=e.scrollDOM.getBoundingClientRect();return{left:r.left-n.left+e.scrollDOM.scrollLeft*e.scaleX,top:r.top-n.top+e.scrollDOM.scrollTop*e.scaleY,height:r.bottom-r.top}}drawCursor(e){if(this.cursor){let{scaleX:t,scaleY:r}=this.view;e?(this.cursor.style.left=e.left/t+"px",this.cursor.style.top=e.top/r+"px",this.cursor.style.height=e.height/r+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(e){this.view.state.field(xA)!=e&&this.view.dispatch({effects:xk.of(e)})}},{eventObservers:{dragover(e){this.setDropPos(this.view.posAtCoords({x:e.clientX,y:e.clientY}))},dragleave(e){e.target!=this.view.contentDOM&&this.view.contentDOM.contains(e.relatedTarget)||this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function xC(e,t,r,n,i){t.lastIndex=0;for(let s=e.iterRange(r,n),o=r,l;!s.next().done;o+=s.value.length)if(!s.lineBreak)for(;l=t.exec(s.value);)i(o+l.index,l)}class xE{constructor(e){const{regexp:t,decoration:r,decorate:n,boundary:i,maxLength:s=1e3}=e;if(!t.global)throw RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,n)this.addMatch=(e,t,r,i)=>n(i,r,r+e[0].length,e,t);else if("function"==typeof r)this.addMatch=(e,t,n,i)=>{let s=r(e,t,n);s&&i(n,n+e[0].length,s)};else if(r)this.addMatch=(e,t,n,i)=>i(n,n+e[0].length,r);else throw RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=i,this.maxLength=s}createDeco(e){let t=new mI,r=t.add.bind(t);for(let{from:t,to:n}of function(e,t){let r=e.visibleRanges;if(1==r.length&&r[0].from==e.viewport.from&&r[0].to==e.viewport.to)return r;let n=[];for(let{from:i,to:s}of r)i=Math.max(e.state.doc.lineAt(i).from,i-t),s=Math.min(e.state.doc.lineAt(s).to,s+t),n.length&&n[n.length-1].to>=i?n[n.length-1].to=s:n.push({from:i,to:s});return n}(e,this.maxLength))xC(e.state.doc,this.regexp,t,n,(t,n)=>this.addMatch(n,e,t,r));return t.finish()}updateDeco(e,t){let r=1e9,n=-1;return(e.docChanged&&e.changes.iterChanges((t,i,s,o)=>{o>=e.view.viewport.from&&s<=e.view.viewport.to&&(r=Math.min(s,r),n=Math.max(o,n))}),e.viewportMoved||n-r>1e3)?this.createDeco(e.view):n>-1?this.updateRange(e.view,t.map(e.changes),r,n):t}updateRange(e,t,r,n){for(let i of e.visibleRanges){let s=Math.max(i.from,r),o=Math.min(i.to,n);if(o>=s){let r=e.state.doc.lineAt(s),n=r.to<o?e.state.doc.lineAt(o):r,l=Math.max(i.from,r.from),a=Math.min(i.to,n.to);if(this.boundary){for(;s>r.from;s--)if(this.boundary.test(r.text[s-1-r.from])){l=s;break}for(;o<n.to;o++)if(this.boundary.test(n.text[o-n.from])){a=o;break}}let c=[],h,u=(e,t,r)=>c.push(r.range(e,t));if(r==n)for(this.regexp.lastIndex=l-r.from;(h=this.regexp.exec(r.text))&&h.index<a-r.from;)this.addMatch(h,e,h.index+r.from,u);else xC(e.state.doc,this.regexp,l,a,(t,r)=>this.addMatch(r,e,t,u));t=t.update({filterFrom:l,filterTo:a,filter:(e,t)=>e<l||t>a,add:c})}}return t}}let xj=null!=/x/.unicode?"gu":"g",xO=RegExp("[\0-\b\n-\x1f\x7f-\x9f\xad\u2028\u2029\uFEFF-]",xj),xP={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"},xM=null,xT=p2.define({combine(e){let t=mE(e,{render:null,specialChars:xO,addSpecialChars:null});return(t.replaceTabs=!function(){var e;if(null==xM&&"undefined"!=typeof document&&document.body){let t=document.body.style;xM=(null!=(e=t.tabSize)?e:t.MozTabSize)!=null}return xM||!1}())&&(t.specialChars=RegExp("	|"+t.specialChars.source,xj)),t.addSpecialChars&&(t.specialChars=RegExp(t.specialChars.source+"|"+t.addSpecialChars.source,xj)),t}}),xI=null;class x$ extends gW{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){var t;let r=(t=this.code)>=32?"":10==t?"":String.fromCharCode(9216+t),n=e.state.phrase("Control character")+" "+(xP[this.code]||"0x"+this.code.toString(16)),i=this.options.render&&this.options.render(this.code,n,r);if(i)return i;let s=document.createElement("span");return s.textContent=r,s.title=n,s.setAttribute("aria-label",n),s.className="cm-specialChar",s}ignoreEvent(){return!1}}class xD extends gW{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}let xR=gH.line({class:"cm-activeLine"}),xN=yC.fromClass(class{constructor(e){this.decorations=this.getDeco(e)}update(e){(e.docChanged||e.selectionSet)&&(this.decorations=this.getDeco(e.view))}getDeco(e){let t=-1,r=[];for(let n of e.state.selection.ranges){let i=e.lineBlockAt(n.head);i.from>t&&(r.push(xR.range(i.from)),t=i.from)}return gH.set(r)}},{decorations:e=>e.decorations});class xL extends gW{constructor(e){super(),this.content=e}toDOM(e){let t=document.createElement("span");return t.className="cm-placeholder",t.style.pointerEvents="none",t.appendChild("string"==typeof this.content?document.createTextNode(this.content):"function"==typeof this.content?this.content(e):this.content.cloneNode(!0)),t.setAttribute("aria-hidden","true"),t}coordsAt(e){let t=e.firstChild?ga(e.firstChild):[];if(!t.length)return null;let r=window.getComputedStyle(e.parentNode),n=gp(t[0],"rtl"!=r.direction),i=parseInt(r.lineHeight);return n.bottom-n.top>1.5*i?{left:n.left,right:n.right,top:n.top,bottom:n.top+i}:n}ignoreEvent(){return!1}}function xF(e,t){var r;let n,i=e.posAtCoords({x:t.clientX,y:t.clientY},!1),s=e.state.doc.lineAt(i),o=i-s.from,l=o>2e3?-1:o==s.length?(r=t.clientX,(n=e.coordsAtPos(e.viewport.from))?Math.round(Math.abs((n.left-r)/e.defaultCharacterWidth)):-1):mV(s.text,e.state.tabSize,i-s.from);return{line:s.number,col:l,off:o}}let x_={Alt:[18,e=>!!e.altKey],Control:[17,e=>!!e.ctrlKey],Shift:[16,e=>!!e.shiftKey],Meta:[91,e=>!!e.metaKey]},xB={style:"cursor: crosshair"},xz="-10000px";class xW{constructor(e,t,r,n){this.facet=t,this.createTooltipView=r,this.removeTooltipView=n,this.input=e.state.facet(t),this.tooltips=this.input.filter(e=>e);let i=null;this.tooltipViews=this.tooltips.map(e=>i=r(e,i))}update(e,t){var r;let n=e.state.facet(this.facet),i=n.filter(e=>e);if(n===this.input){for(let t of this.tooltipViews)t.update&&t.update(e);return!1}let s=[],o=t?[]:null;for(let r=0;r<i.length;r++){let n=i[r],l=-1;if(n){for(let e=0;e<this.tooltips.length;e++){let t=this.tooltips[e];t&&t.create==n.create&&(l=e)}if(l<0)s[r]=this.createTooltipView(n,r?s[r-1]:null),o&&(o[r]=!!n.above);else{let n=s[r]=this.tooltipViews[l];o&&(o[r]=t[l]),n.update&&n.update(e)}}}for(let e of this.tooltipViews)0>s.indexOf(e)&&(this.removeTooltipView(e),null==(r=e.destroy)||r.call(e));return t&&(o.forEach((e,r)=>t[r]=e),t.length=o.length),this.input=n,this.tooltips=i,this.tooltipViews=s,!0}}function xV(e){let t=e.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:t.clientHeight,right:t.clientWidth}}let xH=p2.define({combine:e=>{var t,r,n;return{position:gi.ios?"absolute":(null==(t=e.find(e=>e.position))?void 0:t.position)||"fixed",parent:(null==(r=e.find(e=>e.parent))?void 0:r.parent)||null,tooltipSpace:(null==(n=e.find(e=>e.tooltipSpace))?void 0:n.tooltipSpace)||xV}}}),xU=new WeakMap,xq=yC.fromClass(class{constructor(e){this.view=e,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let t=e.state.facet(xH);this.position=t.position,this.parent=t.parent,this.classes=e.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver="function"==typeof ResizeObserver?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new xW(e,xY,(e,t)=>this.createTooltip(e,t),e=>{this.resizeObserver&&this.resizeObserver.unobserve(e.dom),e.dom.remove()}),this.above=this.manager.tooltips.map(e=>!!e.above),this.intersectionObserver="function"==typeof IntersectionObserver?new IntersectionObserver(e=>{Date.now()>this.lastTransaction-50&&e.length>0&&e[e.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),e.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver)for(let e of(this.intersectionObserver.disconnect(),this.manager.tooltipViews))this.intersectionObserver.observe(e.dom)}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(e){e.transactions.length&&(this.lastTransaction=Date.now());let t=this.manager.update(e,this.above);t&&this.observeIntersection();let r=t||e.geometryChanged,n=e.state.facet(xH);if(n.position!=this.position&&!this.madeAbsolute){for(let e of(this.position=n.position,this.manager.tooltipViews))e.dom.style.position=this.position;r=!0}if(n.parent!=this.parent){for(let e of(this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer(),this.manager.tooltipViews))this.container.appendChild(e.dom);r=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);r&&this.maybeMeasure()}createTooltip(e,t){let r=e.create(this.view),n=t?t.dom:null;if(r.dom.classList.add("cm-tooltip"),e.arrow&&!r.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let e=document.createElement("div");e.className="cm-tooltip-arrow",r.dom.appendChild(e)}return r.dom.style.position=this.position,r.dom.style.top=xz,r.dom.style.left="0px",this.container.insertBefore(r.dom,n),r.mount&&r.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(r.dom),r}destroy(){var e,t,r;for(let t of(this.view.win.removeEventListener("resize",this.measureSoon),this.manager.tooltipViews))t.dom.remove(),null==(e=t.destroy)||e.call(t);this.parent&&this.container.remove(),null==(t=this.resizeObserver)||t.disconnect(),null==(r=this.intersectionObserver)||r.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let e=1,t=1,r=!1;if("fixed"==this.position&&this.manager.tooltipViews.length){let{dom:e}=this.manager.tooltipViews[0];if(gi.safari){let t=e.getBoundingClientRect();r=Math.abs(t.top+1e4)>1||Math.abs(t.left)>1}else r=!!e.offsetParent&&e.offsetParent!=this.container.ownerDocument.body}if(r||"absolute"==this.position)if(this.parent){let r=this.parent.getBoundingClientRect();r.width&&r.height&&(e=r.width/this.parent.offsetWidth,t=r.height/this.parent.offsetHeight)}else({scaleX:e,scaleY:t}=this.view.viewState);let n=this.view.scrollDOM.getBoundingClientRect(),i=yR(this.view);return{visible:{left:n.left+i.left,top:n.top+i.top,right:n.right-i.right,bottom:n.bottom-i.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((e,t)=>{let r=this.manager.tooltipViews[t];return r.getCoords?r.getCoords(e.pos):this.view.coordsAtPos(e.pos)}),size:this.manager.tooltipViews.map(({dom:e})=>e.getBoundingClientRect()),space:this.view.state.facet(xH).tooltipSpace(this.view),scaleX:e,scaleY:t,makeAbsolute:r}}writeMeasure(e){var t;if(e.makeAbsolute)for(let e of(this.madeAbsolute=!0,this.position="absolute",this.manager.tooltipViews))e.dom.style.position="absolute";let{visible:r,space:n,scaleX:i,scaleY:s}=e,o=[];for(let l=0;l<this.manager.tooltips.length;l++){let a=this.manager.tooltips[l],c=this.manager.tooltipViews[l],{dom:h}=c,u=e.pos[l],d=e.size[l];if(!u||!1!==a.clip&&(u.bottom<=Math.max(r.top,n.top)||u.top>=Math.min(r.bottom,n.bottom)||u.right<Math.max(r.left,n.left)-.1||u.left>Math.min(r.right,n.right)+.1)){h.style.top=xz;continue}let f=a.arrow?c.dom.querySelector(".cm-tooltip-arrow"):null,p=7*!!f,m=d.right-d.left,g=null!=(t=xU.get(c))?t:d.bottom-d.top,y=c.offset||xJ,v=this.view.textDirection==g2.LTR,x=d.width>n.right-n.left?v?n.left:n.right-d.width:v?Math.max(n.left,Math.min(u.left-14*!!f+y.x,n.right-m)):Math.min(Math.max(n.left,u.left-m+14*!!f-y.x),n.right-m),b=this.above[l];!a.strictSide&&(b?u.top-g-p-y.y<n.top:u.bottom+g+p+y.y>n.bottom)&&b==n.bottom-u.bottom>u.top-n.top&&(b=this.above[l]=!b);let w=(b?u.top-n.top:n.bottom-u.bottom)-p;if(w<g&&!1!==c.resize){if(w<this.view.defaultLineHeight){h.style.top=xz;continue}xU.set(c,g),h.style.height=(g=w)/s+"px"}else h.style.height&&(h.style.height="");let k=b?u.top-g-p-y.y:u.bottom+p+y.y,A=x+m;if(!0!==c.overlap)for(let e of o)e.left<A&&e.right>x&&e.top<k+g&&e.bottom>k&&(k=b?e.top-g-2-p:e.bottom+p+2);if("absolute"==this.position?(h.style.top=(k-e.parent.top)/s+"px",xK(h,(x-e.parent.left)/i)):(h.style.top=k/s+"px",xK(h,x/i)),f){let e=u.left+(v?y.x:-y.x)-(x+14-7);f.style.left=e/i+"px"}!0!==c.overlap&&o.push({left:x,top:k,right:A,bottom:k+g}),h.classList.toggle("cm-tooltip-above",b),h.classList.toggle("cm-tooltip-below",!b),c.positioned&&c.positioned(e.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView)&&(this.inView=this.view.inView,!this.inView))for(let e of this.manager.tooltipViews)e.dom.style.top=xz}},{eventObservers:{scroll(){this.maybeMeasure()}}});function xK(e,t){let r=parseInt(e.style.left,10);(isNaN(r)||Math.abs(t-r)>1)&&(e.style.left=t+"px")}let xG=v6.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),xJ={x:0,y:0},xY=p2.define({enables:[xq,xG]}),xX=p2.define({combine:e=>e.reduce((e,t)=>e.concat(t),[])});class xZ{static create(e){return new xZ(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new xW(e,xX,(e,t)=>this.createHostedView(e,t),e=>e.dom.remove())}createHostedView(e,t){let r=e.create(this.view);return r.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(r.dom,t?t.dom.nextSibling:this.dom.firstChild),this.mounted&&r.mount&&r.mount(this.view),r}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)null==(e=t.destroy)||e.call(t)}passProp(e){let t;for(let r of this.manager.tooltipViews){let n=r[e];if(void 0!==n){if(void 0===t)t=n;else if(t!==n)return}}return t}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}let xQ=xY.compute([xX],e=>{let t=e.facet(xX);return 0===t.length?null:{pos:Math.min(...t.map(e=>e.pos)),end:Math.max(...t.map(e=>{var t;return null!=(t=e.end)?t:e.pos})),create:xZ.create,above:t[0].above,arrow:t.some(e=>e.arrow)}});class x0{constructor(e,t,r,n,i){this.view=e,this.source=t,this.field=r,this.setHover=n,this.hoverTime=i,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:t}=this,r=e.docView.nearest(t.target);if(!r)return;let n,i=1;if(r instanceof gD)n=r.posAtStart;else{if(null==(n=e.posAtCoords(t)))return;let r=e.coordsAtPos(n);if(!r||t.y<r.top||t.y>r.bottom||t.x<r.left-e.defaultCharacterWidth||t.x>r.right+e.defaultCharacterWidth)return;let s=e.bidiSpans(e.state.doc.lineAt(n)).find(e=>e.from<=n&&e.to>=n),o=s&&s.dir==g2.RTL?-1:1;i=t.x<r.left?-o:o}let s=this.source(e,n,i);if(null==s?void 0:s.then){let t=this.pending={pos:n};s.then(r=>{this.pending==t&&(this.pending=null,r&&!(Array.isArray(r)&&!r.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(r)?r:[r])}))},t=>yw(e.state,t,"hover tooltip"))}else s&&!(Array.isArray(s)&&!s.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(s)?s:[s])})}get tooltip(){let e=this.view.plugin(xq),t=e?e.manager.tooltips.findIndex(e=>e.create==xZ.create):-1;return t>-1?e.manager.tooltipViews[t]:null}mousemove(e){var t,r;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:n,tooltip:i}=this;if(n.length&&i&&!function(e,t){let{left:r,right:n,top:i,bottom:s}=e.getBoundingClientRect(),o;if(o=e.querySelector(".cm-tooltip-arrow")){let e=o.getBoundingClientRect();i=Math.min(e.top,i),s=Math.max(e.bottom,s)}return t.clientX>=r-4&&t.clientX<=n+4&&t.clientY>=i-4&&t.clientY<=s+4}(i.dom,e)||this.pending){let{pos:i}=n[0]||this.pending,s=null!=(r=null==(t=n[0])?void 0:t.end)?r:i;(i==s?this.view.posAtCoords(this.lastMove)!=i:!function(e,t,r,n,i,s){let o=e.scrollDOM.getBoundingClientRect(),l=e.documentTop+e.documentPadding.top+e.contentHeight;if(o.left>n||o.right<n||o.top>i||Math.min(o.bottom,l)<i)return!1;let a=e.posAtCoords({x:n,y:i},!1);return a>=t&&a<=r}(this.view,i,s,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:t}=this;if(t.length){let{tooltip:t}=this;t&&t.dom.contains(e.relatedTarget)?this.watchTooltipLeave(t.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let t=r=>{e.removeEventListener("mouseleave",t),this.active.length&&!this.view.dom.contains(r.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",t)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}function x1(e,t){let r=e.plugin(xq);if(!r)return null;let n=r.manager.tooltips.indexOf(t);return n<0?null:r.manager.tooltipViews[n]}let x2=my.define(),x4=p2.define({combine(e){let t,r;for(let n of e)t=t||n.topContainer,r=r||n.bottomContainer;return{topContainer:t,bottomContainer:r}}});function x3(e,t){let r=e.plugin(x5),n=r?r.specs.indexOf(t):-1;return n>-1?r.panels[n]:null}let x5=yC.fromClass(class{constructor(e){this.input=e.state.facet(x8),this.specs=this.input.filter(e=>e),this.panels=this.specs.map(t=>t(e));let t=e.state.facet(x4);for(let r of(this.top=new x6(e,!0,t.topContainer),this.bottom=new x6(e,!1,t.bottomContainer),this.top.sync(this.panels.filter(e=>e.top)),this.bottom.sync(this.panels.filter(e=>!e.top)),this.panels))r.dom.classList.add("cm-panel"),r.mount&&r.mount()}update(e){let t=e.state.facet(x4);this.top.container!=t.topContainer&&(this.top.sync([]),this.top=new x6(e.view,!0,t.topContainer)),this.bottom.container!=t.bottomContainer&&(this.bottom.sync([]),this.bottom=new x6(e.view,!1,t.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let r=e.state.facet(x8);if(r!=this.input){let t=r.filter(e=>e),n=[],i=[],s=[],o=[];for(let r of t){let t=this.specs.indexOf(r),l;t<0?(l=r(e.view),o.push(l)):(l=this.panels[t]).update&&l.update(e),n.push(l),(l.top?i:s).push(l)}for(let e of(this.specs=t,this.panels=n,this.top.sync(i),this.bottom.sync(s),o))e.dom.classList.add("cm-panel"),e.mount&&e.mount()}else for(let t of this.panels)t.update&&t.update(e)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:e=>v6.scrollMargins.of(t=>{let r=t.plugin(e);return r&&{top:r.top.scrollMargin(),bottom:r.bottom.scrollMargin()}})});class x6{constructor(e,t,r){this.view=e,this.top=t,this.container=r,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&0>e.indexOf(t)&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(0==this.panels.length){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let e=this.container||this.view.dom;e.insertBefore(this.dom,this.top?e.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=x9(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=x9(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(this.container&&this.classes!=this.view.themeClasses){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function x9(e){let t=e.nextSibling;return e.remove(),t}let x8=p2.define({enables:x5});class x7 extends mj{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}x7.prototype.elementClass="",x7.prototype.toDOM=void 0,x7.prototype.mapMode=pV.TrackBefore,x7.prototype.startSide=x7.prototype.endSide=-1,x7.prototype.point=!0;let be=p2.define(),bt=p2.define(),br={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>mT.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{},side:"before"},bn=p2.define(),bi=p2.define({combine:e=>e.some(e=>e)});function bs(e){let t=[bo];return e&&!1===e.fixed&&t.push(bi.of(!0)),t}let bo=yC.fromClass(class{constructor(e){for(let t of(this.view=e,this.domAfter=null,this.prevViewport=e.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters cm-gutters-before",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=e.state.facet(bn).map(t=>new bh(e,t)),this.fixed=!e.state.facet(bi),this.gutters))"after"==t.config.side?this.getDOMAfter().appendChild(t.dom):this.dom.appendChild(t.dom);this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),e.scrollDOM.insertBefore(this.dom,e.contentDOM)}getDOMAfter(){return this.domAfter||(this.domAfter=document.createElement("div"),this.domAfter.className="cm-gutters cm-gutters-after",this.domAfter.setAttribute("aria-hidden","true"),this.domAfter.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.domAfter.style.position=this.fixed?"sticky":"",this.view.scrollDOM.appendChild(this.domAfter)),this.domAfter}update(e){if(this.updateGutters(e)){let t=this.prevViewport,r=e.view.viewport,n=Math.min(t.to,r.to)-Math.max(t.from,r.from);this.syncGutters(n<(r.to-r.from)*.8)}if(e.geometryChanged){let e=this.view.contentHeight/this.view.scaleY+"px";this.dom.style.minHeight=e,this.domAfter&&(this.domAfter.style.minHeight=e)}this.view.state.facet(bi)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"",this.domAfter&&(this.domAfter.style.position=this.fixed?"sticky":"")),this.prevViewport=e.view.viewport}syncGutters(e){let t=this.dom.nextSibling;e&&(this.dom.remove(),this.domAfter&&this.domAfter.remove());let r=mT.iter(this.view.state.facet(be),this.view.viewport.from),n=[],i=this.gutters.map(e=>new bc(e,this.view.viewport,-this.view.documentPadding.top));for(let e of this.view.viewportLineBlocks)if(n.length&&(n=[]),Array.isArray(e.type)){let t=!0;for(let s of e.type)if(s.type==gV.Text&&t){for(let e of(ba(r,n,s.from),i))e.line(this.view,s,n);t=!1}else if(s.widget)for(let e of i)e.widget(this.view,s)}else if(e.type==gV.Text)for(let t of(ba(r,n,e.from),i))t.line(this.view,e,n);else if(e.widget)for(let t of i)t.widget(this.view,e);for(let e of i)e.finish();e&&(this.view.scrollDOM.insertBefore(this.dom,t),this.domAfter&&this.view.scrollDOM.appendChild(this.domAfter))}updateGutters(e){let t=e.startState.facet(bn),r=e.state.facet(bn),n=e.docChanged||e.heightChanged||e.viewportChanged||!mT.eq(e.startState.facet(be),e.state.facet(be),e.view.viewport.from,e.view.viewport.to);if(t==r)for(let t of this.gutters)t.update(e)&&(n=!0);else{n=!0;let i=[];for(let n of r){let r=t.indexOf(n);r<0?i.push(new bh(this.view,n)):(this.gutters[r].update(e),i.push(this.gutters[r]))}for(let e of this.gutters)e.dom.remove(),0>i.indexOf(e)&&e.destroy();for(let e of i)"after"==e.config.side?this.getDOMAfter().appendChild(e.dom):this.dom.appendChild(e.dom);this.gutters=i}return n}destroy(){for(let e of this.gutters)e.destroy();this.dom.remove(),this.domAfter&&this.domAfter.remove()}},{provide:e=>v6.scrollMargins.of(t=>{let r=t.plugin(e);if(!r||0==r.gutters.length||!r.fixed)return null;let n=r.dom.offsetWidth*t.scaleX,i=r.domAfter?r.domAfter.offsetWidth*t.scaleX:0;return t.textDirection==g2.LTR?{left:n,right:i}:{right:n,left:i}})});function bl(e){return Array.isArray(e)?e:[e]}function ba(e,t,r){for(;e.value&&e.from<=r;)e.from==r&&t.push(e.value),e.next()}class bc{constructor(e,t,r){this.gutter=e,this.height=r,this.i=0,this.cursor=mT.iter(e.markers,t.from)}addElement(e,t,r){let{gutter:n}=this,i=(t.top-this.height)/e.scaleY,s=t.height/e.scaleY;if(this.i==n.elements.length){let t=new bu(e,s,i,r);n.elements.push(t),n.dom.appendChild(t.dom)}else n.elements[this.i].update(e,s,i,r);this.height=t.bottom,this.i++}line(e,t,r){let n=[];ba(this.cursor,n,t.from),r.length&&(n=n.concat(r));let i=this.gutter.config.lineMarker(e,t,n);i&&n.unshift(i);let s=this.gutter;(0!=n.length||s.config.renderEmptyElements)&&this.addElement(e,t,n)}widget(e,t){let r=this.gutter.config.widgetMarker(e,t.widget,t),n=r?[r]:null;for(let r of e.state.facet(bt)){let i=r(e,t.widget,t);i&&(n||(n=[])).push(i)}n&&this.addElement(e,t,n)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class bh{constructor(e,t){for(let r in this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:""),t.domEventHandlers)this.dom.addEventListener(r,n=>{let i=n.target,s;if(i!=this.dom&&this.dom.contains(i)){for(;i.parentNode!=this.dom;)i=i.parentNode;let e=i.getBoundingClientRect();s=(e.top+e.bottom)/2}else s=n.clientY;let o=e.lineBlockAtHeight(s-e.documentTop);t.domEventHandlers[r](e,o,n)&&n.preventDefault()});this.markers=bl(t.markers(e)),t.initialSpacer&&(this.spacer=new bu(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=bl(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let t=this.config.updateSpacer(this.spacer.markers[0],e);t!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[t])}let r=e.view.viewport;return!mT.eq(this.markers,t,r.from,r.to)||!!this.config.lineMarkerChange&&this.config.lineMarkerChange(e)}destroy(){for(let e of this.elements)e.destroy()}}class bu{constructor(e,t,r,n){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,r,n)}update(e,t,r,n){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=r&&(this.dom.style.marginTop=(this.above=r)?r+"px":""),!function(e,t){if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].compare(t[r]))return!1;return!0}(this.markers,n)&&this.setMarkers(e,n)}setMarkers(e,t){let r="cm-gutterElement",n=this.dom.firstChild;for(let i=0,s=0;;){let o=s,l=i<t.length?t[i++]:null,a=!1;if(l){let e=l.elementClass;e&&(r+=" "+e);for(let e=s;e<this.markers.length;e++)if(this.markers[e].compare(l)){o=e,a=!0;break}}else o=this.markers.length;for(;s<o;){let e=this.markers[s++];if(e.toDOM){e.destroy(n);let t=n.nextSibling;n.remove(),n=t}}if(!l)break;l.toDOM&&(a?n=n.nextSibling:this.dom.insertBefore(l.toDOM(e),n)),a&&s++}this.dom.className=r,this.markers=t}destroy(){this.setMarkers(null,[])}}let bd=p2.define(),bf=p2.define(),bp=p2.define({combine:e=>mE(e,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let r=Object.assign({},e);for(let e in t){let n=r[e],i=t[e];r[e]=n?(e,t,r)=>n(e,t,r)||i(e,t,r):i}return r}})});class bm extends x7{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function bg(e,t){return e.state.facet(bp).formatNumber(t,e.state)}let by=bn.compute([bp],e=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers:e=>e.state.facet(bd),lineMarker:(e,t,r)=>r.some(e=>e.toDOM)?null:new bm(bg(e,e.state.doc.lineAt(t.from).number)),widgetMarker:(e,t,r)=>{for(let n of e.state.facet(bf)){let i=n(e,t,r);if(i)return i}return null},lineMarkerChange:e=>e.startState.facet(bp)!=e.state.facet(bp),initialSpacer:e=>new bm(bg(e,bv(e.state.doc.lines))),updateSpacer(e,t){let r=bg(t.view,bv(t.view.state.doc.lines));return r==e.number?e:new bm(r)},domEventHandlers:e.facet(bp).domEventHandlers,side:"before"}));function bv(e){let t=9;for(;t<e;)t=10*t+9;return t}let bx=new class extends x7{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},bb=be.compute(["selection"],e=>{let t=[],r=-1;for(let n of e.selection.ranges){let i=e.doc.lineAt(n.head).from;i>r&&(r=i,t.push(bx.range(i)))}return mT.of(t)}),bw=0;class bk{constructor(e,t){this.from=e,this.to=t}}class bA{constructor(e={}){this.id=bw++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw Error("This node type doesn't define a deserialize function")}),this.combine=e.combine||null}add(e){if(this.perNode)throw RangeError("Can't add per-node props to node types");return"function"!=typeof e&&(e=bE.match(e)),t=>{let r=e(t);return void 0===r?null:[this,r]}}}bA.closedBy=new bA({deserialize:e=>e.split(" ")}),bA.openedBy=new bA({deserialize:e=>e.split(" ")}),bA.group=new bA({deserialize:e=>e.split(" ")}),bA.isolate=new bA({deserialize:e=>{if(e&&"rtl"!=e&&"ltr"!=e&&"auto"!=e)throw RangeError("Invalid value for isolate: "+e);return e||"auto"}}),bA.contextHash=new bA({perNode:!0}),bA.lookAhead=new bA({perNode:!0}),bA.mounted=new bA({perNode:!0});class bS{constructor(e,t,r){this.tree=e,this.overlay=t,this.parser=r}static get(e){return e&&e.props&&e.props[bA.mounted.id]}}let bC=Object.create(null);class bE{constructor(e,t,r,n=0){this.name=e,this.props=t,this.id=r,this.flags=n}static define(e){let t=e.props&&e.props.length?Object.create(null):bC,r=!!e.top|2*!!e.skipped|4*!!e.error|8*(null==e.name),n=new bE(e.name||"",t,e.id,r);if(e.props){for(let r of e.props)if(Array.isArray(r)||(r=r(n)),r){if(r[0].perNode)throw RangeError("Can't store a per-node prop on a node type");t[r[0].id]=r[1]}}return n}prop(e){return this.props[e.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(e){if("string"==typeof e){if(this.name==e)return!0;let t=this.prop(bA.group);return!!t&&t.indexOf(e)>-1}return this.id==e}static match(e){let t=Object.create(null);for(let r in e)for(let n of r.split(" "))t[n]=e[r];return e=>{for(let r=e.prop(bA.group),n=-1;n<(r?r.length:0);n++){let i=t[n<0?e.name:r[n]];if(i)return i}}}}bE.none=new bE("",Object.create(null),0,8);class bj{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let r of this.types){let n=null;for(let t of e){let e=t(r);if(e){n||(n=Object.assign({},r.props));let t=e[1],i=e[0];i.combine&&i.id in n&&(t=i.combine(n[i.id],t)),n[i.id]=t}}t.push(n?new bE(r.name,n,r.id,r.flags):r)}return new bj(t)}}let bO=new WeakMap,bP=new WeakMap;(p=m||(m={}))[p.ExcludeBuffers=1]="ExcludeBuffers",p[p.IncludeAnonymous=2]="IncludeAnonymous",p[p.IgnoreMounts=4]="IgnoreMounts",p[p.IgnoreOverlays=8]="IgnoreOverlays";class bM{constructor(e,t,r,n,i){if(this.type=e,this.children=t,this.positions=r,this.length=n,this.props=null,i&&i.length)for(let[e,t]of(this.props=Object.create(null),i))this.props["number"==typeof e?e:e.id]=t}toString(){let e=bS.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let e of this.children){let r=e.toString();r&&(t&&(t+=","),t+=r)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new bV(this.topNode,e)}cursorAt(e,t=0,r=0){let n=new bV(bO.get(this)||this.topNode);return n.moveTo(e,t),bO.set(this,n._tree),n}get topNode(){return new bN(this,0,0,null)}resolve(e,t=0){let r=bD(bO.get(this)||this.topNode,e,t,!1);return bO.set(this,r),r}resolveInner(e,t=0){let r=bD(bP.get(this)||this.topNode,e,t,!0);return bP.set(this,r),r}resolveStack(e,t=0){return function(e,t,r){let n=e.resolveInner(t,r),i=null;for(let e=n instanceof bN?n:n.context.parent;e;e=e.parent)if(e.index<0){let s=e.parent;(i||(i=[n])).push(s.resolve(t,r)),e=s}else{let s=bS.get(e.tree);if(s&&s.overlay&&s.overlay[0].from<=t&&s.overlay[s.overlay.length-1].to>=t){let o=new bN(s.tree,s.overlay[0].from+e.from,-1,e);(i||(i=[n])).push(bD(o,t,r,!1))}}return i?bz(i):n}(this,e,t)}iterate(e){let{enter:t,leave:r,from:n=0,to:i=this.length}=e,s=e.mode||0,o=(s&m.IncludeAnonymous)>0;for(let e=this.cursor(s|m.IncludeAnonymous);;){let s=!1;if(e.from<=i&&e.to>=n&&(!o&&e.type.isAnonymous||!1!==t(e))){if(e.firstChild())continue;s=!0}for(;s&&r&&(o||!e.type.isAnonymous)&&r(e),!e.nextSibling();){if(!e.parent())return;s=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:bK(bE.none,this.children,this.positions,0,this.children.length,0,this.length,(e,t,r)=>new bM(this.type,e,t,r,this.propValues),e.makeTree||((e,t,r)=>new bM(bE.none,e,t,r)))}static build(e){return function(e){var t;let{buffer:r,nodeSet:n,maxBufferLength:i=1024,reused:s=[],minRepeatType:o=n.types.length}=e,l=Array.isArray(r)?new bT(r,r.length):r,a=n.types,c=0,h=0;function u(e,t,r,i,s,o,l,a,c){let h=[],u=[];for(;e.length>i;)h.push(e.pop()),u.push(t.pop()+r-s);e.push(d(n.types[l],h,u,o-s,a-o,c)),t.push(s-r)}function d(e,t,r,n,i,s,o){if(s){let e=[bA.contextHash,s];o=o?[e].concat(o):[e]}if(i>25){let e=[bA.lookAhead,i];o=o?[e].concat(o):[e]}return new bM(e,t,r,n,o)}let f=[],p=[];for(;l.pos>0;)!function e(t,r,f,p,m,g){let{id:y,start:v,end:x,size:b}=l,w=h,k=c;if(b<0){if(l.next(),-1==b){let e=s[y];f.push(e),p.push(v-t);return}if(-3==b){c=y;return}if(-4==b){h=y;return}else throw RangeError(`Unrecognized record size: ${b}`)}let A=a[y],S,C,E=v-t;if(x-v<=i&&(C=function(e,t){let r=l.fork(),n=0,s=0,a=0,c=r.end-i,h={size:0,start:0,skip:0};r:for(let i=r.pos-e;r.pos>i;){let e=r.size;if(r.id==t&&e>=0){h.size=n,h.start=s,h.skip=a,a+=4,n+=4,r.next();continue}let l=r.pos-e;if(e<0||l<i||r.start<c)break;let u=4*(r.id>=o),d=r.start;for(r.next();r.pos>l;){if(r.size<0)if(-3==r.size)u+=4;else break r;else r.id>=o&&(u+=4);r.next()}s=d,n+=e,a+=u}return(t<0||n==e)&&(h.size=n,h.start=s,h.skip=a),h.size>4?h:void 0}(l.pos-r,m))){let e=new Uint16Array(C.size-C.skip),r=l.pos-C.size,i=e.length;for(;l.pos>r;)i=function e(t,r,n){let{id:i,start:s,end:a,size:u}=l;if(l.next(),u>=0&&i<o){let o=n;if(u>4){let i=l.pos-(u-4);for(;l.pos>i;)n=e(t,r,n)}r[--n]=o,r[--n]=a-t,r[--n]=s-t,r[--n]=i}else -3==u?c=i:-4==u&&(h=i);return n}(C.start,e,i);S=new bI(e,x-C.start,n),E=C.start-t}else{let t=l.pos-b;l.next();let r=[],s=[],a=y>=o?y:-1,c=0,h=x;for(;l.pos>t;)a>=0&&l.id==a&&l.size>=0?(l.end<=h-i&&(u(r,s,v,c,l.end,h,a,w,k),c=r.length,h=l.end),l.next()):g>2500?function(e,t,r,s){let o=[],a=0,c=-1;for(;l.pos>t;){let{id:e,start:t,end:r,size:n}=l;if(n>4)l.next();else if(c>-1&&t<c)break;else c<0&&(c=r-i),o.push(e,t,r),a++,l.next()}if(a){let t=new Uint16Array(4*a),i=o[o.length-2];for(let e=o.length-3,r=0;e>=0;e-=3)t[r++]=o[e],t[r++]=o[e+1]-i,t[r++]=o[e+2]-i,t[r++]=r;r.push(new bI(t,o[2]-i,n)),s.push(i-e)}}(v,t,r,s):e(v,t,r,s,a,g+1);if(a>=0&&c>0&&c<r.length&&u(r,s,v,c,v,h,a,w,k),r.reverse(),s.reverse(),a>-1&&c>0){let e=function(e,t){return(r,n,i)=>{let s=0,o=r.length-1,l,a;if(o>=0&&(l=r[o])instanceof bM){if(!o&&l.type==e&&l.length==i)return l;(a=l.prop(bA.lookAhead))&&(s=n[o]+l.length+a)}return d(e,r,n,i,s,t)}}(A,k);S=bK(A,r,s,0,r.length,0,x-v,e,e)}else S=d(A,r,s,x-v,w-x,k)}f.push(S),p.push(E)}(e.start||0,e.bufferStart||0,f,p,-1,0);let m=null!=(t=e.length)?t:f.length?p[0]+f[0].length:0;return new bM(a[e.topID],f.reverse(),p.reverse(),m)}(e)}}bM.empty=new bM(bE.none,[],[],0);class bT{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new bT(this.buffer,this.index)}}class bI{constructor(e,t,r){this.buffer=e,this.length=t,this.set=r}get type(){return bE.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],r=this.buffer[e+3],n=this.set.types[t],i=n.name;if(/\W/.test(i)&&!n.isError&&(i=JSON.stringify(i)),r==(e+=4))return i;let s=[];for(;e<r;)s.push(this.childString(e)),e=this.buffer[e+3];return i+"("+s.join(",")+")"}findChild(e,t,r,n,i){let{buffer:s}=this,o=-1;for(let l=e;l!=t&&(!b$(i,n,s[l+1],s[l+2])||(o=l,!(r>0)));l=s[l+3]);return o}slice(e,t,r){let n=this.buffer,i=new Uint16Array(t-e),s=0;for(let o=e,l=0;o<t;){i[l++]=n[o++],i[l++]=n[o++]-r;let t=i[l++]=n[o++]-r;i[l++]=n[o++]-e,s=Math.max(s,t)}return new bI(i,s,this.set)}}function b$(e,t,r,n){switch(e){case -2:return r<t;case -1:return n>=t&&r<t;case 0:return r<t&&n>t;case 1:return r<=t&&n>t;case 2:return n>t;case 4:return!0}}function bD(e,t,r,n){for(var i;e.from==e.to||(r<1?e.from>=t:e.from>t)||(r>-1?e.to<=t:e.to<t);){let t=!n&&e instanceof bN&&e.index<0?null:e.parent;if(!t)return e;e=t}let s=n?0:m.IgnoreOverlays;if(n)for(let n=e,o=n.parent;o;o=(n=o).parent)n instanceof bN&&n.index<0&&(null==(i=o.enter(t,r,s))?void 0:i.from)!=n.from&&(e=o);for(;;){let n=e.enter(t,r,s);if(!n)return e;e=n}}class bR{cursor(e=0){return new bV(this,e)}getChild(e,t=null,r=null){let n=bL(this,e,t,r);return n.length?n[0]:null}getChildren(e,t=null,r=null){return bL(this,e,t,r)}resolve(e,t=0){return bD(this,e,t,!1)}resolveInner(e,t=0){return bD(this,e,t,!0)}matchContext(e){return bF(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),r=this;for(;t;){let e=t.lastChild;if(!e||e.to!=t.to)break;e.type.isError&&e.from==e.to?(r=t,t=e.prevSibling):t=e}return r}get node(){return this}get next(){return this.parent}}class bN extends bR{constructor(e,t,r,n){super(),this._tree=e,this.from=t,this.index=r,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,r,n,i=0){for(let s=this;;){for(let{children:o,positions:l}=s._tree,a=t>0?o.length:-1;e!=a;e+=t){let a=o[e],c=l[e]+s.from;if(b$(n,r,c,c+a.length)){if(a instanceof bI){if(i&m.ExcludeBuffers)continue;let o=a.findChild(0,a.buffer.length,t,r-c,n);if(o>-1)return new bB(new b_(s,a,e,c),null,o)}else if(i&m.IncludeAnonymous||!a.type.isAnonymous||bH(a)){let o;if(!(i&m.IgnoreMounts)&&(o=bS.get(a))&&!o.overlay)return new bN(o.tree,c,e,s);let l=new bN(a,c,e,s);return i&m.IncludeAnonymous||!l.type.isAnonymous?l:l.nextChild(t<0?a.children.length-1:0,t,r,n)}}}if(i&m.IncludeAnonymous||!s.type.isAnonymous||(e=s.index>=0?s.index+t:t<0?-1:s._parent._tree.children.length,!(s=s._parent)))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,r=0){let n;if(!(r&m.IgnoreOverlays)&&(n=bS.get(this._tree))&&n.overlay){let r=e-this.from;for(let{from:e,to:i}of n.overlay)if((t>0?e<=r:e<r)&&(t<0?i>=r:i>r))return new bN(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,r)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function bL(e,t,r,n){let i=e.cursor(),s=[];if(!i.firstChild())return s;if(null!=r){for(let e=!1;!e;)if(e=i.type.is(r),!i.nextSibling())return s}for(;;){if(null!=n&&i.type.is(n))return s;if(i.type.is(t)&&s.push(i.node),!i.nextSibling())return null==n?s:[]}}function bF(e,t,r=t.length-1){for(let n=e;r>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(t[r]&&t[r]!=n.name)return!1;r--}}return!0}class b_{constructor(e,t,r,n){this.parent=e,this.buffer=t,this.index=r,this.start=n}}class bB extends bR{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,r){super(),this.context=e,this._parent=t,this.index=r,this.type=e.buffer.set.types[e.buffer.buffer[r]]}child(e,t,r){let{buffer:n}=this.context,i=n.findChild(this.index+4,n.buffer[this.index+3],e,t-this.context.start,r);return i<0?null:new bB(this.context,this,i)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,r=0){if(r&m.ExcludeBuffers)return null;let{buffer:n}=this.context,i=n.findChild(this.index+4,n.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return i<0?null:new bB(this.context,this,i)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new bB(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new bB(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:r}=this.context,n=this.index+4,i=r.buffer[this.index+3];if(i>n){let s=r.buffer[this.index+1];e.push(r.slice(n,i,s)),t.push(0)}return new bM(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function bz(e){if(!e.length)return null;let t=0,r=e[0];for(let n=1;n<e.length;n++){let i=e[n];(i.from>r.from||i.to<r.to)&&(r=i,t=n)}let n=r instanceof bN&&r.index<0?null:r.parent,i=e.slice();return n?i[t]=n:i.splice(t,1),new bW(i,r)}class bW{constructor(e,t){this.heads=e,this.node=t}get next(){return bz(this.heads)}}class bV{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof bN)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let t=e._parent;t;t=t._parent)this.stack.unshift(t.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return!!e&&(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0)}yieldBuf(e,t){this.index=e;let{start:r,buffer:n}=this.buffer;return this.type=t||n.set.types[n.buffer[e]],this.from=r+n.buffer[e+1],this.to=r+n.buffer[e+2],!0}yield(e){return!!e&&(e instanceof bN?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,r){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,r,this.mode));let{buffer:n}=this.buffer,i=n.findChild(this.index+4,n.buffer[this.index+3],e,t-this.buffer.start,r);return!(i<0)&&(this.stack.push(this.index),this.yieldBuf(i))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,r=this.mode){return this.buffer?!(r&m.ExcludeBuffers)&&this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,r))}parent(){if(!this.buffer)return this.yieldNode(this.mode&m.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&m.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode));let{buffer:t}=this.buffer,r=this.stack.length-1;if(e<0){let e=r<0?0:this.stack[r]+4;if(this.index!=e)return this.yieldBuf(t.findChild(e,this.index,-1,0,4))}else{let e=t.buffer[this.index+3];if(e<(r<0?t.buffer.length:t.buffer[this.stack[r]+3]))return this.yieldBuf(e)}return r<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,r,{buffer:n}=this;if(n){if(e>0){if(this.index<n.buffer.buffer.length)return!1}else for(let e=0;e<this.index;e++)if(n.buffer.buffer[e+3]<this.index)return!1;({index:t,parent:r}=n)}else({index:t,_parent:r}=this._tree);for(;r;{index:t,_parent:r}=r)if(t>-1)for(let n=t+e,i=e<0?-1:r._tree.children.length;n!=i;n+=e){let e=r._tree.children[n];if(this.mode&m.IncludeAnonymous||e instanceof bI||!e.type.isAnonymous||bH(e))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,r=0;if(e&&e.context==this.buffer)r:for(let n=this.index,i=this.stack.length;i>=0;){for(let s=e;s;s=s._parent)if(s.index==n){if(n==this.index)return s;t=s,r=i+1;break r}n=this.stack[--i]}for(let e=r;e<this.stack.length;e++)t=new bB(this.buffer,t,this.stack[e]);return this.bufferNode=new bB(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let r=0;;){let n=!1;if(this.type.isAnonymous||!1!==e(this)){if(this.firstChild()){r++;continue}this.type.isAnonymous||(n=!0)}for(;;){if(n&&t&&t(this),n=this.type.isAnonymous,!r)return;if(this.nextSibling())break;this.parent(),r--,n=!0}}}matchContext(e){if(!this.buffer)return bF(this.node.parent,e);let{buffer:t}=this.buffer,{types:r}=t.set;for(let n=e.length-1,i=this.stack.length-1;n>=0;i--){if(i<0)return bF(this._tree,e,n);let s=r[t.buffer[this.stack[i]]];if(!s.isAnonymous){if(e[n]&&e[n]!=s.name)return!1;n--}}return!0}}function bH(e){return e.children.some(e=>e instanceof bI||!e.type.isAnonymous||bH(e))}let bU=new WeakMap;function bq(e,t){if(!e.isAnonymous||t instanceof bI||t.type!=e)return 1;let r=bU.get(t);if(null==r){for(let n of(r=1,t.children)){if(n.type!=e||!(n instanceof bM)){r=1;break}r+=bq(e,n)}bU.set(t,r)}return r}function bK(e,t,r,n,i,s,o,l,a){let c=0;for(let r=n;r<i;r++)c+=bq(e,t[r]);let h=Math.ceil(1.5*c/8),u=[],d=[];return!function t(r,n,i,o,l){for(let c=i;c<o;){let i=c,f=n[c],p=bq(e,r[c]);for(c++;c<o;c++){let t=bq(e,r[c]);if(p+t>=h)break;p+=t}if(c==i+1){if(p>h){let e=r[i];t(e.children,e.positions,0,e.children.length,n[i]+l);continue}u.push(r[i])}else{let t=n[c-1]+r[c-1].length-f;u.push(bK(e,r,n,i,c,f,t,null,a))}d.push(f+l-s)}}(t,r,n,i,0),(l||a)(u,d,o)}class bG{constructor(e,t,r,n,i=!1,s=!1){this.from=e,this.to=t,this.tree=r,this.offset=n,this.open=!!i|2*!!s}get openStart(){return(1&this.open)>0}get openEnd(){return(2&this.open)>0}static addTree(e,t=[],r=!1){let n=[new bG(0,e.length,e,0,!1,r)];for(let r of t)r.to>e.length&&n.push(r);return n}static applyChanges(e,t,r=128){if(!t.length)return e;let n=[],i=1,s=e.length?e[0]:null;for(let o=0,l=0,a=0;;o++){let c=o<t.length?t[o]:null,h=c?c.fromA:1e9;if(h-l>=r)for(;s&&s.from<h;){let t=s;if(l>=t.from||h<=t.to||a){let e=Math.max(t.from,l)-a,r=Math.min(t.to,h)-a;t=e>=r?null:new bG(e,r,t.tree,t.offset+a,o>0,!!c)}if(t&&n.push(t),s.to>h)break;s=i<e.length?e[i++]:null}if(!c)break;l=c.toA,a=c.toA-c.toB}return n}}class bJ{startParse(e,t,r){return"string"==typeof e&&(e=new bY(e)),r=r?r.length?r.map(e=>new bk(e.from,e.to)):[new bk(0,0)]:[new bk(0,e.length)],this.createParse(e,t||[],r)}parse(e,t,r){let n=this.startParse(e,t,r);for(;;){let e=n.advance();if(e)return e}}}class bY{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}new bA({perNode:!0});let bX=0;class bZ{constructor(e,t,r,n){this.name=e,this.set=t,this.base=r,this.modified=n,this.id=bX++}toString(){let{name:e}=this;for(let t of this.modified)t.name&&(e=`${t.name}(${e})`);return e}static define(e,t){if(e instanceof bZ&&(t=e),null==t?void 0:t.base)throw Error("Can not derive from a modified tag");let r=new bZ("string"==typeof e?e:"?",[],null,[]);if(r.set.push(r),t)for(let e of t.set)r.set.push(e);return r}static defineModifier(e){let t=new b0(e);return e=>e.modified.indexOf(t)>-1?e:b0.get(e.base||e,e.modified.concat(t).sort((e,t)=>e.id-t.id))}}let bQ=0;class b0{constructor(e){this.name=e,this.instances=[],this.id=bQ++}static get(e,t){if(!t.length)return e;let r=t[0].instances.find(r=>{var n,i;return r.base==e&&(n=t,i=r.modified,n.length==i.length&&n.every((e,t)=>e==i[t]))});if(r)return r;let n=[],i=new bZ(e.name,n,e,t);for(let e of t)e.instances.push(i);let s=function(e){let t=[[]];for(let r=0;r<e.length;r++)for(let n=0,i=t.length;n<i;n++)t.push(t[n].concat(e[r]));return t.sort((e,t)=>t.length-e.length)}(t);for(let t of e.set)if(!t.modified.length)for(let e of s)n.push(b0.get(t,e));return i}}let b1=new bA({combine(e,t){let r,n,i;for(;e||t;){if(!e||t&&e.depth>=t.depth?(i=t,t=t.next):(i=e,e=e.next),r&&r.mode==i.mode&&!i.context&&!r.context)continue;let s=new b2(i.tags,i.mode,i.context);r?r.next=s:n=s,r=s}return n}});class b2{constructor(e,t,r,n){this.tags=e,this.mode=t,this.context=r,this.next=n}get opaque(){return 0==this.mode}get inherit(){return 1==this.mode}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}function b4(e,t){let r=Object.create(null);for(let t of e)if(Array.isArray(t.tag))for(let e of t.tag)r[e.id]=t.class;else r[t.tag.id]=t.class;let{scope:n,all:i=null}=t||{};return{style:e=>{let t=i;for(let n of e)for(let e of n.set){let n=r[e.id];if(n){t=t?t+" "+n:n;break}}return t},scope:n}}b2.empty=new b2([],2,null);class b3{constructor(e,t,r){this.at=e,this.highlighters=t,this.span=r,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,r,n,i){let{type:s,from:o,to:l}=e;if(o>=r||l<=t)return;s.isTop&&(i=this.highlighters.filter(e=>!e.scope||e.scope(s)));let a=n,c=function(e){let t=e.type.prop(b1);for(;t&&t.context&&!e.matchContext(t.context);)t=t.next;return t||null}(e)||b2.empty,h=function(e,t){let r=null;for(let n of e){let e=n.style(t);e&&(r=r?r+" "+e:e)}return r}(i,c.tags);if(h&&(a&&(a+=" "),a+=h,1==c.mode&&(n+=(n?" ":"")+h)),this.startSpan(Math.max(t,o),a),c.opaque)return;let u=e.tree&&e.tree.prop(bA.mounted);if(u&&u.overlay){let s=e.node.enter(u.overlay[0].from+o,1),c=this.highlighters.filter(e=>!e.scope||e.scope(u.tree.type)),h=e.firstChild();for(let d=0,f=o;;d++){let p=d<u.overlay.length?u.overlay[d]:null,m=p?p.from+o:l,g=Math.max(t,f),y=Math.min(r,m);if(g<y&&h)for(;e.from<y&&(this.highlightRange(e,g,y,n,i),this.startSpan(Math.min(y,e.to),a),!(e.to>=m)&&e.nextSibling()););if(!p||m>r)break;(f=p.to+o)>t&&(this.highlightRange(s.cursor(),Math.max(t,p.from+o),Math.min(r,f),"",c),this.startSpan(Math.min(r,f),a))}h&&e.parent()}else if(e.firstChild()){u&&(n="");do{if(e.to<=t)continue;if(e.from>=r)break;this.highlightRange(e,t,r,n,i),this.startSpan(Math.min(r,e.to),a)}while(e.nextSibling());e.parent()}}}let b5=bZ.define,b6=b5(),b9=b5(),b8=b5(b9),b7=b5(b9),we=b5(),wt=b5(we),wr=b5(we),wn=b5(),wi=b5(wn),ws=b5(),wo=b5(),wl=b5(),wa=b5(wl),wc=b5(),wh={comment:b6,lineComment:b5(b6),blockComment:b5(b6),docComment:b5(b6),name:b9,variableName:b5(b9),typeName:b8,tagName:b5(b8),propertyName:b7,attributeName:b5(b7),className:b5(b9),labelName:b5(b9),namespace:b5(b9),macroName:b5(b9),literal:we,string:wt,docString:b5(wt),character:b5(wt),attributeValue:b5(wt),number:wr,integer:b5(wr),float:b5(wr),bool:b5(we),regexp:b5(we),escape:b5(we),color:b5(we),url:b5(we),keyword:ws,self:b5(ws),null:b5(ws),atom:b5(ws),unit:b5(ws),modifier:b5(ws),operatorKeyword:b5(ws),controlKeyword:b5(ws),definitionKeyword:b5(ws),moduleKeyword:b5(ws),operator:wo,derefOperator:b5(wo),arithmeticOperator:b5(wo),logicOperator:b5(wo),bitwiseOperator:b5(wo),compareOperator:b5(wo),updateOperator:b5(wo),definitionOperator:b5(wo),typeOperator:b5(wo),controlOperator:b5(wo),punctuation:wl,separator:b5(wl),bracket:wa,angleBracket:b5(wa),squareBracket:b5(wa),paren:b5(wa),brace:b5(wa),content:wn,heading:wi,heading1:b5(wi),heading2:b5(wi),heading3:b5(wi),heading4:b5(wi),heading5:b5(wi),heading6:b5(wi),contentSeparator:b5(wn),list:b5(wn),quote:b5(wn),emphasis:b5(wn),strong:b5(wn),link:b5(wn),monospace:b5(wn),strikethrough:b5(wn),inserted:b5(),deleted:b5(),changed:b5(),invalid:b5(),meta:wc,documentMeta:b5(wc),annotation:b5(wc),processingInstruction:b5(wc),definition:bZ.defineModifier("definition"),constant:bZ.defineModifier("constant"),function:bZ.defineModifier("function"),standard:bZ.defineModifier("standard"),local:bZ.defineModifier("local"),special:bZ.defineModifier("special")};for(let e in wh){let t=wh[e];t instanceof bZ&&(t.name=e)}b4([{tag:wh.link,class:"tok-link"},{tag:wh.heading,class:"tok-heading"},{tag:wh.emphasis,class:"tok-emphasis"},{tag:wh.strong,class:"tok-strong"},{tag:wh.keyword,class:"tok-keyword"},{tag:wh.atom,class:"tok-atom"},{tag:wh.bool,class:"tok-bool"},{tag:wh.url,class:"tok-url"},{tag:wh.labelName,class:"tok-labelName"},{tag:wh.inserted,class:"tok-inserted"},{tag:wh.deleted,class:"tok-deleted"},{tag:wh.literal,class:"tok-literal"},{tag:wh.string,class:"tok-string"},{tag:wh.number,class:"tok-number"},{tag:[wh.regexp,wh.escape,wh.special(wh.string)],class:"tok-string2"},{tag:wh.variableName,class:"tok-variableName"},{tag:wh.local(wh.variableName),class:"tok-variableName tok-local"},{tag:wh.definition(wh.variableName),class:"tok-variableName tok-definition"},{tag:wh.special(wh.variableName),class:"tok-variableName2"},{tag:wh.definition(wh.propertyName),class:"tok-propertyName tok-definition"},{tag:wh.typeName,class:"tok-typeName"},{tag:wh.namespace,class:"tok-namespace"},{tag:wh.className,class:"tok-className"},{tag:wh.macroName,class:"tok-macroName"},{tag:wh.propertyName,class:"tok-propertyName"},{tag:wh.operator,class:"tok-operator"},{tag:wh.comment,class:"tok-comment"},{tag:wh.meta,class:"tok-meta"},{tag:wh.invalid,class:"tok-invalid"},{tag:wh.punctuation,class:"tok-punctuation"}]);let wu=new bA,wd=new bA;class wf{constructor(e,t,r=[],n=""){this.data=e,this.name=n,mC.prototype.hasOwnProperty("tree")||Object.defineProperty(mC.prototype,"tree",{get(){return wm(this)}}),this.parser=t,this.extension=[wS.of(this),mC.languageData.of((e,t,r)=>{let n=wp(e,t,r),i=n.type.prop(wu);if(!i)return[];let s=e.facet(i),o=n.type.prop(wd);if(o){let i=n.resolve(t-n.from,r);for(let t of o)if(t.test(i,e)){let r=e.facet(t.facet);return"replace"==t.type?r:r.concat(s)}}return s})].concat(r)}isActiveAt(e,t,r=-1){return wp(e,t,r).type.prop(wu)==this.data}findRegions(e){let t=e.facet(wS);if((null==t?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let r=[],n=(e,t)=>{if(e.prop(wu)==this.data)return void r.push({from:t,to:t+e.length});let i=e.prop(bA.mounted);if(i){if(i.tree.prop(wu)==this.data){if(i.overlay)for(let e of i.overlay)r.push({from:e.from+t,to:e.to+t});else r.push({from:t,to:t+e.length});return}else if(i.overlay){let e=r.length;if(n(i.tree,i.overlay[0].from+t),r.length>e)return}}for(let r=0;r<e.children.length;r++){let i=e.children[r];i instanceof bM&&n(i,e.positions[r]+t)}};return n(wm(e),0),r}get allowsNesting(){return!0}}function wp(e,t,r){let n=e.facet(wS),i=wm(e).topNode;if(!n||n.allowsNesting)for(let e=i;e;e=e.enter(t,r,m.ExcludeBuffers))e.type.isTop&&(i=e);return i}function wm(e){let t=e.field(wf.state,!1);return t?t.tree:bM.empty}wf.setState=my.define();class wg{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let r=this.cursorPos-this.string.length;return e<r||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-r,t-r)}}let wy=null;class wv{constructor(e,t,r=[],n,i,s,o,l){this.parser=e,this.state=t,this.fragments=r,this.tree=n,this.treeLen=i,this.viewport=s,this.skipped=o,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,t,r){return new wv(e,t,[],bM.empty,0,r,[],null)}startParse(){return this.parser.startParse(new wg(this.state.doc),this.fragments)}work(e,t){return(null!=t&&t>=this.state.doc.length&&(t=void 0),this.tree!=bM.empty&&this.isDone(null!=t?t:this.state.doc.length))?(this.takeTree(),!0):this.withContext(()=>{var r;if("number"==typeof e){let t=Date.now()+e;e=()=>Date.now()>t}for(this.parse||(this.parse=this.startParse()),null!=t&&(null==this.parse.stoppedAt||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let n=this.parse.advance();if(n){if(this.fragments=this.withoutTempSkipped(bG.addTree(n,this.fragments,null!=this.parse.stoppedAt)),this.treeLen=null!=(r=this.parse.stoppedAt)?r:this.state.doc.length,this.tree=n,this.parse=null,!(this.treeLen<(null!=t?t:this.state.doc.length)))return!0;this.parse=this.startParse()}if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((null==this.parse.stoppedAt||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(bG.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=wy;wy=this;try{return e()}finally{wy=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=wx(e,t.from,t.to);return e}changes(e,t){let{fragments:r,tree:n,treeLen:i,viewport:s,skipped:o}=this;if(this.takeTree(),!e.empty){let t=[];if(e.iterChangedRanges((e,r,n,i)=>t.push({fromA:e,toA:r,fromB:n,toB:i})),r=bG.applyChanges(r,t),n=bM.empty,i=0,s={from:e.mapPos(s.from,-1),to:e.mapPos(s.to,1)},this.skipped.length)for(let t of(o=[],this.skipped)){let r=e.mapPos(t.from,1),n=e.mapPos(t.to,-1);r<n&&o.push({from:r,to:n})}}return new wv(this.parser,t,r,n,i,s,o,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let t=0;t<this.skipped.length;t++){let{from:r,to:n}=this.skipped[t];r<e.to&&n>e.from&&(this.fragments=wx(this.fragments,r,n),this.skipped.splice(t--,1))}return!(this.skipped.length>=t)&&(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends bJ{createParse(t,r,n){let i=n[0].from,s=n[n.length-1].to;return{parsedPos:i,advance(){let t=wy;if(t){for(let e of n)t.tempSkipped.push(e);e&&(t.scheduleOn=t.scheduleOn?Promise.all([t.scheduleOn,e]):e)}return this.parsedPos=s,new bM(bE.none,[],[],s-i)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&0==t[0].from&&t[0].to>=e}static get(){return wy}}function wx(e,t,r){return bG.applyChanges(e,[{fromA:t,toA:r,fromB:t,toB:r}])}class wb{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),r=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,r)||t.takeTree(),new wb(t)}static init(e){let t=Math.min(3e3,e.doc.length),r=wv.create(e.facet(wS).parser,e,{from:0,to:t});return r.work(20,t)||r.takeTree(),new wb(r)}}wf.state=p8.define({create:wb.init,update(e,t){for(let e of t.effects)if(e.is(wf.setState))return e.value;return t.startState.facet(wS)!=t.state.facet(wS)?wb.init(t.state):e.apply(t)}});let ww=e=>{let t=setTimeout(()=>e(),500);return()=>clearTimeout(t)};"undefined"!=typeof requestIdleCallback&&(ww=e=>{let t=-1,r=setTimeout(()=>{t=requestIdleCallback(e,{timeout:400})},100);return()=>t<0?clearTimeout(r):cancelIdleCallback(t)});let wk="undefined"!=typeof navigator&&(null==(g=navigator.scheduling)?void 0:g.isInputPending)?()=>navigator.scheduling.isInputPending():null,wA=yC.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(wf.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(wf.state);t.tree==t.context.tree&&t.context.isDone(e.doc.length)||(this.working=ww(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:r,viewport:{to:n}}=this.view,i=r.field(wf.state);if(i.tree==i.context.tree&&i.context.isDone(n+1e5))return;let s=Date.now()+Math.min(this.chunkBudget,100,e&&!wk?Math.max(25,e.timeRemaining()-5):1e9),o=i.context.treeLen<n&&r.doc.length>n+1e3,l=i.context.work(()=>wk&&wk()||Date.now()>s,n+1e5*!o);this.chunkBudget-=Date.now()-t,(l||this.chunkBudget<=0)&&(i.context.takeTree(),this.view.dispatch({effects:wf.setState.of(new wb(i.context))})),this.chunkBudget>0&&!(l&&!o)&&this.scheduleWork(),this.checkAsyncSchedule(i.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(e=>yw(this.view.state,e)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),wS=p2.define({combine:e=>e.length?e[0]:null,enables:e=>[wf.state,wA,v6.contentAttributes.compute([e],t=>{let r=t.facet(e);return r&&r.name?{"data-language":r.name}:{}})]}),wC=p2.define(),wE=p2.define({combine:e=>{if(!e.length)return"  ";let t=e[0];if(!t||/\S/.test(t)||Array.from(t).some(e=>e!=t[0]))throw Error("Invalid indent unit: "+JSON.stringify(e[0]));return t}});function wj(e){let t=e.facet(wE);return 9==t.charCodeAt(0)?e.tabSize*t.length:t.length}function wO(e,t){let r="",n=e.tabSize,i=e.facet(wE)[0];if("	"==i){for(;t>=n;)r+="	",t-=n;i=" "}for(let e=0;e<t;e++)r+=i;return r}function wP(e,t){for(let r of(e instanceof mC&&(e=new wM(e)),e.state.facet(wC))){let n=r(e,t);if(void 0!==n)return n}let r=wm(e.state);return r.length>=t?function(e,t,r){let n=t.resolveStack(r),i=t.resolveInner(r,-1).resolve(r,0).enterUnfinishedNodesBefore(r);if(i!=n.node){let e=[];for(let t=i;t&&!(t.from<n.node.from||t.to>n.node.to||t.from==n.node.from&&t.type==n.node.type);t=t.parent)e.push(t);for(let t=e.length-1;t>=0;t--)n={node:e[t],next:n}}return wI(n,e,r)}(e,r,t):null}class wM{constructor(e,t={}){this.state=e,this.options=t,this.unit=wj(e)}lineAt(e,t=1){let r=this.state.doc.lineAt(e),{simulateBreak:n,simulateDoubleBreak:i}=this.options;if(null!=n&&n>=r.from&&n<=r.to)if(i&&n==e)return{text:"",from:e};else if(t<0?n<e:n<=e)return{text:r.text.slice(n-r.from),from:n};else return{text:r.text.slice(0,n-r.from),from:r.from};return r}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:r,from:n}=this.lineAt(e,t);return r.slice(e-n,Math.min(r.length,e+100-n))}column(e,t=1){let{text:r,from:n}=this.lineAt(e,t),i=this.countColumn(r,e-n),s=this.options.overrideIndentation?this.options.overrideIndentation(n):-1;return s>-1&&(i+=s-this.countColumn(r,r.search(/\S|$/))),i}countColumn(e,t=e.length){return mV(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:r,from:n}=this.lineAt(e,t),i=this.options.overrideIndentation;if(i){let e=i(n);if(e>-1)return e}return this.countColumn(r,r.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}let wT=new bA;function wI(e,t,r){for(let n=e;n;n=n.next){let e=function(e){let t=e.type.prop(wT);if(t)return t;let r=e.firstChild,n;if(r&&(n=r.type.prop(bA.closedBy))){let t=e.lastChild,r=t&&n.indexOf(t.name)>-1;return e=>(function(e,t,r,n,i){let s=e.textAfter,o=s.match(/^\s*/)[0].length,l=n&&s.slice(o,o+n.length)==n||i==e.pos+o,a=t?function(e){let t=e.node,r=t.childAfter(t.from),n=t.lastChild;if(!r)return null;let i=e.options.simulateBreak,s=e.state.doc.lineAt(r.from),o=null==i||i<=s.from?s.to:Math.min(s.to,i);for(let e=r.to;;){let i=t.childAfter(e);if(!i||i==n)return null;if(!i.type.isSkipped){if(i.from>=o)return null;let e=/^ */.exec(s.text.slice(r.to-s.from))[0].length;return{from:r.from,to:r.to+e}}e=i.to}}(e):null;return a?l?e.column(a.from):e.column(a.to):e.baseIndent+(l?0:+e.unit)})(e,!0,1,void 0,r&&!(e.pos==e.options.simulateBreak&&e.options.simulateDoubleBreak)?t.from:void 0)}return null==e.parent?w$:null}(n.node);if(e)return e(wD.create(t,r,n))}return 0}function w$(){return 0}class wD extends wM{constructor(e,t,r){super(e.state,e.options),this.base=e,this.pos=t,this.context=r}get node(){return this.context.node}static create(e,t,r){return new wD(e,t,r)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let r=e.resolve(t.from);for(;r.parent&&r.parent.from==r.from;)r=r.parent;if(function(e,t){for(let r=t;r;r=r.parent)if(e==r)return!0;return!1}(r,e))break;t=this.state.doc.lineAt(r.from)}return this.lineIndent(t.from)}continue(){return wI(this.context.next,this.base,this.pos)}}let wR=p2.define(),wN=new bA;function wL(e,t,r){for(let n of e.facet(wR)){let i=n(e,t,r);if(i)return i}return function(e,t,r){let n=wm(e);if(n.length<r)return null;let i=n.resolveStack(r,1),s=null;for(let o=i;o;o=o.next){let i=o.node;if(i.to<=r||i.from>r)continue;if(s&&i.from<t)break;let l=i.type.prop(wN);if(l&&(i.to<n.length-50||n.length==e.doc.length||!function(e){let t=e.lastChild;return t&&t.to==e.to&&t.type.isError}(i))){let n=l(i,e);n&&n.from<=r&&n.from>=t&&n.to>r&&(s=n)}}return s}(e,t,r)}function wF(e,t){let r=t.mapPos(e.from,1),n=t.mapPos(e.to,-1);return r>=n?void 0:{from:r,to:n}}let w_=my.define({map:wF}),wB=my.define({map:wF});function wz(e){let t=[];for(let{head:r}of e.state.selection.ranges)t.some(e=>e.from<=r&&e.to>=r)||t.push(e.lineBlockAt(r));return t}let wW=p8.define({create:()=>gH.none,update(e,t){for(let r of(t.isUserEvent("delete")&&t.changes.iterChangedRanges((t,r)=>e=wV(e,t,r)),e=e.map(t.changes),t.effects))if(r.is(w_)&&!function(e,t,r){let n=!1;return e.between(t,t,(e,i)=>{e==t&&i==r&&(n=!0)}),n}(e,r.value.from,r.value.to)){let{preparePlaceholder:n}=t.state.facet(wJ),i=n?gH.replace({widget:new wQ(n(t.state,r.value))}):wZ;e=e.update({add:[i.range(r.value.from,r.value.to)]})}else r.is(wB)&&(e=e.update({filter:(e,t)=>r.value.from!=e||r.value.to!=t,filterFrom:r.value.from,filterTo:r.value.to}));return t.selection&&(e=wV(e,t.selection.main.head)),e},provide:e=>v6.decorations.from(e),toJSON(e,t){let r=[];return e.between(0,t.doc.length,(e,t)=>{r.push(e,t)}),r},fromJSON(e){if(!Array.isArray(e)||e.length%2)throw RangeError("Invalid JSON for fold state");let t=[];for(let r=0;r<e.length;){let n=e[r++],i=e[r++];if("number"!=typeof n||"number"!=typeof i)throw RangeError("Invalid JSON for fold state");t.push(wZ.range(n,i))}return gH.set(t,!0)}});function wV(e,t,r=t){let n=!1;return e.between(t,r,(e,i)=>{e<r&&i>t&&(n=!0)}),n?e.update({filterFrom:t,filterTo:r,filter:(e,n)=>e>=r||n<=t}):e}function wH(e,t,r){var n;let i=null;return null==(n=e.field(wW,!1))||n.between(t,r,(e,t)=>{(!i||i.from>e)&&(i={from:e,to:t})}),i}function wU(e,t){return e.field(wW,!1)?t:t.concat(my.appendConfig.of(wY()))}function wq(e,t,r=!0){let n=e.state.doc.lineAt(t.from).number,i=e.state.doc.lineAt(t.to).number;return v6.announce.of(`${e.state.phrase(r?"Folded lines":"Unfolded lines")} ${n} ${e.state.phrase("to")} ${i}.`)}let wK=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:e=>{for(let t of wz(e)){let r=wL(e.state,t.from,t.to);if(r)return e.dispatch({effects:wU(e.state,[w_.of(r),wq(e,r)])}),!0}return!1}},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:e=>{if(!e.state.field(wW,!1))return!1;let t=[];for(let r of wz(e)){let n=wH(e.state,r.from,r.to);n&&t.push(wB.of(n),wq(e,n,!1))}return t.length&&e.dispatch({effects:t}),t.length>0}},{key:"Ctrl-Alt-[",run:e=>{let{state:t}=e,r=[];for(let n=0;n<t.doc.length;){let i=e.lineBlockAt(n),s=wL(t,i.from,i.to);s&&r.push(w_.of(s)),n=(s?e.lineBlockAt(s.to):i).to+1}return r.length&&e.dispatch({effects:wU(e.state,r)}),!!r.length}},{key:"Ctrl-Alt-]",run:e=>{let t=e.state.field(wW,!1);if(!t||!t.size)return!1;let r=[];return t.between(0,e.state.doc.length,(e,t)=>{r.push(wB.of({from:e,to:t}))}),e.dispatch({effects:r}),!0}}],wG={placeholderDOM:null,preparePlaceholder:null,placeholderText:""},wJ=p2.define({combine:e=>mE(e,wG)});function wY(e){let t=[wW,w2];return e&&t.push(wJ.of(e)),t}function wX(e,t){let{state:r}=e,n=r.facet(wJ),i=t=>{let r=e.lineBlockAt(e.posAtDOM(t.target)),n=wH(e.state,r.from,r.to);n&&e.dispatch({effects:wB.of(n)}),t.preventDefault()};if(n.placeholderDOM)return n.placeholderDOM(e,i,t);let s=document.createElement("span");return s.textContent=n.placeholderText,s.setAttribute("aria-label",r.phrase("folded code")),s.title=r.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=i,s}let wZ=gH.replace({widget:new class extends gW{toDOM(e){return wX(e,null)}}});class wQ extends gW{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return wX(e,this.value)}}let w0={openText:"",closedText:"",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class w1 extends x7{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}let w2=v6.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class w4{constructor(e,t){let r;function n(e){let t=mG.newName();return(r||(r=Object.create(null)))["."+t]=e,t}this.specs=e;const i="string"==typeof t.all?t.all:t.all?n(t.all):void 0,s=t.scope;this.scope=s instanceof wf?e=>e.prop(wu)==s.data:s?e=>e==s:void 0,this.style=b4(e.map(e=>({tag:e.tag,class:e.class||n(Object.assign({},e,{tag:null}))})),{all:i}).style,this.module=r?new mG(r):null,this.themeType=t.themeType}static define(e,t){return new w4(e,t||{})}}let w3=p2.define(),w5=p2.define({combine:e=>e.length?[e[0]]:null});function w6(e){let t=e.facet(w3);return t.length?t:e.facet(w5)}function w9(e,t){let r=[w8],n;return e instanceof w4&&(e.module&&r.push(v6.styleModule.of(e.module)),n=e.themeType),(null==t?void 0:t.fallback)?r.push(w5.of(e)):n?r.push(w3.computeN([v6.darkTheme],t=>t.facet(v6.darkTheme)==("dark"==n)?[e]:[])):r.push(w3.of(e)),r}let w8=me.high(yC.fromClass(class{constructor(e){this.markCache=Object.create(null),this.tree=wm(e.state),this.decorations=this.buildDeco(e,w6(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=wm(e.state),r=w6(e.state),n=r!=w6(e.startState),{viewport:i}=e.view,s=e.changes.mapPos(this.decoratedTo,1);t.length<i.to&&!n&&t.type==this.tree.type&&s>=i.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=s):(t!=this.tree||e.viewportChanged||n)&&(this.tree=t,this.decorations=this.buildDeco(e.view,r),this.decoratedTo=i.to)}buildDeco(e,t){if(!t||!this.tree.length)return gH.none;let r=new mI;for(let{from:n,to:i}of e.visibleRanges)!function(e,t,r,n=0,i=e.length){let s=new b3(n,Array.isArray(t)?t:[t],r);s.highlightRange(e.cursor(),n,i,"",s.highlighters),s.flush(i)}(this.tree,t,(e,t,n)=>{r.add(e,t,this.markCache[n]||(this.markCache[n]=gH.mark({class:n})))},n,i);return r.finish()}},{decorations:e=>e.decorations})),w7=w4.define([{tag:wh.meta,color:"#404740"},{tag:wh.link,textDecoration:"underline"},{tag:wh.heading,textDecoration:"underline",fontWeight:"bold"},{tag:wh.emphasis,fontStyle:"italic"},{tag:wh.strong,fontWeight:"bold"},{tag:wh.strikethrough,textDecoration:"line-through"},{tag:wh.keyword,color:"#708"},{tag:[wh.atom,wh.bool,wh.url,wh.contentSeparator,wh.labelName],color:"#219"},{tag:[wh.literal,wh.inserted],color:"#164"},{tag:[wh.string,wh.deleted],color:"#a11"},{tag:[wh.regexp,wh.escape,wh.special(wh.string)],color:"#e40"},{tag:wh.definition(wh.variableName),color:"#00f"},{tag:wh.local(wh.variableName),color:"#30a"},{tag:[wh.typeName,wh.namespace],color:"#085"},{tag:wh.className,color:"#167"},{tag:[wh.special(wh.variableName),wh.macroName],color:"#256"},{tag:wh.definition(wh.propertyName),color:"#00c"},{tag:wh.comment,color:"#940"},{tag:wh.invalid,color:"#f00"}]),ke=v6.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),kt="()[]{}",kr=p2.define({combine:e=>mE(e,{afterCursor:!0,brackets:kt,maxScanDistance:1e4,renderMatch:ks})}),kn=gH.mark({class:"cm-matchingBracket"}),ki=gH.mark({class:"cm-nonmatchingBracket"});function ks(e){let t=[],r=e.matched?kn:ki;return t.push(r.range(e.start.from,e.start.to)),e.end&&t.push(r.range(e.end.from,e.end.to)),t}let ko=[p8.define({create:()=>gH.none,update(e,t){if(!t.docChanged&&!t.selection)return e;let r=[],n=t.state.facet(kr);for(let e of t.state.selection.ranges){if(!e.empty)continue;let i=kh(t.state,e.head,-1,n)||e.head>0&&kh(t.state,e.head-1,1,n)||n.afterCursor&&(kh(t.state,e.head,1,n)||e.head<t.state.doc.length&&kh(t.state,e.head+1,-1,n));i&&(r=r.concat(n.renderMatch(i,t.state)))}return gH.set(r,!0)},provide:e=>v6.decorations.from(e)}),ke],kl=new bA;function ka(e,t,r){let n=e.prop(t<0?bA.openedBy:bA.closedBy);if(n)return n;if(1==e.name.length){let n=r.indexOf(e.name);if(n>-1&&n%2==+(t<0))return[r[n+t]]}return null}function kc(e){let t=e.type.prop(kl);return t?t(e.node):e}function kh(e,t,r,n={}){let i=n.maxScanDistance||1e4,s=n.brackets||kt,o=wm(e),l=o.resolveInner(t,r);for(let e=l;e;e=e.parent){let n=ka(e.type,r,s);if(n&&e.from<e.to){let i=kc(e);if(i&&(r>0?t>=i.from&&t<i.to:t>i.from&&t<=i.to))return function(e,t,r,n,i,s,o){let l=n.parent,a={from:i.from,to:i.to},c=0,h=null==l?void 0:l.cursor();if(h&&(r<0?h.childBefore(n.from):h.childAfter(n.to)))do if(r<0?h.to<=n.from:h.from>=n.to){if(0==c&&s.indexOf(h.type.name)>-1&&h.from<h.to){let e=kc(h);return{start:a,end:e?{from:e.from,to:e.to}:void 0,matched:!0}}else if(ka(h.type,r,o))c++;else if(ka(h.type,-r,o)){if(0==c){let e=kc(h);return{start:a,end:e&&e.from<e.to?{from:e.from,to:e.to}:void 0,matched:!1}}c--}}while(r<0?h.prevSibling():h.nextSibling());return{start:a,matched:!1}}(0,0,r,e,i,n,s)}}return function(e,t,r,n,i,s,o){let l=r<0?e.sliceDoc(t-1,t):e.sliceDoc(t,t+1),a=o.indexOf(l);if(a<0||a%2==0!=r>0)return null;let c={from:r<0?t-1:t,to:r>0?t+1:t},h=e.doc.iterRange(t,r>0?e.doc.length:0),u=0;for(let e=0;!h.next().done&&e<=s;){let s=h.value;r<0&&(e+=s.length);let l=t+e*r;for(let e=r>0?0:s.length-1,t=r>0?s.length:-1;e!=t;e+=r){let t=o.indexOf(s[e]);if(!(t<0)&&n.resolveInner(l+e,1).type==i)if(t%2==0==r>0)u++;else{if(1==u)return{start:c,end:{from:l+e,to:l+e+1},matched:t>>1==a>>1};u--}}r>0&&(e+=s.length)}return h.done?{start:c,matched:!1}:null}(e,t,r,o,l.type,i,s)}function ku(e,t,r,n=0,i=0){null==t&&-1==(t=e.search(/[^\s\u00a0]/))&&(t=e.length);let s=i;for(let i=n;i<t;i++)9==e.charCodeAt(i)?s+=r-s%r:s++;return s}class kd{constructor(e,t,r,n){this.string=e,this.tabSize=t,this.indentUnit=r,this.overrideIndent=n,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return 0==this.pos}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(e){let t=this.string.charAt(this.pos);if("string"==typeof e?t==e:t&&(e instanceof RegExp?e.test(t):e(t)))return++this.pos,t}eatWhile(e){let t=this.pos;for(;this.eat(e););return this.pos>t}eatSpace(){let e=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e}skipToEnd(){this.pos=this.string.length}skipTo(e){let t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0}backUp(e){this.pos-=e}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=ku(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var e;return null!=(e=this.overrideIndent)?e:ku(this.string,null,this.tabSize)}match(e,t,r){if("string"==typeof e){let n=e=>r?e.toLowerCase():e;return n(this.string.substr(this.pos,e.length))==n(e)?(!1!==t&&(this.pos+=e.length),!0):null}{let r=this.string.slice(this.pos).match(e);return r&&r.index>0?null:(r&&!1!==t&&(this.pos+=r[0].length),r)}}current(){return this.string.slice(this.start,this.pos)}}function kf(e){if("object"!=typeof e)return e;let t={};for(let r in e){let n=e[r];t[r]=n instanceof Array?n.slice():n}return t}let kp=new WeakMap;class km extends wf{constructor(e){let t=function(e){return p2.define({combine:e?t=>t.concat(e):void 0})}(e.languageData),r=function(e){return{name:e.name||"",token:e.token,blankLine:e.blankLine||(()=>{}),startState:e.startState||(()=>!0),copyState:e.copyState||kf,indent:e.indent||(()=>null),languageData:e.languageData||{},tokenTable:e.tokenTable||kx,mergeTokens:!1!==e.mergeTokens}}(e),n;super(t,new class extends bJ{createParse(e,t,r){return new ky(n,e,t,r)}},[],e.name),this.topNode=function(e,t){let r=bE.define({id:kb.length,name:"Document",props:[wu.add(()=>e),wT.add(()=>e=>t.getIndent(e))],top:!0});return kb.push(r),r}(t,this),n=this,this.streamParser=r,this.stateAfter=new bA({perNode:!0}),this.tokenTable=e.tokenTable?new kC(r.tokenTable):kE}static define(e){return new km(e)}getIndent(e){let t,{overrideIndentation:r}=e.options;r&&null!=(t=kp.get(e.state))&&t<e.pos-1e4&&(t=void 0);let n=kg(this,e.node.tree,e.node.from,e.node.from,null!=t?t:e.pos),i,s;if(n?(s=n.state,i=n.pos+1):(s=this.streamParser.startState(e.unit),i=e.node.from),e.pos-i>1e4)return null;for(;i<e.pos;){let t=e.state.doc.lineAt(i),n=Math.min(e.pos,t.to);if(t.length){let i=r?r(t.from):-1,o=new kd(t.text,e.state.tabSize,e.unit,i<0?void 0:i);for(;o.pos<n-t.from;)kv(this.streamParser.token,o,s)}else this.streamParser.blankLine(s,e.unit);if(n==e.pos)break;i=t.to+1}let o=e.lineAt(e.pos);return r&&null==t&&kp.set(e.state,o.from),this.streamParser.indent(s,/^\s*(.*)/.exec(o.text)[1],e)}get allowsNesting(){return!1}}function kg(e,t,r,n,i){let s=r>=n&&r+t.length<=i&&t.prop(e.stateAfter);if(s)return{state:e.streamParser.copyState(s),pos:r+t.length};for(let s=t.children.length-1;s>=0;s--){let o=t.children[s],l=r+t.positions[s],a=o instanceof bM&&l<i&&kg(e,o,l,n,i);if(a)return a}return null}class ky{constructor(e,t,r,n){this.lang=e,this.input=t,this.fragments=r,this.ranges=n,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=n[n.length-1].to;let i=wv.get(),s=n[0].from,{state:o,tree:l}=function(e,t,r,n,i){for(let i of t){let t=i.from+25*!!i.openStart,s=i.to-25*!!i.openEnd,o=t<=r&&s>r&&kg(e,i.tree,0-i.offset,r,s),l;if(o&&o.pos<=n&&(l=function e(t,r,n,i,s){if(s&&n<=0&&i>=r.length)return r;s||0!=n||r.type!=t.topNode||(s=!0);for(let o=r.children.length-1;o>=0;o--){let l=r.positions[o],a=r.children[o],c;if(l<i&&a instanceof bM){if(!(c=e(t,a,n-l,i-l,s)))break;return s?new bM(r.type,r.children.slice(0,o).concat(c),r.positions.slice(0,o+1),l+c.length):c}}return null}(e,i.tree,r+i.offset,o.pos+i.offset,!1)))return{state:o.state,tree:l}}return{state:e.streamParser.startState(i?wj(i):4),tree:bM.empty}}(e,r,s,this.to,null==i?void 0:i.state);this.state=o,this.parsedPos=this.chunkStart=s+l.length;for(let e=0;e<l.children.length;e++)this.chunks.push(l.children[e]),this.chunkPos.push(l.positions[e]);i&&this.parsedPos<i.viewport.from-1e5&&n.some(e=>e.from<=i.viewport.from&&e.to>=i.viewport.from)&&(this.state=this.lang.streamParser.startState(wj(i.state)),i.skipUntilInView(this.parsedPos,i.viewport.from),this.parsedPos=i.viewport.from),this.moveRangeIndex()}advance(){let e=wv.get(),t=null==this.stoppedAt?this.to:Math.min(this.to,this.stoppedAt),r=Math.min(t,this.chunkStart+512);for(e&&(r=Math.min(r,e.viewport.to));this.parsedPos<r;)this.parseLine(e);return(this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=t)?this.finish():e&&this.parsedPos>=e.viewport.to?(e.skipUntilInView(this.parsedPos,t),this.finish()):null}stopAt(e){this.stoppedAt=e}lineAfter(e){let t=this.input.chunk(e);if(this.input.lineChunks)"\n"==t&&(t="");else{let e=t.indexOf("\n");e>-1&&(t=t.slice(0,e))}return e+t.length<=this.to?t:t.slice(0,this.to-e)}nextLine(){let e=this.parsedPos,t=this.lineAfter(e),r=e+t.length;for(let e=this.rangeIndex;;){let n=this.ranges[e].to;if(n>=r||(t=t.slice(0,n-(r-t.length)),++e==this.ranges.length))break;let i=this.ranges[e].from,s=this.lineAfter(i);t+=s,r=i+s.length}return{line:t,end:r}}skipGapsTo(e,t,r){for(;;){let n=this.ranges[this.rangeIndex].to,i=e+t;if(r>0?n>i:n>=i)break;let s=this.ranges[++this.rangeIndex].from;t+=s-n}return t}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(e,t,r,n){let i=4;if(this.ranges.length>1){n=this.skipGapsTo(t,n,1),t+=n;let e=this.chunk.length;n=this.skipGapsTo(r,n,-1),r+=n,i+=this.chunk.length-e}let s=this.chunk.length-4;return this.lang.streamParser.mergeTokens&&4==i&&s>=0&&this.chunk[s]==e&&this.chunk[s+2]==t?this.chunk[s+2]=r:this.chunk.push(e,t,r,i),n}parseLine(e){let{line:t,end:r}=this.nextLine(),n=0,{streamParser:i}=this.lang,s=new kd(t,e?e.state.tabSize:4,e?wj(e.state):2);if(s.eol())i.blankLine(this.state,s.indentUnit);else for(;!s.eol();){let e=kv(i.token,s,this.state);if(e&&(n=this.emitToken(this.lang.tokenTable.resolve(e),this.parsedPos+s.start,this.parsedPos+s.pos,n)),s.start>1e4)break}this.parsedPos=r,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let e=bM.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:kw,topID:0,maxBufferLength:512,reused:this.chunkReused});e=new bM(e.type,e.children,e.positions,e.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(e),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new bM(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function kv(e,t,r){t.start=t.pos;for(let n=0;n<10;n++){let n=e(t,r);if(t.pos>t.start)return n}throw Error("Stream parser failed to advance stream.")}let kx=Object.create(null),kb=[bE.none],kw=new bj(kb),kk=[],kA=Object.create(null),kS=Object.create(null);for(let[e,t]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])kS[e]=kO(kx,t);class kC{constructor(e){this.extra=e,this.table=Object.assign(Object.create(null),kS)}resolve(e){return e?this.table[e]||(this.table[e]=kO(this.extra,e)):0}}let kE=new kC(kx);function kj(e,t){kk.indexOf(e)>-1||(kk.push(e),console.warn(t))}function kO(e,t){let r=[];for(let n of t.split(" ")){let t=[];for(let r of n.split(".")){let n=e[r]||wh[r];n?"function"==typeof n?t.length?t=t.map(n):kj(r,`Modifier ${r} used at start of tag`):t.length?kj(r,`Tag ${r} used as modifier`):t=Array.isArray(n)?n:[n]:kj(r,`Unknown highlighting tag ${r}`)}for(let e of t)r.push(e)}if(!r.length)return 0;let n=t.replace(/ /g,"_"),i=n+" "+r.map(e=>e.id),s=kA[i];if(s)return s.id;let o=kA[i]=bE.define({id:kb.length,name:n,props:[function(e){let t=Object.create(null);for(let r in e){let n=e[r];for(let e of(Array.isArray(n)||(n=[n]),r.split(" ")))if(e){let r=[],i=2,s=e;for(let t=0;;){if("..."==s&&t>0&&t+3==e.length){i=1;break}let n=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(s);if(!n)throw RangeError("Invalid path: "+e);if(r.push("*"==n[0]?"":'"'==n[0][0]?JSON.parse(n[0]):n[0]),(t+=n[0].length)==e.length)break;let o=e[t++];if(t==e.length&&"!"==o){i=0;break}if("/"!=o)throw RangeError("Invalid path: "+e);s=e.slice(t)}let o=r.length-1,l=r[o];if(!l)throw RangeError("Invalid path: "+e);let a=new b2(n,i,o>0?r.slice(0,o):null);t[l]=a.sort(t[l])}}return b1.add(t)}({[n]:r})]});return kb.push(o),o.id}function kP(e,t){return({state:r,dispatch:n})=>{if(r.readOnly)return!1;let i=e(t,r);return!!i&&(n(r.update(i)),!0)}}g2.RTL,g2.LTR;let kM=kP(function(e,t,r=t.selection.ranges){let n=[],i=-1;for(let{from:e,to:s}of r){let r=n.length,o=1e9,l=k$(t,e).line;if(l){for(let r=e;r<=s;){let a=t.doc.lineAt(r);if(a.from>i&&(e==s||s>a.from)){i=a.from;let e=/^\s*/.exec(a.text)[0].length,t=e==a.length,r=a.text.slice(e,e+l.length)==l?e:-1;e<a.text.length&&e<o&&(o=e),n.push({line:a,comment:r,token:l,indent:e,empty:t,single:!1})}r=a.to+1}if(o<1e9)for(let e=r;e<n.length;e++)n[e].indent<n[e].line.text.length&&(n[e].indent=o);n.length==r+1&&(n[r].single=!0)}}if(2!=e&&n.some(e=>e.comment<0&&(!e.empty||e.single))){let e=[];for(let{line:t,token:r,indent:i,empty:s,single:o}of n)(o||!s)&&e.push({from:t.from+i,insert:r+" "});let r=t.changes(e);return{changes:r,selection:t.selection.map(r,1)}}if(1!=e&&n.some(e=>e.comment>=0)){let e=[];for(let{line:t,comment:r,token:i}of n)if(r>=0){let n=t.from+r,s=n+i.length;" "==t.text[s-t.from]&&s++,e.push({from:n,to:s})}return{changes:e}}return null},0),kT=kP(kD,0),kI=kP((e,t)=>kD(e,t,function(e){let t=[];for(let r of e.selection.ranges){let n=e.doc.lineAt(r.from),i=r.to<=n.to?n:e.doc.lineAt(r.to);i.from>n.from&&i.from==r.to&&(i=r.to==n.to+1?n:e.doc.lineAt(r.to-1));let s=t.length-1;s>=0&&t[s].to>n.from?t[s].to=i.to:t.push({from:n.from+/^\s*/.exec(n.text)[0].length,to:i.to})}return t}(t)),0);function k$(e,t){let r=e.languageDataAt("commentTokens",t,1);return r.length?r[0]:{}}function kD(e,t,r=t.selection.ranges){let n=r.map(e=>k$(t,e.from).block);if(!n.every(e=>e))return null;let i=r.map((e,r)=>(function(e,{open:t,close:r},n,i){let s,o,l=e.sliceDoc(n-50,n),a=e.sliceDoc(i,i+50),c=/\s*$/.exec(l)[0].length,h=/^\s*/.exec(a)[0].length,u=l.length-c;if(l.slice(u-t.length,u)==t&&a.slice(h,h+r.length)==r)return{open:{pos:n-c,margin:c&&1},close:{pos:i+h,margin:h&&1}};i-n<=100?s=o=e.sliceDoc(n,i):(s=e.sliceDoc(n,n+50),o=e.sliceDoc(i-50,i));let d=/^\s*/.exec(s)[0].length,f=/\s*$/.exec(o)[0].length,p=o.length-f-r.length;return s.slice(d,d+t.length)==t&&o.slice(p,p+r.length)==r?{open:{pos:n+d+t.length,margin:+!!/\s/.test(s.charAt(d+t.length))},close:{pos:i-f-r.length,margin:+!!/\s/.test(o.charAt(p-1))}}:null})(t,n[r],e.from,e.to));if(2!=e&&!i.every(e=>e))return{changes:t.changes(r.map((e,t)=>i[t]?[]:[{from:e.from,insert:n[t].open+" "},{from:e.to,insert:" "+n[t].close}]))};if(1!=e&&i.some(e=>e)){let e=[];for(let t=0,r;t<i.length;t++)if(r=i[t]){let i=n[t],{open:s,close:o}=r;e.push({from:s.pos-i.open.length,to:s.pos+s.margin},{from:o.pos-o.margin,to:o.pos+i.close.length})}return{changes:e}}return null}let kR=mp.define(),kN=mp.define(),kL=p2.define(),kF=p2.define({combine:e=>mE(e,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(r,n)=>e(r,n)||t(r,n)})}),k_=p8.define({create:()=>kZ.empty,update(e,t){let r=t.state.facet(kF),n=t.annotation(kR);if(n){let i=kU.fromTransaction(t,n.selection),s=n.side,o=0==s?e.undone:e.done;return o=i?kq(o,o.length,r.minDepth,i):kJ(o,t.startState.selection),new kZ(0==s?n.rest:o,0==s?o:n.rest)}let i=t.annotation(kN);if(("full"==i||"before"==i)&&(e=e.isolate()),!1===t.annotation(mv.addToHistory))return t.changes.empty?e:e.addMapping(t.changes.desc);let s=kU.fromTransaction(t),o=t.annotation(mv.time),l=t.annotation(mv.userEvent);return s?e=e.addChanges(s,o,l,r,t):t.selection&&(e=e.addSelection(t.startState.selection,o,l,r.newGroupDelay)),("full"==i||"after"==i)&&(e=e.isolate()),e},toJSON:e=>({done:e.done.map(e=>e.toJSON()),undone:e.undone.map(e=>e.toJSON())}),fromJSON:e=>new kZ(e.done.map(kU.fromJSON),e.undone.map(kU.fromJSON))});function kB(e,t){return function({state:r,dispatch:n}){if(!t&&r.readOnly)return!1;let i=r.field(k_,!1);if(!i)return!1;let s=i.pop(e,r,t);return!!s&&(n(s),!0)}}let kz=kB(0,!1),kW=kB(1,!1),kV=kB(0,!0),kH=kB(1,!0);class kU{constructor(e,t,r,n,i){this.changes=e,this.effects=t,this.mapped=r,this.startSelection=n,this.selectionsAfter=i}setSelAfter(e){return new kU(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,r;return{changes:null==(e=this.changes)?void 0:e.toJSON(),mapped:null==(t=this.mapped)?void 0:t.toJSON(),startSelection:null==(r=this.startSelection)?void 0:r.toJSON(),selectionsAfter:this.selectionsAfter.map(e=>e.toJSON())}}static fromJSON(e){return new kU(e.changes&&pU.fromJSON(e.changes),[],e.mapped&&pH.fromJSON(e.mapped),e.startSelection&&pQ.fromJSON(e.startSelection),e.selectionsAfter.map(pQ.fromJSON))}static fromTransaction(e,t){let r=kG;for(let t of e.startState.facet(kL)){let n=t(e);n.length&&(r=r.concat(n))}return!r.length&&e.changes.empty?null:new kU(e.changes.invert(e.startState.doc),r,void 0,t||e.startState.selection,kG)}static selection(e){return new kU(void 0,kG,void 0,void 0,e)}}function kq(e,t,r,n){let i=e.slice(t+1>r+20?t-r-1:0,t);return i.push(n),i}function kK(e,t){return e.length?t.length?e.concat(t):e:t}let kG=[];function kJ(e,t){if(!e.length)return[kU.selection([t])];{let r=e[e.length-1],n=r.selectionsAfter.slice(Math.max(0,r.selectionsAfter.length-200));return n.length&&n[n.length-1].eq(t)?e:(n.push(t),kq(e,e.length-1,1e9,r.setSelAfter(n)))}}function kY(e,t){if(!e.length)return e;let r=e.length,n=kG;for(;r;){let i=function(e,t,r){let n=kK(e.selectionsAfter.length?e.selectionsAfter.map(e=>e.map(t)):kG,r);if(!e.changes)return kU.selection(n);let i=e.changes.map(t),s=t.mapDesc(e.changes,!0),o=e.mapped?e.mapped.composeDesc(s):s;return new kU(i,my.mapEffects(e.effects,t),o,e.startSelection.map(s),n)}(e[r-1],t,n);if(i.changes&&!i.changes.empty||i.effects.length){let t=e.slice(0,r);return t[r-1]=i,t}t=i.mapped,r--,n=i.selectionsAfter}return n.length?[kU.selection(n)]:kG}let kX=/^(input\.type|delete)($|\.)/;class kZ{constructor(e,t,r=0,n){this.done=e,this.undone=t,this.prevTime=r,this.prevUserEvent=n}isolate(){return this.prevTime?new kZ(this.done,this.undone):this}addChanges(e,t,r,n,i){var s,o;let l,a,c=this.done,h=c[c.length-1];return new kZ(c=h&&h.changes&&!h.changes.empty&&e.changes&&(!r||kX.test(r))&&(!h.selectionsAfter.length&&t-this.prevTime<n.newGroupDelay&&n.joinToEvent(i,(s=h.changes,o=e.changes,l=[],a=!1,s.iterChangedRanges((e,t)=>l.push(e,t)),o.iterChangedRanges((e,t,r,n)=>{for(let e=0;e<l.length;){let t=l[e++],i=l[e++];n>=t&&r<=i&&(a=!0)}}),a))||"input.type.compose"==r)?kq(c,c.length-1,n.minDepth,new kU(e.changes.compose(h.changes),kK(my.mapEffects(e.effects,h.changes),h.effects),h.mapped,h.startSelection,kG)):kq(c,c.length,n.minDepth,e),kG,t,r)}addSelection(e,t,r,n){var i;let s=this.done.length?this.done[this.done.length-1].selectionsAfter:kG;return s.length>0&&t-this.prevTime<n&&r==this.prevUserEvent&&r&&/^select($|\.)/.test(r)&&(i=s[s.length-1],i.ranges.length==e.ranges.length&&0===i.ranges.filter((t,r)=>t.empty!=e.ranges[r].empty).length)?this:new kZ(kJ(this.done,e),this.undone,t,r)}addMapping(e){return new kZ(kY(this.done,e),kY(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,r){let n=0==e?this.done:this.undone;if(0==n.length)return null;let i=n[n.length-1],s=i.selectionsAfter[0]||t.selection;if(r&&i.selectionsAfter.length){let r,o;return t.update({selection:i.selectionsAfter[i.selectionsAfter.length-1],annotations:kR.of({side:e,rest:(r=n[n.length-1],(o=n.slice())[n.length-1]=r.setSelAfter(r.selectionsAfter.slice(0,r.selectionsAfter.length-1)),o),selection:s}),userEvent:0==e?"select.undo":"select.redo",scrollIntoView:!0})}{if(!i.changes)return null;let r=1==n.length?kG:n.slice(0,n.length-1);return i.mapped&&(r=kY(r,i.mapped)),t.update({changes:i.changes,selection:i.startSelection,effects:i.effects,annotations:kR.of({side:e,rest:r,selection:s}),filter:!1,userEvent:0==e?"undo":"redo",scrollIntoView:!0})}}}kZ.empty=new kZ(kG,kG);let kQ=[{key:"Mod-z",run:kz,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:kW,preventDefault:!0},{linux:"Ctrl-Shift-z",run:kW,preventDefault:!0},{key:"Mod-u",run:kV,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:kH,preventDefault:!0}];function k0(e,t){return pQ.create(e.ranges.map(t),e.mainIndex)}function k1(e,t){return e.update({selection:t,scrollIntoView:!0,userEvent:"select"})}function k2({state:e,dispatch:t},r){let n=k0(e.selection,r);return!n.eq(e.selection,!0)&&(t(k1(e,n)),!0)}function k4(e,t){return pQ.cursor(t?e.to:e.from)}function k3(e,t){return k2(e,r=>r.empty?e.moveByChar(r,t):k4(r,t))}function k5(e){return e.textDirectionAt(e.state.selection.main.head)==g2.LTR}let k6=e=>k3(e,!k5(e)),k9=e=>k3(e,k5(e));function k8(e,t){return k2(e,r=>r.empty?e.moveByGroup(r,t):k4(r,t))}function k7(e,t,r){let n,i,s=wm(e).resolveInner(t.head),o=r?bA.closedBy:bA.openedBy;for(let n=t.head;;){let t=r?s.childAfter(n):s.childBefore(n);if(!t)break;!function(e,t,r){if(t.type.prop(r))return!0;let n=t.to-t.from;return n&&(n>2||/[^\s,.;:]/.test(e.sliceDoc(t.from,t.to)))||t.firstChild}(e,t,o)?n=r?t.to:t.from:s=t}return i=s.type.prop(o)&&(n=r?kh(e,s.from,1):kh(e,s.to,-1))&&n.matched?r?n.end.to:n.end.from:r?s.to:s.from,pQ.cursor(i,r?-1:1)}function Ae(e,t){return k2(e,r=>{if(!r.empty)return k4(r,t);let n=e.moveVertically(r,t);return n.head!=r.head?n:e.moveToLineBoundary(r,t)})}"undefined"!=typeof Intl&&Intl.Segmenter;let At=e=>Ae(e,!1),Ar=e=>Ae(e,!0);function An(e){let t=e.scrollDOM.clientHeight<e.scrollDOM.scrollHeight-2,r=0,n=0,i;if(t){for(let t of e.state.facet(v6.scrollMargins)){let i=t(e);(null==i?void 0:i.top)&&(r=Math.max(null==i?void 0:i.top,r)),(null==i?void 0:i.bottom)&&(n=Math.max(null==i?void 0:i.bottom,n))}i=e.scrollDOM.clientHeight-r-n}else i=(e.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:r,marginBottom:n,selfScroll:t,height:Math.max(e.defaultLineHeight,i-5)}}function Ai(e,t){let r,n=An(e),{state:i}=e,s=k0(i.selection,r=>r.empty?e.moveVertically(r,t,n.height):k4(r,t));if(s.eq(i.selection))return!1;if(n.selfScroll){let t=e.coordsAtPos(i.selection.main.head),o=e.scrollDOM.getBoundingClientRect(),l=o.top+n.marginTop,a=o.bottom-n.marginBottom;t&&t.top>l&&t.bottom<a&&(r=v6.scrollIntoView(s.main.head,{y:"start",yMargin:t.top-l}))}return e.dispatch(k1(i,s),{effects:r}),!0}let As=e=>Ai(e,!1),Ao=e=>Ai(e,!0);function Al(e,t,r){let n=e.lineBlockAt(t.head),i=e.moveToLineBoundary(t,r);if(i.head==t.head&&i.head!=(r?n.to:n.from)&&(i=e.moveToLineBoundary(t,r,!1)),!r&&i.head==n.from&&n.length){let r=/^\s*/.exec(e.state.sliceDoc(n.from,Math.min(n.from+100,n.to)))[0].length;r&&t.head!=n.from+r&&(i=pQ.cursor(n.from+r))}return i}function Aa(e,t){let r=k0(e.state.selection,e=>{let r=t(e);return pQ.range(e.anchor,r.head,r.goalColumn,r.bidiLevel||void 0)});return!r.eq(e.state.selection)&&(e.dispatch(k1(e.state,r)),!0)}function Ac(e,t){return Aa(e,r=>e.moveByChar(r,t))}let Ah=e=>Ac(e,!k5(e)),Au=e=>Ac(e,k5(e));function Ad(e,t){return Aa(e,r=>e.moveByGroup(r,t))}function Af(e,t){return Aa(e,r=>e.moveVertically(r,t))}let Ap=e=>Af(e,!1),Am=e=>Af(e,!0);function Ag(e,t){return Aa(e,r=>e.moveVertically(r,t,An(e).height))}let Ay=e=>Ag(e,!1),Av=e=>Ag(e,!0),Ax=({state:e,dispatch:t})=>(t(k1(e,{anchor:0})),!0),Ab=({state:e,dispatch:t})=>(t(k1(e,{anchor:e.doc.length})),!0),Aw=({state:e,dispatch:t})=>(t(k1(e,{anchor:e.selection.main.anchor,head:0})),!0),Ak=({state:e,dispatch:t})=>(t(k1(e,{anchor:e.selection.main.anchor,head:e.doc.length})),!0);function AA(e,t){let{state:r}=e,n=r.selection,i=r.selection.ranges.slice();for(let n of r.selection.ranges){let s=r.doc.lineAt(n.head);if(t?s.to<e.state.doc.length:s.from>0)for(let r=n;;){let n=e.moveVertically(r,t);if(n.head<s.from||n.head>s.to){i.some(e=>e.head==n.head)||i.push(n);break}if(n.head==r.head)break;r=n}}return i.length!=n.ranges.length&&(e.dispatch(k1(r,pQ.create(i,i.length-1))),!0)}function AS(e,t){if(e.state.readOnly)return!1;let r="delete.selection",{state:n}=e,i=n.changeByRange(n=>{let{from:i,to:s}=n;if(i==s){let o=t(n);o<i?(r="delete.backward",o=AC(e,o,!1)):o>i&&(r="delete.forward",o=AC(e,o,!0)),i=Math.min(i,o),s=Math.max(s,o)}else i=AC(e,i,!1),s=AC(e,s,!0);return i==s?{range:n}:{changes:{from:i,to:s},range:pQ.cursor(i,i<n.head?-1:1)}});return!i.changes.empty&&(e.dispatch(n.update(i,{scrollIntoView:!0,userEvent:r,effects:"delete.selection"==r?v6.announce.of(n.phrase("Selection deleted")):void 0})),!0)}function AC(e,t,r){if(e instanceof v6)for(let n of e.state.facet(v6.atomicRanges).map(t=>t(e)))n.between(t,t,(e,n)=>{e<t&&n>t&&(t=r?n:e)});return t}let AE=(e,t,r)=>AS(e,n=>{let i=n.from,{state:s}=e,o=s.doc.lineAt(i),l,a;if(r&&!t&&i>o.from&&i<o.from+200&&!/[^ \t]/.test(l=o.text.slice(0,i-o.from))){if("	"==l[l.length-1])return i-1;let e=mV(l,s.tabSize)%wj(s)||wj(s);for(let t=0;t<e&&" "==l[l.length-1-t];t++)i--;a=i}else(a=pF(o.text,i-o.from,t,t)+o.from)==i&&o.number!=(t?s.doc.lines:1)?a+=t?1:-1:!t&&/[\ufe00-\ufe0f]/.test(o.text.slice(a-o.from,i-o.from))&&(a=pF(o.text,a-o.from,!1,!1)+o.from);return a}),Aj=e=>AE(e,!1,!0),AO=e=>AE(e,!0,!1),AP=(e,t)=>AS(e,r=>{let n=r.head,{state:i}=e,s=i.doc.lineAt(n),o=i.charCategorizer(n);for(let e=null;;){if(n==(t?s.to:s.from)){n==r.head&&s.number!=(t?i.doc.lines:1)&&(n+=t?1:-1);break}let l=pF(s.text,n-s.from,t)+s.from,a=s.text.slice(Math.min(n,l)-s.from,Math.max(n,l)-s.from),c=o(a);if(null!=e&&c!=e)break;(" "!=a||n!=r.head)&&(e=c),n=l}return n}),AM=e=>AP(e,!1);function AT(e){let t=[],r=-1;for(let n of e.selection.ranges){let i=e.doc.lineAt(n.from),s=e.doc.lineAt(n.to);if(n.empty||n.to!=s.from||(s=e.doc.lineAt(n.to-1)),r>=i.number){let e=t[t.length-1];e.to=s.to,e.ranges.push(n)}else t.push({from:i.from,to:s.to,ranges:[n]});r=s.number+1}return t}function AI(e,t,r){if(e.readOnly)return!1;let n=[],i=[];for(let t of AT(e)){if(r?t.to==e.doc.length:0==t.from)continue;let s=e.doc.lineAt(r?t.to+1:t.from-1),o=s.length+1;if(r)for(let r of(n.push({from:t.to,to:s.to},{from:t.from,insert:s.text+e.lineBreak}),t.ranges))i.push(pQ.range(Math.min(e.doc.length,r.anchor+o),Math.min(e.doc.length,r.head+o)));else for(let r of(n.push({from:s.from,to:t.from},{from:t.to,insert:e.lineBreak+s.text}),t.ranges))i.push(pQ.range(r.anchor-o,r.head-o))}return!!n.length&&(t(e.update({changes:n,scrollIntoView:!0,selection:pQ.create(i,e.selection.mainIndex),userEvent:"move.line"})),!0)}function A$(e,t,r){if(e.readOnly)return!1;let n=[];for(let t of AT(e))r?n.push({from:t.from,insert:e.doc.slice(t.from,t.to)+e.lineBreak}):n.push({from:t.to,insert:e.lineBreak+e.doc.slice(t.from,t.to)});return t(e.update({changes:n,scrollIntoView:!0,userEvent:"input.copyline"})),!0}let AD=AN(!1),AR=AN(!0);function AN(e){return({state:t,dispatch:r})=>{if(t.readOnly)return!1;let n=t.changeByRange(r=>{let{from:n,to:i}=r,s=t.doc.lineAt(n),o=!e&&n==i&&function(e,t){if(/\(\)|\[\]|\{\}/.test(e.sliceDoc(t-1,t+1)))return{from:t,to:t};let r=wm(e).resolveInner(t),n=r.childBefore(t),i=r.childAfter(t),s;return n&&i&&n.to<=t&&i.from>=t&&(s=n.type.prop(bA.closedBy))&&s.indexOf(i.name)>-1&&e.doc.lineAt(n.to).from==e.doc.lineAt(i.from).from&&!/\S/.test(e.sliceDoc(n.to,i.from))?{from:n.to,to:i.from}:null}(t,n);e&&(n=i=(i<=s.to?s:t.doc.lineAt(i)).to);let l=new wM(t,{simulateBreak:n,simulateDoubleBreak:!!o}),a=wP(l,n);for(null==a&&(a=mV(/^\s*/.exec(t.doc.lineAt(n).text)[0],t.tabSize));i<s.to&&/\s/.test(s.text[i-s.from]);)i++;o?{from:n,to:i}=o:n>s.from&&n<s.from+100&&!/\S/.test(s.text.slice(0,n))&&(n=s.from);let c=["",wO(t,a)];return o&&c.push(wO(t,l.lineIndent(s.from,-1))),{changes:{from:n,to:i,insert:pP.of(c)},range:pQ.cursor(n+1+c[1].length)}});return r(t.update(n,{scrollIntoView:!0,userEvent:"input"})),!0}}function AL(e,t){let r=-1;return e.changeByRange(n=>{let i=[];for(let s=n.from;s<=n.to;){let o=e.doc.lineAt(s);o.number>r&&(n.empty||n.to>o.from)&&(t(o,i,n),r=o.number),s=o.to+1}let s=e.changes(i);return{changes:i,range:pQ.range(s.mapPos(n.anchor,1),s.mapPos(n.head,1))}})}let AF=({state:e,dispatch:t})=>!e.readOnly&&(t(e.update(AL(e,(t,r)=>{r.push({from:t.from,insert:e.facet(wE)})}),{userEvent:"input.indent"})),!0),A_=({state:e,dispatch:t})=>!e.readOnly&&(t(e.update(AL(e,(t,r)=>{let n=/^\s*/.exec(t.text)[0];if(!n)return;let i=mV(n,e.tabSize),s=0,o=wO(e,Math.max(0,i-wj(e)));for(;s<n.length&&s<o.length&&n.charCodeAt(s)==o.charCodeAt(s);)s++;r.push({from:t.from+s,to:t.from+n.length,insert:o.slice(s)})}),{userEvent:"delete.dedent"})),!0),AB=[{key:"Ctrl-b",run:k6,shift:Ah,preventDefault:!0},{key:"Ctrl-f",run:k9,shift:Au},{key:"Ctrl-p",run:At,shift:Ap},{key:"Ctrl-n",run:Ar,shift:Am},{key:"Ctrl-a",run:e=>k2(e,t=>pQ.cursor(e.lineBlockAt(t.head).from,1)),shift:e=>Aa(e,t=>pQ.cursor(e.lineBlockAt(t.head).from))},{key:"Ctrl-e",run:e=>k2(e,t=>pQ.cursor(e.lineBlockAt(t.head).to,-1)),shift:e=>Aa(e,t=>pQ.cursor(e.lineBlockAt(t.head).to))},{key:"Ctrl-d",run:AO},{key:"Ctrl-h",run:Aj},{key:"Ctrl-k",run:e=>AS(e,t=>{let r=e.lineBlockAt(t.head).to;return t.head<r?r:Math.min(e.state.doc.length,t.head+1)})},{key:"Ctrl-Alt-h",run:AM},{key:"Ctrl-o",run:({state:e,dispatch:t})=>{if(e.readOnly)return!1;let r=e.changeByRange(e=>({changes:{from:e.from,to:e.to,insert:pP.of(["",""])},range:pQ.cursor(e.from)}));return t(e.update(r,{scrollIntoView:!0,userEvent:"input"})),!0}},{key:"Ctrl-t",run:({state:e,dispatch:t})=>{if(e.readOnly)return!1;let r=e.changeByRange(t=>{if(!t.empty||0==t.from||t.from==e.doc.length)return{range:t};let r=t.from,n=e.doc.lineAt(r),i=r==n.from?r-1:pF(n.text,r-n.from,!1)+n.from,s=r==n.to?r+1:pF(n.text,r-n.from,!0)+n.from;return{changes:{from:i,to:s,insert:e.doc.slice(r,s).append(e.doc.slice(i,r))},range:pQ.cursor(s)}});return!r.changes.empty&&(t(e.update(r,{scrollIntoView:!0,userEvent:"move.character"})),!0)}},{key:"Ctrl-v",run:Ao}],Az=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:e=>k2(e,t=>k7(e.state,t,!k5(e))),shift:e=>Aa(e,t=>k7(e.state,t,!k5(e)))},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:e=>k2(e,t=>k7(e.state,t,k5(e))),shift:e=>Aa(e,t=>k7(e.state,t,k5(e)))},{key:"Alt-ArrowUp",run:({state:e,dispatch:t})=>AI(e,t,!1)},{key:"Shift-Alt-ArrowUp",run:({state:e,dispatch:t})=>A$(e,t,!1)},{key:"Alt-ArrowDown",run:({state:e,dispatch:t})=>AI(e,t,!0)},{key:"Shift-Alt-ArrowDown",run:({state:e,dispatch:t})=>A$(e,t,!0)},{key:"Mod-Alt-ArrowUp",run:e=>AA(e,!1)},{key:"Mod-Alt-ArrowDown",run:e=>AA(e,!0)},{key:"Escape",run:({state:e,dispatch:t})=>{let r=e.selection,n=null;return r.ranges.length>1?n=pQ.create([r.main]):r.main.empty||(n=pQ.create([pQ.cursor(r.main.head)])),!!n&&(t(k1(e,n)),!0)}},{key:"Mod-Enter",run:AR},{key:"Alt-l",mac:"Ctrl-l",run:({state:e,dispatch:t})=>{let r=AT(e).map(({from:t,to:r})=>pQ.range(t,Math.min(r+1,e.doc.length)));return t(e.update({selection:pQ.create(r),userEvent:"select"})),!0}},{key:"Mod-i",run:({state:e,dispatch:t})=>{let r=k0(e.selection,t=>{let r=wm(e),n=r.resolveStack(t.from,1);if(t.empty){let e=r.resolveStack(t.from,-1);e.node.from>=n.node.from&&e.node.to<=n.node.to&&(n=e)}for(let e=n;e;e=e.next){let{node:r}=e;if((r.from<t.from&&r.to>=t.to||r.to>t.to&&r.from<=t.from)&&e.next)return pQ.range(r.to,r.from)}return t});return!r.eq(e.selection)&&(t(k1(e,r)),!0)},preventDefault:!0},{key:"Mod-[",run:A_},{key:"Mod-]",run:AF},{key:"Mod-Alt-\\",run:({state:e,dispatch:t})=>{if(e.readOnly)return!1;let r=Object.create(null),n=new wM(e,{overrideIndentation:e=>{let t=r[e];return null==t?-1:t}}),i=AL(e,(t,i,s)=>{let o=wP(n,t.from);if(null==o)return;/\S/.test(t.text)||(o=0);let l=/^\s*/.exec(t.text)[0],a=wO(e,o);(l!=a||s.from<t.from+l.length)&&(r[t.from]=o,i.push({from:t.from,to:t.from+l.length,insert:a}))});return i.changes.empty||t(e.update(i,{userEvent:"indent"})),!0}},{key:"Shift-Mod-k",run:e=>{if(e.state.readOnly)return!1;let{state:t}=e,r=t.changes(AT(t).map(({from:e,to:r})=>(e>0?e--:r<t.doc.length&&r++,{from:e,to:r}))),n=k0(t.selection,t=>{let r;if(e.lineWrapping){let n=e.lineBlockAt(t.head),i=e.coordsAtPos(t.head,t.assoc||1);i&&(r=n.bottom+e.documentTop-i.bottom+e.defaultLineHeight/2)}return e.moveVertically(t,!0,r)}).map(r);return e.dispatch({changes:r,selection:n,scrollIntoView:!0,userEvent:"delete.line"}),!0}},{key:"Shift-Mod-\\",run:({state:e,dispatch:t})=>{let r,n;return r=!1,n=k0(e.selection,t=>{let n=kh(e,t.head,-1)||kh(e,t.head,1)||t.head>0&&kh(e,t.head-1,1)||t.head<e.doc.length&&kh(e,t.head+1,-1);if(!n||!n.end)return t;r=!0;let i=n.start.from==t.head?n.end.to:n.end.from;return pQ.cursor(i)}),!!r&&(t(k1(e,n)),!0)}},{key:"Mod-/",run:e=>{let{state:t}=e,r=t.doc.lineAt(t.selection.main.from),n=k$(e.state,r.from);return n.line?kM(e):!!n.block&&kI(e)}},{key:"Alt-A",run:kT},{key:"Ctrl-m",mac:"Shift-Alt-m",run:e=>(e.setTabFocusMode(),!0)}].concat([{key:"ArrowLeft",run:k6,shift:Ah,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:e=>k8(e,!k5(e)),shift:e=>Ad(e,!k5(e)),preventDefault:!0},{mac:"Cmd-ArrowLeft",run:e=>k2(e,t=>Al(e,t,!k5(e))),shift:e=>Aa(e,t=>Al(e,t,!k5(e))),preventDefault:!0},{key:"ArrowRight",run:k9,shift:Au,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:e=>k8(e,k5(e)),shift:e=>Ad(e,k5(e)),preventDefault:!0},{mac:"Cmd-ArrowRight",run:e=>k2(e,t=>Al(e,t,k5(e))),shift:e=>Aa(e,t=>Al(e,t,k5(e))),preventDefault:!0},{key:"ArrowUp",run:At,shift:Ap,preventDefault:!0},{mac:"Cmd-ArrowUp",run:Ax,shift:Aw},{mac:"Ctrl-ArrowUp",run:As,shift:Ay},{key:"ArrowDown",run:Ar,shift:Am,preventDefault:!0},{mac:"Cmd-ArrowDown",run:Ab,shift:Ak},{mac:"Ctrl-ArrowDown",run:Ao,shift:Av},{key:"PageUp",run:As,shift:Ay},{key:"PageDown",run:Ao,shift:Av},{key:"Home",run:e=>k2(e,t=>Al(e,t,!1)),shift:e=>Aa(e,t=>Al(e,t,!1)),preventDefault:!0},{key:"Mod-Home",run:Ax,shift:Aw},{key:"End",run:e=>k2(e,t=>Al(e,t,!0)),shift:e=>Aa(e,t=>Al(e,t,!0)),preventDefault:!0},{key:"Mod-End",run:Ab,shift:Ak},{key:"Enter",run:AD,shift:AD},{key:"Mod-a",run:({state:e,dispatch:t})=>(t(e.update({selection:{anchor:0,head:e.doc.length},userEvent:"select"})),!0)},{key:"Backspace",run:Aj,shift:Aj,preventDefault:!0},{key:"Delete",run:AO,preventDefault:!0},{key:"Mod-Backspace",mac:"Alt-Backspace",run:AM,preventDefault:!0},{key:"Mod-Delete",mac:"Alt-Delete",run:e=>AP(e,!0),preventDefault:!0},{mac:"Mod-Backspace",run:e=>AS(e,t=>{let r=e.moveToLineBoundary(t,!1).head;return t.head>r?r:Math.max(0,t.head-1)}),preventDefault:!0},{mac:"Mod-Delete",run:e=>AS(e,t=>{let r=e.moveToLineBoundary(t,!0).head;return t.head<r?r:Math.min(e.state.doc.length,t.head+1)}),preventDefault:!0}].concat(AB.map(e=>({mac:e.key,run:e.run,shift:e.shift})))),AW={key:"Tab",run:AF,shift:A_};function AV(){var e=arguments[0];"string"==typeof e&&(e=document.createElement(e));var t=1,r=arguments[1];if(r&&"object"==typeof r&&null==r.nodeType&&!Array.isArray(r)){for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){var i=r[n];"string"==typeof i?e.setAttribute(n,i):null!=i&&(e[n]=i)}t++}for(;t<arguments.length;t++)!function e(t,r){if("string"==typeof r)t.appendChild(document.createTextNode(r));else if(null==r);else if(null!=r.nodeType)t.appendChild(r);else if(Array.isArray(r))for(var n=0;n<r.length;n++)e(t,r[n]);else throw RangeError("Unsupported child node: "+r)}(e,arguments[t]);return e}let AH="function"==typeof String.prototype.normalize?e=>e.normalize("NFKD"):e=>e;class AU{constructor(e,t,r=0,n=e.length,i,s){this.test=s,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(r,n),this.bufferStart=r,this.normalize=i?e=>i(AH(e)):AH,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return -1;this.bufferPos=0,this.buffer=this.iter.value}return p_(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=pB(e),r=this.bufferStart+this.bufferPos;this.bufferPos+=pz(e);let n=this.normalize(t);if(n.length)for(let e=0,i=r;;e++){let s=n.charCodeAt(e),o=this.match(s,i,this.bufferPos+this.bufferStart);if(e==n.length-1){if(o)return this.value=o,this;break}i==r&&e<t.length&&t.charCodeAt(e)==s&&i++}}}match(e,t,r){let n=null;for(let t=0;t<this.matches.length;t+=2){let i=this.matches[t],s=!1;this.query.charCodeAt(i)==e&&(i==this.query.length-1?n={from:this.matches[t+1],to:r}:(this.matches[t]++,s=!0)),s||(this.matches.splice(t,2),t-=2)}return this.query.charCodeAt(0)==e&&(1==this.query.length?n={from:t,to:r}:this.matches.push(1,t)),n&&this.test&&!this.test(n.from,n.to,this.buffer,this.bufferStart)&&(n=null),n}}"undefined"!=typeof Symbol&&(AU.prototype[Symbol.iterator]=function(){return this});let Aq={from:-1,to:-1,match:/.*/.exec("")},AK="gm"+(null==/x/.unicode?"":"u");class AG{constructor(e,t,r,n=0,i=e.length){if(this.text=e,this.to=i,this.curLine="",this.done=!1,this.value=Aq,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new AX(e,t,r,n,i);this.re=new RegExp(t,AK+((null==r?void 0:r.ignoreCase)?"i":"")),this.test=null==r?void 0:r.test,this.iter=e.iter();let s=e.lineAt(n);this.curLineStart=s.from,this.matchPos=AZ(e,n),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let r=this.curLineStart+t.index,n=r+t[0].length;if(this.matchPos=AZ(this.text,n+ +(r==n)),r==this.curLineStart+this.curLine.length&&this.nextLine(),(r<n||r>this.value.to)&&(!this.test||this.test(r,n,t)))return this.value={from:r,to:n,match:t},this;e=this.matchPos-this.curLineStart}else{if(!(this.curLineStart+this.curLine.length<this.to))return this.done=!0,this;this.nextLine(),e=0}}}}let AJ=new WeakMap;class AY{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,r){let n=AJ.get(e);if(!n||n.from>=r||n.to<=t){let n=new AY(t,e.sliceString(t,r));return AJ.set(e,n),n}if(n.from==t&&n.to==r)return n;let{text:i,from:s}=n;return s>t&&(i=e.sliceString(t,s)+i,s=t),n.to<r&&(i+=e.sliceString(n.to,r)),AJ.set(e,new AY(s,i)),new AY(t,i.slice(t-s,r-s))}}class AX{constructor(e,t,r,n,i){this.text=e,this.to=i,this.done=!1,this.value=Aq,this.matchPos=AZ(e,n),this.re=new RegExp(t,AK+((null==r?void 0:r.ignoreCase)?"i":"")),this.test=null==r?void 0:r.test,this.flat=AY.get(e,n,this.chunkEnd(n+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let e=this.flat.from+t.index,r=e+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(e,r,t)))return this.value={from:e,to:r,match:t},this.matchPos=AZ(this.text,r+ +(e==r)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=AY.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+2*this.flat.text.length))}}}function AZ(e,t){if(t>=e.length)return t;let r=e.lineAt(t),n;for(;t<r.to&&(n=r.text.charCodeAt(t-r.from))>=56320&&n<57344;)t++;return t}function AQ(e){let t=AV("input",{class:"cm-textfield",name:"line",value:String(e.state.doc.lineAt(e.state.selection.main.head).number)});function r(){let r=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(t.value);if(!r)return;let{state:n}=e,i=n.doc.lineAt(n.selection.main.head),[,s,o,l,a]=r,c=l?+l.slice(1):0,h=o?+o:i.number;if(o&&a){let e=h/100;s&&(e=e*("-"==s?-1:1)+i.number/n.doc.lines),h=Math.round(n.doc.lines*e)}else o&&s&&(h=h*("-"==s?-1:1)+i.number);let u=n.doc.line(Math.max(1,Math.min(n.doc.lines,h))),d=pQ.cursor(u.from+Math.max(0,Math.min(c,u.length)));e.dispatch({effects:[A0.of(!1),v6.scrollIntoView(d.from,{y:"center"})],selection:d}),e.focus()}return{dom:AV("form",{class:"cm-gotoLine",onkeydown:t=>{27==t.keyCode?(t.preventDefault(),e.dispatch({effects:A0.of(!1)}),e.focus()):13==t.keyCode&&(t.preventDefault(),r())},onsubmit:e=>{e.preventDefault(),r()}},AV("label",e.state.phrase("Go to line"),": ",t)," ",AV("button",{class:"cm-button",type:"submit"},e.state.phrase("go")),AV("button",{name:"close",onclick:()=>{e.dispatch({effects:A0.of(!1)}),e.focus()},"aria-label":e.state.phrase("close"),type:"button"},["\xd7"]))}}"undefined"!=typeof Symbol&&(AG.prototype[Symbol.iterator]=AX.prototype[Symbol.iterator]=function(){return this});let A0=my.define(),A1=p8.define({create:()=>!0,update(e,t){for(let r of t.effects)r.is(A0)&&(e=r.value);return e},provide:e=>x8.from(e,e=>e?AQ:null)}),A2=v6.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px",position:"relative","& label":{fontSize:"80%"},"& [name=close]":{position:"absolute",top:"0",bottom:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:"0"}}}),A4={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},A3=p2.define({combine:e=>mE(e,A4,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}),A5=gH.mark({class:"cm-selectionMatch"}),A6=gH.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function A9(e,t,r,n){return(0==r||e(t.sliceDoc(r-1,r))!=mA.Word)&&(n==t.doc.length||e(t.sliceDoc(n,n+1))!=mA.Word)}let A8=yC.fromClass(class{constructor(e){this.decorations=this.getDeco(e)}update(e){(e.selectionSet||e.docChanged||e.viewportChanged)&&(this.decorations=this.getDeco(e.view))}getDeco(e){let t=e.state.facet(A3),{state:r}=e,n=r.selection;if(n.ranges.length>1)return gH.none;let i=n.main,s,o=null;if(i.empty){if(!t.highlightWordAroundCursor)return gH.none;let e=r.wordAt(i.head);if(!e)return gH.none;o=r.charCategorizer(i.head),s=r.sliceDoc(e.from,e.to)}else{let e=i.to-i.from;if(e<t.minSelectionLength||e>200)return gH.none;if(t.wholeWords){var l,a,c;if(s=r.sliceDoc(i.from,i.to),!(A9(o=r.charCategorizer(i.head),r,i.from,i.to)&&(l=o,a=i.from,c=i.to,l(r.sliceDoc(a,a+1))==mA.Word&&l(r.sliceDoc(c-1,c))==mA.Word)))return gH.none}else if(!(s=r.sliceDoc(i.from,i.to)))return gH.none}let h=[];for(let n of e.visibleRanges){let e=new AU(r.doc,s,n.from,n.to);for(;!e.next().done;){let{from:n,to:s}=e.value;if((!o||A9(o,r,n,s))&&(i.empty&&n<=i.from&&s>=i.to?h.push(A6.range(n,s)):(n>=i.to||s<=i.from)&&h.push(A5.range(n,s)),h.length>t.maxMatches))return gH.none}}return gH.set(h)}},{decorations:e=>e.decorations}),A7=v6.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),Se=p2.define({combine:e=>mE(e,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new SP(e),scrollToMatch:e=>v6.scrollIntoView(e)})});class St{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||function(e){try{return new RegExp(e,AK),!0}catch(e){return!1}}(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(e,t)=>"n"==t?"\n":"r"==t?"\r":"t"==t?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new Sa(this):new Si(this)}getCursor(e,t=0,r){let n=e.doc?e:mC.create({doc:e});return null==r&&(r=n.doc.length),this.regexp?Ss(this,n,t,r):Sn(this,n,t,r)}}class Sr{constructor(e){this.spec=e}}function Sn(e,t,r,n){var i,s;return new AU(t.doc,e.unquoted,r,n,e.caseSensitive?void 0:e=>e.toLowerCase(),e.wholeWord?(i=t.doc,s=t.charCategorizer(t.selection.main.head),(e,t,r,n)=>((n>e||n+r.length<t)&&(n=Math.max(0,e-2),r=i.sliceString(n,Math.min(i.length,t+2))),(s(So(r,e-n))!=mA.Word||s(Sl(r,e-n))!=mA.Word)&&(s(Sl(r,t-n))!=mA.Word||s(So(r,t-n))!=mA.Word))):void 0)}class Si extends Sr{constructor(e){super(e)}nextMatch(e,t,r){let n=Sn(this.spec,e,r,e.doc.length).nextOverlapping();if(n.done){let r=Math.min(e.doc.length,t+this.spec.unquoted.length);n=Sn(this.spec,e,0,r).nextOverlapping()}return n.done||n.value.from==t&&n.value.to==r?null:n.value}prevMatchInRange(e,t,r){for(let n=r;;){let r=Math.max(t,n-1e4-this.spec.unquoted.length),i=Sn(this.spec,e,r,n),s=null;for(;!i.nextOverlapping().done;)s=i.value;if(s)return s;if(r==t)return null;n-=1e4}}prevMatch(e,t,r){let n=this.prevMatchInRange(e,0,t);return n||(n=this.prevMatchInRange(e,Math.max(0,r-this.spec.unquoted.length),e.doc.length)),n&&(n.from!=t||n.to!=r)?n:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let r=Sn(this.spec,e,0,e.doc.length),n=[];for(;!r.next().done;){if(n.length>=t)return null;n.push(r.value)}return n}highlight(e,t,r,n){let i=Sn(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(r+this.spec.unquoted.length,e.doc.length));for(;!i.next().done;)n(i.value.from,i.value.to)}}function Ss(e,t,r,n){var i;return new AG(t.doc,e.search,{ignoreCase:!e.caseSensitive,test:e.wholeWord?(i=t.charCategorizer(t.selection.main.head),(e,t,r)=>!r[0].length||(i(So(r.input,r.index))!=mA.Word||i(Sl(r.input,r.index))!=mA.Word)&&(i(Sl(r.input,r.index+r[0].length))!=mA.Word||i(So(r.input,r.index+r[0].length))!=mA.Word)):void 0},r,n)}function So(e,t){return e.slice(pF(e,t,!1),t)}function Sl(e,t){return e.slice(t,pF(e,t))}class Sa extends Sr{nextMatch(e,t,r){let n=Ss(this.spec,e,r,e.doc.length).next();return n.done&&(n=Ss(this.spec,e,0,t).next()),n.done?null:n.value}prevMatchInRange(e,t,r){for(let n=1;;n++){let i=Math.max(t,r-1e4*n),s=Ss(this.spec,e,i,r),o=null;for(;!s.next().done;)o=s.value;if(o&&(i==t||o.from>i+10))return o;if(i==t)return null}}prevMatch(e,t,r){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,r,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(t,r)=>{if("&"==r)return e.match[0];if("$"==r)return"$";for(let t=r.length;t>0;t--){let n=+r.slice(0,t);if(n>0&&n<e.match.length)return e.match[n]+r.slice(t)}return t})}matchAll(e,t){let r=Ss(this.spec,e,0,e.doc.length),n=[];for(;!r.next().done;){if(n.length>=t)return null;n.push(r.value)}return n}highlight(e,t,r,n){let i=Ss(this.spec,e,Math.max(0,t-250),Math.min(r+250,e.doc.length));for(;!i.next().done;)n(i.value.from,i.value.to)}}let Sc=my.define(),Sh=my.define(),Su=p8.define({create:e=>new Sd(SA(e).create(),null),update(e,t){for(let r of t.effects)r.is(Sc)?e=new Sd(r.value.create(),e.panel):r.is(Sh)&&(e=new Sd(e.query,r.value?Sk:null));return e},provide:e=>x8.from(e,e=>e.panel)});class Sd{constructor(e,t){this.query=e,this.panel=t}}let Sf=gH.mark({class:"cm-searchMatch"}),Sp=gH.mark({class:"cm-searchMatch cm-searchMatch-selected"}),Sm=yC.fromClass(class{constructor(e){this.view=e,this.decorations=this.highlight(e.state.field(Su))}update(e){let t=e.state.field(Su);(t!=e.startState.field(Su)||e.docChanged||e.selectionSet||e.viewportChanged)&&(this.decorations=this.highlight(t))}highlight({query:e,panel:t}){if(!t||!e.spec.valid)return gH.none;let{view:r}=this,n=new mI;for(let t=0,i=r.visibleRanges,s=i.length;t<s;t++){let{from:o,to:l}=i[t];for(;t<s-1&&l>i[t+1].from-500;)l=i[++t].to;e.highlight(r.state,o,l,(e,t)=>{let i=r.state.selection.ranges.some(r=>r.from==e&&r.to==t);n.add(e,t,i?Sp:Sf)})}return n.finish()}},{decorations:e=>e.decorations});function Sg(e){return t=>{let r=t.state.field(Su,!1);return r&&r.query.spec.valid?e(t,r):SE(t)}}let Sy=Sg((e,{query:t})=>{let{to:r}=e.state.selection.main,n=t.nextMatch(e.state,r,r);if(!n)return!1;let i=pQ.single(n.from,n.to),s=e.state.facet(Se);return e.dispatch({selection:i,effects:[SI(e,n),s.scrollToMatch(i.main,e)],userEvent:"select.search"}),SC(e),!0}),Sv=Sg((e,{query:t})=>{let{state:r}=e,{from:n}=r.selection.main,i=t.prevMatch(r,n,n);if(!i)return!1;let s=pQ.single(i.from,i.to),o=e.state.facet(Se);return e.dispatch({selection:s,effects:[SI(e,i),o.scrollToMatch(s.main,e)],userEvent:"select.search"}),SC(e),!0}),Sx=Sg((e,{query:t})=>{let r=t.matchAll(e.state,1e3);return!!r&&!!r.length&&(e.dispatch({selection:pQ.create(r.map(e=>pQ.range(e.from,e.to))),userEvent:"select.search.matches"}),!0)}),Sb=Sg((e,{query:t})=>{let{state:r}=e,{from:n,to:i}=r.selection.main;if(r.readOnly)return!1;let s=t.nextMatch(r,n,n);if(!s)return!1;let o=s,l=[],a,c,h=[];o.from==n&&o.to==i&&(c=r.toText(t.getReplacement(o)),l.push({from:o.from,to:o.to,insert:c}),o=t.nextMatch(r,o.from,o.to),h.push(v6.announce.of(r.phrase("replaced match on line $",r.doc.lineAt(n).number)+".")));let u=e.state.changes(l);return o&&(a=pQ.single(o.from,o.to).map(u),h.push(SI(e,o)),h.push(r.facet(Se).scrollToMatch(a.main,e))),e.dispatch({changes:u,selection:a,effects:h,userEvent:"input.replace"}),!0}),Sw=Sg((e,{query:t})=>{if(e.state.readOnly)return!1;let r=t.matchAll(e.state,1e9).map(e=>{let{from:r,to:n}=e;return{from:r,to:n,insert:t.getReplacement(e)}});if(!r.length)return!1;let n=e.state.phrase("replaced $ matches",r.length)+".";return e.dispatch({changes:r,effects:v6.announce.of(n),userEvent:"input.replace.all"}),!0});function Sk(e){return e.state.facet(Se).createPanel(e)}function SA(e,t){var r,n,i,s,o;let l=e.selection.main,a=l.empty||l.to>l.from+100?"":e.sliceDoc(l.from,l.to);if(t&&!a)return t;let c=e.facet(Se);return new St({search:(null!=(r=null==t?void 0:t.literal)?r:c.literal)?a:a.replace(/\n/g,"\\n"),caseSensitive:null!=(n=null==t?void 0:t.caseSensitive)?n:c.caseSensitive,literal:null!=(i=null==t?void 0:t.literal)?i:c.literal,regexp:null!=(s=null==t?void 0:t.regexp)?s:c.regexp,wholeWord:null!=(o=null==t?void 0:t.wholeWord)?o:c.wholeWord})}function SS(e){let t=x3(e,Sk);return t&&t.dom.querySelector("[main-field]")}function SC(e){let t=SS(e);t&&t==e.root.activeElement&&t.select()}let SE=e=>{let t=e.state.field(Su,!1);if(t&&t.panel){let r=SS(e);if(r&&r!=e.root.activeElement){let n=SA(e.state,t.query.spec);n.valid&&e.dispatch({effects:Sc.of(n)}),r.focus(),r.select()}}else e.dispatch({effects:[Sh.of(!0),t?Sc.of(SA(e.state,t.query.spec)):my.appendConfig.of(SD)]});return!0},Sj=e=>{let t=e.state.field(Su,!1);if(!t||!t.panel)return!1;let r=x3(e,Sk);return r&&r.dom.contains(e.root.activeElement)&&e.focus(),e.dispatch({effects:Sh.of(!1)}),!0},SO=[{key:"Mod-f",run:SE,scope:"editor search-panel"},{key:"F3",run:Sy,shift:Sv,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:Sy,shift:Sv,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:Sj,scope:"editor search-panel"},{key:"Mod-Shift-l",run:({state:e,dispatch:t})=>{let r=e.selection;if(r.ranges.length>1||r.main.empty)return!1;let{from:n,to:i}=r.main,s=[],o=0;for(let t=new AU(e.doc,e.sliceDoc(n,i));!t.next().done;){if(s.length>1e3)return!1;t.value.from==n&&(o=s.length),s.push(pQ.range(t.value.from,t.value.to))}return t(e.update({selection:pQ.create(s,o),userEvent:"select.search.matches"})),!0}},{key:"Mod-Alt-g",run:e=>{let t=x3(e,AQ);if(!t){let r=[A0.of(!0)];null==e.state.field(A1,!1)&&r.push(my.appendConfig.of([A1,A2])),e.dispatch({effects:r}),t=x3(e,AQ)}return t&&t.dom.querySelector("input").select(),!0}},{key:"Mod-d",run:({state:e,dispatch:t})=>{let{ranges:r}=e.selection;if(r.some(e=>e.from===e.to))return(({state:e,dispatch:t})=>{let{selection:r}=e,n=pQ.create(r.ranges.map(t=>e.wordAt(t.head)||pQ.cursor(t.head)),r.mainIndex);return!n.eq(r)&&(t(e.update({selection:n})),!0)})({state:e,dispatch:t});let n=e.sliceDoc(r[0].from,r[0].to);if(e.selection.ranges.some(t=>e.sliceDoc(t.from,t.to)!=n))return!1;let i=function(e,t){let{main:r,ranges:n}=e.selection,i=e.wordAt(r.head),s=i&&i.from==r.from&&i.to==r.to;for(let r=!1,i=new AU(e.doc,t,n[n.length-1].to);;)if(i.next(),i.done){if(r)return null;i=new AU(e.doc,t,0,Math.max(0,n[n.length-1].from-1)),r=!0}else{if(r&&n.some(e=>e.from==i.value.from))continue;if(s){let t=e.wordAt(i.value.from);if(!t||t.from!=i.value.from||t.to!=i.value.to)continue}return i.value}}(e,n);return!!i&&(t(e.update({selection:e.selection.addRange(pQ.range(i.from,i.to),!1),effects:v6.scrollIntoView(i.to)})),!0)},preventDefault:!0}];class SP{constructor(e){this.view=e;let t=this.query=e.state.field(Su).query.spec;function r(e,t,r){return AV("button",{class:"cm-button",name:e,onclick:t,type:"button"},r)}this.commit=this.commit.bind(this),this.searchField=AV("input",{value:t.search,placeholder:SM(e,"Find"),"aria-label":SM(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=AV("input",{value:t.replace,placeholder:SM(e,"Replace"),"aria-label":SM(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=AV("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=AV("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=AV("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit}),this.dom=AV("div",{onkeydown:e=>this.keydown(e),class:"cm-search"},[this.searchField,r("next",()=>Sy(e),[SM(e,"next")]),r("prev",()=>Sv(e),[SM(e,"previous")]),r("select",()=>Sx(e),[SM(e,"all")]),AV("label",null,[this.caseField,SM(e,"match case")]),AV("label",null,[this.reField,SM(e,"regexp")]),AV("label",null,[this.wordField,SM(e,"by word")]),...e.state.readOnly?[]:[AV("br"),this.replaceField,r("replace",()=>Sb(e),[SM(e,"replace")]),r("replaceAll",()=>Sw(e),[SM(e,"replace all")])],AV("button",{name:"close",onclick:()=>Sj(e),"aria-label":SM(e,"close"),type:"button"},["\xd7"])])}commit(){let e=new St({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Sc.of(e)}))}keydown(e){var t;(t=this.view,xc(xo(t.state),e,t,"search-panel"))?e.preventDefault():13==e.keyCode&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?Sv:Sy)(this.view)):13==e.keyCode&&e.target==this.replaceField&&(e.preventDefault(),Sb(this.view))}update(e){for(let t of e.transactions)for(let e of t.effects)e.is(Sc)&&!e.value.eq(this.query)&&this.setQuery(e.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Se).top}}function SM(e,t){return e.state.phrase(t)}let ST=/[\s\.,:;?!]/;function SI(e,{from:t,to:r}){let n=e.state.doc.lineAt(t),i=e.state.doc.lineAt(r).to,s=Math.max(n.from,t-30),o=Math.min(i,r+30),l=e.state.sliceDoc(s,o);if(s!=n.from){for(let e=0;e<30;e++)if(!ST.test(l[e+1])&&ST.test(l[e])){l=l.slice(e);break}}if(o!=i){for(let e=l.length-1;e>l.length-30;e--)if(!ST.test(l[e-1])&&ST.test(l[e])){l=l.slice(0,e);break}}return v6.announce.of(`${e.state.phrase("current match")}. ${l} ${e.state.phrase("on line")} ${n.number}.`)}let S$=v6.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),SD=[Su,me.low(Sm),S$];class SR{constructor(e,t,r,n){this.state=e,this.pos=t,this.explicit=r,this.view=n,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let t=wm(this.state).resolveInner(this.pos,-1);for(;t&&0>e.indexOf(t.name);)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),r=Math.max(t.from,this.pos-250),n=t.text.slice(r-t.from,this.pos-t.from),i=n.search(S_(e,!1));return i<0?null:{from:r+i,to:this.pos,text:n.slice(i)}}get aborted(){return null==this.abortListeners}addEventListener(e,t,r){"abort"==e&&this.abortListeners&&(this.abortListeners.push(t),r&&r.onDocChange&&(this.abortOnDocChange=!0))}}function SN(e){let t=Object.keys(e).join(""),r=/\w/.test(t);return r&&(t=t.replace(/\w/g,"")),`[${r?"\\w":""}${t.replace(/[^\w\s]/g,"\\$&")}]`}class SL{constructor(e,t,r,n){this.completion=e,this.source=t,this.match=r,this.score=n}}function SF(e){return e.selection.main.from}function S_(e,t){var r;let{source:n}=e,i=t&&"^"!=n[0],s="$"!=n[n.length-1];return i||s?RegExp(`${i?"^":""}(?:${n})${s?"$":""}`,null!=(r=e.flags)?r:e.ignoreCase?"i":""):e}let SB=mp.define(),Sz=new WeakMap;function SW(e){if(!Array.isArray(e))return e;let t=Sz.get(e);return t||Sz.set(e,t=function(e){let t=e.map(e=>"string"==typeof e?{label:e}:e),[r,n]=t.every(e=>/^\w+$/.test(e.label))?[/\w*$/,/\w+$/]:function(e){let t=Object.create(null),r=Object.create(null);for(let{label:n}of e){t[n[0]]=!0;for(let e=1;e<n.length;e++)r[n[e]]=!0}let n=SN(t)+SN(r)+"*$";return[RegExp("^"+n),new RegExp(n)]}(t);return e=>{let i=e.matchBefore(n);return i||e.explicit?{from:i?i.from:e.pos,options:t,validFor:r}:null}}(e)),t}let SV=my.define(),SH=my.define();class SU{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let t=0;t<e.length;){let r=p_(e,t),n=pz(r);this.chars.push(r);let i=e.slice(t,t+n),s=i.toUpperCase();this.folded.push(p_(s==i?i.toLowerCase():s,0)),t+=n}this.astral=e.length!=this.chars.length}ret(e,t){return this.score=e,this.matched=t,this}match(e){if(0==this.pattern.length)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:t,folded:r,any:n,precise:i,byWord:s}=this;if(1==t.length){let n=p_(e,0),i=pz(n),s=i==e.length?0:-100;if(n==t[0]);else{if(n!=r[0])return null;s+=-200}return this.ret(s,[0,i])}let o=e.indexOf(this.pattern);if(0==o)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let l=t.length,a=0;if(o<0){for(let i=0,s=Math.min(e.length,200);i<s&&a<l;){let s=p_(e,i);(s==t[a]||s==r[a])&&(n[a++]=i),i+=pz(s)}if(a<l)return null}let c=0,h=0,u=!1,d=0,f=-1,p=-1,m=/[a-z]/.test(e),g=!0;for(let n=0,a=Math.min(e.length,200),y=0;n<a&&h<l;){let a=p_(e,n);o<0&&(c<l&&a==t[c]&&(i[c++]=n),d<l&&(a==t[d]||a==r[d]?(0==d&&(f=n),p=n+1,d++):d=0));let v,x=a<255?a>=48&&a<=57||a>=97&&a<=122?2:+(a>=65&&a<=90):(v=pB(a))!=v.toLowerCase()?1:2*(v!=v.toUpperCase());(!n||1==x&&m||0==y&&0!=x)&&(t[h]==a||r[h]==a&&(u=!0)?s[h++]=n:s.length&&(g=!1)),y=x,n+=pz(a)}return h==l&&0==s[0]&&g?this.result(-100+(u?-200:0),s,e):d==l&&0==f?this.ret(-200-e.length+(p==e.length?0:-100),[0,p]):o>-1?this.ret(-700-e.length,[o,o+this.pattern.length]):d==l?this.ret(-900-e.length,[f,p]):h==l?this.result(-100+(u?-200:0)+-700+(g?0:-1100),s,e):2==t.length?null:this.result((n[0]?-700:0)+-200+-1100,n,e)}result(e,t,r){let n=[],i=0;for(let e of t){let t=e+(this.astral?pz(p_(r,e)):1);i&&n[i-1]==e?n[i-1]=t:(n[i++]=e,n[i++]=t)}return this.ret(e-r.length,n)}}class Sq{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let t=e.slice(0,this.pattern.length),r=t==this.pattern?0:t.toLowerCase()==this.folded?-200:null;return null==r?null:(this.matched=[0,t.length],this.score=r+(e.length==this.pattern.length?0:-100),this)}}let SK=p2.define({combine:e=>mE(e,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:SJ,filterStrict:!1,compareCompletions:(e,t)=>e.label.localeCompare(t.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>r=>SG(e(r),t(r)),optionClass:(e,t)=>r=>SG(e(r),t(r)),addToOptions:(e,t)=>e.concat(t),filterStrict:(e,t)=>e||t})});function SG(e,t){return e?t?e+" "+t:e:t}function SJ(e,t,r,n,i,s){let o=e.textDirection==g2.RTL,l=o,a=!1,c="top",h,u,d=t.left-i.left,f=i.right-t.right,p=n.right-n.left,m=n.bottom-n.top;if(l&&d<Math.min(p,f)?l=!1:!l&&f<Math.min(p,d)&&(l=!0),p<=(l?d:f))h=Math.max(i.top,Math.min(r.top,i.bottom-m))-t.top,u=Math.min(400,l?d:f);else{a=!0,u=Math.min(400,(o?t.right:i.right-t.left)-30);let e=i.bottom-t.bottom;e>=m||e>t.top?h=r.bottom-t.top:(c="bottom",h=t.bottom-r.top)}let g=(t.bottom-t.top)/s.offsetHeight,y=(t.right-t.left)/s.offsetWidth;return{style:`${c}: ${h/g}px; max-width: ${u/y}px`,class:"cm-completionInfo-"+(a?o?"left-narrow":"right-narrow":l?"left":"right")}}function SY(e,t,r){if(e<=r)return{from:0,to:e};if(t<0&&(t=0),t<=e>>1){let e=Math.floor(t/r);return{from:e*r,to:(e+1)*r}}let n=Math.floor((e-t)/r);return{from:e-(n+1)*r,to:e-n*r}}class SX{constructor(e,t,r){this.view=e,this.stateField=t,this.applyCompletion=r,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:e=>this.placeInfo(e),key:this},this.space=null,this.currentClass="";let n=e.state.field(t),{options:i,selected:s}=n.open,o=e.state.facet(SK);this.optionContent=function(e){let t=e.addToOptions.slice();return e.icons&&t.push({render(e){let t=document.createElement("div");return t.classList.add("cm-completionIcon"),e.type&&t.classList.add(...e.type.split(/\s+/g).map(e=>"cm-completionIcon-"+e)),t.setAttribute("aria-hidden","true"),t},position:20}),t.push({render(e,t,r,n){let i=document.createElement("span");i.className="cm-completionLabel";let s=e.displayLabel||e.label,o=0;for(let e=0;e<n.length;){let t=n[e++],r=n[e++];t>o&&i.appendChild(document.createTextNode(s.slice(o,t)));let l=i.appendChild(document.createElement("span"));l.appendChild(document.createTextNode(s.slice(t,r))),l.className="cm-completionMatchedText",o=r}return o<s.length&&i.appendChild(document.createTextNode(s.slice(o))),i},position:50},{render(e){if(!e.detail)return null;let t=document.createElement("span");return t.className="cm-completionDetail",t.textContent=e.detail,t},position:80}),t.sort((e,t)=>e.position-t.position).map(e=>e.render)}(o),this.optionClass=o.optionClass,this.tooltipClass=o.tooltipClass,this.range=SY(i.length,s,o.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",r=>{let{options:n}=e.state.field(t).open;for(let t=r.target,i;t&&t!=this.dom;t=t.parentNode)if("LI"==t.nodeName&&(i=/-(\d+)$/.exec(t.id))&&+i[1]<n.length){this.applyCompletion(e,n[+i[1]]),r.preventDefault();return}}),this.dom.addEventListener("focusout",t=>{let r=e.state.field(this.stateField,!1);r&&r.tooltip&&e.state.facet(SK).closeOnBlur&&t.relatedTarget!=e.contentDOM&&e.dispatch({effects:SH.of(null)})}),this.showOptions(i,n.id)}mount(){this.updateSel()}showOptions(e,t){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,t,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var t;let r=e.state.field(this.stateField),n=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),r!=n){let{options:i,selected:s,disabled:o}=r.open;n.open&&n.open.options==i||(this.range=SY(i.length,s,e.state.facet(SK).maxRenderedOptions),this.showOptions(i,r.id)),this.updateSel(),o!=(null==(t=n.open)?void 0:t.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!o)}}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let e of this.currentClass.split(" "))e&&this.dom.classList.remove(e);for(let e of t.split(" "))e&&this.dom.classList.add(e);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;(t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=SY(t.options.length,t.selected,this.view.state.facet(SK).maxRenderedOptions),this.showOptions(t.options,e.id));let r=this.updateSelectedOption(t.selected);if(r){this.destroyInfo();let{completion:n}=t.options[t.selected],{info:i}=n;if(!i)return;let s="string"==typeof i?document.createTextNode(i):i(n);if(!s)return;"then"in s?s.then(t=>{t&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(t,n)}).catch(e=>yw(this.view.state,e,"completion info")):(this.addInfoPane(s,n),r.setAttribute("aria-describedby",this.info.id))}}addInfoPane(e,t){this.destroyInfo();let r=this.info=document.createElement("div");if(r.className="cm-tooltip cm-completionInfo",r.id="cm-completionInfo-"+Math.floor(65535*Math.random()).toString(16),null!=e.nodeType)r.appendChild(e),this.infoDestroy=null;else{let{dom:t,destroy:n}=e;r.appendChild(t),this.infoDestroy=n||null}this.dom.appendChild(r),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){var t,r;let n,i,s,o=null;for(let t=this.list.firstChild,r=this.range.from;t;t=t.nextSibling,r++)"LI"==t.nodeName&&t.id?r==e?t.hasAttribute("aria-selected")||(t.setAttribute("aria-selected","true"),o=t):t.hasAttribute("aria-selected")&&(t.removeAttribute("aria-selected"),t.removeAttribute("aria-describedby")):r--;return o&&(t=this.list,r=o,n=t.getBoundingClientRect(),i=r.getBoundingClientRect(),s=n.height/t.offsetHeight,i.top<n.top?t.scrollTop-=(n.top-i.top)/s:i.bottom>n.bottom&&(t.scrollTop+=(i.bottom-n.bottom)/s)),o}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),r=this.info.getBoundingClientRect(),n=e.getBoundingClientRect(),i=this.space;if(!i){let e=this.dom.ownerDocument.documentElement;i={left:0,top:0,right:e.clientWidth,bottom:e.clientHeight}}return n.top>Math.min(i.bottom,t.bottom)-10||n.bottom<Math.max(i.top,t.top)+10?null:this.view.state.facet(SK).positionInfo(this.view,t,n,r,i,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,t,r){let n=document.createElement("ul");n.id=t,n.setAttribute("role","listbox"),n.setAttribute("aria-expanded","true"),n.setAttribute("aria-label",this.view.state.phrase("Completions")),n.addEventListener("mousedown",e=>{e.target==n&&e.preventDefault()});let i=null;for(let s=r.from;s<r.to;s++){let{completion:o,match:l}=e[s],{section:a}=o;if(a){let e="string"==typeof a?a:a.name;e!=i&&(s>r.from||0==r.from)&&(i=e,"string"!=typeof a&&a.header?n.appendChild(a.header(a)):n.appendChild(document.createElement("completion-section")).textContent=e)}let c=n.appendChild(document.createElement("li"));c.id=t+"-"+s,c.setAttribute("role","option");let h=this.optionClass(o);for(let e of(h&&(c.className=h),this.optionContent)){let t=e(o,this.view.state,this.view,l);t&&c.appendChild(t)}}return r.from&&n.classList.add("cm-completionListIncompleteTop"),r.to<e.length&&n.classList.add("cm-completionListIncompleteBottom"),n}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function SZ(e){return 100*(e.boost||0)+10*!!e.apply+5*!!e.info+ +!!e.type}class SQ{constructor(e,t,r,n,i,s){this.options=e,this.attrs=t,this.tooltip=r,this.timestamp=n,this.selected=i,this.disabled=s}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new SQ(this.options,S4(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,r,n,i,s){if(n&&!s&&e.some(e=>e.isPending))return n.setDisabled();let o=function(e,t){let r=[],n=null,i=null,s=e=>{r.push(e);let{section:t}=e.completion;if(t){n||(n=[]);let e="string"==typeof t?t:t.name;n.some(t=>t.name==e)||n.push("string"==typeof t?{name:e}:t)}},o=t.facet(SK);for(let n of e)if(n.hasResult()){let e=n.result.getMatch;if(!1===n.result.filter)for(let t of n.result.options)s(new SL(t,n.source,e?e(t):[],1e9-r.length));else{let r=t.sliceDoc(n.from,n.to),l,a=o.filterStrict?new Sq(r):new SU(r);for(let t of n.result.options)if(l=a.match(t.label)){let r=t.displayLabel?e?e(t,l.matched):[]:l.matched,o=l.score+(t.boost||0);if(s(new SL(t,n.source,r,o)),"object"==typeof t.section&&"dynamic"===t.section.rank){let{name:e}=t.section;i||(i=Object.create(null)),i[e]=Math.max(o,i[e]||-1e9)}}}}if(n){let e=Object.create(null),t=0;for(let r of n.sort((e,t)=>("dynamic"===e.rank&&"dynamic"===t.rank?i[t.name]-i[e.name]:0)||("number"==typeof e.rank?e.rank:1e9)-("number"==typeof t.rank?t.rank:1e9)||(e.name<t.name?-1:1)))t-=1e5,e[r.name]=t;for(let t of r){let{section:r}=t.completion;r&&(t.score+=e["string"==typeof r?r:r.name])}}let l=[],a=null,c=o.compareCompletions;for(let e of r.sort((e,t)=>t.score-e.score||c(e.completion,t.completion))){let t=e.completion;a&&a.label==t.label&&a.detail==t.detail&&(null==a.type||null==t.type||a.type==t.type)&&a.apply==t.apply&&a.boost==t.boost?SZ(e.completion)>SZ(a)&&(l[l.length-1]=e):l.push(e),a=e.completion}return l}(e,t);if(!o.length)return n&&e.some(e=>e.isPending)?n.setDisabled():null;let l=t.facet(SK).selectOnOpen?0:-1;if(n&&n.selected!=l&&-1!=n.selected){let e=n.options[n.selected].completion;for(let t=0;t<o.length;t++)if(o[t].completion==e){l=t;break}}return new SQ(o,S4(r,l),{pos:e.reduce((e,t)=>t.hasResult()?Math.min(e,t.from):e,1e8),create:Cr,above:i.aboveCursor},n?n.timestamp:Date.now(),l,!1)}map(e){return new SQ(this.options,this.attrs,{...this.tooltip,pos:e.mapPos(this.tooltip.pos)},this.timestamp,this.selected,this.disabled)}setDisabled(){return new SQ(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class S0{constructor(e,t,r){this.active=e,this.id=t,this.open=r}static start(){return new S0(S3,"cm-ac-"+Math.floor(2e6*Math.random()).toString(36),null)}update(e){let{state:t}=e,r=t.facet(SK),n=(r.override||t.languageDataAt("autocomplete",SF(t)).map(SW)).map(t=>(this.active.find(e=>e.source==t)||new S6(t,+!!this.active.some(e=>0!=e.state))).update(e,r));n.length==this.active.length&&n.every((e,t)=>e==this.active[t])&&(n=this.active);let i=this.open,s=e.effects.some(e=>e.is(S8));for(let o of(i&&e.docChanged&&(i=i.map(e.changes)),e.selection||n.some(t=>t.hasResult()&&e.changes.touchesRange(t.from,t.to))||!function(e,t){if(e==t)return!0;for(let r=0,n=0;;){for(;r<e.length&&!e[r].hasResult();)r++;for(;n<t.length&&!t[n].hasResult();)n++;let i=r==e.length,s=n==t.length;if(i||s)return i==s;if(e[r++].result!=t[n++].result)return!1}}(n,this.active)||s?i=SQ.build(n,t,this.id,i,r,s):i&&i.disabled&&!n.some(e=>e.isPending)&&(i=null),!i&&n.every(e=>!e.isPending)&&n.some(e=>e.hasResult())&&(n=n.map(e=>e.hasResult()?new S6(e.source,0):e)),e.effects))o.is(S7)&&(i=i&&i.setSelected(o.value,this.id));return n==this.active&&i==this.open?this:new S0(n,this.id,i)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?S1:S2}}let S1={"aria-autocomplete":"list"},S2={};function S4(e,t){let r={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":e};return t>-1&&(r["aria-activedescendant"]=e+"-"+t),r}let S3=[];function S5(e,t){if(e.isUserEvent("input.complete")){let r=e.annotation(SB);if(r&&t.activateOnCompletion(r))return 12}let r=e.isUserEvent("input.type");return r&&t.activateOnTyping?5:r?1:e.isUserEvent("delete.backward")?2:e.selection?8:16*!!e.docChanged}class S6{constructor(e,t,r=!1){this.source=e,this.state=t,this.explicit=r}hasResult(){return!1}get isPending(){return 1==this.state}update(e,t){let r=S5(e,t),n=this;for(let t of((8&r||16&r&&this.touches(e))&&(n=new S6(n.source,0)),4&r&&0==n.state&&(n=new S6(this.source,1)),n=n.updateFor(e,r),e.effects))if(t.is(SV))n=new S6(n.source,1,t.value);else if(t.is(SH))n=new S6(n.source,0);else if(t.is(S8))for(let e of t.value)e.source==n.source&&(n=e);return n}updateFor(e,t){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(SF(e.state))}}class S9 extends S6{constructor(e,t,r,n,i,s){super(e,3,t),this.limit=r,this.result=n,this.from=i,this.to=s}hasResult(){return!0}updateFor(e,t){var r;if(!(3&t))return this.map(e.changes);let n=this.result;n.map&&!e.changes.empty&&(n=n.map(n,e.changes));let i=e.changes.mapPos(this.from),s=e.changes.mapPos(this.to,1),o=SF(e.state);if(o>s||!n||2&t&&(SF(e.startState)==this.from||o<this.limit))return new S6(this.source,4&t?1:0);let l=e.changes.mapPos(this.limit);return!function(e,t,r,n){if(!e)return!1;let i=t.sliceDoc(r,n);return"function"==typeof e?e(i,r,n,t):S_(e,!0).test(i)}(n.validFor,e.state,i,s)?n.update&&(n=n.update(n,i,s,new SR(e.state,o,!1)))?new S9(this.source,this.explicit,l,n,n.from,null!=(r=n.to)?r:SF(e.state)):new S6(this.source,1,this.explicit):new S9(this.source,this.explicit,l,n,i,s)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new S9(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new S6(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}let S8=my.define({map:(e,t)=>e.map(e=>e.map(t))}),S7=my.define(),Ce=p8.define({create:()=>S0.start(),update:(e,t)=>e.update(t),provide:e=>[xY.from(e,e=>e.tooltip),v6.contentAttributes.from(e,e=>e.attrs)]});function Ct(e,t){let r=t.completion.apply||t.completion.label,n=e.state.field(Ce).active.find(e=>e.source==t.source);return n instanceof S9&&("string"==typeof r?e.dispatch({...function(e,t,r,n){let{main:i}=e.selection,s=r-i.from,o=n-i.from;return{...e.changeByRange(l=>{if(l!=i&&r!=n&&e.sliceDoc(l.from+s,l.from+o)!=e.sliceDoc(r,n))return{range:l};let a=e.toText(t);return{changes:{from:l.from+s,to:n==i.from?l.to:l.from+o,insert:a},range:pQ.cursor(l.from+s+a.length)}}),scrollIntoView:!0,userEvent:"input.complete"}}(e.state,r,n.from,n.to),annotations:SB.of(t.completion)}):r(e,t.completion,n.from,n.to),!0)}let Cr=e=>new SX(e,Ce,Ct);function Cn(e,t="option"){return r=>{let n=r.state.field(Ce,!1);if(!n||!n.open||n.open.disabled||Date.now()-n.open.timestamp<r.state.facet(SK).interactionDelay)return!1;let i=1,s;"page"==t&&(s=x1(r,n.open.tooltip))&&(i=Math.max(2,Math.floor(s.dom.offsetHeight/s.dom.querySelector("li").offsetHeight)-1));let{length:o}=n.open.options,l=n.open.selected>-1?n.open.selected+i*(e?1:-1):e?0:o-1;return l<0?l="page"==t?0:o-1:l>=o&&(l="page"==t?o-1:0),r.dispatch({effects:S7.of(l)}),!0}}let Ci=e=>!!e.state.field(Ce,!1)&&(e.dispatch({effects:SV.of(!0)}),!0);class Cs{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}let Co=yC.fromClass(class{constructor(e){for(let t of(this.view=e,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0,e.state.field(Ce).active))t.isPending&&this.startQuery(t)}update(e){let t=e.state.field(Ce),r=e.state.facet(SK);if(!e.selectionSet&&!e.docChanged&&e.startState.field(Ce)==t)return;let n=e.transactions.some(e=>{let t=S5(e,r);return 8&t||(e.selection||e.docChanged)&&!(3&t)});for(let t=0;t<this.running.length;t++){let r=this.running[t];if(n||r.context.abortOnDocChange&&e.docChanged||r.updates.length+e.transactions.length>50&&Date.now()-r.time>1e3){for(let e of r.context.abortListeners)try{e()}catch(e){yw(this.view.state,e)}r.context.abortListeners=null,this.running.splice(t--,1)}else r.updates.push(...e.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),e.transactions.some(e=>e.effects.some(e=>e.is(SV)))&&(this.pendingStart=!0);let i=this.pendingStart?50:r.activateOnTypingDelay;if(this.debounceUpdate=t.active.some(e=>e.isPending&&!this.running.some(t=>t.active.source==e.source))?setTimeout(()=>this.startUpdate(),i):-1,0!=this.composing)for(let t of e.transactions)t.isUserEvent("input.type")?this.composing=2:2==this.composing&&t.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:e}=this.view,t=e.field(Ce);for(let e of t.active)e.isPending&&!this.running.some(t=>t.active.source==e.source)&&this.startQuery(e);this.running.length&&t.open&&t.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(SK).updateSyncTime))}startQuery(e){let{state:t}=this.view,r=SF(t),n=new SR(t,r,e.explicit,this.view),i=new Cs(e,n);this.running.push(i),Promise.resolve(e.source(n)).then(e=>{i.context.aborted||(i.done=e||null,this.scheduleAccept())},e=>{this.view.dispatch({effects:SH.of(null)}),yw(this.view.state,e)})}scheduleAccept(){this.running.every(e=>void 0!==e.done)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(SK).updateSyncTime))}accept(){var e;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let t=[],r=this.view.state.facet(SK),n=this.view.state.field(Ce);for(let i=0;i<this.running.length;i++){let s=this.running[i];if(void 0===s.done)continue;if(this.running.splice(i--,1),s.done){let n=SF(s.updates.length?s.updates[0].startState:this.view.state),i=Math.min(n,s.done.from+ +!s.active.explicit),o=new S9(s.active.source,s.active.explicit,i,s.done,s.done.from,null!=(e=s.done.to)?e:n);for(let e of s.updates)o=o.update(e,r);if(o.hasResult()){t.push(o);continue}}let o=n.active.find(e=>e.source==s.active.source);if(o&&o.isPending)if(null==s.done){let e=new S6(s.active.source,0);for(let t of s.updates)e=e.update(t,r);e.isPending||t.push(e)}else this.startQuery(o)}(t.length||n.open&&n.open.disabled)&&this.view.dispatch({effects:S8.of(t)})}},{eventHandlers:{blur(e){let t=this.view.state.field(Ce,!1);if(t&&t.tooltip&&this.view.state.facet(SK).closeOnBlur){let r=t.open&&x1(this.view,t.open.tooltip);r&&r.dom.contains(e.relatedTarget)||setTimeout(()=>this.view.dispatch({effects:SH.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){3==this.composing&&setTimeout(()=>this.view.dispatch({effects:SV.of(!1)}),20),this.composing=0}}}),Cl="object"==typeof navigator&&/Win/.test(navigator.platform),Ca=me.highest(v6.domEventHandlers({keydown(e,t){let r=t.state.field(Ce,!1);if(!r||!r.open||r.open.disabled||r.open.selected<0||e.key.length>1||e.ctrlKey&&!(Cl&&e.altKey)||e.metaKey)return!1;let n=r.open.options[r.open.selected],i=r.active.find(e=>e.source==n.source),s=n.completion.commitCharacters||i.result.commitCharacters;return s&&s.indexOf(e.key)>-1&&Ct(t,n),!1}})),Cc=v6.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"\xb7\xb7\xb7"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"'\uD835\uDC65'"}},".cm-completionIcon-constant":{"&:after":{content:"'\uD835\uDC36'"}},".cm-completionIcon-type":{"&:after":{content:"'\uD835\uDC61'"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"'\uD83D\uDD11'"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),Ch={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},Cu=my.define({map(e,t){let r=t.mapPos(e,-1,pV.TrackAfter);return null==r?void 0:r}}),Cd=new class extends mj{};Cd.startSide=1,Cd.endSide=-1;let Cf=p8.define({create:()=>mT.empty,update(e,t){if(e=e.map(t.changes),t.selection){let r=t.state.doc.lineAt(t.selection.main.head);e=e.update({filter:e=>e>=r.from&&e<=r.to})}for(let r of t.effects)r.is(Cu)&&(e=e.update({add:[Cd.range(r.value,r.value+1)]}));return e}}),Cp="()[]{}<>\xab\xbb\xbb\xab";function Cm(e){for(let t=0;t<Cp.length;t+=2)if(Cp.charCodeAt(t)==e)return Cp.charAt(t+1);return pB(e<128?e:e+1)}function Cg(e,t){return e.languageDataAt("closeBrackets",t)[0]||Ch}let Cy="object"==typeof navigator&&/Android\b/.test(navigator.userAgent),Cv=v6.inputHandler.of((e,t,r,n)=>{if((Cy?e.composing:e.compositionStarted)||e.state.readOnly)return!1;let i=e.state.selection.main;if(n.length>2||2==n.length&&1==pz(p_(n,0))||t!=i.from||r!=i.to)return!1;let s=function(e,t){let r=Cg(e,e.selection.main.head),n=r.brackets||Ch.brackets;for(let i of n){let s=Cm(p_(i,0));if(t==i)return s==i?function(e,t,r,n){let i=n.stringPrefixes||Ch.stringPrefixes,s=null,o=e.changeByRange(n=>{if(!n.empty)return{changes:[{insert:t,from:n.from},{insert:t,from:n.to}],effects:Cu.of(n.to+t.length),range:pQ.range(n.anchor+t.length,n.head+t.length)};let o=n.head,l=Cw(e.doc,o),a;if(l==t){if(Ck(e,o))return{changes:{insert:t+t,from:o},effects:Cu.of(o+t.length),range:pQ.cursor(o+t.length)};else if(Cb(e,o)){let n=r&&e.sliceDoc(o,o+3*t.length)==t+t+t?t+t+t:t;return{changes:{from:o,to:o+n.length,insert:n},range:pQ.cursor(o+n.length)}}}else if(r&&e.sliceDoc(o-2*t.length,o)==t+t&&(a=CA(e,o-2*t.length,i))>-1&&Ck(e,a))return{changes:{insert:t+t+t+t,from:o},effects:Cu.of(o+t.length),range:pQ.cursor(o+t.length)};else if(e.charCategorizer(o)(l)!=mA.Word&&CA(e,o,i)>-1&&!function(e,t,r,n){let i=wm(e).resolveInner(t,-1),s=n.reduce((e,t)=>Math.max(e,t.length),0);for(let o=0;o<5;o++){let o=e.sliceDoc(i.from,Math.min(i.to,i.from+r.length+s)),l=o.indexOf(r);if(!l||l>-1&&n.indexOf(o.slice(0,l))>-1){let t=i.firstChild;for(;t&&t.from==i.from&&t.to-t.from>r.length+l;){if(e.sliceDoc(t.to-r.length,t.to)==r)return!1;t=t.firstChild}return!0}let a=i.to==t&&i.parent;if(!a)break;i=a}return!1}(e,o,t,i))return{changes:{insert:t+t,from:o},effects:Cu.of(o+t.length),range:pQ.cursor(o+t.length)};return{range:s=n}});return s?null:e.update(o,{scrollIntoView:!0,userEvent:"input.type"})}(e,i,n.indexOf(i+i+i)>-1,r):function(e,t,r,n){let i=null,s=e.changeByRange(s=>{if(!s.empty)return{changes:[{insert:t,from:s.from},{insert:r,from:s.to}],effects:Cu.of(s.to+t.length),range:pQ.range(s.anchor+t.length,s.head+t.length)};let o=Cw(e.doc,s.head);return!o||/\s/.test(o)||n.indexOf(o)>-1?{changes:{insert:t+r,from:s.head},effects:Cu.of(s.head+t.length),range:pQ.cursor(s.head+t.length)}:{range:i=s}});return i?null:e.update(s,{scrollIntoView:!0,userEvent:"input.type"})}(e,i,s,r.before||Ch.before);if(t==s&&Cb(e,e.selection.main.from))return function(e,t,r){let n=null,i=e.changeByRange(t=>t.empty&&Cw(e.doc,t.head)==r?{changes:{from:t.head,to:t.head+r.length,insert:r},range:pQ.cursor(t.head+r.length)}:n={range:t});return n?null:e.update(i,{scrollIntoView:!0,userEvent:"input.type"})}(e,0,s)}return null}(e.state,n);return!!s&&(e.dispatch(s),!0)}),Cx=[{key:"Backspace",run:({state:e,dispatch:t})=>{if(e.readOnly)return!1;let r=Cg(e,e.selection.main.head).brackets||Ch.brackets,n=null,i=e.changeByRange(t=>{if(t.empty){var i,s;let n,o=(i=e.doc,s=t.head,pz(p_(n=i.sliceString(s-2,s),0))==n.length?n:n.slice(1));for(let n of r)if(n==o&&Cw(e.doc,t.head)==Cm(p_(n,0)))return{changes:{from:t.head-n.length,to:t.head+n.length},range:pQ.cursor(t.head-n.length)}}return{range:n=t}});return n||t(e.update(i,{scrollIntoView:!0,userEvent:"delete.backward"})),!n}}];function Cb(e,t){let r=!1;return e.field(Cf).between(0,e.doc.length,e=>{e==t&&(r=!0)}),r}function Cw(e,t){let r=e.sliceString(t,t+2);return r.slice(0,pz(p_(r,0)))}function Ck(e,t){let r=wm(e).resolveInner(t+1);return r.parent&&r.from==t}function CA(e,t,r){let n=e.charCategorizer(t);if(n(e.sliceDoc(t-1,t))!=mA.Word)return t;for(let i of r){let r=t-i.length;if(e.sliceDoc(r,t)==i&&n(e.sliceDoc(r-1,r))!=mA.Word)return r}return -1}let CS=[{key:"Ctrl-Space",run:Ci},{mac:"Alt-`",run:Ci},{mac:"Alt-i",run:Ci},{key:"Escape",run:e=>{let t=e.state.field(Ce,!1);return!!t&&!!t.active.some(e=>0!=e.state)&&(e.dispatch({effects:SH.of(null)}),!0)}},{key:"ArrowDown",run:Cn(!0)},{key:"ArrowUp",run:Cn(!1)},{key:"PageDown",run:Cn(!0,"page")},{key:"PageUp",run:Cn(!1,"page")},{key:"Enter",run:e=>{let t=e.state.field(Ce,!1);return!(e.state.readOnly||!t||!t.open||t.open.selected<0||t.open.disabled||Date.now()-t.open.timestamp<e.state.facet(SK).interactionDelay)&&Ct(e,t.open.options[t.open.selected])}}],CC=me.highest(xi.computeN([SK],e=>e.facet(SK).defaultKeymap?[CS]:[]));class CE{constructor(e,t,r){this.from=e,this.to=t,this.diagnostic=r}}class Cj{constructor(e,t,r){this.diagnostics=e,this.panel=t,this.selected=r}static init(e,t,r){let n=r.facet(CN).markerFilter;n&&(e=n(e,r));let i=e.slice().sort((e,t)=>e.from-t.from||e.to-t.to),s=new mI,o=[],l=0,a=r.doc.iter(),c=0,h=r.doc.length;for(let e=0;;){let t,r,n=e==i.length?null:i[e];if(!n&&!o.length)break;if(o.length)t=l,r=o.reduce((e,t)=>Math.min(e,t.to),n&&n.from>t?n.from:1e8);else{if((t=n.from)>h)break;r=n.to,o.push(n),e++}for(;e<i.length;){let n=i[e];if(n.from==t&&(n.to>n.from||n.to==t))o.push(n),e++,r=Math.min(n.to,r);else{r=Math.min(n.from,r);break}}r=Math.min(r,h);let u=!1;if(o.some(e=>e.from==t&&(e.to==r||r==h))&&!(u=t==r)&&r-t<10){let e=t-(c+a.value.length);e>0&&(a.next(e),c=t);for(let e=t;;){if(e>=r){u=!0;break}if(!a.lineBreak&&c+a.value.length>e)break;e=c+a.value.length,c+=a.value.length,a.next()}}let d=function(e){let t="hint",r=1;for(let i of e){var n;let e="error"==(n=i.severity)?4:"warning"==n?3:"info"==n?2:1;e>r&&(r=e,t=i.severity)}return t}(o);if(u)s.add(t,t,gH.widget({widget:new CB(d),diagnostics:o.slice()}));else{let e=o.reduce((e,t)=>t.markClass?e+" "+t.markClass:e,"");s.add(t,r,gH.mark({class:"cm-lintRange cm-lintRange-"+d+e,diagnostics:o.slice(),inclusiveEnd:o.some(e=>e.to>r)}))}if((l=r)==h)break;for(let e=0;e<o.length;e++)o[e].to<=l&&o.splice(e--,1)}let u=s.finish();return new Cj(u,t,CO(u))}}function CO(e,t=null,r=0){let n=null;return e.between(r,1e9,(e,r,{spec:i})=>{if(!(t&&0>i.diagnostics.indexOf(t)))if(n){if(0>i.diagnostics.indexOf(n.diagnostic))return!1;n=new CE(n.from,r,n.diagnostic)}else n=new CE(e,r,t||i.diagnostics[0])}),n}let CP=my.define(),CM=my.define(),CT=my.define(),CI=p8.define({create:()=>new Cj(gH.none,null,null),update(e,t){if(t.docChanged&&e.diagnostics.size){let r=e.diagnostics.map(t.changes),n=null,i=e.panel;if(e.selected){let i=t.changes.mapPos(e.selected.from,1);n=CO(r,e.selected.diagnostic,i)||CO(r,null,i)}!r.size&&i&&t.state.facet(CN).autoPanel&&(i=null),e=new Cj(r,i,n)}for(let r of t.effects)if(r.is(CP)){let n=t.state.facet(CN).autoPanel?r.value.length?CW.open:null:e.panel;e=Cj.init(r.value,n,t.state)}else r.is(CM)?e=new Cj(e.diagnostics,r.value?CW.open:null,e.selected):r.is(CT)&&(e=new Cj(e.diagnostics,e.panel,r.value));return e},provide:e=>[x8.from(e,e=>e.panel),v6.decorations.from(e,e=>e.diagnostics)]}),C$=gH.mark({class:"cm-lintRange cm-lintRange-active"}),CD=e=>{let t=e.state.field(CI,!1);return!!t&&!!t.panel&&(e.dispatch({effects:CM.of(!1)}),!0)},CR=[{key:"Mod-Shift-m",run:e=>{var t,r;let n=e.state.field(CI,!1);n&&n.panel||e.dispatch({effects:(t=e.state,r=[CM.of(!0)],t.field(CI,!1)?r:r.concat(my.appendConfig.of(CU)))});let i=x3(e,CW.open);return i&&i.dom.querySelector(".cm-panel-lint ul").focus(),!0},preventDefault:!0},{key:"F8",run:e=>{let t=e.state.field(CI,!1);if(!t)return!1;let r=e.state.selection.main,n=t.diagnostics.iter(r.to+1);return(!!n.value||!!(n=t.diagnostics.iter(0)).value&&(n.from!=r.from||n.to!=r.to))&&(e.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0}),!0)}}],CN=p2.define({combine:e=>({sources:e.map(e=>e.source).filter(e=>null!=e),...mE(e.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{delay:Math.max,markerFilter:CL,tooltipFilter:CL,needsRefresh:(e,t)=>e?t?r=>e(r)||t(r):e:t,hideOn:(e,t)=>e?t?(r,n,i)=>e(r,n,i)||t(r,n,i):e:t,autoPanel:(e,t)=>e||t})})});function CL(e,t){return e?t?(r,n)=>t(e(r,n),n):e:t}function CF(e){let t=[];if(e)n:for(let{name:r}of e){for(let e=0;e<r.length;e++){let n=r[e];if(/[a-zA-Z]/.test(n)&&!t.some(e=>e.toLowerCase()==n.toLowerCase())){t.push(n);continue n}}t.push("")}return t}function C_(e,t,r){var n;let i=r?CF(t.actions):[];return AV("li",{class:"cm-diagnostic cm-diagnostic-"+t.severity},AV("span",{class:"cm-diagnosticText"},t.renderMessage?t.renderMessage(e):t.message),null==(n=t.actions)?void 0:n.map((r,n)=>{let s=!1,o=n=>{if(n.preventDefault(),s)return;s=!0;let i=CO(e.state.field(CI).diagnostics,t);i&&r.apply(e,i.from,i.to)},{name:l}=r,a=i[n]?l.indexOf(i[n]):-1,c=a<0?l:[l.slice(0,a),AV("u",l.slice(a,a+1)),l.slice(a+1)];return AV("button",{type:"button",class:"cm-diagnosticAction"+(r.markClass?" "+r.markClass:""),onclick:o,onmousedown:o,"aria-label":` Action: ${l}${a<0?"":` (access key "${i[n]})"`}.`},c)}),t.source&&AV("div",{class:"cm-diagnosticSource"},t.source))}class CB extends gW{constructor(e){super(),this.sev=e}eq(e){return e.sev==this.sev}toDOM(){return AV("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class Cz{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(0xffffffff*Math.random()).toString(16),this.dom=C_(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class CW{constructor(e){this.view=e,this.items=[];let t=t=>{if(27==t.keyCode)CD(this.view),this.view.focus();else if(38==t.keyCode||33==t.keyCode)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(40==t.keyCode||34==t.keyCode)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(36==t.keyCode)this.moveSelection(0);else if(35==t.keyCode)this.moveSelection(this.items.length-1);else if(13==t.keyCode)this.view.focus();else{if(!(t.keyCode>=65)||!(t.keyCode<=90)||!(this.selectedIndex>=0))return;let{diagnostic:r}=this.items[this.selectedIndex],n=CF(r.actions);for(let i=0;i<n.length;i++)if(n[i].toUpperCase().charCodeAt(0)==t.keyCode){let t=CO(this.view.state.field(CI).diagnostics,r);t&&r.actions[i].apply(e,t.from,t.to)}}t.preventDefault()},r=e=>{for(let t=0;t<this.items.length;t++)this.items[t].dom.contains(e.target)&&this.moveSelection(t)};this.list=AV("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:r}),this.dom=AV("div",{class:"cm-panel-lint"},this.list,AV("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>CD(this.view)},"\xd7")),this.update()}get selectedIndex(){let e=this.view.state.field(CI).selected;if(!e)return -1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return -1}update(){let{diagnostics:e,selected:t}=this.view.state.field(CI),r=0,n=!1,i=null,s=new Set;for(e.between(0,this.view.state.doc.length,(e,o,{spec:l})=>{for(let e of l.diagnostics){if(s.has(e))continue;s.add(e);let o=-1,l;for(let t=r;t<this.items.length;t++)if(this.items[t].diagnostic==e){o=t;break}o<0?(l=new Cz(this.view,e),this.items.splice(r,0,l),n=!0):(l=this.items[o],o>r&&(this.items.splice(r,o-r),n=!0)),t&&l.diagnostic==t.diagnostic?l.dom.hasAttribute("aria-selected")||(l.dom.setAttribute("aria-selected","true"),i=l):l.dom.hasAttribute("aria-selected")&&l.dom.removeAttribute("aria-selected"),r++}});r<this.items.length&&!(1==this.items.length&&this.items[0].diagnostic.from<0);)n=!0,this.items.pop();0==this.items.length&&(this.items.push(new Cz(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),n=!0),i?(this.list.setAttribute("aria-activedescendant",i.id),this.view.requestMeasure({key:this,read:()=>({sel:i.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:e,panel:t})=>{let r=t.height/this.list.offsetHeight;e.top<t.top?this.list.scrollTop-=(t.top-e.top)/r:e.bottom>t.bottom&&(this.list.scrollTop+=(e.bottom-t.bottom)/r)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),n&&this.sync()}sync(){let e=this.list.firstChild;function t(){let t=e;e=t.nextSibling,t.remove()}for(let r of this.items)if(r.dom.parentNode==this.list){for(;e!=r.dom;)t();e=r.dom.nextSibling}else this.list.insertBefore(r.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=CO(this.view.state.field(CI).diagnostics,this.items[e].diagnostic);t&&this.view.dispatch({selection:{anchor:t.from,head:t.to},scrollIntoView:!0,effects:CT.of(t)})}static open(e){return new CW(e)}}function CV(e){return function(e,t='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${t}>${encodeURIComponent(e)}</svg>')`}(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${e}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}let CH=v6.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:CV("#d11")},".cm-lintRange-warning":{backgroundImage:CV("orange")},".cm-lintRange-info":{backgroundImage:CV("#999")},".cm-lintRange-hint":{backgroundImage:CV("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),CU=[CI,v6.decorations.compute([CI],e=>{let{selected:t,panel:r}=e.field(CI);return t&&r&&t.from!=t.to?gH.set([C$.range(t.from,t.to)]):gH.none}),function(e,t={}){let r=my.define(),n=p8.define({create:()=>[],update(e,n){if(e.length&&(t.hideOnChange&&(n.docChanged||n.selection)?e=[]:t.hideOn&&(e=e.filter(e=>!t.hideOn(n,e))),n.docChanged)){let t=[];for(let r of e){let e=n.changes.mapPos(r.pos,-1,pV.TrackDel);if(null!=e){let i=Object.assign(Object.create(null),r);i.pos=e,null!=i.end&&(i.end=n.changes.mapPos(i.end)),t.push(i)}}e=t}for(let t of n.effects)t.is(r)&&(e=t.value),t.is(x2)&&(e=[]);return e},provide:e=>xX.from(e)});return{active:n,extension:[n,yC.define(i=>new x0(i,e,n,r,t.hoverTime||300)),xQ]}}(function(e,t,r){let{diagnostics:n}=e.state.field(CI),i,s=-1,o=-1;n.between(t-(r<0),t+ +(r>0),(e,n,{spec:l})=>{if(t>=e&&t<=n&&(e==n||(t>e||r>0)&&(t<n||r<0)))return i=l.diagnostics,s=e,o=n,!1});let l=e.state.facet(CN).tooltipFilter;return(i&&l&&(i=l(i,e.state)),i)?{pos:s,end:o,above:e.state.doc.lineAt(s).to<o,create:()=>{var t;return{dom:(t=e,AV("ul",{class:"cm-tooltip-lint"},i.map(e=>C_(t,e,!1))))}}}:null},{hideOn:function(e,t){let r=t.pos,n=t.end||r,i=e.state.facet(CN).hideOn(e,r,n);if(null!=i)return i;let s=e.startState.doc.lineAt(t.pos);return!!(e.effects.some(e=>e.is(CP))||e.changes.touchesRange(s.from,Math.max(s.to,n)))}}),CH];var Cq=function(e){let t;void 0===e&&(e={});var{crosshairCursor:r=!1}=e,n=[];!1!==e.closeBracketsKeymap&&(n=n.concat(Cx)),!1!==e.defaultKeymap&&(n=n.concat(Az)),!1!==e.searchKeymap&&(n=n.concat(SO)),!1!==e.historyKeymap&&(n=n.concat(kQ)),!1!==e.foldKeymap&&(n=n.concat(wK)),!1!==e.completionKeymap&&(n=n.concat(CS)),!1!==e.lintKeymap&&(n=n.concat(CR));var i=[];return!1!==e.lineNumbers&&i.push(function(e={}){return[bp.of(e),bs(),by]}()),!1!==e.highlightActiveLineGutter&&i.push(bb),!1!==e.highlightSpecialChars&&i.push(function(e={}){return[xT.of(e),xI||(xI=yC.fromClass(class{constructor(e){this.view=e,this.decorations=gH.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(e.state.facet(xT)),this.decorations=this.decorator.createDeco(e)}makeDecorator(e){return new xE({regexp:e.specialChars,decoration:(t,r,n)=>{let{doc:i}=r.state,s=p_(t[0],0);if(9==s){let e=i.lineAt(n),t=r.state.tabSize,s=mV(e.text,t,n-e.from);return gH.replace({widget:new xD((t-s%t)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[s]||(this.decorationCache[s]=gH.replace({widget:new x$(e,s)}))},boundary:e.replaceTabs?void 0:/[^]/})}update(e){let t=e.state.facet(xT);e.startState.facet(xT)!=t?(this.decorator=this.makeDecorator(t),this.decorations=this.decorator.createDeco(e.view)):this.decorations=this.decorator.updateDeco(e,this.decorations)}},{decorations:e=>e.decorations}))]}()),!1!==e.history&&i.push(function(e={}){return[k_,kF.of(e),v6.domEventHandlers({beforeinput(e,t){let r="historyUndo"==e.inputType?kz:"historyRedo"==e.inputType?kW:null;return!!r&&(e.preventDefault(),r(t))}})]}()),!1!==e.foldGutter&&i.push(function(e={}){var t;let r={...w0,...e},n=new w1(r,!0),i=new w1(r,!1),s=yC.fromClass(class{constructor(e){this.from=e.viewport.from,this.markers=this.buildMarkers(e)}update(e){(e.docChanged||e.viewportChanged||e.startState.facet(wS)!=e.state.facet(wS)||e.startState.field(wW,!1)!=e.state.field(wW,!1)||wm(e.startState)!=wm(e.state)||r.foldingChanged(e))&&(this.markers=this.buildMarkers(e.view))}buildMarkers(e){let t=new mI;for(let r of e.viewportLineBlocks){let s=wH(e.state,r.from,r.to)?i:wL(e.state,r.from,r.to)?n:null;s&&t.add(r.from,r.from,s)}return t.finish()}}),{domEventHandlers:o}=r;return[s,(t={class:"cm-foldGutter",markers(e){var t;return(null==(t=e.plugin(s))?void 0:t.markers)||mT.empty},initialSpacer:()=>new w1(r,!1),domEventHandlers:{...o,click:(e,t,r)=>{if(o.click&&o.click(e,t,r))return!0;let n=wH(e.state,t.from,t.to);if(n)return e.dispatch({effects:wB.of(n)}),!0;let i=wL(e.state,t.from,t.to);return!!i&&(e.dispatch({effects:w_.of(i)}),!0)}}},[bs(),bn.of({...br,...t})]),wY()]}()),!1!==e.drawSelection&&i.push(function(e={}){return[xg.of(e),xv,xb,xw,yg.of(!0)]}()),!1!==e.dropCursor&&i.push([xA,xS]),!1!==e.allowMultipleSelections&&i.push(mC.allowMultipleSelections.of(!0)),!1!==e.indentOnInput&&i.push(mC.transactionFilter.of(e=>{if(!e.docChanged||!e.isUserEvent("input.type")&&!e.isUserEvent("input.complete"))return e;let t=e.startState.languageDataAt("indentOnInput",e.startState.selection.main.head);if(!t.length)return e;let r=e.newDoc,{head:n}=e.newSelection.main,i=r.lineAt(n);if(n>i.from+200)return e;let s=r.sliceString(i.from,n);if(!t.some(e=>e.test(s)))return e;let{state:o}=e,l=-1,a=[];for(let{head:e}of o.selection.ranges){let t=o.doc.lineAt(e);if(t.from==l)continue;l=t.from;let r=wP(o,t.from);if(null==r)continue;let n=/^\s*/.exec(t.text)[0],i=wO(o,r);n!=i&&a.push({from:t.from,to:t.from+n.length,insert:i})}return a.length?[e,{changes:a,sequential:!0}]:e})),!1!==e.syntaxHighlighting&&i.push(w9(w7,{fallback:!0})),!1!==e.bracketMatching&&i.push(function(e={}){return[kr.of(e),ko]}()),!1!==e.closeBrackets&&i.push([Cv,Cf]),!1!==e.autocompletion&&i.push(function(e={}){return[Ca,Ce,SK.of(e),Co,CC,Cc]}()),!1!==e.rectangularSelection&&i.push((t=e=>e.altKey&&0==e.button,v6.mouseSelectionStyle.of((e,r)=>{let n,i;return t(r)?(n=xF(e,r),i=e.state.selection,n?{update(e){if(e.docChanged){let t=e.changes.mapPos(e.startState.doc.line(n.line).from),r=e.state.doc.lineAt(t);n={line:r.number,col:n.col,off:Math.min(n.off,r.length)},i=i.map(e.changes)}},get(t,r,s){let o=xF(e,t);if(!o)return i;let l=function(e,t,r){let n=Math.min(t.line,r.line),i=Math.max(t.line,r.line),s=[];if(t.off>2e3||r.off>2e3||t.col<0||r.col<0){let o=Math.min(t.off,r.off),l=Math.max(t.off,r.off);for(let t=n;t<=i;t++){let r=e.doc.line(t);r.length<=l&&s.push(pQ.range(r.from+o,r.to+l))}}else{let o=Math.min(t.col,r.col),l=Math.max(t.col,r.col);for(let t=n;t<=i;t++){let r=e.doc.line(t),n=mH(r.text,o,e.tabSize,!0);if(n<0)s.push(pQ.cursor(r.to));else{let t=mH(r.text,l,e.tabSize);s.push(pQ.range(r.from+n,r.from+t))}}}return s}(e.state,n,o);return l.length?s?pQ.create(l.concat(i.ranges)):pQ.create(l):i}}:null):null}))),!1!==r&&i.push(function(e={}){let[t,r]=x_[e.key||"Alt"],n=yC.fromClass(class{constructor(e){this.view=e,this.isDown=!1}set(e){this.isDown!=e&&(this.isDown=e,this.view.update([]))}},{eventObservers:{keydown(e){this.set(e.keyCode==t||r(e))},keyup(e){e.keyCode!=t&&r(e)||this.set(!1)},mousemove(e){this.set(r(e))}}});return[n,v6.contentAttributes.of(e=>{var t;return(null==(t=e.plugin(n))?void 0:t.isDown)?xB:null})]}()),!1!==e.highlightActiveLine&&i.push(xN),!1!==e.highlightSelectionMatches&&i.push([A7,A8]),e.tabSize&&"number"==typeof e.tabSize&&i.push(wE.of(" ".repeat(e.tabSize))),i.concat([xi.of(n.flat())]).filter(Boolean)};let CK="#e06c75",CG="#abb2bf",CJ="#7d8799",CY="#d19a66",CX="#2c313a",CZ="#282c34",CQ="#353a42",C0="#528bff",C1=[v6.theme({"&":{color:CG,backgroundColor:CZ},".cm-content":{caretColor:C0},".cm-cursor, .cm-dropCursor":{borderLeftColor:C0},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:"#3E4451"},".cm-panels":{backgroundColor:"#21252b",color:CG},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:CZ,color:CJ,border:"none"},".cm-activeLineGutter":{backgroundColor:CX},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:CQ},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:CQ,borderBottomColor:CQ},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:CX,color:CG}}},{dark:!0}),w9(w4.define([{tag:wh.keyword,color:"#c678dd"},{tag:[wh.name,wh.deleted,wh.character,wh.propertyName,wh.macroName],color:CK},{tag:[wh.function(wh.variableName),wh.labelName],color:"#61afef"},{tag:[wh.color,wh.constant(wh.name),wh.standard(wh.name)],color:CY},{tag:[wh.definition(wh.name),wh.separator],color:CG},{tag:[wh.typeName,wh.className,wh.number,wh.changed,wh.annotation,wh.modifier,wh.self,wh.namespace],color:"#e5c07b"},{tag:[wh.operator,wh.operatorKeyword,wh.url,wh.escape,wh.regexp,wh.link,wh.special(wh.string)],color:"#56b6c2"},{tag:[wh.meta,wh.comment],color:CJ},{tag:wh.strong,fontWeight:"bold"},{tag:wh.emphasis,fontStyle:"italic"},{tag:wh.strikethrough,textDecoration:"line-through"},{tag:wh.link,color:CJ,textDecoration:"underline"},{tag:wh.heading,fontWeight:"bold",color:CK},{tag:[wh.atom,wh.bool,wh.special(wh.variableName)],color:CY},{tag:[wh.processingInstruction,wh.string,wh.inserted],color:"#98c379"},{tag:wh.invalid,color:"#ffffff"}]))];var C2=v6.theme({"&":{backgroundColor:"#fff"}},{dark:!1}),C4=function(e){let t;void 0===e&&(e={});var{indentWithTab:r=!0,editable:n=!0,readOnly:i=!1,theme:s="light",placeholder:o="",basicSetup:l=!0}=e,a=[];switch(r&&a.unshift(xi.of([AW])),l&&("boolean"==typeof l?a.unshift(Cq()):a.unshift(Cq(l))),o&&a.unshift((t=yC.fromClass(class{constructor(e){this.view=e,this.placeholder=o?gH.set([gH.widget({widget:new xL(o),side:1}).range(0)]):gH.none}get decorations(){return this.view.state.doc.length?gH.none:this.placeholder}},{decorations:e=>e.decorations}),"string"==typeof o?[t,v6.contentAttributes.of({"aria-placeholder":o})]:t)),s){case"light":a.push(C2);break;case"dark":a.push(C1);break;case"none":break;default:a.push(s)}return!1===n&&a.push(v6.editable.of(!1)),i&&a.push(mC.readOnly.of(!0)),[...a]};class C3{constructor(e,t){this.timeLeftMS=void 0,this.timeoutMS=void 0,this.isCancelled=!1,this.isTimeExhausted=!1,this.callbacks=[],this.timeLeftMS=t,this.timeoutMS=t,this.callbacks.push(e)}tick(){if(!this.isCancelled&&!this.isTimeExhausted&&(this.timeLeftMS--,this.timeLeftMS<=0)){this.isTimeExhausted=!0;var e=this.callbacks.slice();this.callbacks.length=0,e.forEach(e=>{try{e()}catch(e){console.error("TimeoutLatch callback error:",e)}})}}cancel(){this.isCancelled=!0,this.callbacks.length=0}reset(){this.timeLeftMS=this.timeoutMS,this.isCancelled=!1,this.isTimeExhausted=!1}get isDone(){return this.isCancelled||this.isTimeExhausted}}class C5{constructor(){this.interval=null,this.latches=new Set}add(e){this.latches.add(e),this.start()}remove(e){this.latches.delete(e),0===this.latches.size&&this.stop()}start(){null===this.interval&&(this.interval=setInterval(()=>{this.latches.forEach(e=>{e.tick(),e.isDone&&this.remove(e)})},1))}stop(){null!==this.interval&&(clearInterval(this.interval),this.interval=null)}}var C6=null,C9=mp.define(),C8=[],C7=["className","value","selection","extensions","onChange","onStatistics","onCreateEditor","onUpdate","autoFocus","theme","height","minHeight","maxHeight","width","minWidth","maxWidth","basicSetup","placeholder","indentWithTab","editable","readOnly","root","initialState"],Ee=(0,tZ.forwardRef)((e,t)=>{var{className:r,value:n="",selection:i,extensions:s=[],onChange:o,onStatistics:l,onCreateEditor:a,onUpdate:c,autoFocus:h,theme:u="light",height:d,minHeight:f,maxHeight:p,width:m,minWidth:g,maxWidth:y,basicSetup:x,placeholder:b,indentWithTab:w,editable:k,readOnly:A,root:S,initialState:C}=e,E=(0,px.A)(e,C7),j=(0,tZ.useRef)(null),{state:O,view:P,container:M,setContainer:T}=function(e){var{value:t,selection:r,onChange:n,onStatistics:i,onCreateEditor:s,onUpdate:o,extensions:l=C8,autoFocus:a,theme:c="light",height:h=null,minHeight:u=null,maxHeight:d=null,width:f=null,minWidth:p=null,maxWidth:m=null,placeholder:g="",editable:y=!0,readOnly:v=!1,indentWithTab:x=!0,basicSetup:b=!0,root:w,initialState:k}=e,[A,S]=(0,tZ.useState)(),[C,E]=(0,tZ.useState)(),[j,O]=(0,tZ.useState)(),P=(0,tZ.useState)(()=>({current:null}))[0],M=(0,tZ.useState)(()=>({current:null}))[0],T=v6.theme({"&":{height:h,minHeight:u,maxHeight:d,width:f,minWidth:p,maxWidth:m},"& .cm-scroller":{height:"100% !important"}}),I=[v6.updateListener.of(e=>{e.docChanged&&"function"==typeof n&&!e.transactions.some(e=>e.annotation(C9))&&(P.current?P.current.reset():(P.current=new C3(()=>{if(M.current){var e=M.current;M.current=null,e()}P.current=null},200),("undefined"==typeof window?new C5:(!C6&&(C6=new C5),C6)).add(P.current)),n(e.state.doc.toString(),e)),i&&i({line:e.state.doc.lineAt(e.state.selection.main.from),lineCount:e.state.doc.lines,lineBreak:e.state.lineBreak,length:e.state.doc.length,readOnly:e.state.readOnly,tabSize:e.state.tabSize,selection:e.state.selection,selectionAsSingle:e.state.selection.asSingle().main,ranges:e.state.selection.ranges,selectionCode:e.state.sliceDoc(e.state.selection.main.from,e.state.selection.main.to),selections:e.state.selection.ranges.map(t=>e.state.sliceDoc(t.from,t.to)),selectedText:e.state.selection.ranges.some(e=>!e.empty)})}),T,...C4({theme:c,editable:y,readOnly:v,placeholder:g,indentWithTab:x,basicSetup:b})];return o&&"function"==typeof o&&I.push(v6.updateListener.of(o)),I=I.concat(l),(0,tZ.useLayoutEffect)(()=>{if(A&&!j){var e={doc:t,selection:r,extensions:I},n=k?mC.fromJSON(k.json,e,k.fields):mC.create(e);if(O(n),!C){var i=new v6({state:n,parent:A,root:w});E(i),s&&s(i,n)}}return()=>{C&&(O(void 0),E(void 0))}},[A,j]),(0,tZ.useEffect)(()=>{e.container&&S(e.container)},[e.container]),(0,tZ.useEffect)(()=>()=>{C&&(C.destroy(),E(void 0)),P.current&&(P.current.cancel(),P.current=null)},[C]),(0,tZ.useEffect)(()=>{a&&C&&C.focus()},[a,C]),(0,tZ.useEffect)(()=>{C&&C.dispatch({effects:my.reconfigure.of(I)})},[c,l,h,u,d,f,p,m,g,y,v,x,b,n,o]),(0,tZ.useEffect)(()=>{if(void 0!==t){var e=C?C.state.doc.toString():"";if(C&&t!==e){var r=P.current&&!P.current.isDone,n=()=>{C&&t!==C.state.doc.toString()&&C.dispatch({changes:{from:0,to:C.state.doc.toString().length,insert:t||""},annotations:[C9.of(!0)]})};r?M.current=n:n()}}},[t,C]),{state:j,setState:O,view:C,setView:E,container:A,setContainer:S}}({root:S,value:n,autoFocus:h,theme:u,height:d,minHeight:f,maxHeight:p,width:m,minWidth:g,maxWidth:y,basicSetup:x,placeholder:b,indentWithTab:w,editable:k,readOnly:A,selection:i,onChange:o,onStatistics:l,onCreateEditor:a,onUpdate:c,extensions:s,initialState:C});(0,tZ.useImperativeHandle)(t,()=>({editor:j.current,state:O,view:P}),[j,M,O,P]);var I=(0,tZ.useCallback)(e=>{j.current=e,T(e)},[T]);if("string"!=typeof n)throw Error("value must be typeof string but got "+typeof n);var $="string"==typeof u?"cm-theme-"+u:"cm-theme";return(0,v.jsx)("div",(0,pv.A)({ref:I,className:""+$+(r?" "+r:"")},E))});Ee.displayName="CodeMirror";var Et=RegExp("\\b((true)|(false)|(on)|(off)|(yes)|(no))$","i");let Er={name:"yaml",token:function(e,t){var r=e.peek(),n=t.escaped;if(t.escaped=!1,"#"==r&&(0==e.pos||/\s/.test(e.string.charAt(e.pos-1))))return e.skipToEnd(),"comment";if(e.match(/^('([^']|\\.)*'?|"([^"]|\\.)*"?)/))return"string";if(t.literal&&e.indentation()>t.keyCol)return e.skipToEnd(),"string";if(t.literal&&(t.literal=!1),e.sol()){if(t.keyCol=0,t.pair=!1,t.pairStart=!1,e.match("---")||e.match("..."))return"def";if(e.match(/^\s*-\s+/))return"meta"}if(e.match(/^(\{|\}|\[|\])/))return"{"==r?t.inlinePairs++:"}"==r?t.inlinePairs--:"["==r?t.inlineList++:t.inlineList--,"meta";if(t.inlineList>0&&!n&&","==r)return e.next(),"meta";if(t.inlinePairs>0&&!n&&","==r)return t.keyCol=0,t.pair=!1,t.pairStart=!1,e.next(),"meta";if(t.pairStart){if(e.match(/^\s*(\||\>)\s*/))return t.literal=!0,"meta";if(e.match(/^\s*(\&|\*)[a-z0-9\._-]+\b/i))return"variable";if(0==t.inlinePairs&&e.match(/^\s*-?[0-9\.\,]+\s?$/)||t.inlinePairs>0&&e.match(/^\s*-?[0-9\.\,]+\s?(?=(,|}))/))return"number";if(e.match(Et))return"keyword"}return!t.pair&&e.match(/^\s*(?:[,\[\]{}&*!|>'"%@`][^\s'":]|[^,\[\]{}#&*!|>'"%@`])[^#]*?(?=\s*:($|\s))/)?(t.pair=!0,t.keyCol=e.indentation(),"atom"):t.pair&&e.match(/^:\s*/)?(t.pairStart=!0,"meta"):(t.pairStart=!1,t.escaped="\\"==r,e.next(),null)},startState:function(){return{pair:!1,pairStart:!1,keyCol:0,inlinePairs:0,inlineList:0,literal:!1,escaped:!1}},languageData:{commentTokens:{line:"#"}}};var En=r(48240);let Ei=(0,tZ.createContext)(void 0);function Es(e){let t=uh(),r=(0,k.gf)(rS.z),{secrets:n}=(0,t9.Z)(),[i,s]=(0,tZ.useState)({results:[],selectedResult:void 0}),o=(0,tZ.useRef)(1),l=(0,tZ.useCallback)(e=>{s(t=>{let r=t.results.find(t=>t.id===e);return r===t.selectedResult?t:{results:t.results,selectedResult:r}})},[]),a=(0,tZ.useCallback)(e=>{s(t=>{let r=t.results.findIndex(t=>t.id===e);if(-1===r)return t;let n=t.results.slice(),[i]=n.splice(r,1);return{results:n,selectedResult:t.selectedResult?.id===i.id?n[0]:t.selectedResult}})},[]),c=(0,tZ.useCallback)(async e=>{if(!r.dryRun)throw Error("Scaffolder API does not support dry-run");let i=py.Ay.parse(e.templateContent),{formState:l,secrets:a}=await t.run({formState:e.values,secrets:n,manifest:i?.spec}),c={...await r.dryRun({template:i,values:l,secrets:a,directoryContents:e.files.map(e=>({path:e.path,base64Content:function(e){if(e.length>65536)return window.btoa("<file too large>");try{return window.btoa(e)}catch{let t=new TextEncoder().encode(e),r=[];for(let e=0;e<t.length;e+=32768)r.push(String.fromCharCode(...t.slice(e,e+32768)));return window.btoa(r.join(""))}}(e.content)}))}),id:o.current++};s(e=>({results:[...e.results,c],selectedResult:e.selectedResult??c}))},[r,t,n]),h=(0,tZ.useMemo)(()=>({...i,selectResult:l,deleteResult:a,execute:c}),[i,l,a,c]);return(0,v.jsx)(Ei.Provider,{value:h,children:e.children})}function Eo(){let e=(0,tZ.useContext)(Ei);if(!e)throw Error("must be used within a DryRunProvider");return e}let El=(0,rM.A)({containerWrapper:{width:"100%"}});class Ea extends tZ.Component{state={shouldRender:!0};componentDidUpdate(e){e.invalidator!==this.props.invalidator&&this.setState({shouldRender:!0})}componentDidCatch(e){this.props.setErrorText(e.message),this.setState({shouldRender:!1})}render(){return this.state.shouldRender?this.props.children:null}}function Ec(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function Eh(e){let{content:t,contentIsSpec:r,onDryRun:n,setErrorText:i,fieldExtensions:s=[],layouts:o=[]}=e,l=El(),a=(0,k.Q2)(),{t:c}=(0,rU.i)(r7.W),[h,u]=(0,tZ.useState)(),d=(0,tZ.useMemo)(()=>Object.fromEntries(s.map(({name:e,component:t})=>[e,t])),[s]);return(0,En.A)(()=>{try{if(!t)return void u(void 0);let e=py.Ay.parseAllDocuments(t).filter(e=>e).map(e=>e.toJSON())[0];if(!Ec(e))return void u(void 0);let n=e;if(!r){if("template"!==String(e.kind).toLocaleLowerCase("en-US"))return void u(void 0);n=Ec(e.spec)?e.spec:{}}let{parameters:o}=n;if(!Array.isArray(o)){i("Template parameters must be an array"),u(void 0);return}let l=Object.fromEntries(s.map(({name:e,validation:t})=>[e,t]));i(),u(o.flatMap(e=>Ec(e)?[{title:String(e.title),schema:e,validate:h4(e,l,{apiHolder:a})}]:[]))}catch(e){i(e.message)}},250,[r,t,a]),(0,v.jsx)("div",{className:l.containerWrapper,children:h?(0,v.jsx)(ni.A,{variant:"outlined",children:(0,v.jsx)(Ea,{invalidator:h,setErrorText:i,children:(0,v.jsx)(ur,{manifest:{steps:h,title:"Template Editor"},extensions:s,components:d,onCreate:async e=>{await n?.(e)},layouts:o,formProps:e.formProps})})}):(0,v.jsx)(rP.A,{variant:"body1",color:"textSecondary",children:c("templateEditorForm.stepper.emptyText")})})}Eh.DirectoryEditorDryRun=function(e){let{setErrorText:t,fieldExtensions:r=[],layouts:n}=e,i=Eo(),s=dQ(),{selectedFile:o}=s??{},l=async e=>{if(o)try{await i.execute({templateContent:o.content,values:e,files:s?.files??[]}),t()}catch(e){throw t(String(e.cause||e)),e}},a=o&&o.path.match(/\.ya?ml$/)?o.content:void 0;return s?(0,v.jsx)(Eh,{onDryRun:l,fieldExtensions:r,setErrorText:t,content:a,layouts:n,formProps:e.formProps}):null};let Eu=(0,rM.A)(e=>({root:{gridArea:"pageContent",display:"grid",gridTemplateRows:"auto 1fr"},controls:{marginBottom:e.spacing(3)},code:{width:"100%"}}),{name:"ScaffolderCustomFieldExtensionsPlaygroud"}),Ed=({fieldExtensions:e=[]})=>{let t=Eu(),{t:r}=(0,rU.i)(r7.W),n=e.filter(e=>!!e.schema),[i,s]=(0,tZ.useState)(Date.now()),[o,l]=(0,tZ.useState)({}),[a,c]=(0,tZ.useState)(n[0]),h=(0,tZ.useMemo)(()=>py.Ay.stringify({parameters:[{title:`${a.name} Example`,properties:{[a.name]:{type:a.schema?.returnValue?.type,"ui:field":a.name,"ui:options":o}}}]}),[o,a]),u=(0,tZ.useMemo)(()=>Object.fromEntries(e.map(({name:e,component:t})=>[e,t])),[e]),d=(0,tZ.useCallback)(e=>{c(e),l({})},[l,c]),f=(0,tZ.useCallback)(e=>{l(e),s(Date.now())},[l,s]);return(0,v.jsxs)("main",{className:t.root,children:[(0,v.jsx)("div",{className:t.controls,children:(0,v.jsx)(r$.Ay,{id:"custom-fields-autocomplete",value:a,options:n,getOptionLabel:e=>e.name,renderInput:e=>(0,v.jsx)(ra.A,{...e,"aria-label":r("templateEditorPage.customFieldExplorer.selectFieldLabel"),placeholder:r("templateEditorPage.customFieldExplorer.selectFieldLabel"),variant:"outlined",InputProps:{...e.InputProps,startAdornment:(0,v.jsx)(rD.A,{position:"start",children:(0,v.jsx)(rR.default,{})})}}),onChange:(e,t)=>{t&&d(t)},disableClearable:!0,fullWidth:!0})}),(0,v.jsxs)("div",{children:[(0,v.jsxs)(rC.A,{defaultExpanded:!0,children:[(0,v.jsx)(rj.A,{expandIcon:(0,v.jsx)(rT.default,{}),"aria-controls":"panel-code-content",id:"panel-code-header",children:(0,v.jsx)(rP.A,{variant:"h6",children:r("templateEditorPage.customFieldExplorer.preview.title")})}),(0,v.jsx)(rE.A,{children:(0,v.jsx)("div",{className:t.code,children:(0,v.jsx)(Ee,{readOnly:!0,theme:"dark",height:"100%",width:"100%",extensions:[km.define(Er)],value:h})})})]}),(0,v.jsxs)(rC.A,{defaultExpanded:!0,children:[(0,v.jsx)(rj.A,{expandIcon:(0,v.jsx)(rT.default,{}),"aria-controls":"panel-preview-content",id:"panel-preview-header",children:(0,v.jsx)(rP.A,{variant:"h6",children:r("templateEditorPage.customFieldExplorer.fieldPreview.title")})}),(0,v.jsx)(rE.A,{children:(0,v.jsx)(Eh,{content:h,contentIsSpec:!0,fieldExtensions:e,setErrorText:()=>null},i)})]}),(0,v.jsxs)(rC.A,{defaultExpanded:!0,children:[(0,v.jsx)(rj.A,{expandIcon:(0,v.jsx)(rT.default,{}),"aria-controls":"panel-options-content",id:"panel-options-header",children:(0,v.jsx)(rP.A,{variant:"h6",children:r("templateEditorPage.customFieldExplorer.fieldForm.title")})}),(0,v.jsx)(rE.A,{children:(0,v.jsx)(hJ,{showErrorList:!1,fields:{...u},noHtml5Validate:!0,formData:o,formContext:{fieldFormState:o},onSubmit:e=>f(e.formData),validator:lh,schema:a.schema?.uiOptions||{},experimental_defaultFormStateBehavior:{allOf:"populateDefaults"},children:(0,v.jsx)(iF.A,{variant:"contained",color:"primary",type:"submit",disabled:!a.schema?.uiOptions,children:r("templateEditorPage.customFieldExplorer.fieldForm.applyButtonTitle")})})})]})]})]})};var Ef=r(38605),Ep=r(74953),Em=r(27062),Eg=r(65859);let Ey=["filter","function","value"],Ev=e=>`${e.kind}_${e.name}`;function Ex(e){return"object"==typeof e}function Eb(e){let t=e=>t=>e in t&&Object.keys(t).every(t=>t.startsWith("$")||t===e);if(Ex(e)&&t("anyOf")(e)&&e.anyOf?.length===2){let r=e.anyOf[0];if(Ex(r)&&t("not")(r)){let t=r.not;if(Ex(t)&&!Object.keys(t).length)return[e.anyOf[1],!1]}}return[e,!0]}let Ew=({t:e,classes:t,name:r,filter:n})=>{let i=(0,tZ.useState)({});if(!Object.keys(n).length)return(0,v.jsx)(rP.A,{style:{fontStyle:"italic"},children:e("templatingExtensions.content.filters.metadataAbsent")});let s=n.schema,o={classes:t,expanded:i,headings:[(0,v.jsx)(rP.A,{variant:"h6",component:"h4"})]};return(0,v.jsxs)(tZ.Fragment,{children:[n.description&&(0,v.jsx)(rz.h,{content:n.description}),(0,v.jsxs)(rO.A,{pb:2,children:[(0,v.jsx)(rP.A,{variant:"h5",component:"h3",children:e("templatingExtensions.content.filters.schema.input")}),(0,v.jsx)(nO,{strategy:"root",context:{parentId:`${r}.input`,...o},schema:s?.input??{}})]}),s?.arguments?.length&&(0,v.jsxs)(rO.A,{pb:2,children:[(0,v.jsx)(rP.A,{variant:"h5",component:"h3",children:e("templatingExtensions.content.filters.schema.arguments")}),s.arguments.map((e,n)=>{let[i,s]=Eb(e);return(0,v.jsxs)(tZ.Fragment,{children:[(0,v.jsx)("div",{className:nm()({[t.argRequired]:s}),children:(0,v.jsx)(rP.A,{variant:"h6",component:"h4",children:`[${n}]`})}),(0,v.jsx)(nO,{strategy:"root",context:{parentId:`${r}.arg${n}`,...o,headings:[(0,v.jsx)(rP.A,{variant:"h6",component:"h5"})]},schema:i})]},n)})]},`${r}.args`),(0,v.jsxs)(rO.A,{pb:2,children:[(0,v.jsx)(rP.A,{variant:"h5",component:"h3",children:e("templatingExtensions.content.filters.schema.output")}),(0,v.jsx)(nO,{strategy:"root",context:{parentId:`${r}.output`,...o},schema:s?.output??{}})]}),n.examples&&(0,v.jsxs)(rC.A,{children:[(0,v.jsx)(rj.A,{expandIcon:(0,v.jsx)(rT.default,{}),children:(0,v.jsx)(rP.A,{variant:"h5",component:"h3",children:e("templatingExtensions.content.filters.examples")})}),(0,v.jsx)(rE.A,{children:(0,v.jsx)(rO.A,{pb:2,children:(0,v.jsx)(nT,{examples:n.examples})})})]})]},`${r}.detail`)},Ek=({t:e,classes:t,filters:r,baseLink:n,selectedItem:i})=>i&&"filter"!==i.kind?(0,v.jsx)(v.Fragment,{}):Object.keys(r).length?(0,v.jsx)("div",{"data-testid":"filters",children:Object.entries(i?{[i.name]:r[i.name]}:r).map(([r,i])=>{let s=Ev({kind:"filter",name:r});return(0,v.jsxs)(rO.A,{pb:4,"data-testid":r,children:[(0,v.jsx)(rP.A,{id:s,variant:"h4",component:"h2",className:t.code,children:r}),(0,tZ.cloneElement)(n,{to:`${n.props.to}#${s}`}),(0,v.jsx)(Ew,{t:e,classes:t,name:r,filter:i})]},r)})}):(0,v.jsx)("div",{"data-testid":"no-filters",children:e("templatingExtensions.content.filters.notAvailable")}),EA=({classes:e,name:t,fn:r,t:n})=>{let i=(0,tZ.useState)({});if(!Object.keys(r).length)return(0,v.jsx)(rP.A,{style:{fontStyle:"italic"},"data-testid":`${t}.metadataAbsent`,children:n("templatingExtensions.content.functions.metadataAbsent")});let s=r.schema,o={classes:e,expanded:i,headings:[(0,v.jsx)(rP.A,{variant:"h6",component:"h4"})]};return(0,v.jsxs)(tZ.Fragment,{children:[r.description&&(0,v.jsx)(rz.h,{content:r.description}),s?.arguments?.length&&(0,v.jsxs)(rO.A,{pb:2,children:[(0,v.jsx)(rP.A,{variant:"h5",component:"h3",children:n("templatingExtensions.content.functions.schema.arguments")}),s.arguments.map((r,n)=>{let[i,s]=Eb(r);return(0,v.jsxs)(tZ.Fragment,{children:[(0,v.jsx)("div",{className:nm()({[e.argRequired]:s}),children:(0,v.jsx)(rP.A,{variant:"h6",component:"h4",children:`[${n}]`})}),(0,v.jsx)(nO,{strategy:"root",context:{parentId:`${t}.arg${n}`,...o,headings:[(0,v.jsx)(rP.A,{variant:"h6",component:"h5"})]},schema:i})]},n)})]},`${t}.args`),(0,v.jsxs)(rO.A,{pb:2,children:[(0,v.jsx)(rP.A,{variant:"h5",component:"h3",children:n("templatingExtensions.content.functions.schema.output")}),(0,v.jsx)(nO,{strategy:"root",context:{parentId:`${t}.output`,...o},schema:s?.output??{}})]}),r.examples&&(0,v.jsxs)(rC.A,{children:[(0,v.jsx)(rj.A,{expandIcon:(0,v.jsx)(rT.default,{}),children:(0,v.jsx)(rP.A,{variant:"h5",component:"h3",children:n("templatingExtensions.content.functions.examples")})}),(0,v.jsx)(rE.A,{children:(0,v.jsx)(rO.A,{pb:2,children:(0,v.jsx)(nT,{examples:r.examples})})})]})]},`${t}.detail`)},ES=({classes:e,functions:t,t:r,baseLink:n,selectedItem:i})=>i&&"function"!==i.kind?(0,v.jsx)(v.Fragment,{}):Object.keys(t).length?(0,v.jsx)("div",{"data-testid":"functions",children:Object.entries(i?{[i.name]:t[i.name]}:t).map(([t,i])=>{let s=Ev({kind:"function",name:t});return(0,v.jsxs)(rO.A,{pb:4,"data-testid":t,children:[(0,v.jsx)(rP.A,{id:s,variant:"h4",component:"h2",className:e.code,children:t}),(0,tZ.cloneElement)(n,{to:`${n.props.to}#${s}`}),(0,v.jsx)(EA,{classes:e,name:t,fn:i,t:r})]},t)})}):(0,v.jsx)("div",{"data-testid":"no-functions",children:r("templatingExtensions.content.functions.notAvailable")}),EC=({classes:e,t,values:r,baseLink:n,selectedItem:i})=>i&&"value"!==i.kind?(0,v.jsx)(v.Fragment,{}):Object.keys(r).length?(0,v.jsx)("div",{"data-testid":"values",children:Object.entries(i?{[i.name]:r[i.name]}:r).map(([t,r])=>{let i=Ev({kind:"value",name:t});return(0,v.jsxs)(rO.A,{pb:4,"data-testid":t,children:[(0,v.jsx)(rP.A,{id:i,variant:"h4",component:"h2",className:e.code,children:t}),(0,tZ.cloneElement)(n,{to:`${n.props.to}#${i}`}),r.description&&(0,v.jsx)(rz.h,{content:r.description}),(0,v.jsx)(rO.A,{padding:1,"data-testid":`${t}.value`,children:(0,v.jsx)(nP.z,{text:JSON.stringify(r.value,null,2),showCopyCodeButton:!0,language:"json"})})]},t)})}):(0,v.jsx)("div",{"data-testid":"no-values",children:t("templatingExtensions.content.values.notAvailable")}),EE=(0,rM.A)(e=>({code:{fontFamily:"Menlo, monospace",padding:e.spacing(1),backgroundColor:"dark"===e.palette.type?e.palette.grey[700]:e.palette.grey[300],display:"inline-block",borderRadius:5,border:`1px solid ${e.palette.grey[500]}`,position:"relative"},codeRequired:{"&::after":{position:"absolute",content:'"*"',top:0,right:e.spacing(.5),fontWeight:"bolder",color:e.palette.error.light}},argRequired:{position:"relative","& > *":{display:"inline",position:"relative","&::after":{position:"absolute",content:'"*"',top:0,right:e.spacing(-1),fontWeight:"bolder",color:e.palette.error.light}}},link:{paddingLeft:e.spacing(1),cursor:"pointer"},tabs:{display:"block",minHeight:"initial",overflow:"initial"}})),Ej=({linkLocal:e})=>{let t,r=(0,k.gf)(rS.z),n=EE(),{t:i}=(0,rU.i)(r7.W),{loading:s,value:o,error:l}=(0,rA.A)(async()=>r.listTemplatingExtensions?r.listTemplatingExtensions():(console.warn("listTemplatingExtensions is not implemented in the scaffolderApi; please make sure to implement this method."),Promise.resolve({filters:{},globals:{functions:{},values:{}}})),[r]),[a,c]=(0,tZ.useState)("filter"),[h,u]=(0,tZ.useState)(null),[d,f]=(0,tZ.useState)("");(0,tZ.useEffect)(()=>{if(o&&window.location.hash)try{c((e=>{let[t,r]=e.split("_",2);if(Ey.includes(t))return{kind:t,name:r};throw Error(e)})(window.location.hash.substring(1)).kind),document.querySelector(window.location.hash)?.scrollIntoView()}catch(e){}},[o]);let p=(0,tZ.useMemo)(()=>({filter:{icon:(0,v.jsx)(Eg.default,{}),label:i("templatingExtensions.content.filters.title")},function:{icon:(0,v.jsx)(r2.default,{}),label:i("templatingExtensions.content.functions.title")},value:{icon:(0,v.jsx)(Em.default,{}),label:i("templatingExtensions.content.values.title")}}),[i]),m=(0,rN.S)(rk.SE);if(s)return(0,v.jsx)(rL.k,{});if(l||!o)return(0,v.jsxs)("div",{"data-testid":"empty",children:[l&&(0,v.jsx)(rF.b,{error:l}),(0,v.jsx)(r_.p,{missing:"info",title:i("templatingExtensions.content.emptyState.title"),description:i("templatingExtensions.content.emptyState.description")})]});let{filters:g,globals:y}=o,x=(0,v.jsx)(rB.N_,{className:n.link,to:m(),...e?{}:{target:"_blank",rel:"noopener noreferrer"},children:(0,v.jsx)(rI.default,{})});return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(r$.Ay,{renderInput:e=>(0,v.jsx)(ra.A,{...e,"aria-label":i("templatingExtensions.content.searchFieldPlaceholder"),placeholder:i("templatingExtensions.content.searchFieldPlaceholder"),variant:"outlined",InputProps:{...e.InputProps,startAdornment:(0,v.jsx)(rD.A,{position:"start",children:(0,v.jsx)(rR.default,{})})}}),getOptionLabel:e=>e.name,getOptionSelected:(e,t)=>e===t,options:[...(t=(e,t)=>t?Object.keys(t).map(t=>({kind:e,name:t})):[])("filter",o.filters),...t("function",o.globals?.functions),...t("value",o.globals?.values)],groupBy:e=>e.kind,renderGroup:e=>(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(rO.A,{display:"flex",alignItems:"center",children:[p[e.group].icon,(0,v.jsx)(rO.A,{sx:{ml:1},children:p[e.group].label})]}),(0,v.jsx)("ul",{children:e.children})]}),renderOption:e=>(0,v.jsx)(rG.A,{primary:e.name}),onChange:(e,t)=>{u(t),t&&c(t.kind)},inputValue:d,onInputChange:(e,t)=>f(t),loading:s,fullWidth:!0,clearOnEscape:!0}),(0,v.jsx)(Ep.A,{value:a,onChange:(e,t)=>{h?.kind!==t&&(u(null),f("")),c(t)},centered:!0,className:n.tabs,children:Object.entries(p).map(([e,t])=>(0,v.jsx)(Ef.A,{value:e,...t},e))}),"filter"===a&&(0,v.jsx)(Ek,{baseLink:x,t:i,classes:n,filters:g,selectedItem:h}),"function"===a&&(0,v.jsx)(ES,{functions:y.functions,...{baseLink:x,t:i,classes:n,selectedItem:h}}),"value"===a&&(0,v.jsx)(EC,{values:y.values,...{baseLink:x,t:i,classes:n,selectedItem:h}})]})},EO=e=>{let t=(0,x.Zp)(),r=(0,rN.S)(rk.Dg),n=(0,rN.S)(rk.JX),i=(0,rN.S)(rk.rQ),s=(0,rN.S)(rk.GF),o={onEditorClicked:e?.contextMenu?.editor!==!1?()=>t(r()):void 0,onActionsClicked:e?.contextMenu?.actions!==!1?()=>t(s()):void 0,onTasksClicked:e?.contextMenu?.tasks!==!1?()=>t(n()):void 0,onCreateClicked:e?.contextMenu?.create!==!1?()=>t(i()):void 0,onTemplatingExtensionsClicked:void 0},{t:l}=(0,rU.i)(r7.W);return(0,v.jsxs)(rW.Y,{themeId:"home",children:[(0,v.jsx)(rV.Y,{pageTitleOverride:l("templatingExtensions.pageTitle"),title:l("templatingExtensions.title"),subtitle:l("templatingExtensions.subtitle"),children:(0,v.jsx)(r8,{...o})}),(0,v.jsx)(rH.U,{children:(0,v.jsx)(Ej,{linkLocal:!0})})]})},EP=(0,rM.A)(e=>({paper:{width:"90%",padding:e.spacing(2),backgroundColor:e.palette.background.default,[e.breakpoints.up("sm")]:{width:"70%"},[e.breakpoints.up("md")]:{width:"50%"}},appbar:{zIndex:1},toolbar:{display:"grid",gridTemplateColumns:"auto 1fr",gridGap:e.spacing(1),padding:e.spacing(0,1),backgroundColor:e.palette.background.paper},toolbarCustomActions:{display:"grid",alignItems:"center",gridAutoFlow:"Column",gridGap:e.spacing(1)},toolbarDefaultActions:{justifySelf:"end"}}),{name:"ScaffolderTemplateEditorToolbar"});function EM(e){let{children:t,fieldExtensions:r}=e,n=EP(),{t:i}=(0,rU.i)(r7.W),[s,o]=(0,tZ.useState)(!1),[l,a]=(0,tZ.useState)(!1),[c,h]=(0,tZ.useState)(!1),[u,d]=(0,tZ.useState)(!1);return(0,v.jsx)(pl.A,{className:n.appbar,position:"relative",children:(0,v.jsxs)(pa.A,{className:n.toolbar,children:[(0,v.jsx)("div",{className:n.toolbarCustomActions,children:t}),(0,v.jsxs)(pc.A,{className:n.toolbarDefaultActions,variant:"text",children:[(0,v.jsx)(nu.Ay,{title:i("templateEditorToolbar.customFieldExplorerTooltip"),children:(0,v.jsx)(iF.A,{onClick:()=>o(!0),children:(0,v.jsx)(pg.default,{})})}),(0,v.jsx)(nu.Ay,{title:i("templateEditorToolbar.installedActionsDocumentationTooltip"),children:(0,v.jsx)(iF.A,{onClick:()=>a(!0),children:(0,v.jsx)(rQ.default,{})})}),(0,v.jsx)(nu.Ay,{title:i("templateEditorToolbar.templatingExtensionsDocumentationTooltip"),children:(0,v.jsx)(iF.A,{onClick:()=>h(!0),children:(0,v.jsx)(r2.default,{})})}),(0,v.jsx)(iF.A,{onClick:()=>d(!0),children:i("templateEditorToolbar.addToCatalogButton")})]}),(0,v.jsx)(ph.Ay,{classes:{paper:n.paper},anchor:"right",open:s,onClose:()=>o(!1),children:(0,v.jsx)(Ed,{fieldExtensions:r})}),(0,v.jsx)(ph.Ay,{classes:{paper:n.paper},anchor:"right",open:l,onClose:()=>a(!1),children:(0,v.jsx)(n$,{})}),(0,v.jsx)(ph.Ay,{classes:{paper:n.paper},anchor:"right",open:c,onClose:()=>h(!1),children:(0,v.jsx)(Ej,{})}),(0,v.jsxs)(pu.A,{onClose:()=>d(!1),open:u,"aria-labelledby":"publish-dialog-title","aria-describedby":"publish-dialog-description",children:[(0,v.jsx)(pd.A,{id:"publish-dialog-title",children:i("templateEditorToolbar.addToCatalogDialogTitle")}),(0,v.jsx)(pf.A,{dividers:!0,children:(0,v.jsxs)(pp.A,{id:"publish-dialog-slide-description",children:[i("templateEditorToolbar.addToCatalogDialogContent.stepsIntroduction"),(0,v.jsx)("ul",{children:i("templateEditorToolbar.addToCatalogDialogContent.stepsListItems").split("\n").map((e,t)=>(0,v.jsx)("li",{children:e},t))})]})}),(0,v.jsx)(pm.A,{children:(0,v.jsx)(iF.A,{color:"primary",href:i("templateEditorToolbar.addToCatalogDialogActions.documentationUrl"),target:"_blank",children:i("templateEditorToolbar.addToCatalogDialogActions.documentationButton")})})]})]})})}var ET=r(37757);function EI(e){let{onOpenDirectory:t,onCreateDirectory:r,onCloseDirectory:n}=e,{t:i}=(0,rU.i)(r7.W),[s,o]=(0,tZ.useState)(null),l=(0,tZ.useCallback)(e=>{o(e.currentTarget)},[o]),a=(0,tZ.useCallback)(()=>{o(null)},[o]),c=(0,tZ.useCallback)(()=>{a(),t?.()},[a,t]),h=(0,tZ.useCallback)(()=>{a(),r?.()},[a,r]),u=(0,tZ.useCallback)(()=>{a(),n?.()},[a,n]);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(iF.A,{"aria-controls":"file-menu","aria-haspopup":"true",onClick:l,children:i("templateEditorToolbarFileMenu.button")}),(0,v.jsxs)(ET.A,{id:"file-menu",anchorEl:s,open:!!s,onClose:a,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:[(0,v.jsx)(rJ.A,{onClick:c,disabled:!t,children:i("templateEditorToolbarFileMenu.options.openDirectory")}),(0,v.jsx)(rJ.A,{onClick:h,disabled:!r,divider:!0,children:i("templateEditorToolbarFileMenu.options.createDirectory")}),(0,v.jsx)(rJ.A,{onClick:u,disabled:!n,children:i("templateEditorToolbarFileMenu.options.closeEditor")})]})]})}var E$=r(32881),ED=r(10010),ER=r(71108),EN=r(1400),EL=r(39850),EF=r(9546),E_=r(45065),EB=tZ.createContext({}),Ez=function(e,t,r){for(var n=t;n<e.length;n+=1)if(r===e[n])return n;return -1},EW=[],EV=[],EH=tZ.forwardRef(function(e,t){var r=e.children,n=e.classes,i=e.className,s=e.defaultCollapseIcon,o=e.defaultEndIcon,l=e.defaultExpanded,a=e.defaultExpandIcon,c=e.defaultParentIcon,h=e.defaultSelected,u=e.disableSelection,d=void 0!==u&&u,f=e.multiSelect,p=void 0!==f&&f,m=e.expanded,g=e.onNodeSelect,y=e.onNodeToggle,v=e.selected,x=(0,EL.A)(e,["children","classes","className","defaultCollapseIcon","defaultEndIcon","defaultExpanded","defaultExpandIcon","defaultParentIcon","defaultSelected","disableSelection","multiSelect","expanded","onNodeSelect","onNodeToggle","selected"]),b=tZ.useState(null),w=b[0],k=b[1],A=tZ.useState(null),S=A[0],C=A[1],E=tZ.useRef({}),j=tZ.useRef({}),O=tZ.useRef([]),P=(0,E_.A)({controlled:m,default:void 0===l?EW:l,name:"TreeView",state:"expanded"}),M=(0,EN.A)(P,2),T=M[0],I=M[1],$=(0,E_.A)({controlled:v,default:void 0===h?EV:h,name:"TreeView",state:"selected"}),D=(0,EN.A)($,2),R=D[0],N=D[1],L=tZ.useCallback(function(e){return!!Array.isArray(T)&&-1!==T.indexOf(e)},[T]),F=tZ.useCallback(function(e){return Array.isArray(R)?-1!==R.indexOf(e):R===e},[R]),_=function(e){var t=O.current.indexOf(e);return -1!==t&&t+1<O.current.length?O.current[t+1]:null},B=function(e){var t=O.current.indexOf(e);return -1!==t&&t-1>=0?O.current[t-1]:null},z=function(){return O.current[O.current.length-1]},W=function(){return O.current[0]},V=function(e,t){var r=O.current.indexOf(e),n=O.current.indexOf(t),i=Math.min(r,n),s=Math.max(r,n);return O.current.slice(i,s+1)},H=function(e){e&&(k(e),C(e))},U=tZ.useRef(null),q=tZ.useRef(!1),K=tZ.useRef([]),G=function(e,t){var r=R,n=t.start,i=t.next,s=t.current;i&&s&&(-1===K.current.indexOf(s)&&(K.current=[]),q.current?-1!==K.current.indexOf(i)?(r=r.filter(function(e){return e===n||e!==s}),K.current=K.current.filter(function(e){return e===n||e!==s})):(r.push(i),K.current.push(i)):(r.push(i),K.current.push(s,i)),g&&g(e,r),N(r))},J=function(e,t){var r=R,n=t.start,i=t.end;q.current&&(r=R.filter(function(e){return -1===K.current.indexOf(e)}));var s=V(n,i);K.current=s;var o=r.concat(s);o=o.filter(function(e,t){return o.indexOf(e)===t}),g&&g(e,o),N(o)},Y=function(e,t){var r=[];r=-1!==R.indexOf(t)?R.filter(function(e){return e!==t}):[t].concat(R),g&&g(e,r),N(r)},X=function(e,t){var r=p?[t]:t;g&&g(e,r),N(r)},Z=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=t.start,i=void 0===n?U.current:n,s=t.end,o=t.current;return r?G(e,{start:i,next:s,current:o}):J(e,{start:i,end:s}),q.current=!0,!0},Q=tZ.useCallback(function(e){var t=E.current[e],r=[];return t&&(r.push(e),t.children&&(r.concat(t.children),t.children.forEach(function(e){r.concat(Q(e))}))),r},[]),ee=tZ.useCallback(function(e){var t=(0,pv.A)({},j.current);e.forEach(function(e){t[e]&&delete t[e]}),j.current=t},[]),et=tZ.useCallback(function(e){var t=Q(e);ee(t);var r=(0,pv.A)({},E.current);t.forEach(function(e){var t=r[e];if(t){if(t.parent){var n=r[t.parent];if(n&&n.children){var i=n.children.filter(function(t){return t!==e});r[t.parent]=(0,pv.A)({},n,{children:i})}}delete r[e]}}),E.current=r,C(function(t){return t===e?null:t})},[Q,ee]),er=tZ.useRef([]),en=tZ.useState(!1),ei=en[0],es=en[1];tZ.useEffect(function(){var e=[];tZ.Children.forEach(r,function(t){tZ.isValidElement(t)&&t.props.nodeId&&e.push(t.props.nodeId)}),function(e,t){if(e.length!==t.length)return!0;for(var r=0;r<e.length;r+=1)if(e[r]!==t[r])return!0;return!1}(er.current,e)&&(E.current[-1]={parent:null,children:e},e.forEach(function(e,t){0===t&&k(e)}),O.current=E.current[-1].children,er.current=e,es(!0))},[r]),tZ.useEffect(function(){ei&&(O.current=function e(t){for(var r=[],n=0;n<t.length;n+=1){var i=t[n];r.push(i);var s=E.current[i].children;L(i)&&s&&(r=r.concat(e(s)))}return r}(E.current[-1].children))},[T,ei,L,r]);var eo=function(){return!1};return tZ.createElement(EB.Provider,{value:{icons:{defaultCollapseIcon:s,defaultExpandIcon:a,defaultParentIcon:c,defaultEndIcon:o},focus:H,focusFirstNode:function(){return H(W())},focusLastNode:function(){return H(z())},focusNextNode:function(e){return H(_(e))},focusPreviousNode:function(e){return H(B(e))},focusByFirstCharacter:function(e,t){var r,n,i=t.toLowerCase(),s=[],o=[];Object.keys(j.current).forEach(function(e){var t=j.current[e],r=E.current[e];(!r.parent||L(r.parent))&&(s.push(e),o.push(t))}),(r=s.indexOf(e)+1)===E.current.length&&(r=0),-1===(n=Ez(o,r,i))&&(n=Ez(o,0,i)),n>-1&&H(s[n])},expandAllSiblings:function(e,t){var r,n=E.current[t],i=E.current[n.parent];r=i?i.children.filter(function(e){return!L(e)}):E.current[-1].children.filter(function(e){return!L(e)});var s=T.concat(r);r.length>0&&(I(s),y&&y(e,s))},toggleExpansion:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:S;-1!==T.indexOf(r)?(t=T.filter(function(e){return e!==r}),k(function(e){var t=E.current[e];return e&&(t&&t.parent?t.parent.id:null)===r?r:e})):t=[r].concat(T),y&&y(e,t),I(t)},isExpanded:L,isFocused:function(e){return S===e},isSelected:F,selectNode:d?eo:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!!t&&(r?Y(e,t):X(e,t),U.current=t,q.current=!1,K.current=[],!0)},selectRange:d?eo:Z,selectNextNode:d?eo:function(e,t){return Z(e,{end:_(t),current:t},!0)},selectPreviousNode:d?eo:function(e,t){return Z(e,{end:B(t),current:t},!0)},rangeSelectToFirst:d?eo:function(e,t){return U.current||(U.current=t),Z(e,{start:q.current?U.current:t,end:W()})},rangeSelectToLast:d?eo:function(e,t){return U.current||(U.current=t),Z(e,{start:q.current?U.current:t,end:z()})},selectAllNodes:d?eo:function(e){return Z(e,{start:W(),end:z()})},isTabbable:function(e){return w===e},multiSelect:p,getParent:function(e){return E.current[e].parent},mapFirstChar:function(e,t){j.current[e]=t},addNodeToNodeMap:function(e,t){var r=E.current[e];E.current[e]=(0,pv.A)({},r,{children:t,id:e}),t.forEach(function(t){var r=E.current[t];E.current[t]=(0,pv.A)({},r,{parent:e,id:t})})},removeNodeFromNodeMap:et}},tZ.createElement("ul",(0,pv.A)({role:"tree","aria-multiselectable":p,className:(0,EF.A)(n.root,i),ref:t},x),r))});let EU=(0,d1.A)({root:{padding:0,margin:0,listStyle:"none"}},{name:"MuiTreeView"})(EH);var Eq=r(63798),EK=r(268),EG=r(19878),EJ=tZ.forwardRef(function(e,t){var r,n=e.children,i=e.classes,s=e.className,o=e.collapseIcon,l=e.endIcon,a=e.expandIcon,c=e.icon,h=e.label,u=e.nodeId,d=e.onClick,f=e.onLabelClick,p=e.onIconClick,m=e.onFocus,g=e.onKeyDown,y=e.onMouseDown,v=e.TransitionComponent,x=void 0===v?nt.A:v,b=e.TransitionProps,w=(0,EL.A)(e,["children","classes","className","collapseIcon","endIcon","expandIcon","icon","label","nodeId","onClick","onLabelClick","onIconClick","onFocus","onKeyDown","onMouseDown","TransitionComponent","TransitionProps"]),k=tZ.useContext(EB),A=k.icons,S=k.focus,C=k.focusFirstNode,E=k.focusLastNode,j=k.focusNextNode,O=k.focusPreviousNode,P=k.focusByFirstCharacter,M=k.selectNode,T=k.selectRange,I=k.selectNextNode,$=k.selectPreviousNode,D=k.rangeSelectToFirst,R=k.rangeSelectToLast,N=k.selectAllNodes,L=k.expandAllSiblings,F=k.toggleExpansion,_=k.isExpanded,B=k.isFocused,z=k.isSelected,W=k.isTabbable,V=k.multiSelect,H=k.getParent,U=k.mapFirstChar,q=k.addNodeToNodeMap,K=k.removeNodeFromNodeMap,G=tZ.useRef(null),J=tZ.useRef(null),Y=(0,EG.A)(G,t),X=c,Z=!!(Array.isArray(n)?n.length:n),Q=!!_&&_(u),ee=!!B&&B(u),et=!!W&&W(u),er=!!z&&z(u),en=A||{},ei=(0,ik.A)();!X&&(Z?(X=Q?o||en.defaultCollapseIcon:a||en.defaultExpandIcon)||(X=en.defaultParentIcon):X=l||en.defaultEndIcon);var es=function(e){return Z&&(Q?j(u):F(e)),!0},eo=function(e){if(Q)return F(e,u),!0;var t=H(u);return!!t&&(S(t),!0)};return tZ.useEffect(function(){if(q){var e=[];tZ.Children.forEach(n,function(t){tZ.isValidElement(t)&&t.props.nodeId&&e.push(t.props.nodeId)}),q(u,e)}},[n,u,q]),tZ.useEffect(function(){if(K)return function(){K(u)}},[u,K]),tZ.useEffect(function(){U&&h&&U(u,J.current.textContent.substring(0,1).toLowerCase())},[U,u,h]),tZ.useEffect(function(){ee&&G.current.focus()},[ee]),V?r=er:er&&(r=!0),tZ.createElement("li",(0,pv.A)({className:(0,EF.A)(i.root,s,Q&&i.expanded,er&&i.selected),role:"treeitem",onKeyDown:function(e){var t=!1,r=e.key;if(!e.altKey&&e.currentTarget===e.target){var n,i=e.ctrlKey||e.metaKey;switch(r){case" ":G.current===e.currentTarget&&(t=V&&e.shiftKey?T(e,{end:u}):V?M(e,u,!0):M(e,u)),e.stopPropagation();break;case"Enter":G.current===e.currentTarget&&Z&&(F(e),t=!0),e.stopPropagation();break;case"ArrowDown":V&&e.shiftKey&&I(e,u),j(u),t=!0;break;case"ArrowUp":V&&e.shiftKey&&$(e,u),O(u),t=!0;break;case"ArrowRight":t="rtl"===ei.direction?eo(e):es(e);break;case"ArrowLeft":t="rtl"===ei.direction?es(e):eo(e);break;case"Home":V&&i&&e.shiftKey&&D(e,u),C(),t=!0;break;case"End":V&&i&&e.shiftKey&&R(e,u),E(),t=!0;break;default:"*"===r?(L(e,u),t=!0):V&&i&&"a"===r.toLowerCase()?t=N(e):!i&&!e.shiftKey&&(n=r)&&1===n.length&&n.match(/\S/)&&(P(u,r),t=!0)}t&&(e.preventDefault(),e.stopPropagation()),g&&g(e)}},onFocus:function(e){ee||e.currentTarget!==e.target||S(u),m&&m(e)},"aria-expanded":Z?Q:null,"aria-selected":r,ref:Y,tabIndex:et?0:-1},w),tZ.createElement("div",{className:i.content,onClick:function(e){ee||S(u);var t=V&&(e.shiftKey||e.ctrlKey||e.metaKey);!Z||e.defaultPrevented||t&&_(u)||F(e,u),t?e.shiftKey?T(e,{end:u}):M(e,u,!0):M(e,u),d&&d(e)},onMouseDown:function(e){(e.shiftKey||e.ctrlKey||e.metaKey)&&e.preventDefault(),y&&y(e)},ref:J},tZ.createElement("div",{onClick:p,className:i.iconContainer},X),tZ.createElement(rP.A,{onClick:f,component:"div",className:i.label},h)),n&&tZ.createElement(x,(0,pv.A)({unmountOnExit:!0,className:i.group,in:Q,component:"ul",role:"group"},b),n))});let EY=(0,d1.A)(function(e){return{root:{listStyle:"none",margin:0,padding:0,outline:0,WebkitTapHighlightColor:"transparent","&:focus > $content $label":{backgroundColor:e.palette.action.hover},"&$selected > $content $label":{backgroundColor:(0,EK.X4)(e.palette.primary.main,e.palette.action.selectedOpacity)},"&$selected > $content $label:hover, &$selected:focus > $content $label":{backgroundColor:(0,EK.X4)(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},expanded:{},selected:{},group:{margin:0,padding:0,marginLeft:17},content:{width:"100%",display:"flex",alignItems:"center",cursor:"pointer"},iconContainer:{marginRight:4,width:15,display:"flex",flexShrink:0,justifyContent:"center","& svg":{fontSize:18}},label:{width:"100%",paddingLeft:4,position:"relative","&:hover":{backgroundColor:e.palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}}}}},{name:"MuiTreeItem"})(EJ),EX=(0,rM.A)(e=>({root:{whiteSpace:"nowrap",overflowY:"auto",padding:e.spacing(1)}}));function EZ({entry:e}){return"file"===e.type?(0,v.jsx)(EY,{nodeId:e.path,label:e.name}):(0,v.jsx)(EY,{nodeId:e.path,label:e.name,children:e.children.map(e=>(0,v.jsx)(EZ,{entry:e},e.path))})}function EQ(e){let t=EX(),r=(0,tZ.useMemo)(()=>(function(e){let t={children:[]};for(let r of e.slice().sort()){let e=r.split("/"),n=t;for(let t=0;t<e.length;t++){let r=e[t];if(""===r)throw Error("Invalid path part: ''");let i=e.slice(0,t+1).join("/"),s=n.children.find(e=>e.name===r);if(s?.type==="file")throw Error(`Duplicate filename at '${i}'`);if(s)n=s;else if(t<e.length-1){let e={type:"directory",name:r,path:i,children:[]},t=n.children.findIndex(e=>"file"===e.type);n.children.splice(t,0,e),n=e}else n.children.push({type:"file",name:r,path:i})}}return t.children})(e.filePaths),[e.filePaths]);return(0,v.jsx)(EU,{selected:e.selected,className:t.root,defaultCollapseIcon:(0,v.jsx)(rT.default,{}),defaultExpandIcon:(0,v.jsx)(Eq.default,{}),onNodeSelect:(t,r)=>{e.onSelect&&e.filePaths.includes(r)&&e.onSelect(r)},children:r.map(e=>(0,v.jsx)(EZ,{entry:e},e.path))})}let E0=(0,rM.A)(e=>({grid:{"& svg":{margin:e.spacing(1)}},closeButton:{marginLeft:"auto"}}),{name:"ScaffolderTemplateEditorBrowser"});function E1(e){let t=E0(),r=dQ(),n=r?.files.filter(e=>e.dirty),{t:i}=(0,rU.i)(r7.W);return r?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(nM.A,{className:t.grid,container:!0,spacing:0,alignItems:"center",children:[(0,v.jsx)(nu.Ay,{title:i("templateEditorPage.templateEditorBrowser.saveIconTooltip"),children:(0,v.jsx)(rq.A,{size:"small",disabled:r.files.every(e=>!e.dirty),onClick:()=>r.save(),children:(0,v.jsx)(ER.default,{})})}),(0,v.jsx)(nu.Ay,{title:i("templateEditorPage.templateEditorBrowser.reloadIconTooltip"),children:(0,v.jsx)(rq.A,{size:"small",onClick:()=>r.reload(),children:(0,v.jsx)(ED.default,{})})}),(0,v.jsx)(nu.Ay,{title:i("templateEditorPage.templateEditorBrowser.closeIconTooltip"),children:(0,v.jsx)(rq.A,{size:"small",className:t.closeButton,onClick:()=>{e.onClose&&(!n?.length||window.confirm(i("templateEditorPage.templateEditorBrowser.closeConfirmMessage")))&&e.onClose()},children:(0,v.jsx)(E$.default,{})})})]}),(0,v.jsx)(iw.A,{}),(0,v.jsx)(EQ,{selected:r.selectedFile?.path??"",onSelect:r.setSelectedFile,filePaths:r.files.map(e=>e.path)??[]})]}):null}var E2=r(16261),E4=r(71039);let E3=r(99416).Bd?window:null,E5=(0,rM.A)(e=>({container:{position:"relative",width:"100%",height:"100%"},typography:{padding:e.spacing(1.5)},button:{verticalAlign:"top"},codeMirror:{height:"100%",[e.breakpoints.up("md")]:{position:"absolute",top:0,bottom:0,left:0,right:0}},errorPanel:{color:e.palette.error.main,lineHeight:2,margin:e.spacing(0,1)},floatingButtons:{position:"absolute",top:e.spacing(1),right:e.spacing(3)},floatingButton:{padding:e.spacing(1)}}));function E6(e){let{errorText:t}=e,r=E5(),{t:n}=(0,rU.i)(r7.W),i=(0,tZ.useMemo)(()=>{if(!t)return x8.of(null);let e=document.createElement("div");return e.classList.add(r.errorPanel),e.textContent=t,x8.of(()=>({dom:e,bottom:!0}))},[r,t]);return!function(e,t,r=[],n={}){let{event:i="keydown",target:s=E3,eventOptions:o}=n,l=(0,E2.J)(t);!function(e,...t){let r=function(e=!1){let t=(0,tZ.useRef)(e),r=(0,tZ.useCallback)(()=>t.current,[]);return(0,tZ.useEffect)(()=>(t.current=!0,()=>{t.current=!1}),[]),r}(),n=(0,E2.J)(t[1]),i=(0,tZ.useMemo)(()=>function(...e){r()&&("function"==typeof n.current?n.current.apply(this,e):"function"==typeof n.current.handleEvent&&n.current.handleEvent.apply(this,e))},[]);(0,tZ.useEffect)(()=>{var r;let n=null!==(r=e)&&"object"==typeof r&&(0,E4.mQ)(r,"current")?e.current:e;if(!n)return;let s=t.slice(2);return(0,E4.on)(n,t[0],i,...s),()=>{(0,E4.AU)(n,t[0],i,...s)}},[e,t[0]])}(s,i,(0,tZ.useMemo)(()=>{let t="function"==typeof e?e:"string"==typeof e?t=>t.key===e:e?E4.ud:E4.HD;return function(e){t(e)&&l.current.call(this,e)}},r),o)}(e=>"s"===e.key&&(e.ctrlKey||e.metaKey),t=>{t.preventDefault(),e.onSave&&e.onSave()}),(0,v.jsxs)("div",{className:r.container,children:[(0,v.jsx)(Ee,{className:r.codeMirror,theme:"dark",height:"100%",extensions:[km.define(Er),i],value:e.content,onChange:e.onUpdate}),(e.onSave||e.onReload)&&(0,v.jsx)("div",{className:r.floatingButtons,children:(0,v.jsxs)(ni.A,{children:[e.onSave&&(0,v.jsx)(nu.Ay,{title:n("templateEditorPage.templateEditorTextArea.saveIconTooltip"),children:(0,v.jsx)(rq.A,{className:r.floatingButton,onClick:()=>e.onSave?.(),children:(0,v.jsx)(ER.default,{})})}),e.onReload&&(0,v.jsx)(nu.Ay,{title:n("templateEditorPage.templateEditorTextArea.refreshIconTooltip"),children:(0,v.jsx)(rq.A,{className:r.floatingButton,onClick:()=>e.onReload?.(),children:(0,v.jsx)(ED.default,{})})})]})})]})}E6.DirectoryEditor=function(e){let t=E5(),r=dQ(),{t:n}=(0,rU.i)(r7.W);if(!r)return(0,v.jsx)(rP.A,{className:t.typography,color:"textSecondary",align:"center",children:n("templateEditorPage.templateEditorTextArea.emptyStateParagraph")});let i=r?.selectedFile?.dirty?{onSave:()=>r.save(),onReload:()=>r.reload()}:{onReload:()=>r.reload()};return(0,v.jsx)(E6,{errorText:e.errorText,content:r.selectedFile?.content,onUpdate:e=>r?.selectedFile?.updateContent(e),...i})};var E9=r(65569),E8=r(62461),E7=r(39590),je=r(12326);let jt=(0,rM.A)(e=>({root:{overflowY:"auto",background:e.palette.background.default},iconSuccess:{minWidth:0,marginRight:e.spacing(1),color:e.palette.status.ok},iconFailure:{minWidth:0,marginRight:e.spacing(1),color:e.palette.status.error}}));function jr(){let e=jt(),t=Eo(),{t:r}=(0,rU.i)(r7.W);return(0,v.jsx)(nr.A,{className:e.root,dense:!0,children:t.results.map(n=>{let i=n.log.some(e=>"failed"===e.body.status),s=!1;async function o(){s=!0,await jn(n.directoryContents,`dry-run-result-${n.id}.zip`),s=!1}return(0,v.jsxs)(nn.A,{button:!0,selected:t.selectedResult?.id===n.id,onClick:()=>t.selectResult(n.id),children:[(0,v.jsx)(rK.A,{className:i?e.iconFailure:e.iconSuccess,children:i?(0,v.jsx)(ds.default,{}):(0,v.jsx)(E8.default,{})}),(0,v.jsx)(rG.A,{primary:r("templateEditorPage.dryRunResultsList.title",{resultId:`${n.id}`})}),(0,v.jsxs)(E9.A,{children:[(0,v.jsx)(rq.A,{edge:"end","aria-label":"download",title:r("templateEditorPage.dryRunResultsList.downloadButtonTitle"),disabled:s,onClick:()=>o(),children:(0,v.jsx)(je.default,{})}),(0,v.jsx)(rq.A,{edge:"end","aria-label":"delete",title:r("templateEditorPage.dryRunResultsList.deleteButtonTitle"),onClick:()=>t.deleteResult(n.id),children:(0,v.jsx)(E7.default,{})})]})]},n.id)})})}async function jn(e,t){var n;let i,{default:s}=await r.e("3214").then(r.t.bind(r,32461,23)),o=new s;for(let t of e){let e=atob(t.base64Content);await o.file(t.path,e)}n=await o.generateAsync({type:"blob"}),(i=document.createElement("a")).href=URL.createObjectURL(n),i.download=t,i.click(),URL.revokeObjectURL(i.href),i.remove()}let ji=(0,rM.A)(e=>({root:{display:"grid",gridTemplateColumns:"280px auto 3fr",gridTemplateRows:"1fr"},child:{overflowY:"auto",height:"100%",minHeight:0},firstChild:{background:e.palette.background.paper}}));function js(e){let t=ji(),r=tZ.Children.toArray(e.children);if(2!==r.length)throw Error("must have exactly 2 children");return(0,v.jsxs)("div",{className:t.root,children:[(0,v.jsx)("div",{className:nm()(t.child,t.firstChild),children:r[0]}),(0,v.jsx)(iw.A,{orientation:"horizontal"}),(0,v.jsx)("div",{className:t.child,children:r[1]})]})}let jo=(0,rM.A)({svgIcon:{display:"inline-block","& svg":{display:"inline-block",fontSize:"inherit",verticalAlign:"baseline"}}}),jl=e=>{let{href:t,text:r,Icon:n,...i}=e,s=jo();return(0,v.jsxs)(nM.A,{container:!0,direction:"row",spacing:1,children:[(0,v.jsx)(nM.A,{item:!0,children:(0,v.jsx)(rP.A,{component:"div",className:s.svgIcon,children:n?(0,v.jsx)(n,{}):(0,v.jsx)(iI.default,{})})}),(0,v.jsx)(nM.A,{item:!0,children:(0,v.jsx)(rB.N_,{to:t,...i,children:r||t})})]})},ja=({output:e})=>{let{links:t=[]}=e,r=(0,nQ.n)(),n=(0,rN.S)(iC.s);return(0,v.jsx)(rO.A,{px:3,pb:3,children:t.filter(({url:e,entityRef:t})=>e||t).map(({url:e,entityRef:t,title:r,icon:i})=>t?{title:r,icon:i,url:n((0,nq.KU)(t,{defaultKind:"<unknown>",defaultNamespace:"<unknown>"}))}:{title:r,icon:i,url:e}).map(({url:e,title:t,icon:n},i)=>(0,v.jsx)(jl,{href:e,text:t??e,Icon:n?r.getSystemIcon(n)??iI.default:iI.default,target:"_blank"},`output-link-${i}`))})};var jc=r(3380);let jh=(0,rM.A)(e=>(0,h3.A)({root:{width:"100%"},button:{marginBottom:e.spacing(2),marginLeft:e.spacing(2)},actionsContainer:{marginBottom:e.spacing(2)},resetContainer:{padding:e.spacing(3)},labelWrapper:{display:"flex",flex:1,flexDirection:"row",justifyContent:"space-between"},stepWrapper:{width:"100%"}})),ju=(0,rM.A)(e=>(0,h3.A)({root:{color:e.palette.text.disabled,display:"flex",height:22,alignItems:"center"},completed:{color:e.palette.status.ok},error:{color:e.palette.status.error}})),jd=({step:e})=>{let[t,r]=(0,tZ.useState)("");return(0,dC.A)(()=>{if(!e.startedAt)return void r("");let t=e.endedAt?nW.c9.fromISO(e.endedAt):nW.c9.local(),n=nW.c9.fromISO(e.startedAt),i=nW.IX.fromDateTimes(n,t).toDuration().valueOf();r(t1()(i,{round:!0}))},1e3),(0,v.jsx)(rP.A,{variant:"caption",children:t})};function jf(e){let t=ju(),{active:r,completed:n,error:i}=e;return(0,v.jsx)("div",{className:nm()(t.root,{[t.completed]:n,[t.error]:i}),children:r?(0,v.jsx)(dv.A,{size:"24px"}):n?(0,v.jsx)(E8.default,{}):i?(0,v.jsx)(ds.default,{}):(0,v.jsx)(jc.default,{})})}let jp=(0,tZ.memo)(e=>{let{steps:t,currentStepId:r,onUserStepChange:n}=e,i=jh(e),{t:s}=(0,rU.i)(r7.W);return(0,v.jsx)("div",{className:i.root,children:(0,v.jsx)(i8.A,{activeStep:t.findIndex(e=>e.id===r),orientation:"vertical",nonLinear:!0,children:t.map((e,t)=>{let r="cancelled"===e.status,o="processing"===e.status,l="completed"===e.status,a="failed"===e.status,c="skipped"===e.status;return(0,v.jsx)(i6.A,{expanded:!0,children:(0,v.jsx)(dy.A,{onClick:()=>n(e.id),children:(0,v.jsx)(i9.A,{StepIconProps:{completed:l,error:a||r,active:o},StepIconComponent:jf,className:i.stepWrapper,children:(0,v.jsxs)("div",{className:i.labelWrapper,children:[(0,v.jsx)(rP.A,{variant:"subtitle2",children:e.name}),c?(0,v.jsx)(rP.A,{variant:"caption",children:s("templateEditorPage.taskStatusStepper.skippedStepTitle")}):(0,v.jsx)(jd,{step:e})]})})})},String(t))})})})}),jm=(0,rM.A)({root:{display:"flex",flexFlow:"column nowrap"},contentWrapper:{flex:1,position:"relative"},content:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex","& > *":{flex:1}},codeMirror:{height:"100%",overflowY:"auto"}});function jg(){let e=jm(),{selectedResult:t}=Eo(),[r,n]=(0,tZ.useState)(""),i=t?.directoryContents.find(e=>e.path===r);return((0,tZ.useEffect)(()=>{if(t){let[e]=t.directoryContents;e?n(e.path):n("")}},[t]),t)?(0,v.jsxs)(js,{children:[(0,v.jsx)(EQ,{selected:r,onSelect:n,filePaths:t.directoryContents.map(e=>e.path)}),(0,v.jsx)(Ee,{className:e.codeMirror,theme:"dark",height:"100%",extensions:[km.define(Er)],readOnly:!0,value:i?.base64Content?atob(i.base64Content):""})]}):null}function jy(){let{selectedResult:e}=Eo(),[t,r]=(0,tZ.useState)(),n=(0,tZ.useMemo)(()=>e?e.steps.map(t=>{let r=e.log.filter(e=>e.body.stepId===t.id);return{id:t.id,name:t.name,logString:r.map(e=>e.body.message).join("\n"),status:r[r.length-1]?.body.status??"completed"}})??[]:[],[e]);if(!e)return null;let i=n.find(e=>e.id===t)??n[0];return(0,v.jsxs)(js,{children:[(0,v.jsx)(jp,{steps:n,currentStepId:i.id,onUserStepChange:r}),(0,v.jsx)(dM.r,{text:i?.logString??""})]})}function jv(){let e=jm(),{selectedResult:t}=Eo();return t?(0,v.jsxs)(js,{children:[(0,v.jsx)(rO.A,{pt:2,children:t.output?.links?.length&&(0,v.jsx)(ja,{output:t.output})}),(0,v.jsx)(Ee,{className:e.codeMirror,theme:"dark",height:"100%",extensions:[km.define(Er)],readOnly:!0,value:JSON.stringify(t.output,null,2)})]}):null}function jx(){let e=jm(),[t,r]=(0,tZ.useState)("files"),{t:n}=(0,rU.i)(r7.W);return(0,v.jsxs)("div",{className:e.root,children:[(0,v.jsxs)(Ep.A,{value:t,onChange:(e,t)=>r(t),children:[(0,v.jsx)(Ef.A,{value:"files",label:n("templateEditorPage.dryRunResultsView.tab.files")}),(0,v.jsx)(Ef.A,{value:"log",label:n("templateEditorPage.dryRunResultsView.tab.log")}),(0,v.jsx)(Ef.A,{value:"output",label:n("templateEditorPage.dryRunResultsView.tab.output")})]}),(0,v.jsx)(iw.A,{}),(0,v.jsx)("div",{className:e.contentWrapper,children:(0,v.jsxs)("div",{className:e.content,children:["files"===t&&(0,v.jsx)(jg,{}),"log"===t&&(0,v.jsx)(jy,{}),"output"===t&&(0,v.jsx)(jv,{})]})})]})}let jb=(0,rM.A)(e=>({header:{height:48,minHeight:0,"&.Mui-expanded":{height:48,minHeight:0}},content:{display:"grid",background:e.palette.background.default,gridTemplateColumns:"180px auto 1fr",gridTemplateRows:"1fr",padding:0,height:400}}));function jw(){let e,t=jb(),r=Eo(),[n,i]=(0,tZ.useState)(!1),[s,o]=(0,tZ.useState)(!0),{t:l}=(0,rU.i)(r7.W),a=r.results.length,c=(e=(0,tZ.useRef)(),(0,tZ.useEffect)(()=>{e.current=a}),e.current);return(0,tZ.useEffect)(()=>{0===c&&1===a?(o(!1),i(!0)):1===c&&0===a&&i(!1)},[c,a]),(0,v.jsx)(v.Fragment,{children:(0,v.jsxs)(rC.A,{variant:"outlined",expanded:n,hidden:0===a&&s,onChange:(e,t)=>i(t),onTransitionEnd:()=>0===a&&o(!0),children:[(0,v.jsx)(rj.A,{className:t.header,expandIcon:(0,v.jsx)(nd.default,{}),children:(0,v.jsx)(rP.A,{children:l("templateEditorPage.dryRunResults.title")})}),(0,v.jsx)(iw.A,{orientation:"horizontal"}),(0,v.jsxs)(rE.A,{className:t.content,children:[(0,v.jsx)(jr,{}),(0,v.jsx)(iw.A,{orientation:"horizontal"}),(0,v.jsx)(jx,{})]})]})})}let jk=e=>{let{layouts:t,formProps:r,fieldExtensions:n}=e,[i,s]=(0,tZ.useState)(),o=(0,x.Zp)(),l=(0,rN.S)(rk.Dg),{directory:a,openDirectory:c,createDirectory:h,closeDirectory:u}=dG(),d=(0,tZ.useCallback)(()=>{u().then(()=>o(l()))},[u,o,l]);return(0,v.jsx)(d0,{directory:a,children:(0,v.jsx)(Es,{children:(0,v.jsxs)(f7,{children:[(0,v.jsx)(pe,{children:(0,v.jsx)(EM,{fieldExtensions:n,children:(0,v.jsx)(EI,{onOpenDirectory:c,onCreateDirectory:h,onCloseDirectory:d})})}),(0,v.jsx)(pt,{children:(0,v.jsx)(E1,{onClose:u})}),(0,v.jsx)(po,{autoSaveId:"template-editor",files:(0,v.jsx)(pr,{children:(0,v.jsx)(E6.DirectoryEditor,{errorText:i})}),preview:(0,v.jsx)(pn,{children:(0,v.jsx)(Eh.DirectoryEditorDryRun,{setErrorText:s,fieldExtensions:n,layouts:t,formProps:r})})}),(0,v.jsx)(pi,{children:(0,v.jsx)(jw,{})})]})})})},jA=(0,rM.A)({content:{padding:0}},{name:"ScaffolderTemplateEditorToolbar"});function jS(e){let t=jA(),r=(0,rN.S)(rk.Dg),{t:n}=(0,rU.i)(r7.W);return(0,v.jsxs)(rW.Y,{themeId:"home",children:[(0,v.jsx)(rV.Y,{title:n("templateEditorPage.title"),subtitle:n("templateEditorPage.subtitle"),type:n("templateIntroPage.title"),typeLink:r()}),(0,v.jsx)(rH.U,{className:t.content,children:(0,v.jsx)(jk,{layouts:e.layouts,formProps:e.formProps,fieldExtensions:e.fieldExtensions})})]})}var jC=r(53318);let jE=(0,rM.A)({menu:{maxHeight:240}});function jj(e){let{options:t,selectedOption:r,onSelectOption:n}=e,i=jE(),[s,o]=(0,tZ.useState)(null),{t:l}=(0,rU.i)(r7.W),a=(0,tZ.useCallback)(e=>!!r&&r.value===e.value,[r]),c=(0,tZ.useCallback)(e=>{o(e.currentTarget)},[o]),h=(0,tZ.useCallback)(()=>{o(null)},[o]),u=(0,tZ.useCallback)(e=>{h(),n(e)},[h,n]);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(iF.A,{"aria-controls":"templates-menu","aria-haspopup":"true",onClick:c,children:l("templateEditorToolbarTemplatesMenu.button")}),(0,v.jsx)(ET.A,{id:"templates-menu",anchorEl:s,open:!!s,onClose:h,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},PaperProps:{className:i.menu},children:t.map((e,t)=>(0,v.jsx)(rJ.A,{selected:a(e),"aria-selected":a(e),onClick:()=>u(e),children:e.label},t))})]})}let jO=`# Edit the template parameters below to see how they will render in the scaffolder form UI
parameters:
  - title: Fill in some steps
    required:
      - name
    properties:
      name:
        title: Name
        type: string
        description: Unique name of the component
      owner:
        title: Owner
        type: string
        description: Owner of the component
        ui:field: OwnerPicker
        ui:options:
          catalogFilter:
            kind: Group
  - title: Choose a location
    required:
      - repoUrl
    properties:
      repoUrl:
        title: Repository Location
        type: string
        ui:field: RepoUrlPicker
        ui:options:
          allowedHosts:
            - github.com
steps:
  - id: fetch-base
    name: Fetch Base
    action: fetch:template
    input:
      url: ./template
      values:
        name: \${{parameters.name}}
`,jP=(0,rM.A)(e=>({root:{height:"100%",gridArea:"pageContent",display:"grid",gridTemplateAreas:`
      "toolbar"
      "textArea"
      "preview"
    `,[e.breakpoints.up("md")]:{gridTemplateAreas:`
      "toolbar toolbar"
      "textArea preview"
    `,gridTemplateRows:"auto 1fr",gridTemplateColumns:"1fr"}},files:{gridArea:"textArea"}}),{name:"ScaffolderTemplateFormPreviewer"}),jM=({defaultPreviewTemplate:e=jO,customFieldExtensions:t=[],layouts:r=[],formProps:n})=>{let i=jP(),s=(0,k.gf)(n7.k),o=(0,k.gf)(nH.v),l=(0,x.Zp)(),a=(0,rN.S)(rk.Dg),[c,h]=(0,tZ.useState)(),[u,d]=(0,tZ.useState)(),[f,p]=(0,tZ.useState)([]),[m,g]=(0,tZ.useState)(e),y=(0,tZ.useCallback)(()=>{l(a())},[l,a]);(0,rA.A)(()=>o.getEntities({filter:{kind:"template"},fields:["kind","metadata.namespace","metadata.name","metadata.title","spec.parameters","spec.steps","spec.output"]}).then(({items:e})=>p(e.map(e=>({label:e.metadata.title??(0,jC.S)(e,{defaultKind:"template"}),value:e})))).catch(e=>s.post({message:`Error loading existing templates: ${e.message}`,severity:"error"})),[o]);let b=(0,tZ.useCallback)(e=>{d(e),g(py.Ay.stringify(e.value.spec))},[d,g]);return(0,v.jsxs)(f7,{classes:{root:i.root},children:[(0,v.jsx)(pe,{children:(0,v.jsxs)(EM,{fieldExtensions:t,children:[(0,v.jsx)(EI,{onCloseDirectory:y}),(0,v.jsx)(jj,{options:f,selectedOption:u,onSelectOption:b})]})}),(0,v.jsx)(po,{autoSaveId:"template-form-previewer",files:(0,v.jsx)(pr,{classes:{root:i.files},children:(0,v.jsx)(E6,{content:m,onUpdate:g,errorText:c})}),preview:(0,v.jsx)(pn,{children:(0,v.jsx)(Eh,{content:m,contentIsSpec:!0,fieldExtensions:t,setErrorText:h,layouts:r,formProps:n})})})]})},jT=(0,rM.A)({root:{padding:0}});function jI(e){let t=jT(),r=(0,x.Zp)(),n=(0,rN.S)(rk.Dg),{t:i}=(0,rU.i)(r7.W),s=(0,tZ.useCallback)(()=>{r(n())},[r,n]);return(0,v.jsxs)(rW.Y,{themeId:"home",children:[(0,v.jsx)(rV.Y,{title:i("templateFormPage.title"),subtitle:i("templateFormPage.subtitle"),type:i("templateIntroPage.title"),typeLink:n()}),(0,v.jsx)(rH.U,{className:t.root,children:(0,v.jsx)(jM,{layouts:e.layouts,formProps:e.formProps,customFieldExtensions:e.fieldExtensions,defaultPreviewTemplate:e.defaultPreviewTemplate,onClose:s})})]})}var j$=r(67349),jD=r(20947),jR=r(80342),jN=r(58055),jL=r(89031),jF=r(57369),j_=r(68482);let jB=(0,rM.A)(e=>({gridRoot:{display:"flex",flex:1,alignItems:"center",justifyContent:"center"},cardGrid:{maxWidth:1e3,display:"grid",gridGap:e.spacing(2),gridAutoFlow:"row",[e.breakpoints.up("md")]:{gridTemplateRows:"1fr 1fr",gridTemplateColumns:"1fr 1fr"}},card:{display:"grid",gridTemplateColumns:"auto 1fr",gridTemplateRows:"1fr",alignItems:"center",margin:e.spacing(0,1),marginTop:e.spacing(2),padding:e.spacing(2)},icon:{justifySelf:"center",paddingTop:e.spacing(1),fontSize:48},introText:{textAlign:"center",marginTop:e.spacing(2)},infoIcon:{position:"absolute",top:e.spacing(1),right:e.spacing(1)},cardContent:{padding:e.spacing(1)}}));function jz(e){let t=!e.requireLoad||dK.isSupported(),{t:r}=(0,rU.i)(r7.W),n=jB(),{Icon:i,title:s,description:o,action:l}=e;return(0,v.jsxs)(nL.A,{className:n.card,children:[!t&&(0,v.jsx)(nu.Ay,{placement:"top",title:r("templateEditorPage.templateEditorIntro.loadLocal.unsupportedTooltip"),children:(0,v.jsx)(jL.default,{})}),(0,v.jsxs)(j$.A,{onClick:l,children:[(0,v.jsx)(jF.A,{children:(0,v.jsx)(i,{className:n.icon,color:t?void 0:"disabled"})}),(0,v.jsxs)(ib.A,{className:n.cardContent,children:[(0,v.jsx)(rP.A,{gutterBottom:!0,variant:"h5",component:"h2",color:t?void 0:"textSecondary",children:s}),(0,v.jsx)(rP.A,{variant:"body2",color:"textSecondary",component:"p",children:o})]})]})]})}function jW(e){let t=jB(),{t:r}=(0,rU.i)(r7.W);return(0,v.jsxs)("div",{style:e.style,children:[(0,v.jsx)(rP.A,{variant:"h4",component:"h2",className:t.introText,children:r("templateEditorPage.templateEditorIntro.title")}),(0,v.jsx)("div",{className:t.gridRoot,children:(0,v.jsxs)("div",{className:t.cardGrid,children:[(0,v.jsx)(jz,{title:r("templateEditorPage.templateEditorIntro.loadLocal.title"),description:r("templateEditorPage.templateEditorIntro.loadLocal.description"),requireLoad:!0,Icon:j_.default,action:()=>e.onSelect?.("local")}),(0,v.jsx)(jz,{title:r("templateEditorPage.templateEditorIntro.createLocal.title"),description:r("templateEditorPage.templateEditorIntro.createLocal.description"),requireLoad:!0,action:()=>e.onSelect?.("create-template"),Icon:jD.default}),(0,v.jsx)(jz,{title:r("templateEditorPage.templateEditorIntro.formEditor.title"),description:r("templateEditorPage.templateEditorIntro.formEditor.description"),Icon:jR.default,action:()=>e.onSelect?.("form")}),(0,v.jsx)(jz,{title:r("templateEditorPage.templateEditorIntro.fieldExplorer.title"),description:r("templateEditorPage.templateEditorIntro.fieldExplorer.description"),Icon:jN.default,action:()=>e.onSelect?.("field-explorer")})]})})]})}function jV(){let e=(0,x.Zp)(),t=(0,rN.S)(rk.rQ),r=(0,rN.S)(rk.GH),n=(0,rN.S)(rk.P),i=(0,rN.S)(rk.t6),{t:s}=(0,rU.i)(r7.W),{openDirectory:o,createDirectory:l}=dG(),a=(0,tZ.useCallback)(t=>{"local"===t?o().then(()=>e(r())).catch(()=>{}):"create-template"===t?l().then(()=>e(r())).catch(()=>{}):"form"===t?e(n()):"field-explorer"===t&&e(i())},[o,l,e,r,n,i]);return(0,v.jsxs)(rW.Y,{themeId:"home",children:[(0,v.jsx)(rV.Y,{title:s("templateIntroPage.title"),type:"Scaffolder",typeLink:t(),subtitle:s("templateIntroPage.subtitle")}),(0,v.jsx)(rH.U,{children:(0,v.jsx)(jW,{onSelect:a})})]})}var jH=r(45685);let jU=(0,rM.A)(e=>({root:{gridArea:"pageContent",display:"grid",gridGap:e.spacing(2),gridTemplateAreas:`
      "controls"
      "fieldForm"
      "preview"
    `,[e.breakpoints.up("md")]:{gridTemplateAreas:`
      "controls controls"
      "fieldForm preview"
    `,gridTemplateRows:"auto 1fr",gridTemplateColumns:"1fr 1fr"}},controls:{gridArea:"controls",display:"flex",flexFlow:"row nowrap",alignItems:"center"},fieldForm:{gridArea:"fieldForm"},preview:{gridArea:"preview",display:"grid",gridGap:e.spacing(2),alignContent:"start"}}),{name:"ScaffolderCustomFieldExplorer"}),jq=({customFieldExtensions:e=[]})=>{let t=jU(),{t:r}=(0,rU.i)(r7.W),n=e.filter(e=>!!e.schema),[i,s]=(0,tZ.useState)(n?.[0]),[o,l]=(0,tZ.useState)({}),[a,c]=(0,tZ.useState)(Date.now()),h=(0,tZ.useMemo)(()=>i?py.Ay.stringify({parameters:[{title:`${i.name} Example`,properties:{[i.name]:{type:i.schema?.returnValue?.type,"ui:field":i.name,"ui:options":o}}}]}):"",[o,i]),u=(0,tZ.useMemo)(()=>Object.fromEntries(e.map(({name:e,component:t})=>[e,t])),[e]),d=(0,tZ.useCallback)(e=>{s(e),l({})},[l,s]),f=(0,tZ.useCallback)(e=>{l(e),c(Date.now())},[l,c]);return(0,v.jsxs)("main",{className:t.root,children:[(0,v.jsx)("div",{className:t.controls,children:(0,v.jsx)(r$.Ay,{id:"custom-fields-autocomplete",value:i,options:n,getOptionLabel:e=>e.name,renderInput:e=>(0,v.jsx)(ra.A,{...e,"aria-label":r("templateEditorPage.customFieldExplorer.selectFieldLabel"),placeholder:r("templateEditorPage.customFieldExplorer.selectFieldLabel"),variant:"outlined",InputProps:{...e.InputProps,startAdornment:(0,v.jsx)(rD.A,{position:"start",children:(0,v.jsx)(rR.default,{})})}}),onChange:(e,t)=>{t&&d(t)},disableClearable:!0,fullWidth:!0})}),(0,v.jsx)("div",{className:t.fieldForm,children:(0,v.jsxs)(nL.A,{children:[(0,v.jsx)(jH.A,{title:r("templateEditorPage.customFieldExplorer.fieldForm.title")}),(0,v.jsx)(ib.A,{children:(0,v.jsx)(hJ,{showErrorList:!1,fields:{...u},noHtml5Validate:!0,formData:o,formContext:{fieldFormState:o},onSubmit:e=>f(e.formData),validator:lh,schema:i?.schema?.uiOptions||{},experimental_defaultFormStateBehavior:{allOf:"populateDefaults"},children:(0,v.jsx)(iF.A,{variant:"contained",color:"primary",type:"submit",disabled:!i?.schema?.uiOptions,children:r("templateEditorPage.customFieldExplorer.fieldForm.applyButtonTitle")})})})]})}),(0,v.jsxs)("div",{className:t.preview,children:[(0,v.jsxs)(nL.A,{children:[(0,v.jsx)(jH.A,{title:r("templateEditorPage.customFieldExplorer.preview.title")}),(0,v.jsx)(ib.A,{children:(0,v.jsx)(Ee,{readOnly:!0,theme:"dark",height:"100%",extensions:[km.define(Er)],value:h})})]}),(0,v.jsx)(Eh,{content:h,contentIsSpec:!0,fieldExtensions:e,setErrorText:()=>null},a)]})]})};function jK(e){let t=(0,rN.S)(rk.Dg),{t:r}=(0,rU.i)(r7.W);return(0,v.jsxs)(rW.Y,{themeId:"home",children:[(0,v.jsx)(rV.Y,{title:r("templateCustomFieldPage.title"),subtitle:r("templateCustomFieldPage.subtitle"),type:r("templateIntroPage.title"),typeLink:t()}),(0,v.jsx)(rH.U,{children:(0,v.jsx)(jq,{customFieldExtensions:e.fieldExtensions})})]})}var jG=r(75014);let jJ=ua.create({type:"@backstage/scaffolder/FormField",versions:["v1"]}),jY=e=>{let{components:{TemplateCardComponent:t,TaskPageComponent:r=dR,ReviewStepComponent:n,EXPERIMENTAL_TemplateOutputsComponent:i,EXPERIMENTAL_TemplateListPageComponent:s=iZ,EXPERIMENTAL_TemplateWizardPageComponent:o=uu}={}}=e,l=(0,x.P1)()||e.children,a=(e=>{let t=(0,k.gf)(S.v),[{result:r},{execute:n}]=(0,b.Y)(()=>t.getFormFields(),[]);(0,w.u)(n);let i=(0,A.O)(e,e=>e.selectByComponentData({key:t6.R}).findComponentData({key:t6.b}));return[...r?.map(e=>({component:e.component,name:e.name,validation:e.validation,schema:e.schema?.schema})),...i]})(l),c=function(e){let[{result:t},{execute:r}]=(0,b.Y)(async()=>(await Promise.all((e??[]).map(e=>e()))).map(e=>jJ.toInternal(e)),[]);return(0,w.u)(r),t}(e.formFieldLoaders),{NotFoundErrorPage:h}=(0,nQ.n)().getComponents(),u=[...a,...c,...rw.filter(({name:e})=>!a.some(t=>t.name===e))],d=(0,A.O)(l,e=>e.selectByComponentData({key:"scaffolder.layouts.wrapper.v1"}).findComponentData({key:"scaffolder.layout.v1"}));return(0,v.jsxs)(x.BV,{children:[(0,v.jsx)(x.qh,{path:"/",element:(0,v.jsx)(s,{TemplateCardComponent:t,contextMenu:e.contextMenu,groups:e.groups,templateFilter:e.templateFilter,headerOptions:e.headerOptions})}),(0,v.jsx)(x.qh,{path:rk.sP.path,element:(0,v.jsx)(t9.Q,{children:(0,v.jsx)(o,{headerOptions:e.headerOptions,customFieldExtensions:u,layouts:d,components:{ReviewStepComponent:n},formProps:e.formProps})})}),(0,v.jsx)(x.qh,{path:rk.bW.path,element:(0,v.jsx)(r,{TemplateOutputsComponent:i})}),(0,v.jsx)(x.qh,{path:rk.Dg.path,element:(0,v.jsx)(jG.T,{permission:r5.$,children:(0,v.jsx)(t9.Q,{children:(0,v.jsx)(jV,{})})})}),(0,v.jsx)(x.qh,{path:rk.t6.path,element:(0,v.jsx)(jG.T,{permission:r5.$,children:(0,v.jsx)(t9.Q,{children:(0,v.jsx)(jK,{fieldExtensions:u})})})}),(0,v.jsx)(x.qh,{path:rk.P.path,element:(0,v.jsx)(jG.T,{permission:r5.$,children:(0,v.jsx)(t9.Q,{children:(0,v.jsx)(jI,{layouts:d,formProps:e.formProps,fieldExtensions:u})})})}),(0,v.jsx)(x.qh,{path:rk.GF.path,element:(0,v.jsx)(nD,{contextMenu:e.contextMenu})}),(0,v.jsx)(x.qh,{path:rk.JX.path,element:(0,v.jsx)(nZ,{contextMenu:e.contextMenu})}),(0,v.jsx)(x.qh,{path:rk.GH.path,element:(0,v.jsx)(jG.T,{permission:r5.$,children:(0,v.jsx)(t9.Q,{children:(0,v.jsx)(jS,{layouts:d,formProps:e.formProps,fieldExtensions:u})})})}),(0,v.jsx)(x.qh,{path:rk.SE.path,element:(0,v.jsx)(EO,{contextMenu:e.contextMenu})}),(0,v.jsx)(x.qh,{path:"*",element:(0,v.jsx)(h,{})})]})},jX=e=>(0,v.jsx)(jY,{...e})},27062:function(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var s=i(r(14041));t.default=(0,n(r(74044)).default)(s.createElement("path",{d:"M18.6 6.62c-1.44 0-2.8.56-3.77 1.53L12 10.66 10.48 12h.01L7.8 14.39c-.64.64-1.49.99-2.4.99-1.87 0-3.39-1.51-3.39-3.38S3.53 8.62 5.4 8.62c.91 0 1.76.35 2.44 1.03l1.13 1 1.51-1.34L9.22 8.2C8.2 7.18 6.84 6.62 5.4 6.62 2.42 6.62 0 9.04 0 12s2.42 5.38 5.4 5.38c1.44 0 2.8-.56 3.77-1.53l2.83-2.5.01.01L13.52 12h-.01l2.69-2.39c.64-.64 1.49-.99 2.4-.99 1.87 0 3.39 1.51 3.39 3.38s-1.52 3.38-3.39 3.38c-.9 0-1.76-.35-2.44-1.03l-1.14-1.01-1.51 1.34 1.27 1.12c1.02 1.01 2.37 1.57 3.82 1.57 2.98 0 5.4-2.41 5.4-5.38s-2.42-5.37-5.4-5.37z"}),"AllInclusive")},68594:function(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var s=i(r(14041));t.default=(0,n(r(74044)).default)(s.createElement("path",{d:"M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"}),"ArrowDownward")},86868:function(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var s=i(r(14041));t.default=(0,n(r(74044)).default)(s.createElement("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.49 2 2 6.49 2 12s4.49 10 10 10 10-4.49 10-10S17.51 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"ControlPoint")},39590:function(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var s=i(r(14041));t.default=(0,n(r(74044)).default)(s.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete")},7147:function(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var s=i(r(14041));t.default=(0,n(r(74044)).default)(s.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"}),"Error")},23164:function(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var s=i(r(14041));t.default=(0,n(r(74044)).default)(s.createElement("path",{d:"M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess")},3380:function(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var s=i(r(14041));t.default=(0,n(r(74044)).default)(s.createElement("circle",{cx:"12",cy:"12",r:"8"}),"FiberManualRecord")},58055:function(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var s=i(r(14041));t.default=(0,n(r(74044)).default)(s.createElement("path",{d:"M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5zm0 12c-.83 0-1.5.68-1.5 1.5s.68 1.5 1.5 1.5 1.5-.68 1.5-1.5-.67-1.5-1.5-1.5zM7 19h14v-2H7v2zm0-6h14v-2H7v2zm0-8v2h14V5H7z"}),"FormatListBulleted")},43135:function(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var s=i(r(14041));t.default=(0,n(r(74044)).default)(s.createElement("path",{d:"M18 4H6v2l6.5 6L6 18v2h12v-3h-7l5-5-5-5h7z"}),"Functions")},12326:function(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var s=i(r(14041));t.default=(0,n(r(74044)).default)(s.createElement("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"}),"GetApp")},20353:function(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var s=i(r(14041));t.default=(0,n(r(74044)).default)(s.createElement("path",{d:"M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"}),"List")},80342:function(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var s=i(r(14041));t.default=(0,n(r(74044)).default)(s.createElement("path",{d:"M19 5v14H5V5h14m1.1-2H3.9c-.5 0-.9.4-.9.9v16.2c0 .4.4.9.9.9h16.2c.4 0 .9-.5.9-.9V3.9c0-.5-.5-.9-.9-.9zM11 7h6v2h-6V7zm0 4h6v2h-6v-2zm0 4h6v2h-6zM7 7h2v2H7zm0 4h2v2H7zm0 4h2v2H7z"}),"ListAlt")},25711:function(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var s=i(r(14041));t.default=(0,n(r(74044)).default)(s.createElement("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"PanoramaFishEye")},68482:function(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var s=i(r(14041));t.default=(0,n(r(74044)).default)(s.createElement("path",{d:"M5 4v2h14V4H5zm0 10h4v6h6v-6h4l-7-7-7 7z"}),"Publish")},10010:function(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var s=i(r(14041));t.default=(0,n(r(74044)).default)(s.createElement("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"}),"Refresh")},51767:function(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var s=i(r(14041));t.default=(0,n(r(74044)).default)(s.createElement("path",{d:"M7 11v2h10v-2H7zm5-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"RemoveCircleOutline")},55534:function(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var s=i(r(14041));t.default=(0,n(r(74044)).default)(s.createElement("path",{d:"M7 7h10v3l4-4-4-4v3H5v6h2V7zm10 10H7v-3l-4 4 4 4v-3h12v-6h-2v4z"}),"Repeat")},71108:function(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var s=i(r(14041));t.default=(0,n(r(74044)).default)(s.createElement("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"}),"Save")},25283:function(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var s=i(r(14041));t.default=(0,n(r(74044)).default)(s.createElement("path",{d:"M3 9h14V7H3v2zm0 4h14v-2H3v2zm0 4h14v-2H3v2zm16 0h2v-2h-2v2zm0-10v2h2V7h-2zm0 6h2v-2h-2v2z"}),"Toc")},85006:function(e,t,r){"use strict";var n=r(4293),i=r(78920);t.default=void 0;var s=i(r(14041));t.default=(0,n(r(74044)).default)(s.createElement("path",{d:"M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3 3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"}),"WrapText")},11259:function(e,t){"use strict";var r,n=Symbol.for("react.element"),i=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),c=Symbol.for("react.context"),h=Symbol.for("react.server_context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.suspense_list"),p=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),g=Symbol.for("react.offscreen");function y(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case s:case l:case o:case d:case f:return e;default:switch(e=e&&e.$$typeof){case h:case c:case u:case m:case p:case a:return e;default:return t}}case i:return t}}}r=Symbol.for("react.module.reference"),t.ContextConsumer=c,t.ContextProvider=a,t.Element=n,t.ForwardRef=u,t.Fragment=s,t.Lazy=m,t.Memo=p,t.Portal=i,t.Profiler=l,t.StrictMode=o,t.Suspense=d,t.SuspenseList=f,t.isAsyncMode=function(){return!1},t.isConcurrentMode=function(){return!1},t.isContextConsumer=function(e){return y(e)===c},t.isContextProvider=function(e){return y(e)===a},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n},t.isForwardRef=function(e){return y(e)===u},t.isFragment=function(e){return y(e)===s},t.isLazy=function(e){return y(e)===m},t.isMemo=function(e){return y(e)===p},t.isPortal=function(e){return y(e)===i},t.isProfiler=function(e){return y(e)===l},t.isStrictMode=function(e){return y(e)===o},t.isSuspense=function(e){return y(e)===d},t.isSuspenseList=function(e){return y(e)===f},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===s||e===l||e===o||e===d||e===f||e===g||"object"==typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===p||e.$$typeof===a||e.$$typeof===c||e.$$typeof===u||e.$$typeof===r||void 0!==e.getModuleId)||!1},t.typeOf=y},35631:function(e,t,r){"use strict";e.exports=r(11259)},95716:function(e){"undefined"!=typeof self&&self,e.exports=(()=>{"use strict";var e={d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function r(e){return"#"===e||""===e||Array.isArray(e)&&0===e.length||!1}e.r(t),e.d(t,{default:()=>A,get:()=>h,isRoot:()=>r,join:()=>w,remove:()=>g,removeUndefinedItems:()=>m,set:()=>f,split:()=>c,splitLast:()=>k});let n=/~1/g,i=/~0/g,s=/\/+/g,o=/(^[#/]*|\/+$)/g;function l(e){return e.replace(n,"/").replace(i,"~")}function a(e){return l(decodeURIComponent(e))}function c(e){if(null==e||"string"!=typeof e||r(e))return Array.isArray(e)?e:[];let t=e.indexOf("#")>=0?a:l,n=(e=(e=e.replace(s,"/")).replace(o,"")).split("/");for(let e=0,r=n.length;e<r;e+=1)n[e]=t(n[e]);return n}function h(e,t,n){if(null==t||null==e)return n;if(r(t))return e;let i=function e(t,r){let n=r.shift();if(void 0!==t)return void 0!==n?e(t[n],r):t}(e,c(t));return void 0===i?n:i}let u=/^\[.*\]$/,d=/^\[(.+)\]$/;function f(e,t,r){if(null==t)return e;let n=c(t);if(0===n.length)return e;null==e&&(e=u.test(n[0])?[]:{});let i,s,o=e;for(;n.length>1;){var l;i=n.shift(),s=u.test(n[0]),"__proto__"===(l=i)||"constructor"==l&&n.length>0&&"prototype"==n[0]||(o=function(e,t,r){if(null!=e[t])return e[t];let n=r?[]:{};return p(e,t,n),n}(o,i,s))}return p(o,i=n.pop(),r),e}function p(e,t,r){let n=t.match(d);"[]"===t&&Array.isArray(e)?e.push(r):n?e[n.pop()]=r:e[t]=r}function m(e){let t=0,r=0;for(;t+r<e.length;)void 0===e[t+r]&&(r+=1),e[t]=e[t+r],t+=1;return e.length=e.length-r,e}function g(e,t,r){let n=c(t),i=n.pop(),s=h(e,n);return s&&delete s[i],Array.isArray(s)&&!0!==r&&m(s),e}let y=/\/+/g,v=/~/g,x=/\//g;function b(e,t){if(0===e.length)return t?"#":"";for(let r=0,n=e.length;r<n;r+=1)e[r]=e[r].replace(v,"~0").replace(x,"~1"),t&&(e[r]=encodeURIComponent(e[r]));return((t?"#/":"/")+e.join("/")).replace(y,"/")}function w(e){let t=[];if(Array.isArray(e))return b(e,!0===arguments[1]);let r=arguments[arguments.length-1],n="boolean"==typeof r?r:e&&"#"===e[0];for(let e=0,r=arguments.length;e<r;e+=1)t.push.apply(t,c(arguments[e]));let i=[];for(let e=0,r=t.length;e<r;e+=1)if(".."===t[e]){if(0===i.length)return n?"#":"";i.pop()}else i.push(t[e]);return b(i,n)}function k(e){let t=c(e);if(0===t.length)return"string"==typeof e&&"#"===e[0]?["#",t[0]]:["",void 0];if(1===t.length)return"#"===e[0]?["#",t[0]]:["",t[0]];let r=t.pop();return[w(t,"#"===e[0]),r]}let A={get:h,set:f,remove:g,join:w,split:c,splitLast:k,isRoot:r,removeUndefinedItems:m};return t})()},49004:function(e,t,r){"use strict";var n=r(10646),i=r(50709),s=r(43225);function o(e,t){var r,n=1;if(0===e)return t;if(0===t)return e;for(;e%2==0&&t%2==0;)e/=2,t/=2,n*=2;for(;e%2==0;)e/=2;for(;t;){for(;t%2==0;)t/=2;e>t&&(r=t,t=e,e=r),t-=e}return n*e}function l(e,t){var r,n=0;if(0===e)return t;if(0===t)return e;for(;(1&e)==0&&(1&t)==0;)e>>>=1,t>>>=1,n++;for(;(1&e)==0;)e>>>=1;for(;t;){for(;(1&t)==0;)t>>>=1;e>t&&(r=t,t=e,e=r),t-=e}return e<<n}e.exports=function(){var e,t,r,a,c,h,u,d=arguments.length;for(u=0,e=Array(d);u<d;u++)e[u]=arguments[u];if(i(e)){if(2===d)return(c=e[0],h=e[1],c<0&&(c=-c),h<0&&(h=-h),c<=0x7fffffff&&h<=0x7fffffff)?l(c,h):o(c,h);r=e}else if(n(e[0]))if(d>1){if(r=e[0],!s(t=e[1]))throw TypeError("gcd()::invalid input argument. Accessor must be a function. Value: `"+t+"`.")}else r=e[0];else throw TypeError("gcd()::invalid input argument. Must provide an array of integers. Value: `"+e[0]+"`.");if((a=r.length)<2)return null;if(t){for(u=0,c=Array(a);u<a;u++)c[u]=t(r[u],u);r=c}if(d<3&&!i(r))throw TypeError("gcd()::invalid input argument. Accessed array values must be integers. Value: `"+r+"`.");for(u=0;u<a;u++)(c=r[u])<0&&(r[u]=-c);for(u=1,c=r[0];u<a;u++)c=(h=r[u])<=0x7fffffff&&c<=0x7fffffff?l(c,h):o(c,h);return c}},23050:function(e,t,r){"use strict";var n=r(49004),i=r(10646),s=r(50709),o=r(43225);e.exports=function(){var e,t,r,l,a,c,h,u=arguments.length;for(h=0,e=Array(u);h<u;h++)e[h]=arguments[h];if(s(e)){if(2===u)return(a=e[0],c=e[1],a<0&&(a=-a),c<0&&(c=-c),0===a||0===c)?0:a/n(a,c)*c;r=e}else if(i(e[0]))if(u>1){if(r=e[0],!o(t=e[1]))throw TypeError("lcm()::invalid input argument. Accessor must be a function. Value: `"+t+"`.")}else r=e[0];else throw TypeError("lcm()::invalid input argument. Must provide an array of integers. Value: `"+e[0]+"`.");if((l=r.length)<2)return null;if(t){for(h=0,a=Array(l);h<l;h++)a[h]=t(r[h],h);r=a}if(u<3&&!s(r))throw TypeError("lcm()::invalid input argument. Accessed array values must be integers. Value: `"+r+"`.");for(h=0;h<l;h++)(a=r[h])<0&&(r[h]=-a);for(h=1,a=r[0];h<l;h++){if(c=r[h],0===a||0===c)return 0;a=a/n(a,c)*c}return a}},52743:function(e){"use strict";var t=function(e){var t,n,i;return!!(t=e)&&"object"==typeof t&&(n=e,"[object RegExp]"!==(i=Object.prototype.toString.call(n))&&"[object Date]"!==i&&n.$$typeof!==r)},r="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function n(e,t){return!1!==t.clone&&t.isMergeableObject(e)?l(Array.isArray(e)?[]:{},e,t):e}function i(e,t,r){return e.concat(t).map(function(e){return n(e,r)})}function s(e){return Object.keys(e).concat(Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter(function(t){return Object.propertyIsEnumerable.call(e,t)}):[])}function o(e,t){try{return t in e}catch(e){return!1}}function l(e,r,a){(a=a||{}).arrayMerge=a.arrayMerge||i,a.isMergeableObject=a.isMergeableObject||t,a.cloneUnlessOtherwiseSpecified=n;var c,h,u=Array.isArray(r);return u!==Array.isArray(e)?n(r,a):u?a.arrayMerge(e,r,a):(h={},(c=a).isMergeableObject(e)&&s(e).forEach(function(t){h[t]=n(e[t],c)}),s(r).forEach(function(t){o(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))||(o(e,t)&&c.isMergeableObject(r[t])?h[t]=(function(e,t){if(!t.customMerge)return l;var r=t.customMerge(e);return"function"==typeof r?r:l})(t,c)(e[t],r[t],c):h[t]=n(r[t],c))}),h)}l.all=function(e,t){if(!Array.isArray(e))throw Error("first argument should be an array");return e.reduce(function(e,r){return l(e,r,t)},{})},e.exports=l},22193:function(e,t,r){"use strict";var n;let i=r(65280);!function(e){e.RULES=[{name:"Grammar",bnf:[["RULE_S*","%Atomic*","EOF"]]},{name:"%Atomic",bnf:[["Production","RULE_S*"]],fragment:!0},{name:"Production",bnf:[["NCName","RULE_S*",'"::="',"RULE_WHITESPACE*","Choice","RULE_WHITESPACE*","RULE_EOL+","RULE_S*"]]},{name:"NCName",bnf:[[/[a-zA-Z][a-zA-Z_0-9]*/]]},{name:"Choice",bnf:[["SequenceOrDifference","%_Choice_1*"]],fragment:!0},{name:"%_Choice_1",bnf:[["RULE_WHITESPACE*",'"|"',"RULE_WHITESPACE*","SequenceOrDifference"]],fragment:!0},{name:"SequenceOrDifference",bnf:[["Item","RULE_WHITESPACE*","%_Item_1?"]]},{name:"%_Item_1",bnf:[["Minus","Item"],["Item*"]],fragment:!0},{name:"Minus",bnf:[['"-"']]},{name:"Item",bnf:[["RULE_WHITESPACE*","%Primary","PrimaryDecoration?"]],fragment:!0},{name:"PrimaryDecoration",bnf:[['"?"'],['"*"'],['"+"']]},{name:"DecorationName",bnf:[['"ebnf://"',/[^\x5D#]+/]]},{name:"%Primary",bnf:[["NCName"],["StringLiteral"],["CharCode"],["CharClass"],["SubItem"]],fragment:!0},{name:"SubItem",bnf:[['"("',"RULE_WHITESPACE*","Choice","RULE_WHITESPACE*",'")"']]},{name:"StringLiteral",bnf:[["'\"'",/[^"]*/,"'\"'"],['"\'"',/[^']*/,'"\'"']],pinned:1},{name:"CharCode",bnf:[['"#x"',/[0-9a-zA-Z]+/]]},{name:"CharClass",bnf:[["'['","'^'?","%RULE_CharClass_1+",'"]"']]},{name:"%RULE_CharClass_1",bnf:[["CharCodeRange"],["CharRange"],["CharCode"],["RULE_Char"]],fragment:!0},{name:"RULE_Char",bnf:[[/\x09/],[/\x0A/],[/\x0D/],[/[\x20-\x5c]/],[/[\x5e-\uD7FF]/],[/[\uE000-\uFFFD]/]]},{name:"CharRange",bnf:[["RULE_Char",'"-"',"RULE_Char"]]},{name:"CharCodeRange",bnf:[["CharCode",'"-"',"CharCode"]]},{name:"RULE_WHITESPACE",bnf:[["%RULE_WHITESPACE_CHAR*"],["Comment","RULE_WHITESPACE*"]]},{name:"RULE_S",bnf:[["RULE_WHITESPACE","RULE_S*"],["RULE_EOL","RULE_S*"]]},{name:"%RULE_WHITESPACE_CHAR",bnf:[[/\x09/],[/\x20/]],fragment:!0},{name:"Comment",bnf:[['"/*"',"%RULE_Comment_Body*",'"*/"']]},{name:"%RULE_Comment_Body",bnf:[['!"*/"',/[^*]/]],fragment:!0},{name:"RULE_EOL",bnf:[[/\x0D/,/\x0A/],[/\x0A/],[/\x0D/]]},{name:"Link",bnf:[["'['","Url","']'"]]},{name:"Url",bnf:[[/[^\x5D:/?#]/,'"://"',/[^\x5D#]+/,"%Url1?"]]},{name:"%Url1",bnf:[['"#"',"NCName"]],fragment:!0}],e.defaultParser=new i.Parser(e.RULES,{debug:!1});let t=/^(!|&)/,r=/(\?|\+|\*)$/,n=/^%/;function s(e){let s=[];return e.grammarRules.forEach(o=>{if(!/^%/.test(o.name)){let l=o.recover?" /* { recoverUntil="+o.recover+" } */":"";s.push(o.name+" ::= "+function e(s,o){let l=i.findRuleByName(s,o);return l?l.bnf.map(s=>s.map(s=>(function(s,o){if("string"!=typeof s)return s.source.replace(/\\(?:x|u)([a-zA-Z0-9]+)/g,"#x$1").replace(/\[\\(?:x|u)([a-zA-Z0-9]+)-\\(?:x|u)([a-zA-Z0-9]+)\]/g,"[#x$1-#x$2]");if(t.test(s))return"";if(n.test(s)){var l,a;let t,n=r.exec(s),c=n?n[0]+" ":"";return(l=s,a=o,(t=i.findRuleByName(l,a))&&1==t.bnf.length&&1==t.bnf[0].length&&(t.bnf[0][0]instanceof RegExp||'"'==t.bnf[0][0][0]||"'"==t.bnf[0][0][0]))?e(s,o)+c:"("+e(s,o)+")"+c}return s})(s,o)).join(" ")).join(" | "):"RULE_NOT_FOUND {"+s+"}"}(o.name,e)+l)}}),s.join("\n")}e.emit=s;let o=0;function l(e){return new RegExp(e.replace(/#x([a-zA-Z0-9]{4})/g,"\\u$1").replace(/#x([a-zA-Z0-9]{3})/g,"\\u0$1").replace(/#x([a-zA-Z0-9]{2})/g,"\\x$1").replace(/#x([a-zA-Z0-9]{1})/g,"\\x0$1"))}function a(t,r=e.defaultParser){let n=r.getAST(t);if(!n)throw Error("Could not parse "+t);if(n.errors&&n.errors.length)throw n.errors[0];let i=[];return n.children.filter(e=>"Production"==e.type).map(e=>{let t=e.children.filter(e=>"NCName"==e.type)[0].text;!function e(t,r,n){let i=r.children.filter(e=>"SequenceOrDifference"==e.type).map(r=>{let i,s;return i=null,s=[],r.children.forEach((a,c)=>{if("Minus"==a.type)throw console.log("reberia restar "+a+" a "+i),Error("Difference not supported yet");let h=r.children[c+1];switch(h=h&&"PrimaryDecoration"==h.type&&h.text||"",a.type){case"SubItem":let u="%"+(n+o++);e(t,a,u),s.push(""+u+h);break;case"NCName":case"StringLiteral":s.push(""+a.text+h);break;case"CharCode":case"CharClass":if(h){let e={name:"%"+(n+o++),bnf:[[l(a.text)]]};t.push(e),s.push(""+e.name+h)}else s.push(l(a.text));break;case"PrimaryDecoration":break;default:throw Error(" HOW SHOULD I PARSE THIS? "+a.type+" -> "+JSON.stringify(a.text))}i=a}),s}),s={name:n,bnf:i},a=null;i.forEach(e=>{a=a||e.recover,delete e.recover}),0==n.indexOf("%")&&(s.fragment=!0),a&&(s.recover=a),t.push(s)}(i,e,t)}),i}e.getRules=a,e.Transform=function(t,r=e.defaultParser){return a(t.join(""),r)};class c extends i.Parser{constructor(t,r){super(a(t,r&&!0===r.debugRulesParser?new i.Parser(e.RULES,{debug:!0}):e.defaultParser),r)}emitSource(){return s(this)}}e.Parser=c}(n||(n={})),t.default=n},65280:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Parser=t.findRuleByName=t.parseRuleName=t.escapeRegExp=t.readToken=void 0;let n=/^[A-Z0-9_]+$/,i=/(\?|\+|\*)$/,s=/^(@|&|!)/,o=r(89849);function l(e,t){let r=t.exec(e);return r&&0==r.index?0==r[0].length&&t.source.length>0?null:{type:null,text:r[0],rest:e.substr(r[0].length),start:0,end:r[0].length-1,fullText:r[0],errors:[],children:[],parent:null}:null}function a(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function c(e){let t=i.exec(e),r=s.exec(e),n=t&&t[0]||"",o=r&&r[0]||"",l={raw:e,name:e.replace(i,"").replace(s,""),isOptional:"?"==n||"*"==n,allowRepetition:"+"==n||"*"==n,atLeastOne:"+"==n,lookupPositive:"&"==o,lookupNegative:"!"==o,pinned:"@"==o,lookup:!1,isLiteral:!1};return l.isLiteral="'"==l.name[0]||'"'==l.name[0],l.lookup=l.lookupNegative||l.lookupPositive,l}function h(e,t){let r=c(e);return t.cachedRules[r.name]||null}function u(e,t){if(e.children){let r=e.children.filter(e=>e.type&&t.test(e.type));for(let t=0;t<r.length;t++){let n=e.children.indexOf(r[t]);-1!=n&&e.children.splice(n,1)}e.children.forEach(e=>u(e,t))}}t.readToken=l,t.escapeRegExp=a,t.parseRuleName=c,t.findRuleByName=h;let d=["EOF"];class f{constructor(e,t){this.grammarRules=e,this.options=t,this.cachedRules={},this.debug=!!t&&!0===t.debug;let r=[],n=[];if(e.forEach(e=>{let t=c(e.name);if(t.name in this.cachedRules)return void r.push("Duplicated rule "+t.name);if(this.cachedRules[t.name]=e,e.bnf&&e.bnf.length)e.bnf.forEach(t=>{if("string"==typeof t[0]&&c(t[0]).name==e.name){let t="Left recursion is not allowed, rule: "+e.name;-1==r.indexOf(t)&&r.push(t)}t.forEach(e=>{if("string"==typeof e){let t=c(e);t.isLiteral||-1!=n.indexOf(t.name)||-1!=d.indexOf(t.name)||n.push(t.name)}})});else{let t="Missing rule content, rule: "+e.name;-1==r.indexOf(t)&&r.push(t)}"WS"==e.name&&(e.implicitWs=!1),e.implicitWs&&-1==n.indexOf("WS")&&n.push("WS"),e.recover&&-1==n.indexOf(e.recover)&&n.push(e.recover)}),n.forEach(e=>{e in this.cachedRules||r.push("Missing rule "+e)}),r.length)throw Error(r.join("\n"))}getAST(e,t){t||(t=this.grammarRules.filter(e=>!e.fragment&&0!=e.name.indexOf("%"))[0].name);let r=this.parse(e,t);if(r){!function e(t,r){r.errors&&r.errors.length&&r.errors.forEach(e=>t.push(e)),r.children&&r.children.forEach(r=>e(t,r))}(r.errors,r),function e(t,r){t.start+=r,t.end+=r,t.children&&t.children.forEach(r=>e(r,t.start))}(r,0),u(r,/^%/),this.options&&this.options.keepUpperRules||u(r,n);let e=r.rest;e&&new o.TokenError("Unexpected end of input: \n"+e,r),function e(t){t.rest="",t.children&&t.children.forEach(t=>e(t))}(r),r.rest=e}return r}emitSource(){return"CANNOT EMIT SOURCE FROM BASE Parser"}parse(e,t,r=0){let i,s=null,u=c(t),d=this.debug&&!n.test(u.name);d&&console.log(Array(r).join("  ")+"Trying to get "+t+" from "+JSON.stringify(e.split("\n")[0]));let f=u.name,p=h(u.name,this);if("EOF"==u.name){if(e.length)return null;else if(0==e.length)return{type:"EOF",text:"",rest:"",start:0,end:0,fullText:"",errors:[],children:[],parent:null}}try{if(!p&&u.isLiteral){let t=u.name.trim();if(t.startsWith('"')?t=JSON.parse(t):t.startsWith("'")&&(t=t.replace(/^'(.+)'$/,"$1").replace(/\\'/g,"'")),""===t)return{type:"%%EMPTY%%",text:"",rest:e,start:0,end:0,fullText:"",errors:[],children:[],parent:null};i=new RegExp(a(t)),f=null}}catch(e){return e instanceof ReferenceError&&console.error(e),null}if(i){let t=l(e,i);if(t)return t.type=f,t}else{let t=p.bnf;t instanceof Array&&t.forEach(t=>{if(s)return;let n=null,i={type:u.name,text:"",children:[],end:0,errors:[],fullText:"",parent:null,start:0,rest:e};p.fragment&&(i.fragment=!0);let a=e,h=0,f=t.length>0,m=!1;for(let e=0;e<t.length;e++)if("string"==typeof t[e]){let l,u=c(t[e]);f=f&&u.isOptional;let g=!1;do{if(l=null,p.implicitWs&&!(l=this.parse(a,u.name,r+1))){let e;do if(e=this.parse(a,"WS",r+1))i.text=i.text+e.text,i.end=i.text.length,e.parent=i,i.children.push(e),a=a.substr(e.text.length),h+=e.text.length;else break;while(e&&e.text.length)}if(l=l||this.parse(a,u.name,r+1),u.lookupNegative){if(l)return;break}if(u.lookupPositive&&!l)return;if(!l&&(u.isOptional||u.atLeastOne&&g))break;if(l&&p.pinned==e+1&&(n=l,d&&console.log(Array(r+1).join("  ")+" "+l.type+" PINNED")),l||(l=this.parseRecovery(p,a,r+1)),!l)if(!n)return;else s=i,l={type:"SyntaxError",text:a,children:[],end:a.length,errors:[],fullText:"",parent:null,start:0,rest:""},a.length?new o.TokenError(`Unexpected end of input. Expecting ${u.name} Got: ${a}`,l):new o.TokenError(`Unexpected end of input. Missing ${u.name}`,l),d&&console.log(Array(r+1).join("  ")+" "+l.type+" "+JSON.stringify(l.text));if(g=!0,m=!0,"%%EMPTY%%"==l.type)break;l.start+=h,l.end+=h,!u.lookupPositive&&l.type&&(l.fragment?l.children&&l.children.forEach(e=>{e.start+=h,e.end+=h,e.parent=i,i.children.push(e)}):(l.parent=i,i.children.push(l))),u.lookup&&(l.lookup=!0),d&&console.log(Array(r+1).join("  ")+" "+l.type+" "+JSON.stringify(l.text)),u.lookup||l.lookup||(i.text=i.text+l.text,i.end=i.text.length,a=a.substr(l.text.length),h+=l.text.length),i.rest=a}while(l&&u.allowRepetition&&a.length&&!l.lookup)}else{let n=l(a,t[e]);if(!n)return;d&&console.log(Array(r+1).join("  ")+"> "+JSON.stringify(n.text)+t[e].source),m=!0,n.start+=h,n.end+=h,i.text=i.text+n.text,i.end=i.text.length,a=a.substr(n.text.length),h+=n.text.length,i.rest=a}m&&(s=i,d&&console.log(Array(r).join("  ")+"<< PUSHING "+s.type+" "+JSON.stringify(s.text)))}),s&&p.simplifyWhenOneChildren&&1==s.children.length&&(s=s.children[0])}return!s&&d&&console.log(t+" NOT RESOLVED FROM "+e),s}parseRecovery(e,t,r){if(e.recover&&t.length){let n,i=this.debug;i&&console.log(Array(r+1).join("  ")+"Trying to recover until token "+e.recover+" from "+JSON.stringify(t.split("\n")[0]+t.split("\n")[1]));let s={type:"SyntaxError",text:"",children:[],end:0,errors:[],fullText:"",parent:null,start:0,rest:""};do{if(n=this.parse(t,e.recover,r+1)){new o.TokenError('Unexpected input: "'+s.text+`" Expecting: ${e.name}`,s);break}s.text=s.text+t[0],s.end=s.text.length,t=t.substr(1)}while(!n&&t.length>0);if(s.text.length>0&&n)return i&&console.log(Array(r+1).join("  ")+"Recovered text: "+JSON.stringify(s.text)),s}return null}}t.Parser=f,t.default=f},89849:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TokenError=void 0,t.TokenError=class extends Error{constructor(e,t){if(super(e),this.message=e,this.token=t,t&&t.errors)t.errors.push(this);else throw this}inspect(){return"SyntaxError: "+this.message}}},4794:function(e){!function(){var t=Object.assign||function(e){for(var t,r=1;r<arguments.length;r++)for(var n in t=arguments[r])m(t,n)&&(e[n]=t[n]);return e},r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},n=l(["",""],["",""],["",""],["",""],["",""],["",""],["",""],["  ","  "],","),i={af:l(["jaar","jaar"],["maand","maande"],["week","weke"],["dag","dae"],["uur","ure"],["minuut","minute"],["sekonde","sekondes"],["millisekonde","millisekondes"],","),am:s("","","","","","","",""),ar:t(s(function(e){return["","",""][h(e)]},function(e){return["","",""][h(e)]},function(e){return["","",""][h(e)]},function(e){return["","",""][h(e)]},function(e){return["","",""][h(e)]},function(e){return["","",""][h(e)]},function(e){return["","",""][h(e)]},function(e){return["  ","  ","  "][h(e)]},","),{delimiter:"  ",_hideCountIf2:!0,_digitReplacements:["","","","","","","","","",""]}),bg:c(["","",""],["","",""],["","",""],["","",""],["","",""],["","",""],["","",""],["","",""]),bn:s("","","","","","","",""),ca:l(["any","anys"],["mes","mesos"],["setmana","setmanes"],["dia","dies"],["hora","hores"],["minut","minuts"],["segon","segons"],["milisegon","milisegons"],","),ckb:s("","","","","","",""," ","."),cs:s(function(e){return["rok","roku","roky","let"][d(e)]},function(e){return["ms\xedc","ms\xedce","ms\xedce","ms\xedc"][d(e)]},function(e){return["t\xfdden","t\xfddne","t\xfddny","t\xfddn"][d(e)]},function(e){return["den","dne","dny","dn\xed"][d(e)]},function(e){return["hodina","hodiny","hodiny","hodin"][d(e)]},function(e){return["minuta","minuty","minuty","minut"][d(e)]},function(e){return["sekunda","sekundy","sekundy","sekund"][d(e)]},function(e){return["milisekunda","milisekundy","milisekundy","milisekund"][d(e)]},","),cy:s("flwyddyn","mis","wythnos","diwrnod","awr","munud","eiliad","milieiliad"),da:l(["\xe5r","\xe5r"],["m\xe5ned","m\xe5neder"],["uge","uger"],["dag","dage"],["time","timer"],["minut","minutter"],["sekund","sekunder"],["millisekund","millisekunder"],","),de:l(["Jahr","Jahre"],["Monat","Monate"],["Woche","Wochen"],["Tag","Tage"],["Stunde","Stunden"],["Minute","Minuten"],["Sekunde","Sekunden"],["Millisekunde","Millisekunden"],","),el:n,en:l(["year","years"],["month","months"],["week","weeks"],["day","days"],["hour","hours"],["minute","minutes"],["second","seconds"],["millisecond","milliseconds"]),eo:l(["jaro","jaroj"],["monato","monatoj"],["semajno","semajnoj"],["tago","tagoj"],["horo","horoj"],["minuto","minutoj"],["sekundo","sekundoj"],["milisekundo","milisekundoj"],","),es:l(["a\xf1o","a\xf1os"],["mes","meses"],["semana","semanas"],["d\xeda","d\xedas"],["hora","horas"],["minuto","minutos"],["segundo","segundos"],["milisegundo","milisegundos"],","),et:l(["aasta","aastat"],["kuu","kuud"],["n\xe4dal","n\xe4dalat"],["p\xe4ev","p\xe4eva"],["tund","tundi"],["minut","minutit"],["sekund","sekundit"],["millisekund","millisekundit"],","),eu:s("urte","hilabete","aste","egun","ordu","minutu","segundo","milisegundo",","),fa:s("","","","","","",""," "),fi:l(["vuosi","vuotta"],["kuukausi","kuukautta"],["viikko","viikkoa"],["p\xe4iv\xe4","p\xe4iv\xe4\xe4"],["tunti","tuntia"],["minuutti","minuuttia"],["sekunti","sekuntia"],["millisekunti","millisekuntia"],","),fo:l(["\xe1r","\xe1r"],["m\xe1na\xf0ur","m\xe1na\xf0ir"],["vika","vikur"],["dagur","dagar"],["t\xedmi","t\xedmar"],["minuttur","minuttir"],["sekund","sekund"],["millisekund","millisekund"],","),fr:s(function(e){return"an"+(e>=2?"s":"")},"mois",function(e){return"semaine"+(e>=2?"s":"")},function(e){return"jour"+(e>=2?"s":"")},function(e){return"heure"+(e>=2?"s":"")},function(e){return"minute"+(e>=2?"s":"")},function(e){return"seconde"+(e>=2?"s":"")},function(e){return"milliseconde"+(e>=2?"s":"")},","),gr:n,he:l(["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]),hr:s(function(e){return e%10==2||e%10==3||e%10==4?"godine":"godina"},function(e){return 1===e?"mjesec":2===e||3===e||4===e?"mjeseca":"mjeseci"},function(e){return e%10==1&&11!==e?"tjedan":"tjedna"},o(["dan","dana"]),function(e){return 1===e?"sat":2===e||3===e||4===e?"sata":"sati"},function(e){var t=e%10;return(2===t||3===t||4===t)&&(e<10||e>14)?"minute":"minuta"},function(e){var t=e%10;if(5===t||Math.floor(e)===e&&e>=10&&e<=19);else if(1===t)return"sekunda";else if(2===t||3===t||4===t)return"sekunde";return"sekundi"},function(e){return 1===e?"milisekunda":e%10==2||e%10==3||e%10==4?"milisekunde":"milisekundi"},","),hi:s("",o(["",""]),o(["",""]),"",o(["",""]),"","",""),hu:s("\xe9v","h\xf3nap","h\xe9t","nap","\xf3ra","perc","m\xe1sodperc","ezredm\xe1sodperc",","),id:s("tahun","bulan","minggu","hari","jam","menit","detik","milidetik"),is:l(["\xe1r","\xe1r"],["m\xe1nu\xf0ur","m\xe1nu\xf0ir"],["vika","vikur"],["dagur","dagar"],["klukkut\xedmi","klukkut\xedmar"],["m\xedn\xfata","m\xedn\xfatur"],["sek\xfanda","sek\xfandur"],["millisek\xfanda","millisek\xfandur"]),it:l(["anno","anni"],["mese","mesi"],["settimana","settimane"],["giorno","giorni"],["ora","ore"],["minuto","minuti"],["secondo","secondi"],["millisecondo","millisecondi"],","),ja:s("","","","","","","",""),km:s("","","","","","","",""),kn:l(["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]),ko:s("","","","","","",""," "),ku:s("sal","meh","hefte","roj","seet","deqe","saniye","m\xeel\xee\xe7irk",","),lo:s("","","","","","","","",","),lt:s(function(e){return e%10==0||e%100>=10&&e%100<=20?"met":"metai"},function(e){return["mnuo","mnesiai","mnesi"][f(e)]},function(e){return["savait","savaits","savaii"][f(e)]},function(e){return["diena","dienos","dien"][f(e)]},function(e){return["valanda","valandos","valand"][f(e)]},function(e){return["minut","minuts","minui"][f(e)]},function(e){return["sekund","sekunds","sekundi"][f(e)]},function(e){return["milisekund","milisekunds","milisekundi"][f(e)]},","),lv:s(function(e){return p(e)?"gads":"gadi"},function(e){return p(e)?"mnesis":"mnei"},function(e){return p(e)?"neda":"nedas"},function(e){return p(e)?"diena":"dienas"},function(e){return p(e)?"stunda":"stundas"},function(e){return p(e)?"minte":"mintes"},function(e){return p(e)?"sekunde":"sekundes"},function(e){return p(e)?"milisekunde":"milisekundes"},","),mk:l(["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],","),mn:s("",""," ","","","","",""),mr:s(o(["",""]),o(["",""]),o(["",""]),"","",o(["",""]),"",""),ms:s("tahun","bulan","minggu","hari","jam","minit","saat","milisaat"),nl:l(["jaar","jaar"],["maand","maanden"],["week","weken"],["dag","dagen"],["uur","uur"],["minuut","minuten"],["seconde","seconden"],["milliseconde","milliseconden"],","),no:l(["\xe5r","\xe5r"],["m\xe5ned","m\xe5neder"],["uke","uker"],["dag","dager"],["time","timer"],["minutt","minutter"],["sekund","sekunder"],["millisekund","millisekunder"],","),pl:s(function(e){return["rok","roku","lata","lat"][u(e)]},function(e){return["miesic","miesica","miesice","miesicy"][u(e)]},function(e){return["tydzie","tygodnia","tygodnie","tygodni"][u(e)]},function(e){return["dzie","dnia","dni","dni"][u(e)]},function(e){return["godzina","godziny","godziny","godzin"][u(e)]},function(e){return["minuta","minuty","minuty","minut"][u(e)]},function(e){return["sekunda","sekundy","sekundy","sekund"][u(e)]},function(e){return["milisekunda","milisekundy","milisekundy","milisekund"][u(e)]},","),pt:l(["ano","anos"],["m\xeas","meses"],["semana","semanas"],["dia","dias"],["hora","horas"],["minuto","minutos"],["segundo","segundos"],["milissegundo","milissegundos"],","),ro:l(["an","ani"],["lun","luni"],["sptm\xe2n","sptm\xe2ni"],["zi","zile"],["or","ore"],["minut","minute"],["secund","secunde"],["milisecund","milisecunde"],","),ru:c(["","",""],["","",""],["","",""],["","",""],["","",""],["","",""],["","",""],["","",""]),sq:s(o(["vit","vjet"]),"muaj","jav\xeb","dit\xeb","or\xeb",function(e){return"minut"+(1===e?"\xeb":"a")},function(e){return"sekond"+(1===e?"\xeb":"a")},function(e){return"milisekond"+(1===e?"\xeb":"a")},","),sr:c(["","",""],["","",""],["","",""],["","",""],["","",""],["","",""],["","",""],["","",""]),sr_Latn:c(["godini","godina","godine"],["meseci","mesec","meseca"],["nedelji","nedelja","nedelje"],["dani","dan","dana"],["sati","sat","sata"],["minuta","minut","minuta"],["sekundi","sekunda","sekunde"],["milisekundi","milisekunda","milisekunde"]),ta:l(["",""],["",""],["",""],["",""],["",""],["",""],["",""],[" "," "]),te:l(["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]),uk:c(["","",""],["","",""],["","",""],["","",""],["","",""],["","",""],["","",""],["","",""]),ur:s("",o(["",""]),o(["",""]),"",o(["",""]),"",""," "),sk:s(function(e){return["rok","roky","roky","rokov"][d(e)]},function(e){return["mesiac","mesiace","mesiace","mesiacov"][d(e)]},function(e){return["t\xfdde","t\xfddne","t\xfddne","t\xfddov"][d(e)]},function(e){return["de","dni","dni","dn\xed"][d(e)]},function(e){return["hodina","hodiny","hodiny","hod\xedn"][d(e)]},function(e){return["min\xfata","min\xfaty","min\xfaty","min\xfat"][d(e)]},function(e){return["sekunda","sekundy","sekundy","sek\xfand"][d(e)]},function(e){return["milisekunda","milisekundy","milisekundy","milisek\xfand"][d(e)]},","),sl:s(function(e){return e%10==1?"leto":e%100==2?"leti":e%100==3||e%100==4||Math.floor(e)!==e&&e%100<=5?"leta":"let"},function(e){return e%10==1?"mesec":e%100==2||Math.floor(e)!==e&&e%100<=5?"meseca":e%10==3||e%10==4?"mesece":"mesecev"},function(e){return e%10==1?"teden":e%10==2||Math.floor(e)!==e&&e%100<=4?"tedna":e%10==3||e%10==4?"tedne":"tednov"},function(e){return e%100==1?"dan":"dni"},function(e){return e%10==1?"ura":e%100==2?"uri":e%10==3||e%10==4||Math.floor(e)!==e?"ure":"ur"},function(e){return e%10==1?"minuta":e%10==2?"minuti":e%10==3||e%10==4||Math.floor(e)!==e&&e%100<=4?"minute":"minut"},function(e){return e%10==1?"sekunda":e%100==2?"sekundi":e%100==3||e%100==4||Math.floor(e)!==e?"sekunde":"sekund"},function(e){return e%10==1?"milisekunda":e%100==2?"milisekundi":e%100==3||e%100==4||Math.floor(e)!==e?"milisekunde":"milisekund"},","),sv:l(["\xe5r","\xe5r"],["m\xe5nad","m\xe5nader"],["vecka","veckor"],["dag","dagar"],["timme","timmar"],["minut","minuter"],["sekund","sekunder"],["millisekund","millisekunder"],","),sw:t(l(["mwaka","miaka"],["mwezi","miezi"],["wiki","wiki"],["siku","masiku"],["saa","masaa"],["dakika","dakika"],["sekunde","sekunde"],["milisekunde","milisekunde"]),{_numberFirst:!0}),tr:s("yl","ay","hafta","g\xfcn","saat","dakika","saniye","milisaniye",","),th:s("","","","","","","",""),uz:s("yil","oy","hafta","kun","soat","minut","sekund","millisekund"),uz_CYR:s("","","","","","","",""),vi:s("nm","th\xe1ng","tun","ng\xe0y","gi","ph\xfat","gi\xe2y","mili gi\xe2y",","),zh_CN:s("","","","","","","",""),zh_TW:s("","","","","","","","")};function s(e,t,r,n,i,s,o,l,a){var c={y:e,mo:t,w:r,d:n,h:i,m:s,s:o,ms:l};return a&&(c.decimal=a),c}function o(e){return function(t){return 1===t?e[0]:e[1]}}function l(e,t,r,n,i,l,a,c,h){return s(o(e),o(t),o(r),o(n),o(i),o(l),o(a),o(c),h)}function a(e){return function(t){return Math.floor(t)!==t?e[2]:t%100>=5&&t%100<=20||t%10>=5&&t%10<=9||t%10==0?e[0]:t%10==1?e[1]:t>1?e[2]:e[1]}}function c(e,t,r,n,i,o,l,c){return s(a(e),a(t),a(r),a(n),a(i),a(o),a(l),a(c),",")}function h(e){return 2===e?1:2*(e>2&&e<11)}function u(e){return 1===e?0:Math.floor(e)!==e?1:e%10>=2&&e%10<=4&&!(e%100>10&&e%100<20)?2:3}function d(e){return 1===e?0:Math.floor(e)!==e?1:e%10>=2&&e%10<=4&&e%100<10?2:3}function f(e){return 1===e||e%10==1&&e%100>20?0:Math.floor(e)!==e||e%10>=2&&e%100>20||e%10>=2&&e%100<10?1:2}function p(e){return e%10==1&&e%100!=11}function m(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function g(e,t,r){var n,i,s,o,l=e.unitName,a=e.unitCount,c=r.spacer,h=r.maxDecimalPoints;n=m(r,"decimal")?r.decimal:m(t,"decimal")?t.decimal:".","digitReplacements"in r?i=r.digitReplacements:"_digitReplacements"in t&&(i=t._digitReplacements);var u=(void 0===h?a:Math.floor(a*Math.pow(10,h))/Math.pow(10,h)).toString();if(t._hideCountIf2&&2===a)s="",c="";else if(i){s="";for(var d=0;d<u.length;d++){var f=u[d];"."===f?s+=n:s+=i[f]}}else s=u.replace(".",n);var p=t[l];return(o="function"==typeof p?p(a):p,t._numberFirst)?o+c+s:s+c+o}function y(e){var n=function(e,s){e=Math.abs(e);var o=t({},n,s||{});return function(e,t){var n,s=function(e){var t=[e.language];if(m(e,"fallbacks"))if(r(e.fallbacks)&&e.fallbacks.length)t=t.concat(e.fallbacks);else throw Error("fallbacks must be an array with at least one element");for(var n=0;n<t.length;n++){var s=t[n];if(m(e.languages,s))return e.languages[s];if(m(i,s))return i[s]}throw Error("No language found.")}(t);if(!e.length){var o=t.units;return g({unitName:o[o.length-1],unitCount:0},s,t)}var l=t.conjunction,a=t.serialComma;n=m(t,"delimiter")?t.delimiter:m(s,"delimiter")?s.delimiter:", ";for(var c=[],h=0;h<e.length;h++)c.push(g(e[h],s,t));return l&&1!==e.length?2===e.length?c.join(l):c.slice(0,-1).join(n)+(a?",":"")+l+c.slice(-1):c.join(n)}(function(e,t){var r,n,i,s,o=t.units,l=t.unitMeasures,a="largest"in t?t.largest:1/0;if(!o.length)return[];var c={};for(n=0,s=e;n<o.length;n++){var h=l[r=o[n]];i=n===o.length-1?s/h:Math.floor(s/h),c[r]=i,s-=i*h}if(t.round){var u=a;for(n=0;n<o.length;n++)if(0!==(i=c[r=o[n]])&&0==--u){for(var d=n+1;d<o.length;d++){var f=o[d],p=c[f];c[r]+=p*l[f]/l[r],c[f]=0}break}for(n=o.length-1;n>=0;n--)if(0!==(i=c[r=o[n]])){var m=Math.round(i);if(c[r]=m,0===n)break;var g=o[n-1],y=l[g],v=Math.floor(m*l[r]/y);if(v)c[g]+=v,c[r]=0;else break}}var x=[];for(n=0;n<o.length&&x.length<a;n++)(i=c[r=o[n]])&&x.push({unitName:r,unitCount:i});return x}(e,o),o)};return t(n,{language:"en",spacer:" ",conjunction:"",serialComma:!0,units:["y","mo","w","d","h","m","s"],languages:{},round:!1,unitMeasures:{y:315576e5,mo:26298e5,w:6048e5,d:864e5,h:36e5,m:6e4,s:1e3,ms:1}},e)}var v=t(y({}),{getSupportedLanguages:function(){var e=[];for(var t in i)m(i,t)&&"gr"!==t&&e.push(t);return e},humanizer:y});"function"==typeof define&&define.amd?define(function(){return v}):e.exports?e.exports=v:this.humanizeDuration=v}()},12651:function(e,t,r){var n=r(46343),i=r(40074),s=r(82438),o=r(19106),l=r(32293),a=r(30306),c=r(48360),h=r(22563),u=e=>Array.isArray(e)?e:[e],d=e=>c(e)||Array.isArray(e)?Object.keys(e):[],f=e=>void 0===e||Array.isArray(e)&&0===e.length,p=(e,t)=>void 0===e&&0===t||void 0===t&&0===e||n(e,t),m=e=>void 0===e||n(e,{})||!0===e,g=e=>void 0===e||n(e,{}),y=e=>void 0===e||c(e)||!0===e||!1===e;function v(e,t){return!!(f(e)&&f(t))||n(i(s(e)),i(s(t)))}function x(e,t,r,o){var l=s(d(e).concat(d(t)));return!!(g(e)&&g(t))||!(g(e)&&d(t).length||g(t)&&d(e).length)&&l.every(function(r){var l=e[r],a=t[r];return Array.isArray(l)&&Array.isArray(a)?n(i(s(e)),i(s(t))):!(Array.isArray(l)&&!Array.isArray(a)||Array.isArray(a)&&!Array.isArray(l))&&t&&t.hasOwnProperty(r)&&e&&e.hasOwnProperty(r)&&o(e[r],t[r])})}function b(e,t,r,n){var i=o(e,n),s=o(t,n);return a(i,s,n).length===Math.max(i.length,s.length)}var w={title:n,uniqueItems:(e,t)=>void 0===e&&!1===t||void 0===t&&!1===e||n(e,t),minLength:p,minItems:p,minProperties:p,required:v,enum:v,type:function(e,t){return e=u(e),t=u(t),n(i(s(e)),i(s(t)))},items:function(e,t,r,i){return c(e)&&c(t)?i(e,t):Array.isArray(e)&&Array.isArray(t)?x(e,t,r,i):n(e,t)},anyOf:b,allOf:b,oneOf:b,properties:x,patternProperties:x,dependencies:x},k=["properties","patternProperties","dependencies","uniqueItems","minLength","minItems","minProperties","required"],A=["additionalProperties","additionalItems","contains","propertyNames","not"];e.exports=function e(t,r,i){if(i=l(i,{ignore:[]}),m(t)&&m(r))return!0;if(!y(t)||!y(r))throw Error("Either of the values are not a JSON schema.");if(t===r)return!0;if(h(t)&&h(r))return t===r;if(void 0===t&&!1===r||void 0===r&&!1===t||void 0===t&&void 0!==r||void 0!==t&&void 0===r)return!1;var o=s(Object.keys(t).concat(Object.keys(r)));if(i.ignore.length&&(o=o.filter(e=>-1===i.ignore.indexOf(e))),!o.length)return!0;function a(t,r){return e(t,r,i)}return o.every(function(s){var o=t[s],l=r[s];if(-1!==A.indexOf(s))return e(o,l,i);var c=w[s];if(c||(c=n),n(o,l))return!0;if(-1===k.indexOf(s)&&(!t.hasOwnProperty(s)&&r.hasOwnProperty(s)||t.hasOwnProperty(s)&&!r.hasOwnProperty(s)))return o===l;var u=c(o,l,s,a);if(!h(u))throw Error("Comparer must return true or false");return u})}},11543:function(e,t){"use strict";function r(e){return e[0]}Object.defineProperty(t,"__esModule",{value:!0});let n=e=>[].concat(...e.map(e=>Array.isArray(e)?n(e):e));function i(e){return e?Array.isArray(e)?n(e).join(""):e:""}t.default={Lexer:void 0,ParserRules:[{name:"Reverse_path",symbols:["Path"]},{name:"Reverse_path$string$1",symbols:[{literal:"<"},{literal:">"}],postprocess:e=>e.join("")},{name:"Reverse_path",symbols:["Reverse_path$string$1"]},{name:"Forward_path$subexpression$1$subexpression$1",symbols:[{literal:"<"},/[pP]/,/[oO]/,/[sS]/,/[tT]/,/[mM]/,/[aA]/,/[sS]/,/[tT]/,/[eE]/,/[rR]/,{literal:"@"}],postprocess:function(e){return e.join("")}},{name:"Forward_path$subexpression$1",symbols:["Forward_path$subexpression$1$subexpression$1","Domain",{literal:">"}]},{name:"Forward_path",symbols:["Forward_path$subexpression$1"]},{name:"Forward_path$subexpression$2",symbols:[{literal:"<"},/[pP]/,/[oO]/,/[sS]/,/[tT]/,/[mM]/,/[aA]/,/[sS]/,/[tT]/,/[eE]/,/[rR]/,{literal:">"}],postprocess:function(e){return e.join("")}},{name:"Forward_path",symbols:["Forward_path$subexpression$2"]},{name:"Forward_path",symbols:["Path"]},{name:"Path$ebnf$1$subexpression$1",symbols:["A_d_l",{literal:":"}]},{name:"Path$ebnf$1",symbols:["Path$ebnf$1$subexpression$1"],postprocess:r},{name:"Path$ebnf$1",symbols:[],postprocess:()=>null},{name:"Path",symbols:[{literal:"<"},"Path$ebnf$1","Mailbox",{literal:">"}]},{name:"A_d_l$ebnf$1",symbols:[]},{name:"A_d_l$ebnf$1$subexpression$1",symbols:[{literal:","},"At_domain"]},{name:"A_d_l$ebnf$1",symbols:["A_d_l$ebnf$1","A_d_l$ebnf$1$subexpression$1"],postprocess:e=>e[0].concat([e[1]])},{name:"A_d_l",symbols:["At_domain","A_d_l$ebnf$1"]},{name:"At_domain",symbols:[{literal:"@"},"Domain"]},{name:"Domain$ebnf$1",symbols:[]},{name:"Domain$ebnf$1$subexpression$1",symbols:[{literal:"."},"sub_domain"]},{name:"Domain$ebnf$1",symbols:["Domain$ebnf$1","Domain$ebnf$1$subexpression$1"],postprocess:e=>e[0].concat([e[1]])},{name:"Domain",symbols:["sub_domain","Domain$ebnf$1"]},{name:"sub_domain",symbols:["U_label"]},{name:"Let_dig",symbols:["ALPHA_DIGIT"],postprocess:r},{name:"Ldh_str$ebnf$1",symbols:[]},{name:"Ldh_str$ebnf$1",symbols:["Ldh_str$ebnf$1","ALPHA_DIG_DASH"],postprocess:e=>e[0].concat([e[1]])},{name:"Ldh_str",symbols:["Ldh_str$ebnf$1","Let_dig"]},{name:"U_Let_dig",symbols:["ALPHA_DIGIT_U"],postprocess:r},{name:"U_Ldh_str$ebnf$1",symbols:[]},{name:"U_Ldh_str$ebnf$1",symbols:["U_Ldh_str$ebnf$1","ALPHA_DIG_DASH_U"],postprocess:e=>e[0].concat([e[1]])},{name:"U_Ldh_str",symbols:["U_Ldh_str$ebnf$1","U_Let_dig"]},{name:"U_label$ebnf$1$subexpression$1",symbols:["U_Ldh_str"]},{name:"U_label$ebnf$1",symbols:["U_label$ebnf$1$subexpression$1"],postprocess:r},{name:"U_label$ebnf$1",symbols:[],postprocess:()=>null},{name:"U_label",symbols:["U_Let_dig","U_label$ebnf$1"]},{name:"address_literal$subexpression$1",symbols:["IPv4_address_literal"]},{name:"address_literal$subexpression$1",symbols:["IPv6_address_literal"]},{name:"address_literal$subexpression$1",symbols:["General_address_literal"]},{name:"address_literal",symbols:[{literal:"["},"address_literal$subexpression$1",{literal:"]"}]},{name:"non_local_part",symbols:["Domain"],postprocess:function(e){return{DomainName:i(e[0])}}},{name:"non_local_part",symbols:["address_literal"],postprocess:function(e){return{AddressLiteral:i(e[0])}}},{name:"Mailbox",symbols:["Local_part",{literal:"@"},"non_local_part"],postprocess:function(e){return{localPart:i(e[0]),domainPart:i(e[2])}}},{name:"Local_part",symbols:["Dot_string"],postprocess:function(e){return{DotString:i(e[0])}}},{name:"Local_part",symbols:["Quoted_string"],postprocess:function(e){return{QuotedString:i(e[0])}}},{name:"Dot_string$ebnf$1",symbols:[]},{name:"Dot_string$ebnf$1$subexpression$1",symbols:[{literal:"."},"Atom"]},{name:"Dot_string$ebnf$1",symbols:["Dot_string$ebnf$1","Dot_string$ebnf$1$subexpression$1"],postprocess:e=>e[0].concat([e[1]])},{name:"Dot_string",symbols:["Atom","Dot_string$ebnf$1"]},{name:"Atom$ebnf$1",symbols:[/[0-9A-Za-z!#$%&'*+\-/=?^_`{|}~\u0080-\uFFFF/]/]},{name:"Atom$ebnf$1",symbols:["Atom$ebnf$1",/[0-9A-Za-z!#$%&'*+\-/=?^_`{|}~\u0080-\uFFFF/]/],postprocess:e=>e[0].concat([e[1]])},{name:"Atom",symbols:["Atom$ebnf$1"]},{name:"Quoted_string$ebnf$1",symbols:[]},{name:"Quoted_string$ebnf$1",symbols:["Quoted_string$ebnf$1","QcontentSMTP"],postprocess:e=>e[0].concat([e[1]])},{name:"Quoted_string",symbols:["DQUOTE","Quoted_string$ebnf$1","DQUOTE"]},{name:"QcontentSMTP",symbols:["qtextSMTP"]},{name:"QcontentSMTP",symbols:["quoted_pairSMTP"]},{name:"quoted_pairSMTP",symbols:[{literal:"\\"},/[\x20-\x7e]/]},{name:"qtextSMTP",symbols:[/[\x20-\x21\x23-\x5b\x5d-\x7e\u0080-\uFFFF]/],postprocess:r},{name:"IPv4_address_literal$macrocall$2",symbols:[{literal:"."},"Snum"]},{name:"IPv4_address_literal$macrocall$1",symbols:["IPv4_address_literal$macrocall$2","IPv4_address_literal$macrocall$2","IPv4_address_literal$macrocall$2"]},{name:"IPv4_address_literal",symbols:["Snum","IPv4_address_literal$macrocall$1"]},{name:"IPv6_address_literal$subexpression$1",symbols:[/[iI]/,/[pP]/,/[vV]/,{literal:"6"},{literal:":"}],postprocess:function(e){return e.join("")}},{name:"IPv6_address_literal",symbols:["IPv6_address_literal$subexpression$1","IPv6_addr"]},{name:"General_address_literal$ebnf$1",symbols:["dcontent"]},{name:"General_address_literal$ebnf$1",symbols:["General_address_literal$ebnf$1","dcontent"],postprocess:e=>e[0].concat([e[1]])},{name:"General_address_literal",symbols:["Standardized_tag",{literal:":"},"General_address_literal$ebnf$1"]},{name:"Standardized_tag",symbols:["Ldh_str"]},{name:"dcontent",symbols:[/[\x21-\x5a\x5e-\x7e]/],postprocess:r},{name:"Snum",symbols:["DIGIT"]},{name:"Snum$subexpression$1",symbols:[/[1-9]/,"DIGIT"]},{name:"Snum",symbols:["Snum$subexpression$1"]},{name:"Snum$subexpression$2",symbols:[{literal:"1"},"DIGIT","DIGIT"]},{name:"Snum",symbols:["Snum$subexpression$2"]},{name:"Snum$subexpression$3",symbols:[{literal:"2"},/[0-4]/,"DIGIT"]},{name:"Snum",symbols:["Snum$subexpression$3"]},{name:"Snum$subexpression$4",symbols:[{literal:"2"},{literal:"5"},/[0-5]/]},{name:"Snum",symbols:["Snum$subexpression$4"]},{name:"IPv6_addr",symbols:["IPv6_full"]},{name:"IPv6_addr",symbols:["IPv6_comp"]},{name:"IPv6_addr",symbols:["IPv6v4_full"]},{name:"IPv6_addr",symbols:["IPv6v4_comp"]},{name:"IPv6_hex",symbols:["HEXDIG"]},{name:"IPv6_hex$subexpression$1",symbols:["HEXDIG","HEXDIG"]},{name:"IPv6_hex",symbols:["IPv6_hex$subexpression$1"]},{name:"IPv6_hex$subexpression$2",symbols:["HEXDIG","HEXDIG","HEXDIG"]},{name:"IPv6_hex",symbols:["IPv6_hex$subexpression$2"]},{name:"IPv6_hex$subexpression$3",symbols:["HEXDIG","HEXDIG","HEXDIG","HEXDIG"]},{name:"IPv6_hex",symbols:["IPv6_hex$subexpression$3"]},{name:"IPv6_full$macrocall$2",symbols:[{literal:":"},"IPv6_hex"]},{name:"IPv6_full$macrocall$1",symbols:["IPv6_full$macrocall$2","IPv6_full$macrocall$2","IPv6_full$macrocall$2","IPv6_full$macrocall$2","IPv6_full$macrocall$2","IPv6_full$macrocall$2","IPv6_full$macrocall$2"]},{name:"IPv6_full",symbols:["IPv6_hex","IPv6_full$macrocall$1"]},{name:"IPv6_comp$ebnf$1$subexpression$1$macrocall$2",symbols:[{literal:":"},"IPv6_hex"]},{name:"IPv6_comp$ebnf$1$subexpression$1$macrocall$1",symbols:["IPv6_comp$ebnf$1$subexpression$1$macrocall$2","IPv6_comp$ebnf$1$subexpression$1$macrocall$2","IPv6_comp$ebnf$1$subexpression$1$macrocall$2","IPv6_comp$ebnf$1$subexpression$1$macrocall$2","IPv6_comp$ebnf$1$subexpression$1$macrocall$2"]},{name:"IPv6_comp$ebnf$1$subexpression$1",symbols:["IPv6_hex","IPv6_comp$ebnf$1$subexpression$1$macrocall$1"]},{name:"IPv6_comp$ebnf$1",symbols:["IPv6_comp$ebnf$1$subexpression$1"],postprocess:r},{name:"IPv6_comp$ebnf$1",symbols:[],postprocess:()=>null},{name:"IPv6_comp$string$1",symbols:[{literal:":"},{literal:":"}],postprocess:e=>e.join("")},{name:"IPv6_comp$ebnf$2$subexpression$1$macrocall$2",symbols:[{literal:":"},"IPv6_hex"]},{name:"IPv6_comp$ebnf$2$subexpression$1$macrocall$1",symbols:["IPv6_comp$ebnf$2$subexpression$1$macrocall$2","IPv6_comp$ebnf$2$subexpression$1$macrocall$2","IPv6_comp$ebnf$2$subexpression$1$macrocall$2","IPv6_comp$ebnf$2$subexpression$1$macrocall$2","IPv6_comp$ebnf$2$subexpression$1$macrocall$2"]},{name:"IPv6_comp$ebnf$2$subexpression$1",symbols:["IPv6_hex","IPv6_comp$ebnf$2$subexpression$1$macrocall$1"]},{name:"IPv6_comp$ebnf$2",symbols:["IPv6_comp$ebnf$2$subexpression$1"],postprocess:r},{name:"IPv6_comp$ebnf$2",symbols:[],postprocess:()=>null},{name:"IPv6_comp",symbols:["IPv6_comp$ebnf$1","IPv6_comp$string$1","IPv6_comp$ebnf$2"]},{name:"IPv6v4_full$macrocall$2",symbols:[{literal:":"},"IPv6_hex"]},{name:"IPv6v4_full$macrocall$1",symbols:["IPv6v4_full$macrocall$2","IPv6v4_full$macrocall$2","IPv6v4_full$macrocall$2","IPv6v4_full$macrocall$2","IPv6v4_full$macrocall$2"]},{name:"IPv6v4_full",symbols:["IPv6_hex","IPv6v4_full$macrocall$1",{literal:":"},"IPv4_address_literal"]},{name:"IPv6v4_comp$ebnf$1$subexpression$1$macrocall$2",symbols:[{literal:":"},"IPv6_hex"]},{name:"IPv6v4_comp$ebnf$1$subexpression$1$macrocall$1",symbols:["IPv6v4_comp$ebnf$1$subexpression$1$macrocall$2","IPv6v4_comp$ebnf$1$subexpression$1$macrocall$2","IPv6v4_comp$ebnf$1$subexpression$1$macrocall$2"]},{name:"IPv6v4_comp$ebnf$1$subexpression$1",symbols:["IPv6_hex","IPv6v4_comp$ebnf$1$subexpression$1$macrocall$1"]},{name:"IPv6v4_comp$ebnf$1",symbols:["IPv6v4_comp$ebnf$1$subexpression$1"],postprocess:r},{name:"IPv6v4_comp$ebnf$1",symbols:[],postprocess:()=>null},{name:"IPv6v4_comp$string$1",symbols:[{literal:":"},{literal:":"}],postprocess:e=>e.join("")},{name:"IPv6v4_comp$ebnf$2$subexpression$1$macrocall$2",symbols:[{literal:":"},"IPv6_hex"]},{name:"IPv6v4_comp$ebnf$2$subexpression$1$macrocall$1",symbols:["IPv6v4_comp$ebnf$2$subexpression$1$macrocall$2","IPv6v4_comp$ebnf$2$subexpression$1$macrocall$2","IPv6v4_comp$ebnf$2$subexpression$1$macrocall$2"]},{name:"IPv6v4_comp$ebnf$2$subexpression$1",symbols:["IPv6_hex","IPv6v4_comp$ebnf$2$subexpression$1$macrocall$1",{literal:":"}]},{name:"IPv6v4_comp$ebnf$2",symbols:["IPv6v4_comp$ebnf$2$subexpression$1"],postprocess:r},{name:"IPv6v4_comp$ebnf$2",symbols:[],postprocess:()=>null},{name:"IPv6v4_comp",symbols:["IPv6v4_comp$ebnf$1","IPv6v4_comp$string$1","IPv6v4_comp$ebnf$2","IPv4_address_literal"]},{name:"DIGIT",symbols:[/[0-9]/],postprocess:r},{name:"ALPHA_DIGIT_U",symbols:[/[0-9A-Za-z\u0080-\uFFFF]/],postprocess:r},{name:"ALPHA_DIGIT",symbols:[/[0-9A-Za-z]/],postprocess:r},{name:"ALPHA_DIG_DASH",symbols:[/[-0-9A-Za-z]/],postprocess:r},{name:"ALPHA_DIG_DASH_U",symbols:[/[-0-9A-Za-z\u0080-\uFFFF]/],postprocess:r},{name:"HEXDIG",symbols:[/[0-9A-Fa-f]/],postprocess:r},{name:"DQUOTE",symbols:[{literal:'"'}],postprocess:r}],ParserStart:"Reverse_path"}},96542:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.canonicalize=t.canonicalize_quoted_string=t.normalize=t.normalize_dot_string=t.parse=void 0;let i=r(63662),s=n(r(11543));s.default.ParserStart="Mailbox";let o=i.Grammar.fromCompiled(s.default);function l(e){let t=new i.Parser(o);if(t.feed(e),1!==t.results.length)throw Error("address parsing failed: ambiguous grammar");return t.results[0]}function a(e){let t;return(-1===(t=e.indexOf("+"))?e:e.substr(0,t)).replace(/\./g,"").toLowerCase()}function c(e){let t=e.substr(1).substr(0,e.length-2).replace(/(?:\\(.))/g,"$1").replace(/(?:(["\\]))/g,"\\$1");return`"${t}"`}t.parse=l,t.normalize_dot_string=a,t.normalize=function(e){var t,r;let n=l(e),i=null!=(t=n.domainPart.AddressLiteral)?t:n.domainPart.DomainName.toLowerCase(),s=null!=(r=n.localPart.QuotedString)?r:a(n.localPart.DotString);return`${s}@${i}`},t.canonicalize_quoted_string=c,t.canonicalize=function(e){var t;let r=l(e),n=null!=(t=r.domainPart.AddressLiteral)?t:r.domainPart.DomainName.toLowerCase(),i=r.localPart.QuotedString?c(r.localPart.QuotedString):r.localPart.DotString;return`${i}@${n}`}},28690:function(e,t,r){let n=r(75857),i=r(53435),s=r(48360),o=r(82438),l=r(19106),a=r(30795),c=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),h=e=>s(e)||Array.isArray(e)?Object.keys(e):[],u=e=>!h(e).length&&!1!==e&&!0!==e;e.exports={allUniqueKeys:e=>o(i(e.map(h))),deleteUndefinedProps:function(e){for(let t in e)c(e,t)&&u(e[t])&&delete e[t];return e},getValues:(e,t)=>e.map(e=>e&&e[t]),has:c,isEmptySchema:u,isSchema:e=>s(e)||!0===e||!1===e,keys:h,notUndefined:e=>void 0!==e,uniqWith:l,withoutArr:(e,...t)=>a.apply(null,[e].concat(n(t)))}},52474:function(e,t,r){let n=r(12651),i=r(83657),{allUniqueKeys:s,deleteUndefinedProps:o,has:l,isSchema:a,notUndefined:c,uniqWith:h}=r(28690);e.exports={keywords:["items","additionalItems"],resolver(e,t,r){var u,d;let f,p=e.map(e=>e.items),m=p.filter(c),g={};return m.every(a)?g.items=r.items(p):(u=r.items,g.items=s(p).reduce(function(t,r){let i=h(e.map(function(e){if(e)if(!Array.isArray(e.items))return e.items;else{let t=e.items[r];if(a(t))return t;if(l(e,"additionalItems"))return e.additionalItems}}).filter(c),n);return t[r]=u(i,r),t},[])),m.every(Array.isArray)?f=e.map(e=>e.additionalItems):m.some(Array.isArray)&&(f=e.map(function(e){if(e)return Array.isArray(e.items)?e.additionalItems:e.items})),f&&(g.additionalItems=r.additionalItems(f)),!1===g.additionalItems&&Array.isArray(g.items)&&i(d=g.items,function(e,t){!1===e&&d.splice(t,1)}),o(g)}}},51537:function(e,t,r){let n=r(12651),i=r(83657),{allUniqueKeys:s,deleteUndefinedProps:o,getValues:l,keys:a,notUndefined:c,uniqWith:h,withoutArr:u}=r(28690);function d(e,t){return s(e).reduce(function(r,i){let s=h(l(e,i).filter(c),n);return r[i]=t(s,i),r},{})}e.exports={keywords:["properties","patternProperties","additionalProperties"],resolver(e,t,r,n){var s;n.ignoreAdditionalProperties||(e.forEach(function(t){let n=e.filter(e=>e!==t),i=a(t.properties),s=a(t.patternProperties).map(e=>new RegExp(e));n.forEach(function(e){let n=a(e.properties),o=n.filter(e=>s.some(t=>t.test(e)));u(n,i,o).forEach(function(n){e.properties[n]=r.properties([e.properties[n],t.additionalProperties],n)})})}),e.forEach(function(t){let r=e.filter(e=>e!==t),n=a(t.patternProperties);!1===t.additionalProperties&&r.forEach(function(e){u(a(e.patternProperties),n).forEach(t=>delete e.patternProperties[t])})}));let l={additionalProperties:r.additionalProperties(e.map(e=>e.additionalProperties)),patternProperties:d(e.map(e=>e.patternProperties),r.patternProperties),properties:d(e.map(e=>e.properties),r.properties)};return!1===l.additionalProperties&&i(s=l.properties,function(e,t){!1===e&&delete s[t]}),o(l)}}},587:function(e,t,r){let n=r(46108),i=r(12651),s=r(23050),o=r(69383),l=r(75857),a=r(53435),c=r(58150),h=r(30306),u=r(46343),d=r(48360),f=r(92962),p=r(40074),m=r(82438),g=r(19106),y=r(51537),v=r(52474),x=(e,t)=>-1!==e.indexOf(t),b=e=>d(e)||!0===e||!1===e,w=e=>!1===e,k=e=>!0===e,A=(e,t,r)=>r(e),S=e=>p(m(a(e))),C=e=>void 0!==e,E=e=>m(a(e.map(T))),j=e=>e[0],O=e=>Math.max.apply(Math,e),P=e=>Math.min.apply(Math,e);function M(e,t){return e.map(e=>e&&e[t])}function T(e){return d(e)||Array.isArray(e)?Object.keys(e):[]}function I(e,t){let r;try{r=e.map(function(e){return JSON.stringify(e,null,2)}).join("\n")}catch(t){r=e.join(", ")}throw Error('Could not resolve values for path:"'+t.join(".")+'". They are probably incompatible. Values: \n'+r)}function $(e){return{required:e}}let D=["properties","patternProperties","definitions","dependencies"],R=["anyOf","oneOf"],N=["additionalProperties","additionalItems","contains","propertyNames","not","items"],L={type(e){if(e.some(Array.isArray)){let t=e.map(function(e){return Array.isArray(e)?e:[e]}),r=c.apply(null,t);if(1===r.length)return r[0];if(r.length>1)return m(r)}},dependencies:(e,t,r)=>E(e).reduce(function(t,n){let s=g(M(e,n).filter(C),u),o=s.filter(Array.isArray);if(o.length){if(o.length===s.length)t[n]=S(s);else{let e=s.filter(b),i=o.map($);t[n]=r(e.concat(i),n)}return t}return s=g(s,i),t[n]=r(s,n),t},{}),oneOf(e,t,r){var s;let o=g((s=function e(t,r){if(r=r||[],!t.length)return r;let n=t.slice(0).shift(),i=t.slice(1);return r.length?e(i,l(r.map(e=>n.map(t=>[t].concat(e))))):e(i,n.map(e=>e))}(n(e)),s.map(function(e,t){try{return r(e,t)}catch(e){return}}).filter(C)),i);if(o.length)return o},not:e=>({anyOf:e}),pattern:e=>e.map(e=>"(?="+e+")").join(""),multipleOf(e){let t=e.slice(0),r=1;for(;t.some(e=>!Number.isInteger(e));)t=t.map(e=>10*e),r*=10;return s(t)/r},enum(e){let t=h.apply(null,e.concat(u));if(t.length)return p(t)}};L.$id=j,L.$ref=j,L.$schema=j,L.additionalItems=A,L.additionalProperties=A,L.anyOf=L.oneOf,L.contains=A,L.default=j,L.definitions=L.dependencies,L.description=j,L.examples=e=>g(l(e),u),L.exclusiveMaximum=P,L.exclusiveMinimum=O,L.items=v,L.maximum=P,L.maxItems=P,L.maxLength=P,L.maxProperties=P,L.minimum=O,L.minItems=O,L.minLength=O,L.minProperties=O,L.properties=y,L.propertyNames=A,L.required=e=>S(e),L.title=j,L.uniqueItems=e=>e.some(k);let F={properties:y,items:v};function _(e,t,r){r=r||[];let s=Object.entries((t=o(t,{ignoreAdditionalProperties:!1,resolvers:L,complexResolvers:F,deep:!0})).complexResolvers);return function e(o,l,a){o=n(o.filter(C)),a=a||[];let c=d(l)?l:{};if(!o.length)return;if(o.some(w))return!1;if(o.every(k))return!0;let h=E(o=o.filter(d));if(t.deep&&x(h,"allOf"))return _({allOf:o},t,r);let u=s.map(([e,t])=>h.filter(e=>t.keywords.includes(e)));return u.forEach(e=>f(h,e)),h.forEach(function(r){let n=g(M(o,r).filter(C),function(e,t){return i({[r]:e},{[r]:t})});if(1===n.length&&x(R,r))c[r]=n[0].map(t=>e([t],t));else if(1!==n.length||x(D,r)||x(N,r)){let i=t.resolvers[r]||t.resolvers.defaultResolver;if(!i)throw Error("No resolver found for key "+r+". You can provide a resolver for this keyword in the options, or provide a default resolver.");c[r]=i(n,a.concat(r),(t,n=[])=>e(t,null,a.concat(r,n)),t),void 0===c[r]?I(n,a.concat(r)):void 0===c[r]&&delete c[r]}else c[r]=n[0]}),s.reduce((r,[n,s],l)=>({...r,...function(e,t,r,n,s,o){if(e.length){let l=s.complexResolvers[t];if(!l||!l.resolver)throw Error("No resolver found for "+t);let a=g(r.map(t=>e.reduce((e,r)=>(void 0!==t[r]&&(e[r]=t[r]),e),{})),i),c=l.keywords.reduce((e,t)=>({...e,[t]:(e,r=[])=>n(e,null,o.concat(t,r))}),{}),h=l.resolver(a,o.concat(t),c,s);return d(h)||I(a,o.concat(t)),h}}(u[l],n,o,e,t,a)}),c)}(a(function e(t){let{allOf:r=[],...n}=t;return[n=d(t)?n:t,...r.map(e)]}(e)))}_.options={resolvers:L},e.exports=_},96576:function(e,t,r){var n=r(23212),i=r(59756),s=r(43316),o=r(65111),l=r(49460),a=r(65568);e.exports=function(e,t,r,c){var h=-1,u=i,d=!0,f=e.length,p=[],m=t.length;if(!f)return p;r&&(t=o(t,l(r))),c?(u=s,d=!1):t.length>=200&&(u=a,d=!1,t=new n(t));i:for(;++h<f;){var g=e[h],y=null==r?g:r(g);if(g=c||0!==g?g:0,d&&y==y){for(var v=m;v--;)if(t[v]===y)continue i;p.push(g)}else u(t,y,c)||p.push(g)}return p}},38250:function(e){e.exports=function(e,t,r,n){for(var i=r-1,s=e.length;++i<s;)if(n(e[i],t))return i;return -1}},93854:function(e,t,r){var n=r(23212),i=r(59756),s=r(43316),o=r(65111),l=r(49460),a=r(65568),c=Math.min;e.exports=function(e,t,r){for(var h=r?s:i,u=e[0].length,d=e.length,f=d,p=Array(d),m=1/0,g=[];f--;){var y=e[f];f&&t&&(y=o(y,l(t))),m=c(y.length,m),p[f]=!r&&(t||u>=120&&y.length>=120)?new n(f&&y):void 0}y=e[0];var v=-1,x=p[0];i:for(;++v<u&&g.length<m;){var b=y[v],w=t?t(b):b;if(b=r||0!==b?b:0,!(x?a(x,w):h(g,w,r))){for(f=d;--f;){var k=p[f];if(!(k?a(k,w):h(e[f],w,r)))continue i}x&&x.push(w),g.push(b)}}return g}},49261:function(e,t,r){var n=r(65111),i=r(2478),s=r(38250),o=r(49460),l=r(84354),a=Array.prototype.splice;e.exports=function(e,t,r,c){var h=c?s:i,u=-1,d=t.length,f=e;for(e===t&&(t=l(t)),r&&(f=n(e,o(r)));++u<d;)for(var p=0,m=t[u],g=r?r(m):m;(p=h(f,g,p,c))>-1;)f!==e&&a.call(f,p,1),a.call(e,p,1);return e}},81586:function(e,t,r){var n=r(93526),i=r(98087),s=r(13398),o=r(66040);e.exports=function(e,t){return t=n(t,e),null==(e=s(e,t))||delete e[o(i(t))]}},47648:function(e,t,r){var n=r(65406);e.exports=function(e){return n(e)?e:[]}},52107:function(e,t,r){var n=r(40091),i=r(41580);e.exports=function e(t,r,s,o,l,a){return i(t)&&i(r)&&(a.set(r,t),n(t,r,void 0,e,a),a.delete(r)),t}},29259:function(e,t,r){var n=r(48360);e.exports=function(e){return n(e)?void 0:e}},13398:function(e,t,r){var n=r(57923),i=r(73501);e.exports=function(e,t){return t.length<2?e:n(e,i(t,0,-1))}},56005:function(e,t,r){var n=r(95243),i=r(5485);e.exports=function(e){return i(n(e).toLowerCase())}},69383:function(e,t,r){var n=r(86912),i=r(23945),s=r(52107),o=r(48875);e.exports=i(function(e){return e.push(void 0,s),n(o,void 0,e)})},53435:function(e,t,r){var n=r(90313),i=1/0;e.exports=function(e){return(null==e?0:e.length)?n(e,i):[]}},58150:function(e,t,r){var n=r(65111),i=r(93854),s=r(23945),o=r(47648);e.exports=s(function(e){var t=n(e,o);return t.length&&t[0]===e[0]?i(t):[]})},30306:function(e,t,r){var n=r(65111),i=r(93854),s=r(23945),o=r(47648),l=r(98087);e.exports=s(function(e){var t=l(e),r=n(e,o);return(t="function"==typeof t?t:void 0)&&r.pop(),r.length&&r[0]===e[0]?i(r,void 0,t):[]})},22563:function(e,t,r){var n=r(87379),i=r(80547);e.exports=function(e){return!0===e||!1===e||i(e)&&"[object Boolean]"==n(e)}},40575:function(e,t,r){var n=r(94687);e.exports=function(e,t,r){var i=(r="function"==typeof r?r:void 0)?r(e,t):void 0;return void 0===i?n(e,t,void 0,r):!!i}},3668:function(e){e.exports=function(e){return null==e}},60986:function(e,t,r){var n=r(87379),i=r(80547);e.exports=function(e){return"number"==typeof e||i(e)&&"[object Number]"==n(e)}},48875:function(e,t,r){var n=r(40091);e.exports=r(77848)(function(e,t,r,i){n(e,t,r,i)})},3326:function(e,t,r){var n=r(65111),i=r(69334),s=r(81586),o=r(93526),l=r(39032),a=r(29259),c=r(41439),h=r(93650);e.exports=c(function(e,t){var r={};if(null==e)return r;var c=!1;t=n(t,function(t){return t=o(t,e),c||(c=t.length>1),t}),l(e,h(e),r),c&&(r=i(r,7,a));for(var u=t.length;u--;)s(r,t[u]);return r})},92962:function(e,t,r){var n=r(49261);e.exports=function(e,t){return e&&e.length&&t&&t.length?n(e,t):e}},92551:function(e,t,r){var n=r(87655);e.exports=function(e,t,r,i){return i="function"==typeof i?i:void 0,null==e?e:n(e,t,r,i)}},55009:function(e,t,r){var n=r(26137),i=r(23997),s=r(67642),o=Math.min;e.exports=function(e,t){if((e=s(e))<1||e>0x1fffffffffffff)return[];var r=0xffffffff,l=o(e,0xffffffff);t=i(t),e-=0xffffffff;for(var a=n(l,t);++r<e;)t(r);return a}},42613:function(e,t,r){var n=r(65111),i=r(84354),s=r(53142),o=r(51187),l=r(96493),a=r(66040),c=r(95243);e.exports=function(e){return s(e)?n(e,a):o(e)?[e]:i(l(c(e)))}},19106:function(e,t,r){var n=r(15630);e.exports=function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?n(e,void 0,t):[]}},73450:function(e,t,r){var n=r(81586);e.exports=function(e,t){return null==e||n(e,t)}},30795:function(e,t,r){var n=r(96576),i=r(23945),s=r(65406);e.exports=i(function(e,t){return s(e)?n(e,t):[]})},63662:function(e){var t;t=function(){function e(t,r,n){return this.id=++e.highestId,this.name=t,this.symbols=r,this.postprocess=n,this}function t(e,t,r,n){this.rule=e,this.dot=t,this.reference=r,this.data=[],this.wantedBy=n,this.isComplete=this.dot===e.symbols.length}function r(e,t){this.grammar=e,this.index=t,this.states=[],this.wants={},this.scannable=[],this.completed={}}function n(e,t){this.rules=e,this.start=t||this.rules[0].name;var r=this.byName={};this.rules.forEach(function(e){r.hasOwnProperty(e.name)||(r[e.name]=[]),r[e.name].push(e)})}function i(){this.reset("")}function s(e,t,s){if(e instanceof n)var o=e,s=t;else var o=n.fromCompiled(e,t);for(var l in this.grammar=o,this.options={keepHistory:!1,lexer:o.lexer||new i},s||{})this.options[l]=s[l];this.lexer=this.options.lexer,this.lexerState=void 0;var a=new r(o,0);this.table=[a],a.wants[o.start]=[],a.predict(o.start),a.process(),this.current=0}function o(e){var t=typeof e;if("string"===t)return e;if("object"===t)if(e.literal)return JSON.stringify(e.literal);else if(e instanceof RegExp)return e.toString();else if(e.type)return"%"+e.type;else if(e.test)return"<"+String(e.test)+">";else throw Error("Unknown symbol type: "+e)}return e.highestId=0,e.prototype.toString=function(e){var t=void 0===e?this.symbols.map(o).join(" "):this.symbols.slice(0,e).map(o).join(" ")+"  "+this.symbols.slice(e).map(o).join(" ");return this.name+"  "+t},t.prototype.toString=function(){return"{"+this.rule.toString(this.dot)+"}, from: "+(this.reference||0)},t.prototype.nextState=function(e){var r=new t(this.rule,this.dot+1,this.reference,this.wantedBy);return r.left=this,r.right=e,r.isComplete&&(r.data=r.build(),r.right=void 0),r},t.prototype.build=function(){var e=[],t=this;do e.push(t.right.data),t=t.left;while(t.left);return e.reverse(),e},t.prototype.finish=function(){this.rule.postprocess&&(this.data=this.rule.postprocess(this.data,this.reference,s.fail))},r.prototype.process=function(e){for(var t=this.states,r=this.wants,n=this.completed,i=0;i<t.length;i++){var o=t[i];if(o.isComplete){if(o.finish(),o.data!==s.fail){for(var l=o.wantedBy,a=l.length;a--;){var c=l[a];this.complete(c,o)}if(o.reference===this.index){var h=o.rule.name;(this.completed[h]=this.completed[h]||[]).push(o)}}}else{var h=o.rule.symbols[o.dot];if("string"!=typeof h){this.scannable.push(o);continue}if(r[h]){if(r[h].push(o),n.hasOwnProperty(h))for(var u=n[h],a=0;a<u.length;a++){var d=u[a];this.complete(o,d)}}else r[h]=[o],this.predict(h)}}},r.prototype.predict=function(e){for(var r=this.grammar.byName[e]||[],n=0;n<r.length;n++){var i=r[n],s=this.wants[e],o=new t(i,0,this.index,s);this.states.push(o)}},r.prototype.complete=function(e,t){var r=e.nextState(t);this.states.push(r)},n.fromCompiled=function(t,r){var i=t.Lexer;t.ParserStart&&(r=t.ParserStart,t=t.ParserRules);var t=t.map(function(t){return new e(t.name,t.symbols,t.postprocess)}),s=new n(t,r);return s.lexer=i,s},i.prototype.reset=function(e,t){this.buffer=e,this.index=0,this.line=t?t.line:1,this.lastLineBreak=t?-t.col:0},i.prototype.next=function(){if(this.index<this.buffer.length){var e=this.buffer[this.index++];return"\n"===e&&(this.line+=1,this.lastLineBreak=this.index),{value:e}}},i.prototype.save=function(){return{line:this.line,col:this.index-this.lastLineBreak}},i.prototype.formatError=function(e,t){var r=this.buffer;if("string"!=typeof r)return t+" at index "+(this.index-1);var n=r.split("\n").slice(Math.max(0,this.line-5),this.line),i=r.indexOf("\n",this.index);-1===i&&(i=r.length);var s=this.index-this.lastLineBreak,o=String(this.line).length;return t+=" at line "+this.line+" col "+s+":\n\n",t+=n.map(function(e,t){return l(this.line-n.length+t+1,o)+" "+e},this).join("\n"),t+="\n"+l("",o+s)+"^\n";function l(e,t){var r=String(e);return Array(t-r.length+1).join(" ")+r}},s.fail={},s.prototype.feed=function(e){var t,n=this.lexer;for(n.reset(e,this.lexerState);;){try{if(!(t=n.next()))break}catch(e){var s=new r(this.grammar,this.current+1);this.table.push(s);var o=Error(this.reportLexerError(e));throw o.offset=this.current,o.token=e.token,o}var l=this.table[this.current];this.options.keepHistory||delete this.table[this.current-1];var a=this.current+1,s=new r(this.grammar,a);this.table.push(s);for(var c=void 0!==t.text?t.text:t.value,h=n.constructor===i?t.value:t,u=l.scannable,d=u.length;d--;){var f=u[d],p=f.rule.symbols[f.dot];if(p.test?p.test(h):p.type?p.type===t.type:p.literal===c){var m=f.nextState({data:h,token:t,isToken:!0,reference:a-1});s.states.push(m)}}if(s.process(),0===s.states.length){var o=Error(this.reportError(t));throw o.offset=this.current,o.token=t,o}this.options.keepHistory&&(l.lexerState=n.save()),this.current++}return l&&(this.lexerState=n.save()),this.results=this.finish(),this},s.prototype.reportLexerError=function(e){var t,r,n=e.token;return n?(t="input "+JSON.stringify(n.text[0])+" (lexer error)",r=this.lexer.formatError(n,"Syntax error")):(t="input (lexer error)",r=e.message),this.reportErrorCommon(r,t)},s.prototype.reportError=function(e){var t=(e.type?e.type+" token: ":"")+JSON.stringify(void 0!==e.value?e.value:e),r=this.lexer.formatError(e,"Syntax error");return this.reportErrorCommon(r,t)},s.prototype.reportErrorCommon=function(e,t){var r=[];r.push(e);var n=this.table.length-2,i=this.table[n],s=i.states.filter(function(e){var t=e.rule.symbols[e.dot];return t&&"string"!=typeof t});return 0===s.length?(r.push("Unexpected "+t+". I did not expect any more input. Here is the state of my parse table:\n"),this.displayStateStack(i.states,r)):(r.push("Unexpected "+t+". Instead, I was expecting to see one of the following:\n"),s.map(function(e){return this.buildFirstStateStack(e,[])||[e]},this).forEach(function(e){var t=e[0],n=t.rule.symbols[t.dot],i=this.getSymbolDisplay(n);r.push("A "+i+" based on:"),this.displayStateStack(e,r)},this)),r.push(""),r.join("\n")},s.prototype.displayStateStack=function(e,t){for(var r,n=0,i=0;i<e.length;i++){var s=e[i],o=s.rule.toString(s.dot);o===r?n++:(n>0&&t.push("    ^ "+n+" more lines identical to this"),n=0,t.push("    "+o)),r=o}},s.prototype.getSymbolDisplay=function(e){var t=e,r=typeof t;if("string"===r)return t;if("object"===r)if(t.literal)return JSON.stringify(t.literal);else if(t instanceof RegExp)return"character matching "+t;else if(t.type)return t.type+" token";else if(t.test)return"token matching "+String(t.test);else throw Error("Unknown symbol type: "+t)},s.prototype.buildFirstStateStack=function(e,t){if(-1!==t.indexOf(e))return null;if(0===e.wantedBy.length)return[e];var r=e.wantedBy[0],n=[e].concat(t),i=this.buildFirstStateStack(r,n);return null===i?null:[e].concat(i)},s.prototype.save=function(){var e=this.table[this.current];return e.lexerState=this.lexerState,e},s.prototype.restore=function(e){var t=e.index;this.current=t,this.table[t]=e,this.table.splice(t+1),this.lexerState=e.lexerState,this.results=this.finish()},s.prototype.rewind=function(e){if(!this.options.keepHistory)throw Error("set option `keepHistory` to enable rewinding");this.restore(this.table[e])},s.prototype.finish=function(){var e=[],t=this.grammar.start;return this.table[this.table.length-1].states.forEach(function(r){r.rule.name===t&&r.dot===r.rule.symbols.length&&0===r.reference&&r.data!==s.fail&&e.push(r)}),e.map(function(e){return e.data})},{Parser:s,Grammar:n,Rule:e}},e.exports?e.exports=t():this.nearley=t()},16983:function(e,t,r){"use strict";var n=r(85608),i=r(14041),s=n.__importDefault(r(49069));t.default=function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=[]);var n=s.default(e,t),o=n[0],l=n[1],a=n[2];return i.useEffect(a,r),[o,l]}},49069:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(14041);t.default=function(e,t){void 0===t&&(t=0);var r=n.useRef(!1),i=n.useRef(),s=n.useRef(e),o=n.useCallback(function(){return r.current},[]),l=n.useCallback(function(){r.current=!1,i.current&&clearTimeout(i.current),i.current=setTimeout(function(){r.current=!0,s.current()},t)},[t]),a=n.useCallback(function(){r.current=null,i.current&&clearTimeout(i.current)},[]);return n.useEffect(function(){s.current=e},[e]),n.useEffect(function(){return l(),a},[t]),[o,a,l]}},47112:function(e,t,r){!function(e){"use strict";e.exports.is_uri=r,e.exports.is_http_uri=n,e.exports.is_https_uri=i,e.exports.is_web_uri=s,e.exports.isUri=r,e.exports.isHttpUri=n,e.exports.isHttpsUri=i,e.exports.isWebUri=s;var t=function(e){return e.match(/(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/)};function r(e){if(!(!e||/[^a-z0-9\:\/\?\#\[\]\@\!\$\&\'\(\)\*\+\,\;\=\.\-\_\~\%]/i.test(e)||/%[^0-9a-f]/i.test(e)||/%[0-9a-f](:?[^0-9a-f]|$)/i.test(e))){var r=[],n="",i="",s="",o="",l="",a="";if(n=(r=t(e))[1],i=r[2],s=r[3],o=r[4],l=r[5],n&&n.length&&s.length>=0){if(i&&i.length){if(!(0===s.length||/^\//.test(s)))return}else if(/^\/\//.test(s))return;if(/^[a-z][a-z0-9\+\-\.]*$/.test(n.toLowerCase()))return a+=n+":",i&&i.length&&(a+="//"+i),a+=s,o&&o.length&&(a+="?"+o),l&&l.length&&(a+="#"+l),a}}}function n(e,n){if(r(e)){var i=[],s="",o="",l="",a="",c="",h="",u="";if(s=(i=t(e))[1],o=i[2],l=i[3],c=i[4],h=i[5],s){if(n){if("https"!=s.toLowerCase())return}else if("http"!=s.toLowerCase())return;if(o)return/:(\d+)$/.test(o)&&(a=o.match(/:(\d+)$/)[0],o=o.replace(/:\d+$/,"")),u+=s+":",u+="//"+o,a&&(u+=a),u+=l,c&&c.length&&(u+="?"+c),h&&h.length&&(u+="#"+h),u}}}function i(e){return n(e,!0)}function s(e){return n(e)||i(e)}}(e=r.nmd(e))},10646:function(e){"use strict";e.exports=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},43225:function(e){"use strict";e.exports=function(e){return"function"==typeof e}},50709:function(e,t,r){"use strict";var n=r(10646),i=r(70925);e.exports=function(e){var t;if(!n(e)||!(t=e.length))return!1;for(var r=0;r<t;r++)if(!i(e[r]))return!1;return!0}},70925:function(e,t,r){"use strict";var n=r(72100);e.exports=function(e){return n(e)&&e%1==0}},72100:function(e){"use strict";e.exports=function(e){return("number"==typeof e||"[object Number]"===Object.prototype.toString.call(e))&&e.valueOf()===e.valueOf()}},91042:function(e,t,r){"use strict";r.d(t,{Y:()=>s});var n=r(14041),i=r(16261);function s(e,t){let[r,s]=(0,n.useState)({status:"not-executed",error:void 0,result:t}),o=(0,n.useRef)(),l=(0,n.useRef)(),a=(0,i.J)({execute(...t){l.current=t;let r=e(...t);return o.current=r,s(e=>({...e,status:"loading"})),r.then(e=>{r===o.current&&s(t=>({...t,status:"success",error:void 0,result:e}))},e=>{r===o.current&&s(t=>({...t,status:"error",error:e}))}),r},reset(){s({status:"not-executed",error:void 0,result:t}),o.current=void 0,l.current=void 0}});return[r,(0,n.useMemo)(()=>({reset(){a.current.reset()},execute:(...e)=>a.current.execute(...e)}),[]),{promise:o.current,lastArgs:l.current}]}}}]);
//# sourceMappingURL=6290.f58210e6.chunk.js.map