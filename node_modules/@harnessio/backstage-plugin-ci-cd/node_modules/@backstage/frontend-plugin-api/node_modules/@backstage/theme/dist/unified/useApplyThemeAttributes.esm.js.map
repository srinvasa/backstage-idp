{"version":3,"file":"useApplyThemeAttributes.esm.js","sources":["../../src/unified/useApplyThemeAttributes.ts"],"sourcesContent":["/*\n * Copyright 2025 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect } from 'react';\n\ntype ThemeFrame = { mode?: string; name?: string };\n\nconst STACK_ATTR = 'data-unified-theme-stack';\nconst MODE_ATTR = 'data-theme-mode';\nconst NAME_ATTR = 'data-theme-name';\n\nfunction mutateAttrStack(mutator: (stack: ThemeFrame[]) => void) {\n  const stack = (() => {\n    const raw = document.body.getAttribute(STACK_ATTR);\n    if (!raw) {\n      return [] as ThemeFrame[];\n    }\n    try {\n      const parsed = JSON.parse(raw);\n      return Array.isArray(parsed) ? (parsed as ThemeFrame[]) : [];\n    } catch {\n      return [] as ThemeFrame[];\n    }\n  })();\n\n  mutator(stack);\n\n  if (stack.length === 0) {\n    document.body.removeAttribute(STACK_ATTR);\n  } else {\n    document.body.setAttribute(STACK_ATTR, JSON.stringify(stack));\n  }\n\n  const top = stack[stack.length - 1];\n  if (top?.mode) {\n    document.body.setAttribute(MODE_ATTR, String(top.mode));\n  } else {\n    document.body.removeAttribute(MODE_ATTR);\n  }\n  if (top?.name) {\n    document.body.setAttribute(NAME_ATTR, String(top.name));\n  } else {\n    document.body.removeAttribute(NAME_ATTR);\n  }\n}\n\nexport function useApplyThemeAttributes(themeMode: string, themeName: string) {\n  useEffect(() => {\n    mutateAttrStack(stack => {\n      stack.push({ mode: themeMode, name: themeName });\n    });\n\n    return () => {\n      mutateAttrStack(stack => {\n        stack.pop();\n      });\n    };\n  }, [themeMode, themeName]);\n}\n"],"names":[],"mappings":";;AAoBA,MAAM,UAAA,GAAa,0BAAA;AACnB,MAAM,SAAA,GAAY,iBAAA;AAClB,MAAM,SAAA,GAAY,iBAAA;AAElB,SAAS,gBAAgB,OAAA,EAAwC;AAC/D,EAAA,MAAM,SAAS,MAAM;AACnB,IAAA,MAAM,GAAA,GAAM,QAAA,CAAS,IAAA,CAAK,YAAA,CAAa,UAAU,CAAA;AACjD,IAAA,IAAI,CAAC,GAAA,EAAK;AACR,MAAA,OAAO,EAAC;AAAA,IACV;AACA,IAAA,IAAI;AACF,MAAA,MAAM,MAAA,GAAS,IAAA,CAAK,KAAA,CAAM,GAAG,CAAA;AAC7B,MAAA,OAAO,KAAA,CAAM,OAAA,CAAQ,MAAM,CAAA,GAAK,SAA0B,EAAC;AAAA,IAC7D,CAAA,CAAA,MAAQ;AACN,MAAA,OAAO,EAAC;AAAA,IACV;AAAA,EACF,CAAA,GAAG;AAEH,EAAA,OAAA,CAAQ,KAAK,CAAA;AAEb,EAAA,IAAI,KAAA,CAAM,WAAW,CAAA,EAAG;AACtB,IAAA,QAAA,CAAS,IAAA,CAAK,gBAAgB,UAAU,CAAA;AAAA,EAC1C,CAAA,MAAO;AACL,IAAA,QAAA,CAAS,KAAK,YAAA,CAAa,UAAA,EAAY,IAAA,CAAK,SAAA,CAAU,KAAK,CAAC,CAAA;AAAA,EAC9D;AAEA,EAAA,MAAM,GAAA,GAAM,KAAA,CAAM,KAAA,CAAM,MAAA,GAAS,CAAC,CAAA;AAClC,EAAA,IAAI,KAAK,IAAA,EAAM;AACb,IAAA,QAAA,CAAS,KAAK,YAAA,CAAa,SAAA,EAAW,MAAA,CAAO,GAAA,CAAI,IAAI,CAAC,CAAA;AAAA,EACxD,CAAA,MAAO;AACL,IAAA,QAAA,CAAS,IAAA,CAAK,gBAAgB,SAAS,CAAA;AAAA,EACzC;AACA,EAAA,IAAI,KAAK,IAAA,EAAM;AACb,IAAA,QAAA,CAAS,KAAK,YAAA,CAAa,SAAA,EAAW,MAAA,CAAO,GAAA,CAAI,IAAI,CAAC,CAAA;AAAA,EACxD,CAAA,MAAO;AACL,IAAA,QAAA,CAAS,IAAA,CAAK,gBAAgB,SAAS,CAAA;AAAA,EACzC;AACF;AAEO,SAAS,uBAAA,CAAwB,WAAmB,SAAA,EAAmB;AAC5E,EAAA,SAAA,CAAU,MAAM;AACd,IAAA,eAAA,CAAgB,CAAA,KAAA,KAAS;AACvB,MAAA,KAAA,CAAM,KAAK,EAAE,IAAA,EAAM,SAAA,EAAW,IAAA,EAAM,WAAW,CAAA;AAAA,IACjD,CAAC,CAAA;AAED,IAAA,OAAO,MAAM;AACX,MAAA,eAAA,CAAgB,CAAA,KAAA,KAAS;AACvB,QAAA,KAAA,CAAM,GAAA,EAAI;AAAA,MACZ,CAAC,CAAA;AAAA,IACH,CAAA;AAAA,EACF,CAAA,EAAG,CAAC,SAAA,EAAW,SAAS,CAAC,CAAA;AAC3B;;;;"}