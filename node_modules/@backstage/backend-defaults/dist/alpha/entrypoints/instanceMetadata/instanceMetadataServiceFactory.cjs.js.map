{"version":3,"file":"instanceMetadataServiceFactory.cjs.js","sources":["../../../../src/alpha/entrypoints/instanceMetadata/instanceMetadataServiceFactory.ts"],"sourcesContent":["/*\n * Copyright 2025 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  coreServices,\n  createServiceFactory,\n} from '@backstage/backend-plugin-api';\nimport {\n  BackendFeatureMeta,\n  InstanceMetadataService,\n  instanceMetadataServiceRef,\n} from '@backstage/backend-plugin-api/alpha';\n\n/**\n * @alpha\n * @deprecated use {@link @backstage/backend-plugin-api#coreServices.rootInstanceMetadata} instead\n */\nexport const instanceMetadataServiceFactory = createServiceFactory({\n  service: instanceMetadataServiceRef,\n  deps: {\n    instanceMetadata: coreServices.rootInstanceMetadata,\n  },\n  factory: async ({ instanceMetadata }) => {\n    const plugins = await instanceMetadata.getInstalledPlugins();\n    const features: BackendFeatureMeta[] = [];\n    for (const plugin of plugins) {\n      features.push({\n        type: 'plugin' as const,\n        pluginId: plugin.pluginId,\n      });\n      for (const module of plugin.modules) {\n        features.push({\n          type: 'module' as const,\n          pluginId: plugin.pluginId,\n          moduleId: module.moduleId,\n        });\n      }\n    }\n    const service: InstanceMetadataService = {\n      getInstalledFeatures: () => features,\n    };\n\n    return service;\n  },\n});\n"],"names":["createServiceFactory","instanceMetadataServiceRef","coreServices"],"mappings":";;;;;AA8BO,MAAM,iCAAiCA,qCAAA,CAAqB;AAAA,EACjE,OAAA,EAASC,gCAAA;AAAA,EACT,IAAA,EAAM;AAAA,IACJ,kBAAkBC,6BAAA,CAAa;AAAA,GACjC;AAAA,EACA,OAAA,EAAS,OAAO,EAAE,gBAAA,EAAiB,KAAM;AACvC,IAAA,MAAM,OAAA,GAAU,MAAM,gBAAA,CAAiB,mBAAA,EAAoB;AAC3D,IAAA,MAAM,WAAiC,EAAC;AACxC,IAAA,KAAA,MAAW,UAAU,OAAA,EAAS;AAC5B,MAAA,QAAA,CAAS,IAAA,CAAK;AAAA,QACZ,IAAA,EAAM,QAAA;AAAA,QACN,UAAU,MAAA,CAAO;AAAA,OAClB,CAAA;AACD,MAAA,KAAA,MAAW,MAAA,IAAU,OAAO,OAAA,EAAS;AACnC,QAAA,QAAA,CAAS,IAAA,CAAK;AAAA,UACZ,IAAA,EAAM,QAAA;AAAA,UACN,UAAU,MAAA,CAAO,QAAA;AAAA,UACjB,UAAU,MAAA,CAAO;AAAA,SAClB,CAAA;AAAA,MACH;AAAA,IACF;AACA,IAAA,MAAM,OAAA,GAAmC;AAAA,MACvC,sBAAsB,MAAM;AAAA,KAC9B;AAEA,IAAA,OAAO,OAAA;AAAA,EACT;AACF,CAAC;;;;"}