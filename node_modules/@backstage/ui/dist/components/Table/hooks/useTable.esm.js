import { useState, useMemo, useCallback } from 'react';

function useTable(config = {}) {
  const { data, pagination: paginationConfig = {} } = config;
  const {
    rowCount: providedRowCount,
    offset: controlledOffset,
    pageSize: controlledPageSize,
    onOffsetChange,
    onPageSizeChange,
    defaultPageSize = 10,
    defaultOffset = 0,
    onNextPage,
    onPreviousPage,
    showPageSizeOptions = true
  } = paginationConfig;
  const isControlled = controlledOffset !== void 0 || controlledPageSize !== void 0;
  const rowCount = data?.length ?? providedRowCount ?? 0;
  const [internalOffset, setInternalOffset] = useState(defaultOffset);
  const [internalPageSize, setInternalPageSize] = useState(defaultPageSize);
  const currentOffset = controlledOffset ?? internalOffset;
  const currentPageSize = controlledPageSize ?? internalPageSize;
  const currentData = useMemo(() => {
    if (!data) return void 0;
    return data.slice(currentOffset, currentOffset + currentPageSize);
  }, [data, currentOffset, currentPageSize]);
  const setOffset = useCallback(
    (newOffset) => {
      if (isControlled) {
        onOffsetChange?.(newOffset);
      } else {
        setInternalOffset(newOffset);
      }
    },
    [isControlled, onOffsetChange]
  );
  const setPageSize = useCallback(
    (newPageSize) => {
      const newOffset = 0;
      if (isControlled) {
        onPageSizeChange?.(newPageSize);
        onOffsetChange?.(newOffset);
      } else {
        setInternalPageSize(newPageSize);
        setInternalOffset(newOffset);
      }
    },
    [isControlled, onPageSizeChange, onOffsetChange]
  );
  const nextPage = useCallback(() => {
    const nextOffset = currentOffset + currentPageSize;
    if (nextOffset < rowCount) {
      onNextPage?.();
      setOffset(nextOffset);
    }
  }, [currentOffset, currentPageSize, rowCount, onNextPage, setOffset]);
  const previousPage = useCallback(() => {
    if (currentOffset > 0) {
      onPreviousPage?.();
      const prevOffset = Math.max(0, currentOffset - currentPageSize);
      setOffset(prevOffset);
    }
  }, [currentOffset, currentPageSize, onPreviousPage, setOffset]);
  const paginationProps = useMemo(
    () => ({
      offset: currentOffset,
      pageSize: currentPageSize,
      rowCount,
      setOffset,
      setPageSize,
      onNextPage,
      onPreviousPage,
      showPageSizeOptions
    }),
    [
      currentOffset,
      currentPageSize,
      rowCount,
      setOffset,
      setPageSize,
      onNextPage,
      onPreviousPage,
      showPageSizeOptions
    ]
  );
  const pagination = useMemo(
    () => ({
      paginationProps,
      offset: currentOffset,
      pageSize: currentPageSize,
      data: currentData,
      nextPage,
      previousPage,
      setOffset,
      setPageSize
    }),
    [
      paginationProps,
      currentOffset,
      currentPageSize,
      currentData,
      nextPage,
      previousPage,
      setOffset,
      setPageSize
    ]
  );
  return {
    data: currentData,
    paginationProps,
    pagination
  };
}

export { useTable };
//# sourceMappingURL=useTable.esm.js.map
