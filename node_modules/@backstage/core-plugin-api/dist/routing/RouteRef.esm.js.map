{"version":3,"file":"RouteRef.esm.js","sources":["../../src/routing/RouteRef.ts"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  RouteRef,\n  routeRefType,\n  AnyParams,\n  ParamKeys,\n  OptionalParams,\n} from './types';\n\n/**\n * @internal\n */\nexport class RouteRefImpl<Params extends AnyParams>\n  implements RouteRef<Params>\n{\n  // The marker is used for type checking while the symbol is used at runtime.\n  declare $$routeRefType: 'absolute';\n  readonly [routeRefType] = 'absolute';\n\n  private readonly id: string;\n  readonly params: ParamKeys<Params>;\n\n  constructor(id: string, params: ParamKeys<Params>) {\n    this.id = id;\n    this.params = params;\n  }\n\n  get title() {\n    return this.id;\n  }\n\n  toString() {\n    if (this.#nfsId) {\n      return `routeRef{id=${this.#nfsId},legacyId=${this.id}}`;\n    }\n    return `routeRef{type=absolute,id=${this.id}}`;\n  }\n\n  // NFS implementation below\n  readonly $$type = '@backstage/RouteRef';\n  readonly version = 'v1';\n  readonly T = undefined as any;\n  readonly alias = undefined;\n\n  #nfsId: string | undefined = undefined;\n\n  getParams() {\n    return this.params;\n  }\n  getDescription() {\n    if (this.#nfsId) {\n      return this.#nfsId;\n    }\n    return this.id;\n  }\n  setId(newId: string) {\n    if (!newId) {\n      throw new Error(`RouteRef id must be a non-empty string`);\n    }\n    if (this.#nfsId && this.#nfsId !== newId) {\n      throw new Error(\n        `RouteRef was referenced twice as both '${this.#nfsId}' and '${newId}'`,\n      );\n    }\n    this.#nfsId = newId;\n  }\n}\n\n/**\n * Create a {@link RouteRef} from a route descriptor.\n *\n * @param config - Description of the route reference to be created.\n * @public\n */\nexport function createRouteRef<\n  // Params is the type that we care about and the one to be embedded in the route ref.\n  // For example, given the params ['name', 'kind'], Params will be {name: string, kind: string}\n  Params extends { [param in ParamKey]: string },\n  // ParamKey is here to make sure the Params type properly has its keys narrowed down\n  // to only the elements of params. Defaulting to never makes sure we end up with\n  // Param = {} if the params array is empty.\n  ParamKey extends string = never,\n>(config: {\n  /** The id of the route ref, used to identify it when printed */\n  id: string;\n  /** A list of parameter names that the path that this route ref is bound to must contain */\n  params?: ParamKey[];\n}): RouteRef<OptionalParams<Params>> {\n  return new RouteRefImpl(\n    config.id,\n    (config.params ?? []) as ParamKeys<OptionalParams<Params>>,\n  ) as RouteRef<OptionalParams<Params>>;\n}\n"],"names":[],"mappings":";;AA2BO,MAAM,YAAA,CAEb;AAAA,EAGE,CAAU,YAAY,IAAI,UAAA;AAAA,EAET,EAAA;AAAA,EACR,MAAA;AAAA,EAET,WAAA,CAAY,IAAY,MAAA,EAA2B;AACjD,IAAA,IAAA,CAAK,EAAA,GAAK,EAAA;AACV,IAAA,IAAA,CAAK,MAAA,GAAS,MAAA;AAAA,EAChB;AAAA,EAEA,IAAI,KAAA,GAAQ;AACV,IAAA,OAAO,IAAA,CAAK,EAAA;AAAA,EACd;AAAA,EAEA,QAAA,GAAW;AACT,IAAA,IAAI,KAAK,MAAA,EAAQ;AACf,MAAA,OAAO,CAAA,YAAA,EAAe,IAAA,CAAK,MAAM,CAAA,UAAA,EAAa,KAAK,EAAE,CAAA,CAAA,CAAA;AAAA,IACvD;AACA,IAAA,OAAO,CAAA,0BAAA,EAA6B,KAAK,EAAE,CAAA,CAAA,CAAA;AAAA,EAC7C;AAAA;AAAA,EAGS,MAAA,GAAS,qBAAA;AAAA,EACT,OAAA,GAAU,IAAA;AAAA,EACV,CAAA,GAAI,MAAA;AAAA,EACJ,KAAA,GAAQ,MAAA;AAAA,EAEjB,MAAA,GAA6B,MAAA;AAAA,EAE7B,SAAA,GAAY;AACV,IAAA,OAAO,IAAA,CAAK,MAAA;AAAA,EACd;AAAA,EACA,cAAA,GAAiB;AACf,IAAA,IAAI,KAAK,MAAA,EAAQ;AACf,MAAA,OAAO,IAAA,CAAK,MAAA;AAAA,IACd;AACA,IAAA,OAAO,IAAA,CAAK,EAAA;AAAA,EACd;AAAA,EACA,MAAM,KAAA,EAAe;AACnB,IAAA,IAAI,CAAC,KAAA,EAAO;AACV,MAAA,MAAM,IAAI,MAAM,CAAA,sCAAA,CAAwC,CAAA;AAAA,IAC1D;AACA,IAAA,IAAI,IAAA,CAAK,MAAA,IAAU,IAAA,CAAK,MAAA,KAAW,KAAA,EAAO;AACxC,MAAA,MAAM,IAAI,KAAA;AAAA,QACR,CAAA,uCAAA,EAA0C,IAAA,CAAK,MAAM,CAAA,OAAA,EAAU,KAAK,CAAA,CAAA;AAAA,OACtE;AAAA,IACF;AACA,IAAA,IAAA,CAAK,MAAA,GAAS,KAAA;AAAA,EAChB;AACF;AAQO,SAAS,eAQd,MAAA,EAKmC;AACnC,EAAA,OAAO,IAAI,YAAA;AAAA,IACT,MAAA,CAAO,EAAA;AAAA,IACN,MAAA,CAAO,UAAU;AAAC,GACrB;AACF;;;;"}