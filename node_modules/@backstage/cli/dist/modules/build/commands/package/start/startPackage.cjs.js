'use strict';

var startBackend = require('./startBackend.cjs.js');
var startFrontend = require('./startFrontend.cjs.js');
var path = require('path');
var glob = require('glob');

function resolveEntryPath(entrypoint = "dev", targetDir) {
  const { dir: entryDir, name: entryName } = path.parse(entrypoint);
  const [entryFile] = glob.glob.sync(`${path.resolve(targetDir, entryDir, entryName)}.*`);
  if (entryFile) {
    return path.join(entryDir, entryName);
  }
  return path.join(entryDir, entryName, "index");
}
async function startPackage(options) {
  switch (options.role) {
    case "backend":
      return startBackend.startBackend(options);
    case "backend-plugin":
    case "backend-plugin-module":
    case "node-library":
      return startBackend.startBackendPlugin(options);
    case "frontend":
      return startFrontend.startFrontend({
        ...options,
        entry: "src/index",
        verifyVersions: true
      });
    case "web-library":
    case "frontend-plugin":
    case "frontend-plugin-module":
      return startFrontend.startFrontend({
        ...options,
        entry: resolveEntryPath(options.entrypoint, options.targetDir)
      });
    case "frontend-dynamic-container":
      return startFrontend.startFrontend({
        entry: "src/index",
        ...options,
        skipOpenBrowser: true,
        isModuleFederationRemote: true
      });
    default:
      throw new Error(
        `Start command is not supported for package role '${options.role}'`
      );
  }
}

exports.resolveEntryPath = resolveEntryPath;
exports.startPackage = startPackage;
//# sourceMappingURL=startPackage.cjs.js.map
