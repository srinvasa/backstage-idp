'use strict';

var bitbucket = require('bitbucket');

const getBitbucketClient = (config) => {
  if (config.token) {
    return new bitbucket.Bitbucket({
      auth: {
        token: config.token
      }
    });
  } else if (config.username && config.appPassword) {
    return new bitbucket.Bitbucket({
      auth: {
        username: config.username,
        password: config.appPassword
      }
    });
  }
  throw new Error(
    `Authorization has not been provided for Bitbucket Cloud. Please add either provide a username and token or username and appPassword to the Integrations config`
  );
};
const getAuthorizationHeader = (config) => {
  if (config.username && (config.token ?? config.appPassword)) {
    const buffer = Buffer.from(
      `${config.username}:${config.token ?? config.appPassword}`,
      "utf8"
    );
    return `Basic ${buffer.toString("base64")}`;
  }
  if (config.token) {
    return `Bearer ${config.token}`;
  }
  throw new Error(
    `Authorization has not been provided for Bitbucket Cloud. Please add either provide a username and token or username and appPassword to the Integrations config`
  );
};

exports.getAuthorizationHeader = getAuthorizationHeader;
exports.getBitbucketClient = getBitbucketClient;
//# sourceMappingURL=helpers.cjs.js.map
