{"version":3,"file":"deployments.cjs.js","sources":["../../src/error-detection/deployments.ts"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DetectedError, ErrorMapper } from './types';\nimport { Deployment } from 'kubernetes-models/apps/v1';\nimport { detectErrorsInObjects } from './common';\n\nconst deploymentErrorMappers: ErrorMapper<Deployment>[] = [\n  {\n    detectErrors: deployment => {\n      return (deployment.status?.conditions ?? [])\n        .filter(c => c.status === 'False')\n        .filter(c => c.message !== undefined)\n        .map(c => ({\n          type: 'condition-message-present',\n          message: c.message ?? '',\n          severity: 6,\n          sourceRef: {\n            name: deployment.metadata?.name ?? 'unknown hpa',\n            namespace: deployment.metadata?.namespace ?? 'unknown namespace',\n            kind: 'Deployment',\n            apiGroup: 'apps/v1',\n          },\n          occurrenceCount: 1,\n        }));\n    },\n  },\n];\n\nexport const detectErrorsInDeployments = (\n  deployments: Deployment[],\n): DetectedError[] =>\n  detectErrorsInObjects(deployments, deploymentErrorMappers);\n"],"names":["detectErrorsInObjects"],"mappings":";;;;AAoBA,MAAM,sBAAA,GAAoD;AAAA,EACxD;AAAA,IACE,cAAc,CAAA,UAAA,KAAc;AAC1B,MAAA,OAAA,CAAQ,WAAW,MAAA,EAAQ,UAAA,IAAc,EAAC,EACvC,MAAA,CAAO,OAAK,CAAA,CAAE,MAAA,KAAW,OAAO,CAAA,CAChC,OAAO,CAAA,CAAA,KAAK,CAAA,CAAE,YAAY,MAAS,CAAA,CACnC,IAAI,CAAA,CAAA,MAAM;AAAA,QACT,IAAA,EAAM,2BAAA;AAAA,QACN,OAAA,EAAS,EAAE,OAAA,IAAW,EAAA;AAAA,QACtB,QAAA,EAAU,CAAA;AAAA,QACV,SAAA,EAAW;AAAA,UACT,IAAA,EAAM,UAAA,CAAW,QAAA,EAAU,IAAA,IAAQ,aAAA;AAAA,UACnC,SAAA,EAAW,UAAA,CAAW,QAAA,EAAU,SAAA,IAAa,mBAAA;AAAA,UAC7C,IAAA,EAAM,YAAA;AAAA,UACN,QAAA,EAAU;AAAA,SACZ;AAAA,QACA,eAAA,EAAiB;AAAA,OACnB,CAAE,CAAA;AAAA,IACN;AAAA;AAEJ,CAAA;AAEO,MAAM,yBAAA,GAA4B,CACvC,WAAA,KAEAA,4BAAA,CAAsB,aAAa,sBAAsB;;;;"}