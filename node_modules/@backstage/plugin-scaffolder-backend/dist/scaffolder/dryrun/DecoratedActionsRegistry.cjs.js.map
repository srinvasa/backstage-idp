{"version":3,"file":"DecoratedActionsRegistry.cjs.js","sources":["../../../src/scaffolder/dryrun/DecoratedActionsRegistry.ts"],"sourcesContent":["/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { TemplateAction } from '@backstage/plugin-scaffolder-node';\nimport { TemplateActionRegistry } from '../actions';\nimport { BackstageCredentials } from '@backstage/backend-plugin-api';\n\n/** @internal */\nexport class DecoratedActionsRegistry implements TemplateActionRegistry {\n  private readonly innerActions: Map<string, TemplateAction> = new Map();\n  private readonly innerRegistry: TemplateActionRegistry;\n\n  constructor(\n    innerRegistry: TemplateActionRegistry,\n    extraActions: Array<TemplateAction>,\n  ) {\n    this.innerRegistry = innerRegistry;\n    for (const action of extraActions) {\n      this.innerActions.set(action.id, action);\n    }\n  }\n\n  async get(\n    actionId: string,\n    options: { credentials: BackstageCredentials },\n  ): Promise<TemplateAction> {\n    try {\n      return await this.innerRegistry.get(actionId, options);\n    } catch (e) {\n      if (!this.innerActions.has(actionId)) {\n        throw e;\n      }\n      return this.innerActions.get(actionId)!;\n    }\n  }\n\n  async list(options: {\n    credentials: BackstageCredentials;\n  }): Promise<Map<string, TemplateAction<any, any, any>>> {\n    const inner = await this.innerRegistry.list(options);\n    return new Map<string, TemplateAction<any, any, any>>([\n      ...inner,\n      ...this.innerActions,\n    ]);\n  }\n\n  register(action: TemplateAction<any, any, any>): void {\n    this.innerRegistry.register(action);\n  }\n}\n"],"names":[],"mappings":";;AAqBO,MAAM,wBAAA,CAA2D;AAAA,EACrD,YAAA,uBAAgD,GAAA,EAAI;AAAA,EACpD,aAAA;AAAA,EAEjB,WAAA,CACE,eACA,YAAA,EACA;AACA,IAAA,IAAA,CAAK,aAAA,GAAgB,aAAA;AACrB,IAAA,KAAA,MAAW,UAAU,YAAA,EAAc;AACjC,MAAA,IAAA,CAAK,YAAA,CAAa,GAAA,CAAI,MAAA,CAAO,EAAA,EAAI,MAAM,CAAA;AAAA,IACzC;AAAA,EACF;AAAA,EAEA,MAAM,GAAA,CACJ,QAAA,EACA,OAAA,EACyB;AACzB,IAAA,IAAI;AACF,MAAA,OAAO,MAAM,IAAA,CAAK,aAAA,CAAc,GAAA,CAAI,UAAU,OAAO,CAAA;AAAA,IACvD,SAAS,CAAA,EAAG;AACV,MAAA,IAAI,CAAC,IAAA,CAAK,YAAA,CAAa,GAAA,CAAI,QAAQ,CAAA,EAAG;AACpC,QAAA,MAAM,CAAA;AAAA,MACR;AACA,MAAA,OAAO,IAAA,CAAK,YAAA,CAAa,GAAA,CAAI,QAAQ,CAAA;AAAA,IACvC;AAAA,EACF;AAAA,EAEA,MAAM,KAAK,OAAA,EAE6C;AACtD,IAAA,MAAM,KAAA,GAAQ,MAAM,IAAA,CAAK,aAAA,CAAc,KAAK,OAAO,CAAA;AACnD,IAAA,OAAO,IAAI,GAAA,CAA2C;AAAA,MACpD,GAAG,KAAA;AAAA,MACH,GAAG,IAAA,CAAK;AAAA,KACT,CAAA;AAAA,EACH;AAAA,EAEA,SAAS,MAAA,EAA6C;AACpD,IAAA,IAAA,CAAK,aAAA,CAAc,SAAS,MAAM,CAAA;AAAA,EACpC;AACF;;;;"}