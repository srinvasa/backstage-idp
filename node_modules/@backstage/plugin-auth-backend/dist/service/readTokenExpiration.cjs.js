'use strict';

var config = require('@backstage/config');
var types = require('@backstage/types');

const TOKEN_EXP_DEFAULT_S = 3600;
const TOKEN_EXP_MIN_S = 600;
const TOKEN_EXP_MAX_S = 86400;
function readBackstageTokenExpiration(config) {
  return readTokenExpiration(config, {
    configKey: "auth.backstageTokenExpiration"
  });
}
function readDcrTokenExpiration(config) {
  return readTokenExpiration(config, {
    configKey: "auth.experimentalDynamicClientRegistration.tokenExpiration"
  });
}
function readTokenExpiration(config$1, options) {
  const {
    configKey,
    maxExpiration = TOKEN_EXP_MAX_S,
    minExpiration = TOKEN_EXP_MIN_S,
    defaultExpiration = TOKEN_EXP_DEFAULT_S
  } = options ?? {};
  if (!config$1.has(configKey)) {
    return defaultExpiration;
  }
  const duration = config.readDurationFromConfig(config$1, {
    key: configKey
  });
  const durationS = Math.round(types.durationToMilliseconds(duration) / 1e3);
  if (durationS < minExpiration) {
    return minExpiration;
  } else if (durationS > maxExpiration) {
    return maxExpiration;
  }
  return durationS;
}

exports.readBackstageTokenExpiration = readBackstageTokenExpiration;
exports.readDcrTokenExpiration = readDcrTokenExpiration;
exports.readTokenExpiration = readTokenExpiration;
//# sourceMappingURL=readTokenExpiration.cjs.js.map
