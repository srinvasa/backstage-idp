{"version":3,"file":"useMatchingErrors.esm.js","sources":["../../src/hooks/useMatchingErrors.ts"],"sourcesContent":["/*\n * Copyright 2023 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { createContext, useContext } from 'react';\nimport {\n  DetectedError,\n  ResourceRef,\n} from '@backstage/plugin-kubernetes-common';\nimport type { TypeMeta } from '@kubernetes-models/base';\nimport type { IIoK8sApimachineryPkgApisMetaV1ObjectMeta as V1ObjectMeta } from '@kubernetes-models/apimachinery/apis/meta/v1/ObjectMeta';\n\n/**\n * Context for detected errors\n *\n * @public\n */\nexport const DetectedErrorsContext = createContext<DetectedError[]>([]);\n\n/**\n *\n * @public\n */\nexport type ErrorMatcher = {\n  metadata?: V1ObjectMeta;\n} & TypeMeta;\n\n/**\n * Find errors which match the resource\n *\n * @public\n */\nexport const useMatchingErrors = (matcher: ErrorMatcher): DetectedError[] => {\n  const targetRef: ResourceRef = {\n    name: matcher.metadata?.name ?? '',\n    namespace: matcher.metadata?.namespace ?? '',\n    kind: matcher.kind,\n    apiGroup: matcher.apiVersion,\n  };\n\n  const errors = useContext(DetectedErrorsContext);\n\n  return errors.filter(e => {\n    const r = e.sourceRef;\n    return (\n      targetRef.apiGroup === r.apiGroup &&\n      targetRef.kind === r.kind &&\n      targetRef.name === r.name &&\n      targetRef.namespace === r.namespace\n    );\n  });\n};\n"],"names":[],"mappings":";;AA4BO,MAAM,qBAAA,GAAwB,aAAA,CAA+B,EAAE;AAe/D,MAAM,iBAAA,GAAoB,CAAC,OAAA,KAA2C;AAC3E,EAAA,MAAM,SAAA,GAAyB;AAAA,IAC7B,IAAA,EAAM,OAAA,CAAQ,QAAA,EAAU,IAAA,IAAQ,EAAA;AAAA,IAChC,SAAA,EAAW,OAAA,CAAQ,QAAA,EAAU,SAAA,IAAa,EAAA;AAAA,IAC1C,MAAM,OAAA,CAAQ,IAAA;AAAA,IACd,UAAU,OAAA,CAAQ;AAAA,GACpB;AAEA,EAAA,MAAM,MAAA,GAAS,WAAW,qBAAqB,CAAA;AAE/C,EAAA,OAAO,MAAA,CAAO,OAAO,CAAA,CAAA,KAAK;AACxB,IAAA,MAAM,IAAI,CAAA,CAAE,SAAA;AACZ,IAAA,OACE,SAAA,CAAU,QAAA,KAAa,CAAA,CAAE,QAAA,IACzB,UAAU,IAAA,KAAS,CAAA,CAAE,IAAA,IACrB,SAAA,CAAU,IAAA,KAAS,CAAA,CAAE,IAAA,IACrB,SAAA,CAAU,cAAc,CAAA,CAAE,SAAA;AAAA,EAE9B,CAAC,CAAA;AACH;;;;"}