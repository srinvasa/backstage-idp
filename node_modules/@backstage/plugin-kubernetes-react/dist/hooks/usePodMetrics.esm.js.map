{"version":3,"file":"usePodMetrics.esm.js","sources":["../../src/hooks/usePodMetrics.ts"],"sourcesContent":["/*\n * Copyright 2023 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { createContext, useContext } from 'react';\nimport type { IObjectMeta } from '@kubernetes-models/apimachinery/apis/meta/v1/ObjectMeta';\nimport { ClientPodStatus } from '@backstage/plugin-kubernetes-common';\n\n/**\n * Context for Pod Metrics\n *\n * @public\n */\nexport const PodMetricsContext = createContext<Map<string, ClientPodStatus[]>>(\n  new Map(),\n);\n\n/**\n * @public\n */\nexport type PodMetricsMatcher = {\n  metadata?: IObjectMeta;\n};\n\n/**\n * Find metrics matching the provided pod\n *\n * @public\n */\nexport const usePodMetrics = (\n  clusterName: string,\n  matcher: PodMetricsMatcher,\n): ClientPodStatus | undefined => {\n  const targetRef = {\n    name: matcher.metadata?.name ?? '',\n    namespace: matcher.metadata?.namespace ?? '',\n  };\n\n  const metricsMap = useContext(PodMetricsContext);\n\n  const metrics = metricsMap.get(clusterName);\n\n  return metrics?.find(m => {\n    const pod = m.pod;\n    return (\n      targetRef.name === (pod.metadata?.name ?? '') &&\n      targetRef.namespace === (pod.metadata?.namespace ?? '')\n    );\n  });\n};\n"],"names":[],"mappings":";;AAwBO,MAAM,iBAAA,GAAoB,aAAA;AAAA,sBAC3B,GAAA;AACN;AAcO,MAAM,aAAA,GAAgB,CAC3B,WAAA,EACA,OAAA,KACgC;AAChC,EAAA,MAAM,SAAA,GAAY;AAAA,IAChB,IAAA,EAAM,OAAA,CAAQ,QAAA,EAAU,IAAA,IAAQ,EAAA;AAAA,IAChC,SAAA,EAAW,OAAA,CAAQ,QAAA,EAAU,SAAA,IAAa;AAAA,GAC5C;AAEA,EAAA,MAAM,UAAA,GAAa,WAAW,iBAAiB,CAAA;AAE/C,EAAA,MAAM,OAAA,GAAU,UAAA,CAAW,GAAA,CAAI,WAAW,CAAA;AAE1C,EAAA,OAAO,OAAA,EAAS,KAAK,CAAA,CAAA,KAAK;AACxB,IAAA,MAAM,MAAM,CAAA,CAAE,GAAA;AACd,IAAA,OACE,SAAA,CAAU,IAAA,MAAU,GAAA,CAAI,QAAA,EAAU,IAAA,IAAQ,OAC1C,SAAA,CAAU,SAAA,MAAe,GAAA,CAAI,QAAA,EAAU,SAAA,IAAa,EAAA,CAAA;AAAA,EAExD,CAAC,CAAA;AACH;;;;"}