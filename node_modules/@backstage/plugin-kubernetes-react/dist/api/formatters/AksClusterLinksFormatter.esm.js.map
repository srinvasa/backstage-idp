{"version":3,"file":"AksClusterLinksFormatter.esm.js","sources":["../../../src/api/formatters/AksClusterLinksFormatter.ts"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {\n  ClusterLinksFormatter,\n  ClusterLinksFormatterOptions,\n} from '../../types';\n\nconst basePath =\n  'https://portal.azure.com/#blade/Microsoft_Azure_ContainerService/AksK8ResourceMenuBlade/overview-Deployment/aksClusterId';\n\nconst requiredParams = ['subscriptionId', 'resourceGroup', 'clusterName'];\n\n/** @public */\nexport class AksClusterLinksFormatter implements ClusterLinksFormatter {\n  async formatClusterLink(options: ClusterLinksFormatterOptions) {\n    if (!options.dashboardParameters) {\n      throw new Error('AKS dashboard requires a dashboardParameters option');\n    }\n    const args = options.dashboardParameters;\n    for (const param of requiredParams) {\n      if (typeof args[param] !== 'string') {\n        throw new Error(\n          `AKS dashboard requires a \"${param}\" of type string in the dashboardParameters option`,\n        );\n      }\n    }\n\n    const path = `/subscriptions/${args.subscriptionId}/resourceGroups/${args.resourceGroup}/providers/Microsoft.ContainerService/managedClusters/${args.clusterName}`;\n\n    const { name, namespace, uid } = options.object.metadata;\n    const { selector } = options.object.spec;\n    const params = {\n      kind: options.kind,\n      metadata: { name, namespace, uid },\n      spec: {\n        selector,\n      },\n    };\n\n    return new URL(\n      `${basePath}/${encodeURIComponent(path)}/resource/${encodeURIComponent(\n        JSON.stringify(params),\n      )}`,\n    );\n  }\n}\n"],"names":[],"mappings":"AAoBA,MAAM,QAAA,GACJ,0HAAA;AAEF,MAAM,cAAA,GAAiB,CAAC,gBAAA,EAAkB,eAAA,EAAiB,aAAa,CAAA;AAGjE,MAAM,wBAAA,CAA0D;AAAA,EACrE,MAAM,kBAAkB,OAAA,EAAuC;AAC7D,IAAA,IAAI,CAAC,QAAQ,mBAAA,EAAqB;AAChC,MAAA,MAAM,IAAI,MAAM,qDAAqD,CAAA;AAAA,IACvE;AACA,IAAA,MAAM,OAAO,OAAA,CAAQ,mBAAA;AACrB,IAAA,KAAA,MAAW,SAAS,cAAA,EAAgB;AAClC,MAAA,IAAI,OAAO,IAAA,CAAK,KAAK,CAAA,KAAM,QAAA,EAAU;AACnC,QAAA,MAAM,IAAI,KAAA;AAAA,UACR,6BAA6B,KAAK,CAAA,kDAAA;AAAA,SACpC;AAAA,MACF;AAAA,IACF;AAEA,IAAA,MAAM,IAAA,GAAO,kBAAkB,IAAA,CAAK,cAAc,mBAAmB,IAAA,CAAK,aAAa,CAAA,sDAAA,EAAyD,IAAA,CAAK,WAAW,CAAA,CAAA;AAEhK,IAAA,MAAM,EAAE,IAAA,EAAM,SAAA,EAAW,GAAA,EAAI,GAAI,QAAQ,MAAA,CAAO,QAAA;AAChD,IAAA,MAAM,EAAE,QAAA,EAAS,GAAI,OAAA,CAAQ,MAAA,CAAO,IAAA;AACpC,IAAA,MAAM,MAAA,GAAS;AAAA,MACb,MAAM,OAAA,CAAQ,IAAA;AAAA,MACd,QAAA,EAAU,EAAE,IAAA,EAAM,SAAA,EAAW,GAAA,EAAI;AAAA,MACjC,IAAA,EAAM;AAAA,QACJ;AAAA;AACF,KACF;AAEA,IAAA,OAAO,IAAI,GAAA;AAAA,MACT,GAAG,QAAQ,CAAA,CAAA,EAAI,kBAAA,CAAmB,IAAI,CAAC,CAAA,UAAA,EAAa,kBAAA;AAAA,QAClD,IAAA,CAAK,UAAU,MAAM;AAAA,OACtB,CAAA;AAAA,KACH;AAAA,EACF;AACF;;;;"}