{"version":3,"file":"Events.esm.js","sources":["../../../../src/components/Pods/Events/Events.tsx"],"sourcesContent":["/*\n * Copyright 2023 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport Avatar from '@material-ui/core/Avatar';\nimport Container from '@material-ui/core/Container';\nimport Grid from '@material-ui/core/Grid';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Typography from '@material-ui/core/Typography';\n\nimport InfoIcon from '@material-ui/icons/Info';\nimport WarningIcon from '@material-ui/icons/Warning';\nimport { DateTime } from 'luxon';\n\nimport { useEvents } from './useEvents';\nimport Skeleton from '@material-ui/lab/Skeleton';\nimport { DismissableBanner } from '@backstage/core-components';\nimport { Event } from 'kubernetes-models/v1';\n\n/**\n * Props for Events\n *\n * @public\n */\nexport interface EventsContentProps {\n  warningEventsOnly?: boolean;\n  events: Event[];\n}\n\nconst getAvatarByType = (type?: string) => {\n  return (\n    <ListItemAvatar>\n      <Avatar>{type === 'Warning' ? <WarningIcon /> : <InfoIcon />}</Avatar>\n    </ListItemAvatar>\n  );\n};\n\n/**\n * Shows given Kubernetes events\n *\n * @public\n */\nexport const EventsContent = ({\n  events,\n  warningEventsOnly,\n}: EventsContentProps) => {\n  if (events.length === 0) {\n    return <Typography>No events found</Typography>;\n  }\n\n  return (\n    <Container>\n      <Grid>\n        <List>\n          {events\n            .filter(event => {\n              if (warningEventsOnly) {\n                return event.type === 'Warning';\n              }\n              return true;\n            })\n            .map((event, index) => {\n              const timeAgo = event.metadata.creationTimestamp\n                ? DateTime.fromISO(event.metadata.creationTimestamp).toRelative(\n                    {\n                      locale: 'en',\n                    },\n                  )\n                : 'unknown';\n              return (\n                <ListItem key={`${event.metadata.name}-${index}`}>\n                  <Tooltip title={`${event.type ?? ''} event`}>\n                    {getAvatarByType(event.type)}\n                  </Tooltip>\n                  <ListItemText\n                    primary={`First event ${timeAgo} (count: ${event.count})`}\n                    secondary={`${event.reason}: ${event.message}`}\n                  />\n                </ListItem>\n              );\n            })}\n        </List>\n      </Grid>\n    </Container>\n  );\n};\n\n/**\n * Props for Events\n *\n * @public\n */\nexport interface EventsProps {\n  involvedObjectName: string;\n  namespace: string;\n  clusterName: string;\n  warningEventsOnly?: boolean;\n}\n\n/**\n * Retrieves and shows Kubernetes events for the given object\n *\n * @public\n */\nexport const Events = ({\n  involvedObjectName,\n  namespace,\n  clusterName,\n  warningEventsOnly,\n}: EventsProps) => {\n  const { value, error, loading } = useEvents({\n    involvedObjectName,\n    namespace,\n    clusterName,\n  });\n\n  return (\n    <>\n      {error && (\n        <DismissableBanner\n          {...{\n            message: error.message,\n            variant: 'error',\n            fixed: false,\n          }}\n          id=\"events\"\n        />\n      )}\n      {loading && <Skeleton variant=\"rect\" width=\"100%\" height=\"100%\" />}\n      {!loading && value !== undefined && (\n        <EventsContent warningEventsOnly={warningEventsOnly} events={value} />\n      )}\n    </>\n  );\n};\n"],"names":[],"mappings":"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"}