{"version":3,"file":"ErrorReporting.esm.js","sources":["../../../src/components/ErrorReporting/ErrorReporting.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {\n  ClusterAttributes,\n  DetectedError,\n  DetectedErrorsByCluster,\n} from '@backstage/plugin-kubernetes-common';\nimport { Table, TableColumn } from '@backstage/core-components';\n\n/**\n *\n *\n * @public\n */\nexport type ErrorReportingProps = {\n  detectedErrors: DetectedErrorsByCluster;\n  clusters: ClusterAttributes[];\n};\n\nconst columns: TableColumn<Row>[] = [\n  {\n    title: 'cluster',\n    width: '10%',\n    render: (row: Row) => row.cluster.title || row.cluster.name,\n  },\n  {\n    title: 'namespace',\n    width: '10%',\n    render: (row: Row) => row.error.sourceRef.namespace,\n  },\n  {\n    title: 'kind',\n    width: '10%',\n    render: (row: Row) => row.error.sourceRef.kind,\n  },\n  {\n    title: 'name',\n    width: '30%',\n    render: (row: Row) => {\n      return <>{row.error.sourceRef.name} </>;\n    },\n  },\n  {\n    title: 'messages',\n    width: '40%',\n    render: (row: Row) => row.error.message,\n  },\n];\n\ninterface Row {\n  cluster: ClusterAttributes;\n  error: DetectedError;\n}\n\nconst sortBySeverity = (a: Row, b: Row) => {\n  if (a.error.severity < b.error.severity) {\n    return 1;\n  } else if (b.error.severity < a.error.severity) {\n    return -1;\n  }\n  return 0;\n};\n\n/**\n *\n *\n * @public\n */\nexport const ErrorReporting = ({\n  detectedErrors,\n  clusters,\n}: ErrorReportingProps) => {\n  const errors = Array.from(detectedErrors.entries())\n    .flatMap(([clusterName, resourceErrors]) => {\n      return resourceErrors.map(e => ({\n        cluster: clusters.find(c => c.name === clusterName)!,\n        error: e,\n      }));\n    })\n    .sort(sortBySeverity);\n\n  return (\n    <>\n      {errors.length !== 0 && (\n        <Table\n          title=\"Error Reporting\"\n          data={errors}\n          columns={columns}\n          options={{ paging: true, search: false, emptyRowsWhenPaging: false }}\n        />\n      )}\n    </>\n  );\n};\n"],"names":[],"mappings":";;;AAgCA,MAAM,OAAA,GAA8B;AAAA,EAClC;AAAA,IACE,KAAA,EAAO,SAAA;AAAA,IACP,KAAA,EAAO,KAAA;AAAA,IACP,QAAQ,CAAC,GAAA,KAAa,IAAI,OAAA,CAAQ,KAAA,IAAS,IAAI,OAAA,CAAQ;AAAA,GACzD;AAAA,EACA;AAAA,IACE,KAAA,EAAO,WAAA;AAAA,IACP,KAAA,EAAO,KAAA;AAAA,IACP,MAAA,EAAQ,CAAC,GAAA,KAAa,GAAA,CAAI,MAAM,SAAA,CAAU;AAAA,GAC5C;AAAA,EACA;AAAA,IACE,KAAA,EAAO,MAAA;AAAA,IACP,KAAA,EAAO,KAAA;AAAA,IACP,MAAA,EAAQ,CAAC,GAAA,KAAa,GAAA,CAAI,MAAM,SAAA,CAAU;AAAA,GAC5C;AAAA,EACA;AAAA,IACE,KAAA,EAAO,MAAA;AAAA,IACP,KAAA,EAAO,KAAA;AAAA,IACP,MAAA,EAAQ,CAAC,GAAA,KAAa;AACpB,MAAA,uBAAO,IAAA,CAAA,QAAA,EAAA,EAAG,QAAA,EAAA;AAAA,QAAA,GAAA,CAAI,MAAM,SAAA,CAAU,IAAA;AAAA,QAAK;AAAA,OAAA,EAAC,CAAA;AAAA,IACtC;AAAA,GACF;AAAA,EACA;AAAA,IACE,KAAA,EAAO,UAAA;AAAA,IACP,KAAA,EAAO,KAAA;AAAA,IACP,MAAA,EAAQ,CAAC,GAAA,KAAa,GAAA,CAAI,KAAA,CAAM;AAAA;AAEpC,CAAA;AAOA,MAAM,cAAA,GAAiB,CAAC,CAAA,EAAQ,CAAA,KAAW;AACzC,EAAA,IAAI,CAAA,CAAE,KAAA,CAAM,QAAA,GAAW,CAAA,CAAE,MAAM,QAAA,EAAU;AACvC,IAAA,OAAO,CAAA;AAAA,EACT,WAAW,CAAA,CAAE,KAAA,CAAM,QAAA,GAAW,CAAA,CAAE,MAAM,QAAA,EAAU;AAC9C,IAAA,OAAO,EAAA;AAAA,EACT;AACA,EAAA,OAAO,CAAA;AACT,CAAA;AAOO,MAAM,iBAAiB,CAAC;AAAA,EAC7B,cAAA;AAAA,EACA;AACF,CAAA,KAA2B;AACzB,EAAA,MAAM,MAAA,GAAS,KAAA,CAAM,IAAA,CAAK,cAAA,CAAe,OAAA,EAAS,CAAA,CAC/C,OAAA,CAAQ,CAAC,CAAC,WAAA,EAAa,cAAc,CAAA,KAAM;AAC1C,IAAA,OAAO,cAAA,CAAe,IAAI,CAAA,CAAA,MAAM;AAAA,MAC9B,SAAS,QAAA,CAAS,IAAA,CAAK,CAAA,CAAA,KAAK,CAAA,CAAE,SAAS,WAAW,CAAA;AAAA,MAClD,KAAA,EAAO;AAAA,KACT,CAAE,CAAA;AAAA,EACJ,CAAC,CAAA,CACA,IAAA,CAAK,cAAc,CAAA;AAEtB,EAAA,uBACE,GAAA,CAAA,QAAA,EAAA,EACG,QAAA,EAAA,MAAA,CAAO,MAAA,KAAW,CAAA,oBACjB,GAAA;AAAA,IAAC,KAAA;AAAA,IAAA;AAAA,MACC,KAAA,EAAM,iBAAA;AAAA,MACN,IAAA,EAAM,MAAA;AAAA,MACN,OAAA;AAAA,MACA,SAAS,EAAE,MAAA,EAAQ,MAAM,MAAA,EAAQ,KAAA,EAAO,qBAAqB,KAAA;AAAM;AAAA,GACrE,EAEJ,CAAA;AAEJ;;;;"}