{"version":3,"file":"HeaderWorldClock.esm.js","sources":["../../../src/homePageComponents/HeaderWorldClock/HeaderWorldClock.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useState, useEffect } from 'react';\nimport { HeaderLabel } from '@backstage/core-components';\n\nconst timeFormat: Intl.DateTimeFormatOptions = {\n  hour: '2-digit',\n  minute: '2-digit',\n};\n\ntype TimeObj = {\n  label: string;\n  value: string;\n  dateTime: string;\n};\n\n/** @public */\nexport type ClockConfig = {\n  label: string;\n  timeZone: string;\n};\n\nfunction getTimes(\n  clockConfigs: ClockConfig[],\n  customTimeFormat?: Intl.DateTimeFormatOptions,\n) {\n  const d = new Date();\n  const lang = window.navigator.language;\n\n  const clocks: TimeObj[] = [];\n\n  if (!clockConfigs) {\n    return clocks;\n  }\n\n  for (const clockConfig of clockConfigs) {\n    let label = clockConfig.label;\n\n    const options: Intl.DateTimeFormatOptions = {\n      timeZone: clockConfig.timeZone,\n      ...(customTimeFormat ?? timeFormat),\n    };\n\n    try {\n      new Date().toLocaleString(lang, options);\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.warn(\n        `The timezone ${options.timeZone} is invalid. Defaulting to GMT`,\n      );\n      options.timeZone = 'GMT';\n      label = 'GMT';\n    }\n\n    const value = d.toLocaleTimeString(lang, options);\n    const dateTime = d.toLocaleTimeString(lang, {\n      timeZone: options.timeZone,\n      hour: '2-digit',\n      minute: '2-digit',\n      hour12: false,\n    });\n    clocks.push({ label, value, dateTime });\n  }\n\n  return clocks;\n}\n\n/**\n * A component to display a configurable list of clocks for various time zones.\n *\n * @example\n * Here's a simple example:\n * ```\n * // This will give you a clock for the time zone that Stockholm is in\n * // you can add more than one but keep in mind space may be limited\n * const clockConfigs: ClockConfig[] = [\n *  {\n *    label: 'STO',\n *    timeZone: 'Europe/Stockholm',\n *  },\n * ];\n *\n * // Setting hour12 to false will make all the clocks show in the 24hr format\n * const timeFormat: Intl.DateTimeFormatOptions = {\n *  hour: '2-digit',\n *  minute: '2-digit',\n *  hour12: false,\n * };\n *\n * // Here is the component in use:\n * <HeaderWorldClock\n *  clockConfigs={clockConfigs}\n *  customTimeFormat={timeFormat}\n * />\n * ```\n *\n * @public\n */\nexport const HeaderWorldClock = (props: {\n  clockConfigs: ClockConfig[];\n  customTimeFormat?: Intl.DateTimeFormatOptions;\n}) => {\n  const { clockConfigs, customTimeFormat } = props;\n\n  const defaultTimes: TimeObj[] = [];\n  const [clocks, setTimes] = useState(defaultTimes);\n\n  useEffect(() => {\n    setTimes(getTimes(clockConfigs, customTimeFormat));\n\n    const intervalId = setInterval(() => {\n      setTimes(getTimes(clockConfigs, customTimeFormat));\n    }, 1000);\n\n    return () => {\n      clearInterval(intervalId);\n    };\n  }, [clockConfigs, customTimeFormat]);\n\n  if (clocks.length !== 0) {\n    return (\n      <>\n        {clocks.map(clock => (\n          <HeaderLabel\n            key={clock.label}\n            label={clock.label}\n            value={<time dateTime={clock.dateTime}>{clock.value}</time>}\n          />\n        ))}\n      </>\n    );\n  }\n  return null;\n};\n"],"names":[],"mappings":";;;;AAmBA,MAAM,UAAA,GAAyC;AAAA,EAC7C,IAAA,EAAM,SAAA;AAAA,EACN,MAAA,EAAQ;AACV,CAAA;AAcA,SAAS,QAAA,CACP,cACA,gBAAA,EACA;AACA,EAAA,MAAM,CAAA,uBAAQ,IAAA,EAAK;AACnB,EAAA,MAAM,IAAA,GAAO,OAAO,SAAA,CAAU,QAAA;AAE9B,EAAA,MAAM,SAAoB,EAAC;AAE3B,EAAA,IAAI,CAAC,YAAA,EAAc;AACjB,IAAA,OAAO,MAAA;AAAA,EACT;AAEA,EAAA,KAAA,MAAW,eAAe,YAAA,EAAc;AACtC,IAAA,IAAI,QAAQ,WAAA,CAAY,KAAA;AAExB,IAAA,MAAM,OAAA,GAAsC;AAAA,MAC1C,UAAU,WAAA,CAAY,QAAA;AAAA,MACtB,GAAI,gBAAA,IAAoB;AAAA,KAC1B;AAEA,IAAA,IAAI;AACF,MAAA,iBAAA,IAAI,IAAA,EAAK,EAAE,cAAA,CAAe,IAAA,EAAM,OAAO,CAAA;AAAA,IACzC,SAAS,CAAA,EAAG;AAEV,MAAA,OAAA,CAAQ,IAAA;AAAA,QACN,CAAA,aAAA,EAAgB,QAAQ,QAAQ,CAAA,8BAAA;AAAA,OAClC;AACA,MAAA,OAAA,CAAQ,QAAA,GAAW,KAAA;AACnB,MAAA,KAAA,GAAQ,KAAA;AAAA,IACV;AAEA,IAAA,MAAM,KAAA,GAAQ,CAAA,CAAE,kBAAA,CAAmB,IAAA,EAAM,OAAO,CAAA;AAChD,IAAA,MAAM,QAAA,GAAW,CAAA,CAAE,kBAAA,CAAmB,IAAA,EAAM;AAAA,MAC1C,UAAU,OAAA,CAAQ,QAAA;AAAA,MAClB,IAAA,EAAM,SAAA;AAAA,MACN,MAAA,EAAQ,SAAA;AAAA,MACR,MAAA,EAAQ;AAAA,KACT,CAAA;AACD,IAAA,MAAA,CAAO,IAAA,CAAK,EAAE,KAAA,EAAO,KAAA,EAAO,UAAU,CAAA;AAAA,EACxC;AAEA,EAAA,OAAO,MAAA;AACT;AAiCO,MAAM,gBAAA,GAAmB,CAAC,KAAA,KAG3B;AACJ,EAAA,MAAM,EAAE,YAAA,EAAc,gBAAA,EAAiB,GAAI,KAAA;AAE3C,EAAA,MAAM,eAA0B,EAAC;AACjC,EAAA,MAAM,CAAC,MAAA,EAAQ,QAAQ,CAAA,GAAI,SAAS,YAAY,CAAA;AAEhD,EAAA,SAAA,CAAU,MAAM;AACd,IAAA,QAAA,CAAS,QAAA,CAAS,YAAA,EAAc,gBAAgB,CAAC,CAAA;AAEjD,IAAA,MAAM,UAAA,GAAa,YAAY,MAAM;AACnC,MAAA,QAAA,CAAS,QAAA,CAAS,YAAA,EAAc,gBAAgB,CAAC,CAAA;AAAA,IACnD,GAAG,GAAI,CAAA;AAEP,IAAA,OAAO,MAAM;AACX,MAAA,aAAA,CAAc,UAAU,CAAA;AAAA,IAC1B,CAAA;AAAA,EACF,CAAA,EAAG,CAAC,YAAA,EAAc,gBAAgB,CAAC,CAAA;AAEnC,EAAA,IAAI,MAAA,CAAO,WAAW,CAAA,EAAG;AACvB,IAAA,uBACE,GAAA,CAAA,QAAA,EAAA,EACG,QAAA,EAAA,MAAA,CAAO,GAAA,CAAI,CAAA,KAAA,qBACV,GAAA;AAAA,MAAC,WAAA;AAAA,MAAA;AAAA,QAEC,OAAO,KAAA,CAAM,KAAA;AAAA,QACb,uBAAO,GAAA,CAAC,MAAA,EAAA,EAAK,UAAU,KAAA,CAAM,QAAA,EAAW,gBAAM,KAAA,EAAM;AAAA,OAAA;AAAA,MAF/C,KAAA,CAAM;AAAA,KAId,CAAA,EACH,CAAA;AAAA,EAEJ;AACA,EAAA,OAAO,IAAA;AACT;;;;"}