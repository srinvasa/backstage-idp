{"version":3,"file":"Context.esm.js","sources":["../../../src/homePageComponents/VisitedByType/Context.tsx"],"sourcesContent":["/*\n * Copyright 2023 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Dispatch,\n  SetStateAction,\n  createContext,\n  useMemo,\n  useState,\n  useContext as useReactContext,\n} from 'react';\nimport { Visit } from '../../api/VisitsApi';\nimport { VisitedByTypeKind } from './Content';\n\nexport type ContextValueOnly<T = Visit> = {\n  collapsed: boolean;\n  numVisitsOpen: number;\n  numVisitsTotal: number;\n  visits: Array<T>;\n  loading: boolean;\n  kind: VisitedByTypeKind;\n};\n\nexport type ContextValue<T = Visit> = ContextValueOnly<T> & {\n  setCollapsed: Dispatch<SetStateAction<boolean>>;\n  setNumVisitsOpen: Dispatch<SetStateAction<number>>;\n  setNumVisitsTotal: Dispatch<SetStateAction<number>>;\n  setVisits: Dispatch<SetStateAction<Array<T>>>;\n  setLoading: Dispatch<SetStateAction<boolean>>;\n  setKind: Dispatch<SetStateAction<VisitedByTypeKind>>;\n  setContext: Dispatch<SetStateAction<ContextValueOnly<T>>>;\n};\n\nconst defaultContextValueOnly: ContextValueOnly = {\n  collapsed: true,\n  numVisitsOpen: 3,\n  numVisitsTotal: 8,\n  visits: [],\n  loading: true,\n  kind: 'recent',\n};\n\nexport const defaultContextValue: ContextValue = {\n  ...defaultContextValueOnly,\n  setCollapsed: () => {},\n  setNumVisitsOpen: () => {},\n  setNumVisitsTotal: () => {},\n  setVisits: () => {},\n  setLoading: () => {},\n  setKind: () => {},\n  setContext: () => {},\n};\n\nexport const Context = createContext<ContextValue>(defaultContextValue);\n\nconst getFilteredSet =\n  <T,>(\n    setContext: Dispatch<SetStateAction<ContextValueOnly>>,\n    contextKey: keyof ContextValueOnly,\n  ) =>\n  (e: SetStateAction<T>) =>\n    setContext(state => ({\n      ...state,\n      [contextKey]:\n        typeof e === 'function' ? (e as Function)(state[contextKey]) : e,\n    }));\n\nexport const ContextProvider = ({ children }: { children: JSX.Element }) => {\n  const [context, setContext] = useState<ContextValueOnly>({\n    ...defaultContextValueOnly,\n  });\n  const {\n    setCollapsed,\n    setNumVisitsOpen,\n    setNumVisitsTotal,\n    setVisits,\n    setLoading,\n    setKind,\n  } = useMemo(\n    () => ({\n      setCollapsed: getFilteredSet(setContext, 'collapsed'),\n      setNumVisitsOpen: getFilteredSet(setContext, 'numVisitsOpen'),\n      setNumVisitsTotal: getFilteredSet(setContext, 'numVisitsTotal'),\n      setVisits: getFilteredSet(setContext, 'visits'),\n      setLoading: getFilteredSet(setContext, 'loading'),\n      setKind: getFilteredSet(setContext, 'kind'),\n    }),\n    [setContext],\n  );\n\n  const value: ContextValue = {\n    ...context,\n    setContext,\n    setCollapsed,\n    setNumVisitsOpen,\n    setNumVisitsTotal,\n    setVisits,\n    setLoading,\n    setKind,\n  };\n\n  return <Context.Provider value={value}>{children}</Context.Provider>;\n};\n\nexport const useContext = () => {\n  const value = useReactContext(Context);\n\n  if (value === undefined)\n    throw new Error(\n      'VisitedByType useContext found undefined ContextValue, <ContextProvider/> could be missing',\n    );\n\n  return value;\n};\n\nexport default Context;\n"],"names":["useReactContext"],"mappings":";;;AA8CA,MAAM,uBAAA,GAA4C;AAAA,EAChD,SAAA,EAAW,IAAA;AAAA,EACX,aAAA,EAAe,CAAA;AAAA,EACf,cAAA,EAAgB,CAAA;AAAA,EAChB,QAAQ,EAAC;AAAA,EACT,OAAA,EAAS,IAAA;AAAA,EACT,IAAA,EAAM;AACR,CAAA;AAEO,MAAM,mBAAA,GAAoC;AAAA,EAC/C,GAAG,uBAAA;AAAA,EACH,cAAc,MAAM;AAAA,EAAC,CAAA;AAAA,EACrB,kBAAkB,MAAM;AAAA,EAAC,CAAA;AAAA,EACzB,mBAAmB,MAAM;AAAA,EAAC,CAAA;AAAA,EAC1B,WAAW,MAAM;AAAA,EAAC,CAAA;AAAA,EAClB,YAAY,MAAM;AAAA,EAAC,CAAA;AAAA,EACnB,SAAS,MAAM;AAAA,EAAC,CAAA;AAAA,EAChB,YAAY,MAAM;AAAA,EAAC;AACrB;AAEO,MAAM,OAAA,GAAU,cAA4B,mBAAmB;AAEtE,MAAM,iBACJ,CACE,UAAA,EACA,eAEF,CAAC,CAAA,KACC,WAAW,CAAA,KAAA,MAAU;AAAA,EACnB,GAAG,KAAA;AAAA,EACH,CAAC,UAAU,GACT,OAAO,CAAA,KAAM,aAAc,CAAA,CAAe,KAAA,CAAM,UAAU,CAAC,CAAA,GAAI;AACnE,CAAA,CAAE,CAAA;AAEC,MAAM,eAAA,GAAkB,CAAC,EAAE,QAAA,EAAS,KAAiC;AAC1E,EAAA,MAAM,CAAC,OAAA,EAAS,UAAU,CAAA,GAAI,QAAA,CAA2B;AAAA,IACvD,GAAG;AAAA,GACJ,CAAA;AACD,EAAA,MAAM;AAAA,IACJ,YAAA;AAAA,IACA,gBAAA;AAAA,IACA,iBAAA;AAAA,IACA,SAAA;AAAA,IACA,UAAA;AAAA,IACA;AAAA,GACF,GAAI,OAAA;AAAA,IACF,OAAO;AAAA,MACL,YAAA,EAAc,cAAA,CAAe,UAAA,EAAY,WAAW,CAAA;AAAA,MACpD,gBAAA,EAAkB,cAAA,CAAe,UAAA,EAAY,eAAe,CAAA;AAAA,MAC5D,iBAAA,EAAmB,cAAA,CAAe,UAAA,EAAY,gBAAgB,CAAA;AAAA,MAC9D,SAAA,EAAW,cAAA,CAAe,UAAA,EAAY,QAAQ,CAAA;AAAA,MAC9C,UAAA,EAAY,cAAA,CAAe,UAAA,EAAY,SAAS,CAAA;AAAA,MAChD,OAAA,EAAS,cAAA,CAAe,UAAA,EAAY,MAAM;AAAA,KAC5C,CAAA;AAAA,IACA,CAAC,UAAU;AAAA,GACb;AAEA,EAAA,MAAM,KAAA,GAAsB;AAAA,IAC1B,GAAG,OAAA;AAAA,IACH,UAAA;AAAA,IACA,YAAA;AAAA,IACA,gBAAA;AAAA,IACA,iBAAA;AAAA,IACA,SAAA;AAAA,IACA,UAAA;AAAA,IACA;AAAA,GACF;AAEA,EAAA,uBAAO,GAAA,CAAC,OAAA,CAAQ,QAAA,EAAR,EAAiB,OAAe,QAAA,EAAS,CAAA;AACnD;AAEO,MAAM,aAAa,MAAM;AAC9B,EAAA,MAAM,KAAA,GAAQA,aAAgB,OAAO,CAAA;AAErC,EAAA,IAAI,KAAA,KAAU,MAAA;AACZ,IAAA,MAAM,IAAI,KAAA;AAAA,MACR;AAAA,KACF;AAEF,EAAA,OAAO,KAAA;AACT;;;;"}