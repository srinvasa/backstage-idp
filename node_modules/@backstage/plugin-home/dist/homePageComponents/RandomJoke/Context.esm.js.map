{"version":3,"file":"Context.esm.js","sources":["../../../src/homePageComponents/RandomJoke/Context.tsx"],"sourcesContent":["/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  useState,\n  useCallback,\n  useEffect,\n  useContext,\n  createContext,\n} from 'react';\n\nexport type JokeType = 'any' | 'programming';\n\ntype Joke = {\n  setup: string;\n  punchline: string;\n};\n\ntype RandomJokeContextValue = {\n  loading: boolean;\n  joke: Joke;\n  type: JokeType;\n  rerollJoke: Function;\n  handleChangeType: Function;\n};\n\nconst Context = createContext<RandomJokeContextValue | undefined>(undefined);\n\nconst getNewJoke = (type: string): Promise<Joke> =>\n  fetch(\n    `https://official-joke-api.appspot.com/jokes${\n      type !== 'any' ? `/${type}` : ''\n    }/random`,\n  )\n    .then(res => res.json())\n    .then(data => (Array.isArray(data) ? data[0] : data));\n\nexport const ContextProvider = (props: {\n  children: JSX.Element;\n  defaultCategory?: JokeType;\n}) => {\n  const { children, defaultCategory } = props;\n\n  const [loading, setLoading] = useState(true);\n  const [joke, setJoke] = useState<Joke>({\n    setup: '',\n    punchline: '',\n  });\n  const [type, setType] = useState<JokeType>(\n    defaultCategory || ('programming' as JokeType),\n  );\n\n  const rerollJoke = useCallback(() => {\n    setLoading(true);\n    getNewJoke(type).then(newJoke => setJoke(newJoke));\n  }, [type]);\n\n  const handleChangeType = (newType: JokeType) => {\n    setType(newType);\n  };\n\n  useEffect(() => {\n    setLoading(false);\n  }, [joke]);\n\n  useEffect(() => {\n    rerollJoke();\n  }, [rerollJoke]);\n\n  const value: RandomJokeContextValue = {\n    loading,\n    joke,\n    type,\n    rerollJoke,\n    handleChangeType,\n  };\n\n  return <Context.Provider value={value}>{children}</Context.Provider>;\n};\n\nexport const useRandomJoke = () => {\n  const value = useContext(Context);\n\n  if (value === undefined) {\n    throw new Error('useRandomJoke must be used within a RandomJokeProvider');\n  }\n\n  return value;\n};\n\nexport default Context;\n"],"names":[],"mappings":";;;AAuCA,MAAM,OAAA,GAAU,cAAkD,MAAS;AAE3E,MAAM,UAAA,GAAa,CAAC,IAAA,KAClB,KAAA;AAAA,EACE,8CACE,IAAA,KAAS,KAAA,GAAQ,CAAA,CAAA,EAAI,IAAI,KAAK,EAChC,CAAA,OAAA;AACF,CAAA,CACG,IAAA,CAAK,CAAA,GAAA,KAAO,GAAA,CAAI,IAAA,EAAM,CAAA,CACtB,IAAA,CAAK,CAAA,IAAA,KAAS,KAAA,CAAM,QAAQ,IAAI,CAAA,GAAI,IAAA,CAAK,CAAC,IAAI,IAAK,CAAA;AAEjD,MAAM,eAAA,GAAkB,CAAC,KAAA,KAG1B;AACJ,EAAA,MAAM,EAAE,QAAA,EAAU,eAAA,EAAgB,GAAI,KAAA;AAEtC,EAAA,MAAM,CAAC,OAAA,EAAS,UAAU,CAAA,GAAI,SAAS,IAAI,CAAA;AAC3C,EAAA,MAAM,CAAC,IAAA,EAAM,OAAO,CAAA,GAAI,QAAA,CAAe;AAAA,IACrC,KAAA,EAAO,EAAA;AAAA,IACP,SAAA,EAAW;AAAA,GACZ,CAAA;AACD,EAAA,MAAM,CAAC,IAAA,EAAM,OAAO,CAAA,GAAI,QAAA;AAAA,IACtB,eAAA,IAAoB;AAAA,GACtB;AAEA,EAAA,MAAM,UAAA,GAAa,YAAY,MAAM;AACnC,IAAA,UAAA,CAAW,IAAI,CAAA;AACf,IAAA,UAAA,CAAW,IAAI,CAAA,CAAE,IAAA,CAAK,CAAA,OAAA,KAAW,OAAA,CAAQ,OAAO,CAAC,CAAA;AAAA,EACnD,CAAA,EAAG,CAAC,IAAI,CAAC,CAAA;AAET,EAAA,MAAM,gBAAA,GAAmB,CAAC,OAAA,KAAsB;AAC9C,IAAA,OAAA,CAAQ,OAAO,CAAA;AAAA,EACjB,CAAA;AAEA,EAAA,SAAA,CAAU,MAAM;AACd,IAAA,UAAA,CAAW,KAAK,CAAA;AAAA,EAClB,CAAA,EAAG,CAAC,IAAI,CAAC,CAAA;AAET,EAAA,SAAA,CAAU,MAAM;AACd,IAAA,UAAA,EAAW;AAAA,EACb,CAAA,EAAG,CAAC,UAAU,CAAC,CAAA;AAEf,EAAA,MAAM,KAAA,GAAgC;AAAA,IACpC,OAAA;AAAA,IACA,IAAA;AAAA,IACA,IAAA;AAAA,IACA,UAAA;AAAA,IACA;AAAA,GACF;AAEA,EAAA,uBAAO,GAAA,CAAC,OAAA,CAAQ,QAAA,EAAR,EAAiB,OAAe,QAAA,EAAS,CAAA;AACnD;AAEO,MAAM,gBAAgB,MAAM;AACjC,EAAA,MAAM,KAAA,GAAQ,WAAW,OAAO,CAAA;AAEhC,EAAA,IAAI,UAAU,MAAA,EAAW;AACvB,IAAA,MAAM,IAAI,MAAM,wDAAwD,CAAA;AAAA,EAC1E;AAEA,EAAA,OAAO,KAAA;AACT;;;;"}