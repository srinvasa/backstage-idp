import { jsx } from 'react/jsx-runtime';
import { useState, useCallback, useEffect, createContext, useContext } from 'react';

const Context = createContext(void 0);
const getNewJoke = (type) => fetch(
  `https://official-joke-api.appspot.com/jokes${type !== "any" ? `/${type}` : ""}/random`
).then((res) => res.json()).then((data) => Array.isArray(data) ? data[0] : data);
const ContextProvider = (props) => {
  const { children, defaultCategory } = props;
  const [loading, setLoading] = useState(true);
  const [joke, setJoke] = useState({
    setup: "",
    punchline: ""
  });
  const [type, setType] = useState(
    defaultCategory || "programming"
  );
  const rerollJoke = useCallback(() => {
    setLoading(true);
    getNewJoke(type).then((newJoke) => setJoke(newJoke));
  }, [type]);
  const handleChangeType = (newType) => {
    setType(newType);
  };
  useEffect(() => {
    setLoading(false);
  }, [joke]);
  useEffect(() => {
    rerollJoke();
  }, [rerollJoke]);
  const value = {
    loading,
    joke,
    type,
    rerollJoke,
    handleChangeType
  };
  return /* @__PURE__ */ jsx(Context.Provider, { value, children });
};
const useRandomJoke = () => {
  const value = useContext(Context);
  if (value === void 0) {
    throw new Error("useRandomJoke must be used within a RandomJokeProvider");
  }
  return value;
};

export { ContextProvider, Context as default, useRandomJoke };
//# sourceMappingURL=Context.esm.js.map
