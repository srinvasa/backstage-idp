{"version":3,"file":"config.esm.js","sources":["../../src/api/config.ts"],"sourcesContent":["/*\n * Copyright 2023 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Visit,\n  VisitsApiQueryParams,\n  Operators,\n  isOperator,\n} from './VisitsApi';\nimport { Config } from '@backstage/config';\n\n/**\n * Reads a single FilterBy config.\n *\n * @param config - The single config object\n *\n * @public\n */\n\nexport function readFilterConfig(config: Config):\n  | {\n      field: keyof Visit;\n      operator: Operators;\n      value: string | number;\n    }\n  | undefined {\n  try {\n    const field = config.getString('field') as keyof Visit;\n    const operator = config.getString('operator');\n    const value = getValue(config);\n    if (isOperator(operator) && value !== undefined) {\n      return { field, operator, value };\n    }\n    return undefined;\n  } catch (error) {\n    // invalid filter config - ignore filter\n    return undefined;\n  }\n}\n\nfunction getValue(config: Config) {\n  let value = undefined;\n  try {\n    value = config.getString('value');\n  } catch (error) {\n    try {\n      value = config.getNumber('value');\n    } catch {\n      // value is not string or number - ignore filter\n    }\n  }\n  return value;\n}\n\n/**\n * Reads a set of filter by configs.\n *\n * @param configs - All of the config objects\n *\n * @public\n */\nexport function createFilterByQueryParamFromConfig(\n  configs: Config[],\n): VisitsApiQueryParams['filterBy'] | undefined {\n  try {\n    return configs\n      .map(readFilterConfig)\n      .filter(Boolean) as VisitsApiQueryParams['filterBy'];\n  } catch {\n    return undefined;\n  }\n}\n"],"names":[],"mappings":";;AAgCO,SAAS,iBAAiB,MAAA,EAMnB;AACZ,EAAA,IAAI;AACF,IAAA,MAAM,KAAA,GAAQ,MAAA,CAAO,SAAA,CAAU,OAAO,CAAA;AACtC,IAAA,MAAM,QAAA,GAAW,MAAA,CAAO,SAAA,CAAU,UAAU,CAAA;AAC5C,IAAA,MAAM,KAAA,GAAQ,SAAS,MAAM,CAAA;AAC7B,IAAA,IAAI,UAAA,CAAW,QAAQ,CAAA,IAAK,KAAA,KAAU,KAAA,CAAA,EAAW;AAC/C,MAAA,OAAO,EAAE,KAAA,EAAO,QAAA,EAAU,KAAA,EAAM;AAAA,IAClC;AACA,IAAA,OAAO,KAAA,CAAA;AAAA,EACT,SAAS,KAAA,EAAO;AAEd,IAAA,OAAO,MAAA;AAAA,EACT;AACF;AAEA,SAAS,SAAS,MAAA,EAAgB;AAChC,EAAA,IAAI,KAAA,GAAQ,MAAA;AACZ,EAAA,IAAI;AACF,IAAA,KAAA,GAAQ,MAAA,CAAO,UAAU,OAAO,CAAA;AAAA,EAClC,SAAS,KAAA,EAAO;AACd,IAAA,IAAI;AACF,MAAA,KAAA,GAAQ,MAAA,CAAO,UAAU,OAAO,CAAA;AAAA,IAClC,CAAA,CAAA,MAAQ;AAAA,IAER;AAAA,EACF;AACA,EAAA,OAAO,KAAA;AACT;AASO,SAAS,mCACd,OAAA,EAC8C;AAC9C,EAAA,IAAI;AACF,IAAA,OAAO,OAAA,CACJ,GAAA,CAAI,gBAAgB,CAAA,CACpB,OAAO,OAAO,CAAA;AAAA,EACnB,CAAA,CAAA,MAAQ;AACN,IAAA,OAAO,MAAA;AAAA,EACT;AACF;;;;"}