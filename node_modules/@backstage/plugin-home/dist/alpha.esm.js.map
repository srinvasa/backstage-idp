{"version":3,"file":"alpha.esm.js","sources":["../src/alpha.tsx"],"sourcesContent":["/*\n * Copyright 2023 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  coreExtensionData,\n  createExtensionDataRef,\n  createExtensionInput,\n  PageBlueprint,\n  createFrontendPlugin,\n  createRouteRef,\n  AppRootElementBlueprint,\n  identityApiRef,\n  storageApiRef,\n  ApiBlueprint,\n} from '@backstage/frontend-plugin-api';\nimport { compatWrapper } from '@backstage/core-compat-api';\nimport { VisitListener } from './components/';\nimport { visitsApiRef, VisitsStorageApi } from './api';\n\nconst rootRouteRef = createRouteRef();\n\n/**\n * @alpha\n */\nexport const titleExtensionDataRef = createExtensionDataRef<string>().with({\n  id: 'title',\n});\n\nconst homePage = PageBlueprint.makeWithOverrides({\n  inputs: {\n    props: createExtensionInput(\n      [\n        coreExtensionData.reactElement.optional(),\n        titleExtensionDataRef.optional(),\n      ],\n      {\n        singleton: true,\n        optional: true,\n      },\n    ),\n  },\n  factory: (originalFactory, { inputs }) => {\n    return originalFactory({\n      path: '/home',\n      routeRef: rootRouteRef,\n      loader: () =>\n        import('./components/').then(m =>\n          compatWrapper(\n            <m.HomepageCompositionRoot\n              children={inputs.props?.get(coreExtensionData.reactElement)}\n              title={inputs.props?.get(titleExtensionDataRef)}\n            />,\n          ),\n        ),\n    });\n  },\n});\n\nconst visitListenerAppRootElement = AppRootElementBlueprint.make({\n  name: 'visit-listener',\n  params: {\n    element: <VisitListener />,\n  },\n});\n\nconst visitsApi = ApiBlueprint.make({\n  name: 'visits',\n  params: defineParams =>\n    defineParams({\n      api: visitsApiRef,\n      deps: {\n        storageApi: storageApiRef,\n        identityApi: identityApiRef,\n      },\n      factory: ({ storageApi, identityApi }) =>\n        VisitsStorageApi.create({ storageApi, identityApi }),\n    }),\n});\n\n/**\n * @alpha\n */\nexport default createFrontendPlugin({\n  pluginId: 'home',\n  info: { packageJson: () => import('../package.json') },\n  extensions: [homePage, visitsApi, visitListenerAppRootElement],\n  routes: {\n    root: rootRouteRef,\n  },\n});\n\nexport { homeTranslationRef } from './translation';\n"],"names":[],"mappings":";;;;;;;;;;;;AAgCA,MAAM,eAAe,cAAA,EAAe;AAK7B,MAAM,qBAAA,GAAwB,sBAAA,EAA+B,CAAE,IAAA,CAAK;AAAA,EACzE,EAAA,EAAI;AACN,CAAC;AAED,MAAM,QAAA,GAAW,cAAc,iBAAA,CAAkB;AAAA,EAC/C,MAAA,EAAQ;AAAA,IACN,KAAA,EAAO,oBAAA;AAAA,MACL;AAAA,QACE,iBAAA,CAAkB,aAAa,QAAA,EAAS;AAAA,QACxC,sBAAsB,QAAA;AAAS,OACjC;AAAA,MACA;AAAA,QACE,SAAA,EAAW,IAAA;AAAA,QACX,QAAA,EAAU;AAAA;AACZ;AACF,GACF;AAAA,EACA,OAAA,EAAS,CAAC,eAAA,EAAiB,EAAE,QAAO,KAAM;AACxC,IAAA,OAAO,eAAA,CAAgB;AAAA,MACrB,IAAA,EAAM,OAAA;AAAA,MACN,QAAA,EAAU,YAAA;AAAA,MACV,MAAA,EAAQ,MACN,OAAO,2BAAe,CAAA,CAAE,IAAA;AAAA,QAAK,CAAA,CAAA,KAC3B,aAAA;AAAA,0BACE,GAAA;AAAA,YAAC,CAAA,CAAE,uBAAA;AAAA,YAAF;AAAA,cACC,QAAA,EAAU,MAAA,CAAO,KAAA,EAAO,GAAA,CAAI,kBAAkB,YAAY,CAAA;AAAA,cAC1D,KAAA,EAAO,MAAA,CAAO,KAAA,EAAO,GAAA,CAAI,qBAAqB;AAAA;AAAA;AAChD;AACF;AACF,KACH,CAAA;AAAA,EACH;AACF,CAAC,CAAA;AAED,MAAM,2BAAA,GAA8B,wBAAwB,IAAA,CAAK;AAAA,EAC/D,IAAA,EAAM,gBAAA;AAAA,EACN,MAAA,EAAQ;AAAA,IACN,OAAA,sBAAU,aAAA,EAAA,EAAc;AAAA;AAE5B,CAAC,CAAA;AAED,MAAM,SAAA,GAAY,aAAa,IAAA,CAAK;AAAA,EAClC,IAAA,EAAM,QAAA;AAAA,EACN,MAAA,EAAQ,kBACN,YAAA,CAAa;AAAA,IACX,GAAA,EAAK,YAAA;AAAA,IACL,IAAA,EAAM;AAAA,MACJ,UAAA,EAAY,aAAA;AAAA,MACZ,WAAA,EAAa;AAAA,KACf;AAAA,IACA,OAAA,EAAS,CAAC,EAAE,UAAA,EAAY,WAAA,EAAY,KAClC,gBAAA,CAAiB,MAAA,CAAO,EAAE,UAAA,EAAY,WAAA,EAAa;AAAA,GACtD;AACL,CAAC,CAAA;AAKD,YAAe,oBAAA,CAAqB;AAAA,EAClC,QAAA,EAAU,MAAA;AAAA,EACV,MAAM,EAAE,WAAA,EAAa,MAAM,OAAO,uBAAiB,CAAA,EAAE;AAAA,EACrD,UAAA,EAAY,CAAC,QAAA,EAAU,SAAA,EAAW,2BAA2B,CAAA;AAAA,EAC7D,MAAA,EAAQ;AAAA,IACN,IAAA,EAAM;AAAA;AAEV,CAAC,CAAA;;;;"}