{"version":3,"file":"Context.esm.js","sources":["../../../src/components/VisitList/Context.tsx"],"sourcesContent":["/*\n * Copyright 2023 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createContext, useContext, ReactNode } from 'react';\nimport { CompoundEntityRef, parseEntityRef } from '@backstage/catalog-model';\nimport { colorVariants } from '@backstage/theme';\nimport { Visit } from '../../api/VisitsApi';\n\n/**\n * Type definition for the chip color function\n * @public\n */\nexport type GetChipColorFunction = (visit: Visit) => string;\n\n/**\n * Type definition for the label function\n * @public\n */\nexport type GetLabelFunction = (visit: Visit) => string;\n\n/**\n * Context value interface\n * @public\n */\nexport interface VisitDisplayContextValue {\n  getChipColor: GetChipColorFunction;\n  getLabel: GetLabelFunction;\n}\n\n/**\n * Props for the VisitDisplayProvider\n * @public\n */\nexport interface VisitDisplayProviderProps {\n  children: ReactNode;\n  getChipColor?: GetChipColorFunction;\n  getLabel?: GetLabelFunction;\n}\n\n// Default implementations\nconst getColorByIndex = (index: number) => {\n  const variants = Object.keys(colorVariants);\n  const variantIndex = index % variants.length;\n  return colorVariants[variants[variantIndex]][0];\n};\n\nconst maybeEntity = (visit: Visit): CompoundEntityRef | undefined => {\n  try {\n    return parseEntityRef(visit?.entityRef ?? '');\n  } catch (e) {\n    return undefined;\n  }\n};\n\nconst defaultGetChipColor: GetChipColorFunction = (visit: Visit): string => {\n  const defaultColor = getColorByIndex(0);\n  const entity = maybeEntity(visit);\n  if (!entity) return defaultColor;\n\n  // IDEA: Use or replicate useAllKinds hook thus supporting all software catalog\n  //       registered kinds. See:\n  //       plugins/catalog-react/src/components/EntityKindPicker/kindFilterUtils.ts\n  //       Provide extension point to register your own color code.\n  const entityKinds = [\n    'component',\n    'template',\n    'api',\n    'group',\n    'user',\n    'resource',\n    'system',\n    'domain',\n    'location',\n  ];\n  const foundIndex = entityKinds.indexOf(\n    entity.kind.toLocaleLowerCase('en-US'),\n  );\n  return foundIndex === -1 ? defaultColor : getColorByIndex(foundIndex + 1);\n};\n\nconst defaultGetLabel: GetLabelFunction = (visit: Visit): string => {\n  const entity = maybeEntity(visit);\n  return (entity?.kind ?? 'Other').toLocaleLowerCase('en-US');\n};\n\n// Create the context\nconst VisitDisplayContext = createContext<VisitDisplayContextValue>({\n  getChipColor: defaultGetChipColor,\n  getLabel: defaultGetLabel,\n});\n\n/**\n * Provider component for VisitDisplay customization\n * @public\n */\nexport const VisitDisplayProvider = ({\n  children,\n  getChipColor = defaultGetChipColor,\n  getLabel = defaultGetLabel,\n}: VisitDisplayProviderProps) => {\n  const value: VisitDisplayContextValue = {\n    getChipColor,\n    getLabel,\n  };\n\n  return (\n    <VisitDisplayContext.Provider value={value}>\n      {children}\n    </VisitDisplayContext.Provider>\n  );\n};\n\n/**\n * Hook to use the VisitDisplay context\n * @public\n */\nexport const useVisitDisplay = (): VisitDisplayContextValue => {\n  const context = useContext(VisitDisplayContext);\n  if (!context) {\n    throw new Error(\n      'useVisitDisplay must be used within a VisitDisplayProvider',\n    );\n  }\n  return context;\n};\n"],"names":[],"mappings":";;;;;AAqDA,MAAM,eAAA,GAAkB,CAAC,KAAA,KAAkB;AACzC,EAAA,MAAM,QAAA,GAAW,MAAA,CAAO,IAAA,CAAK,aAAa,CAAA;AAC1C,EAAA,MAAM,YAAA,GAAe,QAAQ,QAAA,CAAS,MAAA;AACtC,EAAA,OAAO,aAAA,CAAc,QAAA,CAAS,YAAY,CAAC,EAAE,CAAC,CAAA;AAChD,CAAA;AAEA,MAAM,WAAA,GAAc,CAAC,KAAA,KAAgD;AACnE,EAAA,IAAI;AACF,IAAA,OAAO,cAAA,CAAe,KAAA,EAAO,SAAA,IAAa,EAAE,CAAA;AAAA,EAC9C,SAAS,CAAA,EAAG;AACV,IAAA,OAAO,MAAA;AAAA,EACT;AACF,CAAA;AAEA,MAAM,mBAAA,GAA4C,CAAC,KAAA,KAAyB;AAC1E,EAAA,MAAM,YAAA,GAAe,gBAAgB,CAAC,CAAA;AACtC,EAAA,MAAM,MAAA,GAAS,YAAY,KAAK,CAAA;AAChC,EAAA,IAAI,CAAC,QAAQ,OAAO,YAAA;AAMpB,EAAA,MAAM,WAAA,GAAc;AAAA,IAClB,WAAA;AAAA,IACA,UAAA;AAAA,IACA,KAAA;AAAA,IACA,OAAA;AAAA,IACA,MAAA;AAAA,IACA,UAAA;AAAA,IACA,QAAA;AAAA,IACA,QAAA;AAAA,IACA;AAAA,GACF;AACA,EAAA,MAAM,aAAa,WAAA,CAAY,OAAA;AAAA,IAC7B,MAAA,CAAO,IAAA,CAAK,iBAAA,CAAkB,OAAO;AAAA,GACvC;AACA,EAAA,OAAO,UAAA,KAAe,EAAA,GAAK,YAAA,GAAe,eAAA,CAAgB,aAAa,CAAC,CAAA;AAC1E,CAAA;AAEA,MAAM,eAAA,GAAoC,CAAC,KAAA,KAAyB;AAClE,EAAA,MAAM,MAAA,GAAS,YAAY,KAAK,CAAA;AAChC,EAAA,OAAA,CAAQ,MAAA,EAAQ,IAAA,IAAQ,OAAA,EAAS,iBAAA,CAAkB,OAAO,CAAA;AAC5D,CAAA;AAGA,MAAM,sBAAsB,aAAA,CAAwC;AAAA,EAClE,YAAA,EAAc,mBAAA;AAAA,EACd,QAAA,EAAU;AACZ,CAAC,CAAA;AAMM,MAAM,uBAAuB,CAAC;AAAA,EACnC,QAAA;AAAA,EACA,YAAA,GAAe,mBAAA;AAAA,EACf,QAAA,GAAW;AACb,CAAA,KAAiC;AAC/B,EAAA,MAAM,KAAA,GAAkC;AAAA,IACtC,YAAA;AAAA,IACA;AAAA,GACF;AAEA,EAAA,uBACE,GAAA,CAAC,mBAAA,CAAoB,QAAA,EAApB,EAA6B,OAC3B,QAAA,EACH,CAAA;AAEJ;AAMO,MAAM,kBAAkB,MAAgC;AAC7D,EAAA,MAAM,OAAA,GAAU,WAAW,mBAAmB,CAAA;AAC9C,EAAA,IAAI,CAAC,OAAA,EAAS;AACZ,IAAA,MAAM,IAAI,KAAA;AAAA,MACR;AAAA,KACF;AAAA,EACF;AACA,EAAA,OAAO,OAAA;AACT;;;;"}