{"version":3,"file":"static/2557.63ecff37.chunk.js","sources":["webpack://app/../../node_modules/@backstage/plugin-catalog-graph/dist/components/EntityRelationsGraph/DefaultRenderLabel.esm.js","webpack://app/../../node_modules/@backstage/plugin-catalog-graph/dist/components/EntityRelationsGraph/EntityIcon.esm.js","webpack://app/../../node_modules/@backstage/plugin-catalog-graph/dist/components/EntityRelationsGraph/DefaultRenderNode.esm.js","webpack://app/../../node_modules/@backstage/plugin-catalog-graph/dist/lib/graph-transformations/merge-relations.esm.js","webpack://app/../../node_modules/@backstage/plugin-catalog-graph/dist/lib/graph-transformations/index.esm.js","webpack://app/../../node_modules/@backstage/plugin-catalog-graph/dist/lib/graph-transformations/reduce-edges.esm.js","webpack://app/../../node_modules/@backstage/plugin-catalog-graph/dist/lib/graph-transformations/set-distance.esm.js","webpack://app/../../node_modules/@backstage/plugin-catalog-graph/dist/lib/graph-transformations/order-forward.esm.js","webpack://app/../../node_modules/@backstage/plugin-catalog-graph/dist/lib/graph-transformations/strip-distant-edges.esm.js","webpack://app/../../node_modules/@backstage/plugin-catalog-graph/dist/lib/graph-transformations/remove-backward-edges.esm.js","webpack://app/../../node_modules/@backstage/plugin-catalog-graph/dist/components/EntityRelationsGraph/EntityRelationsGraph.esm.js","webpack://app/../../node_modules/@backstage/plugin-catalog-graph/dist/components/EntityRelationsGraph/useEntityRelationNodesAndEdges.esm.js","webpack://app/../../node_modules/@backstage/plugin-catalog-graph/dist/components/EntityRelationsGraph/useEntityRelationGraph.esm.js","webpack://app/../../node_modules/@backstage/plugin-catalog-graph/dist/components/EntityRelationsGraph/useEntityStore.esm.js","webpack://app/../../node_modules/@backstage/plugin-catalog-graph/dist/lib/graph/build-graph.esm.js","webpack://app/../../node_modules/@backstage/plugin-catalog-graph/dist/hooks/useRelations.esm.js","webpack://app/../../node_modules/@backstage/plugin-catalog-graph/dist/translation.esm.js"],"sourcesContent":["import { jsx, jsxs } from 'react/jsx-runtime';\nimport makeStyles from '@material-ui/core/styles/makeStyles';\nimport classNames from 'classnames';\n\nconst useStyles = makeStyles(\n  (theme) => ({\n    text: {\n      fill: theme.palette.textContrast\n    },\n    secondary: {\n      fill: theme.palette.textSubtle\n    }\n  }),\n  { name: \"PluginCatalogGraphCustomLabel\" }\n);\nfunction DefaultRenderLabel({\n  edge: { relations }\n}) {\n  const classes = useStyles();\n  return /* @__PURE__ */ jsx(\"text\", { className: classes.text, textAnchor: \"middle\", children: relations.map((r, i) => /* @__PURE__ */ jsxs(\"tspan\", { className: classNames(i % 2 !== 0 && classes.secondary), children: [\n    i > 0 && /* @__PURE__ */ jsx(\"tspan\", { children: \" / \" }),\n    r\n  ] }, r)) });\n}\n\nexport { DefaultRenderLabel };\n//# sourceMappingURL=DefaultRenderLabel.esm.js.map\n","import { jsx } from 'react/jsx-runtime';\nimport SvgIcon from '@material-ui/core/SvgIcon';\n\nfunction EntityIcon({\n  icon,\n  ...props\n}) {\n  const Icon = icon ?? SvgIcon;\n  return /* @__PURE__ */ jsx(Icon, { ...props });\n}\n\nexport { EntityIcon };\n//# sourceMappingURL=EntityIcon.esm.js.map\n","import { jsxs, jsx } from 'react/jsx-runtime';\nimport { useEntityPresentation } from '@backstage/plugin-catalog-react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport classNames from 'classnames';\nimport { useState, useRef, useLayoutEffect } from 'react';\nimport { EntityIcon } from './EntityIcon.esm.js';\nimport { DEFAULT_NAMESPACE } from '@backstage/catalog-model';\n\nconst useStyles = makeStyles(\n  (theme) => ({\n    node: {\n      fill: theme.palette.grey[300],\n      stroke: theme.palette.grey[300],\n      \"&.primary\": {\n        fill: theme.palette.primary.light,\n        stroke: theme.palette.primary.light\n      },\n      \"&.secondary\": {\n        fill: theme.palette.secondary.light,\n        stroke: theme.palette.secondary.light\n      }\n    },\n    text: {\n      fill: theme.palette.getContrastText(theme.palette.grey[300]),\n      \"&.primary\": {\n        fill: theme.palette.primary.contrastText\n      },\n      \"&.secondary\": {\n        fill: theme.palette.secondary.contrastText\n      },\n      \"&.focused\": {\n        fontWeight: \"bold\"\n      }\n    },\n    clickable: {\n      cursor: \"pointer\"\n    }\n  }),\n  { name: \"PluginCatalogGraphCustomNode\" }\n);\nfunction DefaultRenderNode({\n  node: { id, entity, color = \"default\", focused, onClick }\n}) {\n  const classes = useStyles();\n  const [width, setWidth] = useState(0);\n  const [height, setHeight] = useState(0);\n  const idRef = useRef(null);\n  const entityRefPresentationSnapshot = useEntityPresentation(entity, {\n    defaultNamespace: DEFAULT_NAMESPACE\n  });\n  useLayoutEffect(() => {\n    if (idRef.current) {\n      let { height: renderedHeight, width: renderedWidth } = idRef.current.getBBox();\n      renderedHeight = Math.round(renderedHeight);\n      renderedWidth = Math.round(renderedWidth);\n      if (renderedHeight !== height || renderedWidth !== width) {\n        setWidth(renderedWidth);\n        setHeight(renderedHeight);\n      }\n    }\n  }, [width, height]);\n  const hasKindIcon = !!entityRefPresentationSnapshot.Icon;\n  const padding = 10;\n  const iconSize = height;\n  const paddedIconWidth = hasKindIcon ? iconSize + padding : 0;\n  const paddedWidth = paddedIconWidth + width + padding * 2;\n  const paddedHeight = height + padding * 2;\n  const displayTitle = entityRefPresentationSnapshot.primaryTitle ?? id;\n  return /* @__PURE__ */ jsxs(\"g\", { onClick, className: classNames(onClick && classes.clickable), children: [\n    /* @__PURE__ */ jsx(\n      \"rect\",\n      {\n        className: classNames(\n          classes.node,\n          color === \"primary\" && \"primary\",\n          color === \"secondary\" && \"secondary\"\n        ),\n        width: paddedWidth,\n        height: paddedHeight,\n        rx: 10\n      }\n    ),\n    hasKindIcon && /* @__PURE__ */ jsx(\n      EntityIcon,\n      {\n        icon: entityRefPresentationSnapshot.Icon,\n        y: padding,\n        x: padding,\n        width: iconSize,\n        height: iconSize,\n        className: classNames(\n          classes.text,\n          focused && \"focused\",\n          color === \"primary\" && \"primary\",\n          color === \"secondary\" && \"secondary\"\n        )\n      }\n    ),\n    /* @__PURE__ */ jsx(\n      \"text\",\n      {\n        ref: idRef,\n        className: classNames(\n          classes.text,\n          focused && \"focused\",\n          color === \"primary\" && \"primary\",\n          color === \"secondary\" && \"secondary\"\n        ),\n        y: paddedHeight / 2,\n        x: paddedIconWidth + (width + padding * 2) / 2,\n        textAnchor: \"middle\",\n        alignmentBaseline: \"middle\",\n        children: displayTitle\n      }\n    ),\n    /* @__PURE__ */ jsx(\"title\", { children: entityRefPresentationSnapshot.entityRef })\n  ] });\n}\n\nexport { DefaultRenderNode };\n//# sourceMappingURL=DefaultRenderNode.esm.js.map\n","function concatRelations(a, b) {\n  return Array.from(/* @__PURE__ */ new Set([...a ?? [], ...b ?? []]));\n}\nconst mergeRelations = (options) => {\n  const mergedEdges = /* @__PURE__ */ new Map();\n  options.edges.forEach((edge) => {\n    const keyForward = `${edge.from}-${edge.to}`;\n    const keyBackward = `${edge.to}-${edge.from}`;\n    const edgeForward = mergedEdges.get(keyForward);\n    const edgeBackward = mergedEdges.get(keyBackward);\n    if (edgeForward) {\n      edgeForward.relations = concatRelations(\n        edgeForward.relations,\n        edge.relations\n      );\n    } else if (edgeBackward) {\n      edgeBackward.relations = concatRelations(\n        edgeBackward.relations,\n        edge.relations\n      );\n    } else {\n      mergedEdges.set(keyForward, edge);\n    }\n  });\n  options.edges = Array.from(mergedEdges.values());\n};\n\nexport { mergeRelations };\n//# sourceMappingURL=merge-relations.esm.js.map\n","import { reduceEdges } from './reduce-edges.esm.js';\nimport { setDistances } from './set-distance.esm.js';\nimport { orderForward } from './order-forward.esm.js';\nimport { stripDistantEdges } from './strip-distant-edges.esm.js';\nimport { mergeRelations } from './merge-relations.esm.js';\nimport { removeBackwardEdges } from './remove-backward-edges.esm.js';\n\nconst builtInTransformations = {\n  \"reduce-edges\": reduceEdges,\n  \"set-distances\": setDistances,\n  \"order-forward\": orderForward,\n  \"strip-distant-edges\": stripDistantEdges,\n  \"merge-relations\": mergeRelations,\n  \"remove-backward-edges\": removeBackwardEdges\n};\n\nexport { builtInTransformations };\n//# sourceMappingURL=index.esm.js.map\n","const reduceEdges = (ctx) => {\n  ctx.edges = ctx.edges.reduce((previousEdges, currentEdge) => {\n    const indexFound = previousEdges.findIndex(\n      (previousEdge) => previousEdge.from === currentEdge.from && previousEdge.to === currentEdge.to\n    );\n    if (indexFound >= 0) {\n      previousEdges[indexFound] = {\n        ...previousEdges[indexFound],\n        relations: Array.from(\n          /* @__PURE__ */ new Set([\n            ...previousEdges[indexFound].relations,\n            ...currentEdge.relations\n          ])\n        )\n      };\n      return previousEdges;\n    }\n    return [...previousEdges, currentEdge];\n  }, []);\n};\n\nexport { reduceEdges };\n//# sourceMappingURL=reduce-edges.esm.js.map\n","const setDistances = ({\n  nodeDistances,\n  edges,\n  rootEntityRefs\n}) => {\n  const edgeMap = /* @__PURE__ */ new Map();\n  edges.forEach((edge) => {\n    const fromEdges = edgeMap.get(edge.from) ?? [];\n    fromEdges.push(edge);\n    edgeMap.set(edge.from, fromEdges);\n    const toEdges = edgeMap.get(edge.to) ?? [];\n    toEdges.push(edge);\n    edgeMap.set(edge.to, toEdges);\n  });\n  rootEntityRefs.forEach((rootEntityRef) => {\n    nodeDistances.set(rootEntityRef, 0);\n  });\n  const visitedNodes = new Set(rootEntityRefs);\n  let currentNodes = rootEntityRefs;\n  let distance = 0;\n  while (currentNodes.length > 0) {\n    const thisDistance = ++distance;\n    const nextNodes = [];\n    currentNodes.forEach((node) => {\n      edgeMap.get(node)?.forEach((edge) => {\n        edge.distance ??= thisDistance;\n        const fromDistance = nodeDistances.get(edge.from) ?? thisDistance;\n        nodeDistances.set(edge.from, fromDistance);\n        nextNodes.push(edge.from);\n        const toDistance = nodeDistances.get(edge.to) ?? thisDistance;\n        nodeDistances.set(edge.to, toDistance);\n        nextNodes.push(edge.to);\n      });\n    });\n    for (const currentNode of currentNodes) {\n      visitedNodes.add(currentNode);\n    }\n    currentNodes = Array.from(new Set(nextNodes)).filter(\n      (node) => !visitedNodes.has(node)\n    );\n  }\n};\n\nexport { setDistances };\n//# sourceMappingURL=set-distance.esm.js.map\n","const orderForward = ({\n  rootEntityRefs,\n  nodes,\n  edges\n}) => {\n  const entityEdges = /* @__PURE__ */ new Map();\n  edges.forEach((edge) => {\n    let fromEdges = entityEdges.get(edge.from);\n    if (!fromEdges) {\n      fromEdges = [];\n      entityEdges.set(edge.from, fromEdges);\n    }\n    fromEdges.push(edge);\n    let toEdges = entityEdges.get(edge.to);\n    if (!toEdges) {\n      toEdges = [];\n      entityEdges.set(edge.to, toEdges);\n    }\n    toEdges.push(edge);\n  });\n  const visitedNodes = /* @__PURE__ */ new Set();\n  for (const rootEntityRef of rootEntityRefs) {\n    let currentNodes = [rootEntityRef].filter(\n      (node) => !visitedNodes.has(node)\n    );\n    while (currentNodes.length > 0) {\n      for (const currentNode of currentNodes) {\n        visitedNodes.add(currentNode);\n      }\n      const nextNodes = [];\n      currentNodes.forEach((node) => {\n        entityEdges.get(node)?.forEach((edge) => {\n          if (edge.to === node && !visitedNodes.has(edge.from)) {\n            const { from, to } = edge;\n            edge.from = to;\n            edge.to = from;\n            edge.relations.reverse();\n          }\n          nextNodes.push(edge.from, edge.to);\n        });\n      });\n      currentNodes = Array.from(new Set(nextNodes)).filter(\n        (node) => !visitedNodes.has(node)\n      );\n    }\n  }\n  const nodeOrder = Array.from(visitedNodes);\n  nodes.sort((a, b) => {\n    const aOrder = nodeOrder.findIndex((node) => node === a.id);\n    const bOrder = nodeOrder.findIndex((node) => node === b.id);\n    return aOrder - bOrder;\n  });\n};\n\nexport { orderForward };\n//# sourceMappingURL=order-forward.esm.js.map\n","const stripDistantEdges = (options) => {\n  const entityEdges = /* @__PURE__ */ new Map();\n  options.edges.forEach((edge) => {\n    let fromEdges = entityEdges.get(edge.from);\n    if (!fromEdges) {\n      fromEdges = [];\n      entityEdges.set(edge.from, fromEdges);\n    }\n    fromEdges.push(edge);\n    let toEdges = entityEdges.get(edge.to);\n    if (!toEdges) {\n      toEdges = [];\n      entityEdges.set(edge.to, toEdges);\n    }\n    toEdges.push(edge);\n  });\n  options.edges = options.edges.filter((edge) => {\n    const fromEdges = entityEdges.get(edge.from).filter(\n      (fromEdge) => !(fromEdge.from === edge.from && fromEdge.to === edge.to) && !(fromEdge.from === edge.to && fromEdge.to === edge.from)\n    );\n    const toEdges = entityEdges.get(edge.to).filter(\n      (toEdge) => !(toEdge.from === edge.from && toEdge.to === edge.to) && !(toEdge.from === edge.to && toEdge.to === edge.from)\n    );\n    if (fromEdges.length === 0 || toEdges.length === 0) {\n      return true;\n    }\n    const shorterFrom = fromEdges.some(\n      (fromEdge) => (fromEdge.distance ?? 0) < (edge.distance ?? 0)\n    );\n    const shorterTo = toEdges.some(\n      (toEdge) => (toEdge.distance ?? 0) < (edge.distance ?? 0)\n    );\n    if (shorterFrom && shorterTo) {\n      return false;\n    }\n    return true;\n  });\n};\n\nexport { stripDistantEdges };\n//# sourceMappingURL=strip-distant-edges.esm.js.map\n","const removeBackwardEdges = (ctx) => {\n  const { edges } = ctx;\n  const edgesMapFrom = /* @__PURE__ */ new Map();\n  edges.forEach((edge) => {\n    const theseEdges = edgesMapFrom.get(edge.from) ?? [];\n    theseEdges.push(edge);\n    edgesMapFrom.set(edge.from, theseEdges);\n  });\n  edges.forEach((edge) => {\n    if (edge.relations.length > 1) {\n      edge.relations = edge.relations.slice(0, 1);\n    }\n  });\n};\n\nexport { removeBackwardEdges };\n//# sourceMappingURL=remove-backward-edges.esm.js.map\n","import { jsxs, jsx } from 'react/jsx-runtime';\nimport { stringifyEntityRef } from '@backstage/catalog-model';\nimport { DependencyGraph, DependencyGraphTypes } from '@backstage/core-components';\nimport { useApi, errorApiRef } from '@backstage/core-plugin-api';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport { makeStyles, useTheme } from '@material-ui/core/styles';\nimport classNames from 'classnames';\nimport { useMemo, useEffect } from 'react';\nimport { DefaultRenderLabel } from './DefaultRenderLabel.esm.js';\nimport { DefaultRenderNode } from './DefaultRenderNode.esm.js';\nimport { Direction } from '../../lib/types/graph.esm.js';\nimport { useEntityRelationNodesAndEdges } from './useEntityRelationNodesAndEdges.esm.js';\n\nconst useStyles = makeStyles(\n  (theme) => ({\n    progress: {\n      position: \"absolute\",\n      left: \"50%\",\n      top: \"50%\",\n      marginLeft: \"-20px\",\n      marginTop: \"-20px\"\n    },\n    container: {\n      position: \"relative\",\n      width: \"100%\",\n      display: \"flex\",\n      flexDirection: \"column\"\n    },\n    graph: {\n      width: \"100%\",\n      flex: 1,\n      // Right now there is no good way to style edges between nodes, we have to\n      // fall back to these hacks:\n      \"& path[marker-end]\": {\n        transition: \"filter 0.1s ease-in-out\"\n      },\n      \"& path[marker-end]:hover\": {\n        filter: `drop-shadow(2px 2px 4px ${theme.palette.primary.dark});`\n      },\n      \"& g[data-testid=label]\": {\n        transition: \"transform 0s\"\n      }\n    }\n  }),\n  { name: \"PluginCatalogGraphEntityRelationsGraph\" }\n);\nconst EntityRelationsGraph = (props) => {\n  const {\n    rootEntityNames,\n    maxDepth = 2,\n    unidirectional = true,\n    mergeRelations = true,\n    kinds,\n    relations,\n    entityFilter,\n    direction = Direction.LEFT_RIGHT,\n    onNodeClick,\n    relationPairs,\n    className,\n    zoom = \"enabled\",\n    renderNode,\n    renderLabel,\n    renderEdge,\n    curve,\n    showArrowHeads,\n    allowFullscreen\n  } = props;\n  const theme = useTheme();\n  const classes = useStyles();\n  const rootEntityRefs = useMemo(\n    () => (Array.isArray(rootEntityNames) ? rootEntityNames : [rootEntityNames]).map((e) => stringifyEntityRef(e)),\n    [rootEntityNames]\n  );\n  const errorApi = useApi(errorApiRef);\n  const { loading, error, nodes, edges } = useEntityRelationNodesAndEdges({\n    rootEntityRefs,\n    maxDepth,\n    unidirectional,\n    mergeRelations,\n    kinds,\n    relations,\n    entityFilter,\n    onNodeClick,\n    relationPairs\n  });\n  useEffect(() => {\n    if (error) {\n      errorApi.post(error);\n    }\n  }, [errorApi, error]);\n  return /* @__PURE__ */ jsxs(\"div\", { className: classNames(classes.container, className), children: [\n    loading && /* @__PURE__ */ jsx(CircularProgress, { className: classes.progress }),\n    nodes && edges && /* @__PURE__ */ jsx(\n      DependencyGraph,\n      {\n        nodes,\n        edges,\n        renderNode: renderNode || DefaultRenderNode,\n        renderLabel: renderLabel || DefaultRenderLabel,\n        renderEdge,\n        direction,\n        className: classes.graph,\n        fit: \"contain\",\n        paddingX: theme.spacing(4),\n        paddingY: theme.spacing(4),\n        labelPosition: DependencyGraphTypes.LabelPosition.RIGHT,\n        labelOffset: theme.spacing(1),\n        zoom,\n        curve,\n        showArrowHeads,\n        allowFullscreen\n      }\n    )\n  ] });\n};\n\nexport { EntityRelationsGraph };\n//# sourceMappingURL=EntityRelationsGraph.esm.js.map\n","import { useState } from 'react';\nimport useDebounce from 'react-use/esm/useDebounce';\nimport { useEntityRelationGraph } from './useEntityRelationGraph.esm.js';\nimport { DEFAULT_NAMESPACE } from '@backstage/catalog-model';\nimport { useRelations } from '../../hooks/useRelations.esm.js';\nimport { buildGraph } from '../../lib/graph/build-graph.esm.js';\nimport { builtInTransformations } from '../../lib/graph-transformations/index.esm.js';\n\nfunction useEntityRelationNodesAndEdges({\n  rootEntityRefs,\n  maxDepth = Number.POSITIVE_INFINITY,\n  unidirectional = true,\n  mergeRelations = true,\n  kinds,\n  relations,\n  entityFilter,\n  onNodeClick,\n  relationPairs: incomingRelationPairs\n}) {\n  const [nodesAndEdges, setNodesAndEdges] = useState({});\n  const { entities, loading, error } = useEntityRelationGraph({\n    rootEntityRefs,\n    filter: {\n      maxDepth,\n      kinds,\n      relations,\n      entityFilter\n    }\n  });\n  const { relationPairs, includeRelation } = useRelations({\n    relations,\n    relationPairs: incomingRelationPairs\n  });\n  useDebounce(\n    () => {\n      if (!entities || Object.keys(entities).length === 0) {\n        setNodesAndEdges({});\n        return;\n      }\n      const nodes = Object.entries(entities).map(([entityRef, entity]) => {\n        const focused = rootEntityRefs.includes(entityRef);\n        const node = {\n          id: entityRef,\n          entity,\n          focused,\n          color: focused ? \"secondary\" : \"primary\",\n          // @deprecated\n          kind: entity.kind,\n          name: entity.metadata.name,\n          namespace: entity.metadata.namespace || DEFAULT_NAMESPACE,\n          title: entity.metadata.title,\n          spec: entity.spec\n        };\n        if (onNodeClick) {\n          node.onClick = (event) => onNodeClick(node, event);\n        }\n        return node;\n      });\n      const edges = buildGraph({\n        rootEntityRefs,\n        entities,\n        includeRelation,\n        kinds,\n        mergeRelations,\n        relationPairs,\n        unidirectional\n      });\n      const transformationContext = {\n        nodeDistances: /* @__PURE__ */ new Map(),\n        edges,\n        nodes,\n        rootEntityRefs,\n        unidirectional,\n        maxDepth\n      };\n      const runTransformation = (transformation) => {\n        if (typeof transformation === \"function\") {\n          transformation(transformationContext);\n        } else {\n          builtInTransformations[transformation](transformationContext);\n        }\n      };\n      runTransformation(\"reduce-edges\");\n      runTransformation(\"set-distances\");\n      if (unidirectional) {\n        runTransformation(\"strip-distant-edges\");\n      }\n      if (mergeRelations || unidirectional) {\n        runTransformation(\"merge-relations\");\n      }\n      if (unidirectional && !mergeRelations) {\n        runTransformation(\"order-forward\");\n        runTransformation(\"remove-backward-edges\");\n      }\n      setNodesAndEdges({\n        nodes: transformationContext.nodes,\n        edges: transformationContext.edges\n      });\n    },\n    100,\n    [\n      maxDepth,\n      entities,\n      rootEntityRefs,\n      kinds,\n      includeRelation,\n      unidirectional,\n      mergeRelations,\n      onNodeClick,\n      relationPairs\n    ]\n  );\n  return {\n    loading,\n    error,\n    ...nodesAndEdges\n  };\n}\n\nexport { useEntityRelationNodesAndEdges };\n//# sourceMappingURL=useEntityRelationNodesAndEdges.esm.js.map\n","import { useEffect, useMemo } from 'react';\nimport { useEntityStore } from './useEntityStore.esm.js';\nimport { pickBy } from 'lodash';\nimport { useRelations } from '../../hooks/useRelations.esm.js';\n\nfunction useEntityRelationGraph({\n  rootEntityRefs,\n  filter: {\n    maxDepth = Number.POSITIVE_INFINITY,\n    relations,\n    kinds,\n    entityFilter\n  } = {}\n}) {\n  const { entities, loading, error, requestEntities } = useEntityStore();\n  const { includeRelation } = useRelations({ relations });\n  useEffect(() => {\n    const expectedEntities = /* @__PURE__ */ new Set([...rootEntityRefs]);\n    const processedEntityRefs = /* @__PURE__ */ new Set();\n    let nextDepthRefQueue = [...rootEntityRefs];\n    let depth = 0;\n    while (nextDepthRefQueue.length > 0 && (!isFinite(maxDepth) || depth < maxDepth)) {\n      const entityRefQueue = nextDepthRefQueue;\n      nextDepthRefQueue = [];\n      while (entityRefQueue.length > 0) {\n        const entityRef = entityRefQueue.shift();\n        const entity = entities[entityRef];\n        processedEntityRefs.add(entityRef);\n        if (entity && entity.relations) {\n          if (entityFilter && !entityFilter(entity)) {\n            continue;\n          }\n          for (const rel of entity.relations) {\n            if (includeRelation(rel.type) && (!kinds || kinds.some(\n              (kind) => rel.targetRef.startsWith(\n                `${kind.toLocaleLowerCase(\"en-US\")}:`\n              )\n            ))) {\n              if (!processedEntityRefs.has(rel.targetRef)) {\n                nextDepthRefQueue.push(rel.targetRef);\n                expectedEntities.add(rel.targetRef);\n              }\n            }\n          }\n        }\n      }\n      ++depth;\n    }\n    requestEntities([...expectedEntities]);\n  }, [\n    entities,\n    rootEntityRefs,\n    maxDepth,\n    includeRelation,\n    kinds,\n    entityFilter,\n    requestEntities\n  ]);\n  const filteredEntities = useMemo(() => {\n    if (loading) {\n      return {};\n    }\n    return entityFilter ? pickBy(entities, (value, _key) => entityFilter(value)) : entities;\n  }, [loading, entities, entityFilter]);\n  return {\n    entities: filteredEntities,\n    loading,\n    error\n  };\n}\n\nexport { useEntityRelationGraph };\n//# sourceMappingURL=useEntityRelationGraph.esm.js.map\n","import { stringifyEntityRef } from '@backstage/catalog-model';\nimport { useApi } from '@backstage/core-plugin-api';\nimport { catalogApiRef } from '@backstage/plugin-catalog-react';\nimport { useRef, useState, useCallback } from 'react';\nimport useAsyncFn from 'react-use/esm/useAsyncFn';\n\nfunction useEntityStore() {\n  const catalogClient = useApi(catalogApiRef);\n  const state = useRef({\n    requestedEntities: /* @__PURE__ */ new Set(),\n    outstandingEntities: /* @__PURE__ */ new Map(),\n    cachedEntities: /* @__PURE__ */ new Map()\n  });\n  const [entities, setEntities] = useState({});\n  const updateEntities = useCallback(() => {\n    const { cachedEntities, requestedEntities } = state.current;\n    const filteredEntities = {};\n    requestedEntities.forEach((entityRef) => {\n      const entity = cachedEntities.get(entityRef);\n      if (entity) {\n        filteredEntities[entityRef] = entity;\n      }\n    });\n    setEntities(filteredEntities);\n  }, [state, setEntities]);\n  const [asyncState, fetch] = useAsyncFn(async () => {\n    const { requestedEntities, cachedEntities } = state.current;\n    const entityRefs = Array.from(requestedEntities).filter(\n      (entityRef) => !cachedEntities.has(entityRef)\n    );\n    if (entityRefs.length === 0) {\n      updateEntities();\n      return;\n    }\n    const { items } = await catalogClient.getEntitiesByRefs({ entityRefs });\n    items.forEach((ent) => {\n      if (ent) {\n        const entityRef = stringifyEntityRef(ent);\n        cachedEntities.set(entityRef, ent);\n      }\n    });\n    updateEntities();\n  }, [state, updateEntities]);\n  const { loading, error } = asyncState;\n  const requestEntities = useCallback(\n    (entityRefs) => {\n      const n = new Set(entityRefs);\n      const { requestedEntities } = state.current;\n      if (n.size !== requestedEntities.size || Array.from(n).some((e) => !requestedEntities.has(e))) {\n        state.current.requestedEntities = n;\n        fetch();\n        updateEntities();\n      }\n    },\n    [state, fetch, updateEntities]\n  );\n  return {\n    entities,\n    loading,\n    error,\n    requestEntities\n  };\n}\n\nexport { useEntityStore };\n//# sourceMappingURL=useEntityStore.esm.js.map\n","function buildGraph({\n  rootEntityRefs,\n  entities,\n  includeRelation,\n  kinds,\n  mergeRelations,\n  relationPairs,\n  unidirectional\n}) {\n  const edges = [];\n  const visitedNodes = /* @__PURE__ */ new Set();\n  const nodeQueue = [...rootEntityRefs];\n  const hasEdge = (fromRef, toRef, relation) => {\n    return edges.some(\n      (edge) => fromRef === edge.from && toRef === edge.to && edge.relations.some(\n        (rel) => rel[0] === relation[0] && rel[1] === relation[1]\n      )\n    );\n  };\n  while (nodeQueue.length > 0) {\n    const entityRef = nodeQueue.pop();\n    const entity = entities[entityRef];\n    visitedNodes.add(entityRef);\n    if (entity) {\n      entity?.relations?.forEach((rel) => {\n        if (!entities[rel.targetRef]) {\n          return;\n        }\n        if (!includeRelation(rel.type)) {\n          return;\n        }\n        if (kinds && !kinds.some(\n          (kind) => rel.targetRef.startsWith(`${kind.toLocaleLowerCase(\"en-US\")}:`)\n        )) {\n          return;\n        }\n        if (mergeRelations) {\n          const pair = relationPairs.find(\n            ([l, r]) => l === rel.type || r === rel.type\n          ) ?? [rel.type];\n          const [left] = pair;\n          const from = left === rel.type ? entityRef : rel.targetRef;\n          const to = left === rel.type ? rel.targetRef : entityRef;\n          if (!unidirectional || !hasEdge(from, to, pair)) {\n            edges.push({\n              from,\n              to,\n              relations: pair,\n              label: \"visible\"\n            });\n          }\n        } else {\n          if (!unidirectional || !hasEdge(entityRef, rel.targetRef, [rel.type])) {\n            edges.push({\n              from: entityRef,\n              to: rel.targetRef,\n              relations: [rel.type],\n              label: \"visible\"\n            });\n          }\n        }\n        if (!visitedNodes.has(rel.targetRef)) {\n          nodeQueue.push(rel.targetRef);\n          visitedNodes.add(rel.targetRef);\n        }\n        if (unidirectional) {\n          const findIndex = edges.findIndex(\n            (edge) => entityRef === edge.from && rel.targetRef === edge.to && !edge.relations.includes(rel.type)\n          );\n          if (findIndex >= 0) {\n            if (mergeRelations) {\n              const pair = relationPairs.find(\n                ([l, r]) => l === rel.type || r === rel.type\n              ) ?? [rel.type];\n              edges[findIndex].relations = [\n                ...edges[findIndex].relations,\n                ...pair\n              ];\n            } else {\n              edges[findIndex].relations = [\n                ...edges[findIndex].relations,\n                rel.type\n              ];\n            }\n          }\n        }\n      });\n    }\n  }\n  return edges;\n}\n\nexport { buildGraph };\n//# sourceMappingURL=build-graph.esm.js.map\n","import { useCallback, useMemo } from 'react';\nimport { useApi } from '@backstage/core-plugin-api';\nimport { catalogGraphApiRef } from '../api/CatalogGraphApi.esm.js';\nimport '@backstage/catalog-model';\n\nfunction useRelations(opts = {}) {\n  const { knownRelations, knownRelationPairs, defaultRelations } = useApi(catalogGraphApiRef);\n  const relations = opts.relations ?? knownRelations;\n  const relationPairs = opts.relationPairs ?? knownRelationPairs;\n  const relationsToInclude = opts.relations ?? defaultRelations;\n  const includeRelation = useCallback(\n    (type) => {\n      return relationsToInclude.includes(type);\n    },\n    [relationsToInclude]\n  );\n  return useMemo(\n    () => ({\n      relations,\n      relationPairs,\n      defaultRelations,\n      relationsToInclude,\n      includeRelation\n    }),\n    [\n      relations,\n      relationPairs,\n      defaultRelations,\n      relationsToInclude,\n      includeRelation\n    ]\n  );\n}\n\nexport { useRelations };\n//# sourceMappingURL=useRelations.esm.js.map\n","import { createTranslationRef } from '@backstage/frontend-plugin-api';\n\nconst catalogGraphTranslationRef = createTranslationRef({\n  id: \"catalog-graph\",\n  messages: {\n    catalogGraphCard: {\n      title: \"Relations\",\n      deepLinkTitle: \"View graph\"\n    },\n    catalogGraphPage: {\n      title: \"Catalog Graph\",\n      filterToggleButtonTitle: \"Filters\",\n      supportButtonDescription: \"Start tracking your component in by adding it to the software catalog.\",\n      simplifiedSwitchLabel: \"Simplified\",\n      mergeRelationsSwitchLabel: \"Merge relations\",\n      zoomOutDescription: \"Use pinch &amp; zoom to move around the diagram. Click to change active node, shift click to navigate to entity.\",\n      curveFilter: {\n        title: \"Curve\",\n        curveMonotoneX: \"Monotone X\",\n        curveStepBefore: \"Step Before\"\n      },\n      directionFilter: {\n        title: \"Direction\",\n        leftToRight: \"Left to right\",\n        rightToLeft: \"Right to left\",\n        topToBottom: \"Top to bottom\",\n        bottomToTop: \"Bottom to top\"\n      },\n      maxDepthFilter: {\n        title: \"Max depth\",\n        inputPlaceholder: \"\\u221E Infinite\",\n        clearButtonAriaLabel: \"clear max depth\"\n      },\n      selectedKindsFilter: {\n        title: \"Kinds\"\n      },\n      selectedRelationsFilter: {\n        title: \"Relations\"\n      }\n    }\n  }\n});\n\nexport { catalogGraphTranslationRef };\n//# sourceMappingURL=translation.esm.js.map\n"],"names":["u","Math","Array","Set","r","Map","e","t","l","isFinite","Object"],"mappings":"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"}