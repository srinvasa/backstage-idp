{"version":3,"file":"ReleasesCard.esm.js","sources":["../../../../src/components/Widgets/ReleasesCard/ReleasesCard.tsx"],"sourcesContent":["/*\n * Copyright 2025 Larder Software Limited\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Chip, Link, List, ListItem } from '@material-ui/core';\nimport LocalOfferOutlinedIcon from '@material-ui/icons/LocalOfferOutlined';\nimport Alert from '@material-ui/lab/Alert';\nimport {\n  InfoCard,\n  MissingAnnotationEmptyState,\n  Progress,\n} from '@backstage/core-components';\nimport { useRequest } from '../../../hooks/useRequest';\nimport { useEntityGithubScmIntegration } from '../../../hooks/useEntityGithubScmIntegration';\nimport { useProjectEntity } from '../../../hooks/useProjectEntity';\nimport {\n  GITHUB_INSIGHTS_ANNOTATION,\n  isGithubInsightsAvailable,\n} from '../../utils/isGithubInsightsAvailable';\nimport { useEntity } from '@backstage/plugin-catalog-react';\nimport { styles as useStyles } from '../../utils/styles';\nimport { getHostname } from '../../utils/githubUtils';\nimport { GitHubAuthorizationWrapper } from '@roadiehq/github-auth-utils-react';\n\ntype Release = {\n  id: number;\n  html_url: string;\n  tag_name: string;\n  prerelease: boolean;\n  name: string;\n};\n\nconst ReleasesCardContent = () => {\n  const classes = useStyles();\n  const { entity } = useEntity();\n\n  const { owner, repo } = useProjectEntity(entity);\n  const { value, loading, error } = useRequest(entity, 'releases', 0, 5);\n  const { hostname } = useEntityGithubScmIntegration(entity);\n\n  const projectAlert = isGithubInsightsAvailable(entity);\n  if (!projectAlert) {\n    return (\n      <MissingAnnotationEmptyState annotation={GITHUB_INSIGHTS_ANNOTATION} />\n    );\n  }\n\n  if (loading) {\n    return <Progress />;\n  } else if (error) {\n    return (\n      <Alert severity=\"error\" className={classes.infoCard}>\n        {error.message}\n      </Alert>\n    );\n  }\n\n  return value?.length && owner && repo ? (\n    <InfoCard\n      title=\"Releases\"\n      deepLink={{\n        link: `https://${hostname}/${owner}/${repo}/releases`,\n        title: 'Releases',\n        onClick: e => {\n          e.preventDefault();\n          window.open(`https://${hostname}/${owner}/${repo}/releases`);\n        },\n      }}\n      className={classes.infoCard}\n    >\n      <List>\n        {value.map((release: Release) => (\n          <ListItem className={classes.listItem} key={release.id}>\n            <Link\n              href={release.html_url}\n              color=\"inherit\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n            >\n              <p className={classes.releaseTitle}>{release.name}</p>\n              <LocalOfferOutlinedIcon\n                fontSize=\"inherit\"\n                className={classes.releaseTagIcon}\n              />{' '}\n              {release.tag_name}\n              {/* by {release.author.login} */}\n            </Link>\n            {release.prerelease && (\n              <Chip color=\"primary\" size=\"small\" label=\"Pre-release\" />\n            )}\n          </ListItem>\n        ))}\n      </List>\n    </InfoCard>\n  ) : (\n    <></>\n  );\n};\n\nconst ReleasesCard = () => {\n  const { entity } = useEntity();\n  const hostname = getHostname(entity);\n\n  return (\n    <GitHubAuthorizationWrapper title=\"Releases\" hostname={hostname}>\n      <ReleasesCardContent />\n    </GitHubAuthorizationWrapper>\n  );\n};\n\nexport default ReleasesCard;\n"],"names":["useStyles"],"mappings":"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"}