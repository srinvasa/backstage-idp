{"version":3,"file":"useEntityGithubScmIntegration.esm.js","sources":["../../src/hooks/useEntityGithubScmIntegration.ts"],"sourcesContent":["/*\n * Copyright 2021 Larder Software Limited\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useApi } from '@backstage/core-plugin-api';\nimport { scmIntegrationsApiRef } from '@backstage/integration-react';\nimport {\n  Entity,\n  parseLocationRef,\n  ANNOTATION_LOCATION,\n  ANNOTATION_SOURCE_LOCATION,\n} from '@backstage/catalog-model';\n\nconst defaultGithubIntegration = {\n  hostname: 'github.com',\n  baseUrl: 'https://api.github.com',\n};\n\nexport const useEntityGithubScmIntegration = (entity: Entity) => {\n  const integrations = useApi(scmIntegrationsApiRef);\n  if (!entity) {\n    return defaultGithubIntegration;\n  }\n\n  let location = entity.metadata.annotations?.[ANNOTATION_SOURCE_LOCATION];\n\n  if (!location) {\n    location = entity.metadata.annotations?.[ANNOTATION_LOCATION];\n  }\n\n  const { target } = parseLocationRef(location || '');\n\n  const scm = integrations.github.byUrl(target);\n  if (scm) {\n    return {\n      hostname: scm.config.host,\n      baseUrl: scm.config.apiBaseUrl,\n    };\n  }\n  return defaultGithubIntegration;\n};\n"],"names":[],"mappings":";;;;AAyBA,MAAM,wBAA2B,GAAA;AAAA,EAC/B,QAAU,EAAA,YAAA;AAAA,EACV,OAAS,EAAA;AACX,CAAA;AAEa,MAAA,6BAAA,GAAgC,CAAC,MAAmB,KAAA;AAC/D,EAAM,MAAA,YAAA,GAAe,OAAO,qBAAqB,CAAA;AACjD,EAAA,IAAI,CAAC,MAAQ,EAAA;AACX,IAAO,OAAA,wBAAA;AAAA;AAGT,EAAA,IAAI,QAAW,GAAA,MAAA,CAAO,QAAS,CAAA,WAAA,GAAc,0BAA0B,CAAA;AAEvE,EAAA,IAAI,CAAC,QAAU,EAAA;AACb,IAAW,QAAA,GAAA,MAAA,CAAO,QAAS,CAAA,WAAA,GAAc,mBAAmB,CAAA;AAAA;AAG9D,EAAA,MAAM,EAAE,MAAA,EAAW,GAAA,gBAAA,CAAiB,YAAY,EAAE,CAAA;AAElD,EAAA,MAAM,GAAM,GAAA,YAAA,CAAa,MAAO,CAAA,KAAA,CAAM,MAAM,CAAA;AAC5C,EAAA,IAAI,GAAK,EAAA;AACP,IAAO,OAAA;AAAA,MACL,QAAA,EAAU,IAAI,MAAO,CAAA,IAAA;AAAA,MACrB,OAAA,EAAS,IAAI,MAAO,CAAA;AAAA,KACtB;AAAA;AAEF,EAAO,OAAA,wBAAA;AACT;;;;"}