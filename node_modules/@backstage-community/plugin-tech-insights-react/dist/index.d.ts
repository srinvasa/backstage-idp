import * as _backstage_core_plugin_api from '@backstage/core-plugin-api';
import { DiscoveryApi, IdentityApi } from '@backstage/core-plugin-api';
import { CheckResult, Check, BulkCheckResponse, InsightFacts, FactSchema, CheckLink } from '@backstage-community/plugin-tech-insights-common';
import { ReactElement, PropsWithChildren, MouseEventHandler, ElementType, ReactNode } from 'react';
import { CompoundEntityRef, Entity } from '@backstage/catalog-model';
import { TechInsightsClient as TechInsightsClient$1 } from '@backstage-community/plugin-tech-insights-common/client';
import * as react_jsx_runtime from 'react/jsx-runtime';

/**
 * Defines a react component that is responsible for rendering a result of a given type.
 *
 * @public
 */
type CheckResultRenderer = {
    type: string;
    component: (check: CheckResult) => ReactElement;
    description?: (check: CheckResult) => string | ReactElement;
    isFailed?: (check: CheckResult) => boolean;
};
/**
 * Default renderer for json-rules-engine check results.
 *
 * @public
 */
declare const jsonRulesEngineCheckResultRenderer: CheckResultRenderer;

/**
 * {@link @backstage/core-plugin-api#ApiRef} for the {@link TechInsightsApi}
 *
 * @public
 */
declare const techInsightsApiRef: _backstage_core_plugin_api.ApiRef<TechInsightsApi>;
/**
 * Tech Insights API client interface
 *
 * @public
 */
interface TechInsightsApi {
    getCheckResultRenderers: (types: string[]) => CheckResultRenderer[];
    isCheckResultFailed: (check: CheckResult) => boolean;
    getAllChecks(): Promise<Check[]>;
    runChecks(entityParams: CompoundEntityRef, checks?: string[]): Promise<CheckResult[]>;
    runBulkChecks(entities: CompoundEntityRef[], checks?: Check[]): Promise<BulkCheckResponse>;
    getFacts(entity: CompoundEntityRef, facts: string[]): Promise<InsightFacts>;
    getFactSchemas(): Promise<FactSchema[]>;
    getLinksForEntity(result: CheckResult, entity: Entity, options?: {
        includeStaticLinks?: boolean;
    }): CheckLink[];
}

/**
 * Implementation of the {@link TechInsightsApi} interface.
 *
 * @public
 */
declare class TechInsightsClient extends TechInsightsClient$1 implements TechInsightsApi {
    private readonly renderers?;
    private readonly customGetEntityLinks;
    constructor(options: {
        discoveryApi: DiscoveryApi;
        identityApi: IdentityApi;
        renderers?: CheckResultRenderer[];
        getEntityLinks?: (result: CheckResult, entity: Entity) => CheckLink[];
    });
    /**
     * Get the check result renderers for the given check types.
     *
     * @param types - The types of checks to get renderers for
     * @returns An array of check result renderers
     *
     * @public
     */
    getCheckResultRenderers(types: string[]): CheckResultRenderer[];
    /**
     * Determine if a check result represents a failure.
     *
     * @param check - The check result to evaluate
     * @returns true if the check result represents a failure, false otherwise
     *
     * @public
     */
    isCheckResultFailed(check: CheckResult): boolean;
    /**
     * Get the links for a given check result and entity.
     *
     * @param result - The check result to get links for
     * @param entity - The entity to get links for
     * @param options - Optional options for the links
     * @returns An array of check links
     *
     * @public
     */
    getLinksForEntity(result: CheckResult, entity: Entity, options?: {
        includeStaticLinks?: boolean;
    }): CheckLink[];
}

/**
 * A component that renders a boolean check result as either a success or failure icon.
 *
 * @public
 */
declare const BooleanCheck: (props: {
    checkResult: CheckResult;
}) => react_jsx_runtime.JSX.Element;
/**
 * Helper function to determine if a boolean check result represents a failure.
 *
 * @returns true if the check result represents a failure (result is false), false otherwise
 *
 * @public
 */
declare const isBooleanCheckFailed: (checkResult: CheckResult) => boolean;

/** @public */
type ResultCheckIconBaseComponentProps = PropsWithChildren<{
    onClick?: MouseEventHandler;
}>;
/**
 * ResultCheckIcon props
 *
 * The only necessary prop is {@link ResultCheckIconProps.result}, but if
 * {@link ResultCheckIconProps.entity} is provided, the popup menu with links
 * will also include links specifically for this entity.
 *
 * @public
 */
interface ResultCheckIconProps<P extends ResultCheckIconBaseComponentProps> {
    /**
     * The CheckResult object to create an icon for
     */
    result: CheckResult;
    /**
     * The entity for which this check result is created. This is optional, but if
     * provided, entity-specific links will be added to the popup menu, if any.
     */
    entity?: Entity;
    /**
     * This can optionally be provided, with a small performance improvement, if
     * it is already cashed upstream.
     */
    checkResultRenderer?: CheckResultRenderer;
    /**
     * Will disable the popup menu
     */
    disableLinksMenu?: boolean;
    /**
     * The icon is rendered with an `IconButton` which handles the onClick.
     * To wrap this in another component, handling the onClick, pass a component,
     * such as `ListItemSecondaryAction` which handles the `onClick` to open the
     * popup menu.
     *
     * The {@link ResultCheckIconProps.componentProps} prop can be specified to
     * add props to the wrapping component.
     */
    component?: ElementType<P>;
    /**
     * Props to provide to the wrapping component
     * {@link ResultCheckIconProps.component}.
     */
    componentProps?: Omit<P, 'onClick' | 'children'>;
    /**
     * Override the component used to display instead of a result icon, when no
     * renderer was found for this check type.
     */
    missingRendererComponent?: ReactNode;
}
/**
 * A component that renders an icon representing a check result, optionally with a popup menu
 * containing links related to the check.
 *
 * @public
 */
declare const ResultCheckIcon: <P extends ResultCheckIconBaseComponentProps>(props: ResultCheckIconProps<P>) => react_jsx_runtime.JSX.Element;

/**
 * ResultLinksMenu setMenu receiver.
 *
 * This object contains an {@link ResultLinksMenuInfo.open | open} function,
 * which can be used to open the popup menu. It closes automatically on
 * click-away.
 *
 * @public
 */
type ResultLinksMenuInfo = {
    /**
     * Call this function to open the popup menu. The element argument should be
     * an element which is used as an anchor for the menu - where to display it.
     */
    open: (element: Element) => void;
};
/**
 * A component that renders a popup menu with links related to a check result.
 *
 * @public
 */
declare const ResultLinksMenu: (props: PropsWithChildren<{
    result: CheckResult;
    entity?: Entity | undefined;
    setMenu(opener: ResultLinksMenuInfo | undefined): void;
}>) => react_jsx_runtime.JSX.Element | null;

export { BooleanCheck, type CheckResultRenderer, ResultCheckIcon, type ResultCheckIconBaseComponentProps, type ResultCheckIconProps, ResultLinksMenu, type ResultLinksMenuInfo, type TechInsightsApi, TechInsightsClient, isBooleanCheckFailed, jsonRulesEngineCheckResultRenderer, techInsightsApiRef };
