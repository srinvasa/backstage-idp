{"version":3,"file":"CheckRegistry.cjs.js","sources":["../../src/service/CheckRegistry.ts"],"sourcesContent":["/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ConflictError, NotFoundError } from '@backstage/errors';\nimport { TechInsightCheckRegistry } from '@backstage-community/plugin-tech-insights-node';\nimport { Check } from '@backstage-community/plugin-tech-insights-common';\n\nexport class DefaultCheckRegistry<CheckType extends Check>\n  implements TechInsightCheckRegistry<CheckType>\n{\n  private readonly checks = new Map<string, CheckType>();\n\n  constructor(checks: CheckType[]) {\n    checks.forEach(check => {\n      this.register(check);\n    });\n  }\n\n  async register(check: CheckType): Promise<CheckType> {\n    if (this.checks.has(check.id)) {\n      throw new ConflictError(\n        `Tech insight check with id ${check.id} has already been registered`,\n      );\n    }\n    this.checks.set(check.id, check);\n    return check;\n  }\n\n  async get(checkId: string): Promise<CheckType> {\n    const check = this.checks.get(checkId);\n    if (!check) {\n      throw new NotFoundError(\n        `Tech insight check with id '${checkId}' is not registered.`,\n      );\n    }\n    return check;\n  }\n  async getAll(checks: string[]): Promise<CheckType[]> {\n    return Promise.all(checks.map(checkId => this.get(checkId)));\n  }\n\n  async list(): Promise<CheckType[]> {\n    return [...this.checks.values()];\n  }\n}\n"],"names":["ConflictError","NotFoundError"],"mappings":";;;;AAoBO,MAAM,oBAEb,CAAA;AAAA,EACmB,MAAA,uBAAa,GAAuB,EAAA;AAAA,EAErD,YAAY,MAAqB,EAAA;AAC/B,IAAA,MAAA,CAAO,QAAQ,CAAS,KAAA,KAAA;AACtB,MAAA,IAAA,CAAK,SAAS,KAAK,CAAA;AAAA,KACpB,CAAA;AAAA;AACH,EAEA,MAAM,SAAS,KAAsC,EAAA;AACnD,IAAA,IAAI,IAAK,CAAA,MAAA,CAAO,GAAI,CAAA,KAAA,CAAM,EAAE,CAAG,EAAA;AAC7B,MAAA,MAAM,IAAIA,oBAAA;AAAA,QACR,CAAA,2BAAA,EAA8B,MAAM,EAAE,CAAA,4BAAA;AAAA,OACxC;AAAA;AAEF,IAAA,IAAA,CAAK,MAAO,CAAA,GAAA,CAAI,KAAM,CAAA,EAAA,EAAI,KAAK,CAAA;AAC/B,IAAO,OAAA,KAAA;AAAA;AACT,EAEA,MAAM,IAAI,OAAqC,EAAA;AAC7C,IAAA,MAAM,KAAQ,GAAA,IAAA,CAAK,MAAO,CAAA,GAAA,CAAI,OAAO,CAAA;AACrC,IAAA,IAAI,CAAC,KAAO,EAAA;AACV,MAAA,MAAM,IAAIC,oBAAA;AAAA,QACR,+BAA+B,OAAO,CAAA,oBAAA;AAAA,OACxC;AAAA;AAEF,IAAO,OAAA,KAAA;AAAA;AACT,EACA,MAAM,OAAO,MAAwC,EAAA;AACnD,IAAO,OAAA,OAAA,CAAQ,IAAI,MAAO,CAAA,GAAA,CAAI,aAAW,IAAK,CAAA,GAAA,CAAI,OAAO,CAAC,CAAC,CAAA;AAAA;AAC7D,EAEA,MAAM,IAA6B,GAAA;AACjC,IAAA,OAAO,CAAC,GAAG,IAAK,CAAA,MAAA,CAAO,QAAQ,CAAA;AAAA;AAEnC;;;;"}